{
  "origin": "codeshovel",
  "repositoryName": "checkstyle",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/checkstyle/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "OneTopLevelClassCheck.java",
  "functionName": "beginTree",
  "functionId": "beginTree___rootAST-DetailAST",
  "sourceFilePath": "src/main/java/com/puppycrawl/tools/checkstyle/checks/design/OneTopLevelClassCheck.java",
  "functionStartLine": 108,
  "functionEndLine": 139,
  "numCommitsSeen": 40,
  "timeTaken": 1436,
  "changeHistory": [
    "32c6d986004ec58f883f1d0651fccb376f1ef33a",
    "e73ec41c667a6aa5bf3213be9fb0a853d372a1c6",
    "949f78ab6084827c8f0027fd0e925133aefdcb70",
    "50c9bb69bcd93e6fbf272670e8b9d95f2f451c5f",
    "9d93afb1f351d4619953e9ac18c59423b8623e81"
  ],
  "changeHistoryShort": {
    "32c6d986004ec58f883f1d0651fccb376f1ef33a": "Ybodychange",
    "e73ec41c667a6aa5bf3213be9fb0a853d372a1c6": "Ybodychange",
    "949f78ab6084827c8f0027fd0e925133aefdcb70": "Ybodychange",
    "50c9bb69bcd93e6fbf272670e8b9d95f2f451c5f": "Ymultichange(Yparameterchange,Ybodychange)",
    "9d93afb1f351d4619953e9ac18c59423b8623e81": "Yintroduced"
  },
  "changeHistoryDetails": {
    "32c6d986004ec58f883f1d0651fccb376f1ef33a": {
      "type": "Ybodychange",
      "commitMessage": "Issue #7812: OneTopLevelClass: Improve data structure efficiency\n",
      "commitDate": "03/04/20 6:21 AM",
      "commitName": "32c6d986004ec58f883f1d0651fccb376f1ef33a",
      "commitAuthor": "wltan",
      "commitDateOld": "10/03/20 10:58 PM",
      "commitNameOld": "e73ec41c667a6aa5bf3213be9fb0a853d372a1c6",
      "commitAuthorOld": "wltan",
      "daysBetweenCommits": 23.31,
      "commitsBetweenForRepo": 100,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,21 +1,32 @@\n     public void beginTree(DetailAST rootAST) {\n-        publicTypeFound \u003d false;\n-        lineNumberTypeMap.clear();\n-\n         DetailAST currentNode \u003d rootAST;\n+        boolean publicTypeFound \u003d false;\n+        DetailAST firstType \u003d null;\n+\n         while (currentNode !\u003d null) {\n-            if (currentNode.getType() \u003d\u003d TokenTypes.CLASS_DEF\n-                    || currentNode.getType() \u003d\u003d TokenTypes.ENUM_DEF\n-                    || currentNode.getType() \u003d\u003d TokenTypes.INTERFACE_DEF) {\n+            if (isTypeDef(currentNode)) {\n                 if (isPublic(currentNode)) {\n+                    // log the first type later\n                     publicTypeFound \u003d true;\n                 }\n-                else {\n+                if (firstType \u003d\u003d null) {\n+                    // first type is set aside\n+                    firstType \u003d currentNode;\n+                }\n+                else if (!isPublic(currentNode)) {\n+                    // extra non-public type, log immediately\n                     final String typeName \u003d currentNode\n-                            .findFirstToken(TokenTypes.IDENT).getText();\n-                    lineNumberTypeMap.put(currentNode, typeName);\n+                        .findFirstToken(TokenTypes.IDENT).getText();\n+                    log(currentNode, MSG_KEY, typeName);\n                 }\n             }\n             currentNode \u003d currentNode.getNextSibling();\n         }\n+\n+        // if there was a public type and first type is non-public, log it\n+        if (publicTypeFound \u0026\u0026 !isPublic(firstType)) {\n+            final String typeName \u003d firstType\n+                .findFirstToken(TokenTypes.IDENT).getText();\n+            log(firstType, MSG_KEY, typeName);\n+        }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void beginTree(DetailAST rootAST) {\n        DetailAST currentNode \u003d rootAST;\n        boolean publicTypeFound \u003d false;\n        DetailAST firstType \u003d null;\n\n        while (currentNode !\u003d null) {\n            if (isTypeDef(currentNode)) {\n                if (isPublic(currentNode)) {\n                    // log the first type later\n                    publicTypeFound \u003d true;\n                }\n                if (firstType \u003d\u003d null) {\n                    // first type is set aside\n                    firstType \u003d currentNode;\n                }\n                else if (!isPublic(currentNode)) {\n                    // extra non-public type, log immediately\n                    final String typeName \u003d currentNode\n                        .findFirstToken(TokenTypes.IDENT).getText();\n                    log(currentNode, MSG_KEY, typeName);\n                }\n            }\n            currentNode \u003d currentNode.getNextSibling();\n        }\n\n        // if there was a public type and first type is non-public, log it\n        if (publicTypeFound \u0026\u0026 !isPublic(firstType)) {\n            final String typeName \u003d firstType\n                .findFirstToken(TokenTypes.IDENT).getText();\n            log(firstType, MSG_KEY, typeName);\n        }\n    }",
      "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/design/OneTopLevelClassCheck.java",
      "extendedDetails": {}
    },
    "e73ec41c667a6aa5bf3213be9fb0a853d372a1c6": {
      "type": "Ybodychange",
      "commitMessage": "Issue #7754: Update AbstractChecks to log DetailAST - OneTopLevelClass\n",
      "commitDate": "10/03/20 10:58 PM",
      "commitName": "e73ec41c667a6aa5bf3213be9fb0a853d372a1c6",
      "commitAuthor": "wltan",
      "commitDateOld": "07/03/20 6:52 PM",
      "commitNameOld": "abf829f542023e089c741c55f73098cae52dcb12",
      "commitAuthorOld": "wltan",
      "daysBetweenCommits": 3.13,
      "commitsBetweenForRepo": 14,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,21 +1,21 @@\n     public void beginTree(DetailAST rootAST) {\n         publicTypeFound \u003d false;\n         lineNumberTypeMap.clear();\n \n         DetailAST currentNode \u003d rootAST;\n         while (currentNode !\u003d null) {\n             if (currentNode.getType() \u003d\u003d TokenTypes.CLASS_DEF\n                     || currentNode.getType() \u003d\u003d TokenTypes.ENUM_DEF\n                     || currentNode.getType() \u003d\u003d TokenTypes.INTERFACE_DEF) {\n                 if (isPublic(currentNode)) {\n                     publicTypeFound \u003d true;\n                 }\n                 else {\n                     final String typeName \u003d currentNode\n                             .findFirstToken(TokenTypes.IDENT).getText();\n-                    lineNumberTypeMap.put(currentNode.getLineNo(), typeName);\n+                    lineNumberTypeMap.put(currentNode, typeName);\n                 }\n             }\n             currentNode \u003d currentNode.getNextSibling();\n         }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void beginTree(DetailAST rootAST) {\n        publicTypeFound \u003d false;\n        lineNumberTypeMap.clear();\n\n        DetailAST currentNode \u003d rootAST;\n        while (currentNode !\u003d null) {\n            if (currentNode.getType() \u003d\u003d TokenTypes.CLASS_DEF\n                    || currentNode.getType() \u003d\u003d TokenTypes.ENUM_DEF\n                    || currentNode.getType() \u003d\u003d TokenTypes.INTERFACE_DEF) {\n                if (isPublic(currentNode)) {\n                    publicTypeFound \u003d true;\n                }\n                else {\n                    final String typeName \u003d currentNode\n                            .findFirstToken(TokenTypes.IDENT).getText();\n                    lineNumberTypeMap.put(currentNode, typeName);\n                }\n            }\n            currentNode \u003d currentNode.getNextSibling();\n        }\n    }",
      "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/design/OneTopLevelClassCheck.java",
      "extendedDetails": {}
    },
    "949f78ab6084827c8f0027fd0e925133aefdcb70": {
      "type": "Ybodychange",
      "commitMessage": "OneTopLevelClass check example is broken and documentation missing, for \u0027tokens\u0027 property. Issue #1017\n",
      "commitDate": "30/04/15 5:08 PM",
      "commitName": "949f78ab6084827c8f0027fd0e925133aefdcb70",
      "commitAuthor": "Roman Ivanov",
      "commitDateOld": "08/04/15 12:11 PM",
      "commitNameOld": "95fc97c6d8b63393d8f07c65b501820d46272d42",
      "commitAuthorOld": "Michal Kordas",
      "daysBetweenCommits": 22.21,
      "commitsBetweenForRepo": 117,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,21 +1,23 @@\n     public void beginTree(DetailAST rootAST)\n     {\n+        publicTypeFound \u003d false;\n+        lineNumberTypeMap.clear();\n+\n         DetailAST currentNode \u003d rootAST;\n         while (currentNode !\u003d null) {\n             if (currentNode.getType() \u003d\u003d TokenTypes.CLASS_DEF\n                     || currentNode.getType() \u003d\u003d TokenTypes.ENUM_DEF\n                     || currentNode.getType() \u003d\u003d TokenTypes.INTERFACE_DEF)\n             {\n                 if (isPublic(currentNode)) {\n                     publicTypeFound \u003d true;\n                 }\n-\n                 else {\n                     final String typeName \u003d currentNode.\n                             findFirstToken(TokenTypes.IDENT).getText();\n                     lineNumberTypeMap.put(currentNode.getLineNo(), typeName);\n                 }\n             }\n             currentNode \u003d currentNode.getNextSibling();\n         }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void beginTree(DetailAST rootAST)\n    {\n        publicTypeFound \u003d false;\n        lineNumberTypeMap.clear();\n\n        DetailAST currentNode \u003d rootAST;\n        while (currentNode !\u003d null) {\n            if (currentNode.getType() \u003d\u003d TokenTypes.CLASS_DEF\n                    || currentNode.getType() \u003d\u003d TokenTypes.ENUM_DEF\n                    || currentNode.getType() \u003d\u003d TokenTypes.INTERFACE_DEF)\n            {\n                if (isPublic(currentNode)) {\n                    publicTypeFound \u003d true;\n                }\n                else {\n                    final String typeName \u003d currentNode.\n                            findFirstToken(TokenTypes.IDENT).getText();\n                    lineNumberTypeMap.put(currentNode.getLineNo(), typeName);\n                }\n            }\n            currentNode \u003d currentNode.getNextSibling();\n        }\n    }",
      "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/design/OneTopLevelClassCheck.java",
      "extendedDetails": {}
    },
    "50c9bb69bcd93e6fbf272670e8b9d95f2f451c5f": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "Prefixes, design, #512\n",
      "commitDate": "19/01/15 6:21 AM",
      "commitName": "50c9bb69bcd93e6fbf272670e8b9d95f2f451c5f",
      "commitAuthor": "alexkravin",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "Prefixes, design, #512\n",
          "commitDate": "19/01/15 6:21 AM",
          "commitName": "50c9bb69bcd93e6fbf272670e8b9d95f2f451c5f",
          "commitAuthor": "alexkravin",
          "commitDateOld": "05/07/14 6:58 AM",
          "commitNameOld": "9d93afb1f351d4619953e9ac18c59423b8623e81",
          "commitAuthorOld": "Max",
          "daysBetweenCommits": 198.02,
          "commitsBetweenForRepo": 424,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,21 +1,21 @@\n-    public void beginTree(DetailAST aRootAST)\n+    public void beginTree(DetailAST rootAST)\n     {\n-        DetailAST currentNode \u003d aRootAST;\n+        DetailAST currentNode \u003d rootAST;\n         while (currentNode !\u003d null) {\n             if (currentNode.getType() \u003d\u003d TokenTypes.CLASS_DEF\n                     || currentNode.getType() \u003d\u003d TokenTypes.ENUM_DEF\n                     || currentNode.getType() \u003d\u003d TokenTypes.INTERFACE_DEF)\n             {\n                 if (isPublic(currentNode)) {\n-                    mPublicTypeFound \u003d true;\n+                    publicTypeFound \u003d true;\n                 }\n \n                 else {\n                     final String typeName \u003d currentNode.\n                             findFirstToken(TokenTypes.IDENT).getText();\n-                    mLineNumberTypeMap.put(currentNode.getLineNo(), typeName);\n+                    lineNumberTypeMap.put(currentNode.getLineNo(), typeName);\n                 }\n             }\n             currentNode \u003d currentNode.getNextSibling();\n         }\n     }\n\\ No newline at end of file\n",
          "actualSource": "    public void beginTree(DetailAST rootAST)\n    {\n        DetailAST currentNode \u003d rootAST;\n        while (currentNode !\u003d null) {\n            if (currentNode.getType() \u003d\u003d TokenTypes.CLASS_DEF\n                    || currentNode.getType() \u003d\u003d TokenTypes.ENUM_DEF\n                    || currentNode.getType() \u003d\u003d TokenTypes.INTERFACE_DEF)\n            {\n                if (isPublic(currentNode)) {\n                    publicTypeFound \u003d true;\n                }\n\n                else {\n                    final String typeName \u003d currentNode.\n                            findFirstToken(TokenTypes.IDENT).getText();\n                    lineNumberTypeMap.put(currentNode.getLineNo(), typeName);\n                }\n            }\n            currentNode \u003d currentNode.getNextSibling();\n        }\n    }",
          "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/design/OneTopLevelClassCheck.java",
          "extendedDetails": {
            "oldValue": "[aRootAST-DetailAST]",
            "newValue": "[rootAST-DetailAST]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "Prefixes, design, #512\n",
          "commitDate": "19/01/15 6:21 AM",
          "commitName": "50c9bb69bcd93e6fbf272670e8b9d95f2f451c5f",
          "commitAuthor": "alexkravin",
          "commitDateOld": "05/07/14 6:58 AM",
          "commitNameOld": "9d93afb1f351d4619953e9ac18c59423b8623e81",
          "commitAuthorOld": "Max",
          "daysBetweenCommits": 198.02,
          "commitsBetweenForRepo": 424,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,21 +1,21 @@\n-    public void beginTree(DetailAST aRootAST)\n+    public void beginTree(DetailAST rootAST)\n     {\n-        DetailAST currentNode \u003d aRootAST;\n+        DetailAST currentNode \u003d rootAST;\n         while (currentNode !\u003d null) {\n             if (currentNode.getType() \u003d\u003d TokenTypes.CLASS_DEF\n                     || currentNode.getType() \u003d\u003d TokenTypes.ENUM_DEF\n                     || currentNode.getType() \u003d\u003d TokenTypes.INTERFACE_DEF)\n             {\n                 if (isPublic(currentNode)) {\n-                    mPublicTypeFound \u003d true;\n+                    publicTypeFound \u003d true;\n                 }\n \n                 else {\n                     final String typeName \u003d currentNode.\n                             findFirstToken(TokenTypes.IDENT).getText();\n-                    mLineNumberTypeMap.put(currentNode.getLineNo(), typeName);\n+                    lineNumberTypeMap.put(currentNode.getLineNo(), typeName);\n                 }\n             }\n             currentNode \u003d currentNode.getNextSibling();\n         }\n     }\n\\ No newline at end of file\n",
          "actualSource": "    public void beginTree(DetailAST rootAST)\n    {\n        DetailAST currentNode \u003d rootAST;\n        while (currentNode !\u003d null) {\n            if (currentNode.getType() \u003d\u003d TokenTypes.CLASS_DEF\n                    || currentNode.getType() \u003d\u003d TokenTypes.ENUM_DEF\n                    || currentNode.getType() \u003d\u003d TokenTypes.INTERFACE_DEF)\n            {\n                if (isPublic(currentNode)) {\n                    publicTypeFound \u003d true;\n                }\n\n                else {\n                    final String typeName \u003d currentNode.\n                            findFirstToken(TokenTypes.IDENT).getText();\n                    lineNumberTypeMap.put(currentNode.getLineNo(), typeName);\n                }\n            }\n            currentNode \u003d currentNode.getNextSibling();\n        }\n    }",
          "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/design/OneTopLevelClassCheck.java",
          "extendedDetails": {}
        }
      ]
    },
    "9d93afb1f351d4619953e9ac18c59423b8623e81": {
      "type": "Yintroduced",
      "commitMessage": "OneTopLevelClass #172\n",
      "commitDate": "05/07/14 6:58 AM",
      "commitName": "9d93afb1f351d4619953e9ac18c59423b8623e81",
      "commitAuthor": "Max",
      "diff": "@@ -0,0 +1,21 @@\n+    public void beginTree(DetailAST aRootAST)\n+    {\n+        DetailAST currentNode \u003d aRootAST;\n+        while (currentNode !\u003d null) {\n+            if (currentNode.getType() \u003d\u003d TokenTypes.CLASS_DEF\n+                    || currentNode.getType() \u003d\u003d TokenTypes.ENUM_DEF\n+                    || currentNode.getType() \u003d\u003d TokenTypes.INTERFACE_DEF)\n+            {\n+                if (isPublic(currentNode)) {\n+                    mPublicTypeFound \u003d true;\n+                }\n+\n+                else {\n+                    final String typeName \u003d currentNode.\n+                            findFirstToken(TokenTypes.IDENT).getText();\n+                    mLineNumberTypeMap.put(currentNode.getLineNo(), typeName);\n+                }\n+            }\n+            currentNode \u003d currentNode.getNextSibling();\n+        }\n+    }\n\\ No newline at end of file\n",
      "actualSource": "    public void beginTree(DetailAST aRootAST)\n    {\n        DetailAST currentNode \u003d aRootAST;\n        while (currentNode !\u003d null) {\n            if (currentNode.getType() \u003d\u003d TokenTypes.CLASS_DEF\n                    || currentNode.getType() \u003d\u003d TokenTypes.ENUM_DEF\n                    || currentNode.getType() \u003d\u003d TokenTypes.INTERFACE_DEF)\n            {\n                if (isPublic(currentNode)) {\n                    mPublicTypeFound \u003d true;\n                }\n\n                else {\n                    final String typeName \u003d currentNode.\n                            findFirstToken(TokenTypes.IDENT).getText();\n                    mLineNumberTypeMap.put(currentNode.getLineNo(), typeName);\n                }\n            }\n            currentNode \u003d currentNode.getNextSibling();\n        }\n    }",
      "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/design/OneTopLevelClassCheck.java"
    }
  }
}