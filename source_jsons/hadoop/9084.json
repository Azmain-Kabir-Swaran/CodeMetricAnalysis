{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "FSNamesystem.java",
  "functionName": "closeFileCommitBlocks",
  "functionId": "closeFileCommitBlocks___src-String__pendingFile-INodeFile__storedBlock-BlockInfo",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
  "functionStartLine": 4036,
  "functionEndLine": 4046,
  "numCommitsSeen": 2856,
  "timeTaken": 45926,
  "changeHistory": [
    "bd909ed9f2d853f614f04a50e2230a7932732776",
    "0b18e5e8c69b40c9a446fff448d38e0dd10cb45e",
    "4928f5473394981829e5ffd4b16ea0801baf5c45",
    "9f2f583f401189c3f4a2687795a9e3e0b288322b",
    "1382ae525c67bf95d8f3a436b547dbc72cfbb177",
    "c78e3a7cdd10c40454e9acb06986ba6d8573cb19",
    "fd2ba4911bec60386a106c85aedd5cc99cd8cab3",
    "70cff9e2f0c8f78c1dc54a064182971bb2106795",
    "ce68f410b05a58ad05965f32ad7f5b246b363a75",
    "f138ae68f9be0ae072a6a4ee50e94a1608c90edb"
  ],
  "changeHistoryShort": {
    "bd909ed9f2d853f614f04a50e2230a7932732776": "Ybodychange",
    "0b18e5e8c69b40c9a446fff448d38e0dd10cb45e": "Ymultichange(Yparameterchange,Yreturntypechange,Ybodychange)",
    "4928f5473394981829e5ffd4b16ea0801baf5c45": "Yparameterchange",
    "9f2f583f401189c3f4a2687795a9e3e0b288322b": "Yparameterchange",
    "1382ae525c67bf95d8f3a436b547dbc72cfbb177": "Yparameterchange",
    "c78e3a7cdd10c40454e9acb06986ba6d8573cb19": "Ybodychange",
    "fd2ba4911bec60386a106c85aedd5cc99cd8cab3": "Ybodychange",
    "70cff9e2f0c8f78c1dc54a064182971bb2106795": "Ybodychange",
    "ce68f410b05a58ad05965f32ad7f5b246b363a75": "Yparameterchange",
    "f138ae68f9be0ae072a6a4ee50e94a1608c90edb": "Yintroduced"
  },
  "changeHistoryDetails": {
    "bd909ed9f2d853f614f04a50e2230a7932732776": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-8999. Allow a file to be closed with COMMITTED but not yet COMPLETE blocks.\n",
      "commitDate": "25/01/16 6:32 PM",
      "commitName": "bd909ed9f2d853f614f04a50e2230a7932732776",
      "commitAuthor": "Tsz-Wo Nicholas Sze",
      "commitDateOld": "24/01/16 2:19 PM",
      "commitNameOld": "10a2bc0dffaece216eb9a6bac3236a086b9ece31",
      "commitAuthorOld": "Eric Yang",
      "daysBetweenCommits": 1.18,
      "commitsBetweenForRepo": 11,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,11 +1,11 @@\n   void closeFileCommitBlocks(String src, INodeFile pendingFile,\n       BlockInfo storedBlock) throws IOException {\n     final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n \n     // commit the last block and complete it if it has minimum replicas\n     commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n \n     //remove lease, close file\n-    finalizeINodeFileUnderConstruction(src, pendingFile,\n-        Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID));\n+    int s \u003d Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID);\n+    finalizeINodeFileUnderConstruction(src, pendingFile, s, false);\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void closeFileCommitBlocks(String src, INodeFile pendingFile,\n      BlockInfo storedBlock) throws IOException {\n    final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n\n    // commit the last block and complete it if it has minimum replicas\n    commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n\n    //remove lease, close file\n    int s \u003d Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID);\n    finalizeINodeFileUnderConstruction(src, pendingFile, s, false);\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
      "extendedDetails": {}
    },
    "0b18e5e8c69b40c9a446fff448d38e0dd10cb45e": {
      "type": "Ymultichange(Yparameterchange,Yreturntypechange,Ybodychange)",
      "commitMessage": "HDFS-6481. DatanodeManager#getDatanodeStorageInfos() should check the length of storageIDs. (Contributed by szetszwo)\n",
      "commitDate": "06/11/15 10:15 AM",
      "commitName": "0b18e5e8c69b40c9a446fff448d38e0dd10cb45e",
      "commitAuthor": "Arpit Agarwal",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-6481. DatanodeManager#getDatanodeStorageInfos() should check the length of storageIDs. (Contributed by szetszwo)\n",
          "commitDate": "06/11/15 10:15 AM",
          "commitName": "0b18e5e8c69b40c9a446fff448d38e0dd10cb45e",
          "commitAuthor": "Arpit Agarwal",
          "commitDateOld": "03/11/15 5:16 PM",
          "commitNameOld": "194251c85250fcbe80a6ffee88b2cd4689334be3",
          "commitAuthorOld": "Yongjun Zhang",
          "daysBetweenCommits": 2.71,
          "commitsBetweenForRepo": 25,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,15 +1,11 @@\n-  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n-      throws IOException {\n+  void closeFileCommitBlocks(String src, INodeFile pendingFile,\n+      BlockInfo storedBlock) throws IOException {\n     final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n-    final String src \u003d iip.getPath();\n \n     // commit the last block and complete it if it has minimum replicas\n     commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n \n     //remove lease, close file\n     finalizeINodeFileUnderConstruction(src, pendingFile,\n-                                       Snapshot.findLatestSnapshot(pendingFile,\n-                                                                   Snapshot.CURRENT_STATE_ID));\n-\n-    return src;\n+        Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID));\n   }\n\\ No newline at end of file\n",
          "actualSource": "  void closeFileCommitBlocks(String src, INodeFile pendingFile,\n      BlockInfo storedBlock) throws IOException {\n    final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n\n    // commit the last block and complete it if it has minimum replicas\n    commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n\n    //remove lease, close file\n    finalizeINodeFileUnderConstruction(src, pendingFile,\n        Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID));\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
          "extendedDetails": {
            "oldValue": "[pendingFile-INodeFile, storedBlock-BlockInfo]",
            "newValue": "[src-String, pendingFile-INodeFile, storedBlock-BlockInfo]"
          }
        },
        {
          "type": "Yreturntypechange",
          "commitMessage": "HDFS-6481. DatanodeManager#getDatanodeStorageInfos() should check the length of storageIDs. (Contributed by szetszwo)\n",
          "commitDate": "06/11/15 10:15 AM",
          "commitName": "0b18e5e8c69b40c9a446fff448d38e0dd10cb45e",
          "commitAuthor": "Arpit Agarwal",
          "commitDateOld": "03/11/15 5:16 PM",
          "commitNameOld": "194251c85250fcbe80a6ffee88b2cd4689334be3",
          "commitAuthorOld": "Yongjun Zhang",
          "daysBetweenCommits": 2.71,
          "commitsBetweenForRepo": 25,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,15 +1,11 @@\n-  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n-      throws IOException {\n+  void closeFileCommitBlocks(String src, INodeFile pendingFile,\n+      BlockInfo storedBlock) throws IOException {\n     final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n-    final String src \u003d iip.getPath();\n \n     // commit the last block and complete it if it has minimum replicas\n     commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n \n     //remove lease, close file\n     finalizeINodeFileUnderConstruction(src, pendingFile,\n-                                       Snapshot.findLatestSnapshot(pendingFile,\n-                                                                   Snapshot.CURRENT_STATE_ID));\n-\n-    return src;\n+        Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID));\n   }\n\\ No newline at end of file\n",
          "actualSource": "  void closeFileCommitBlocks(String src, INodeFile pendingFile,\n      BlockInfo storedBlock) throws IOException {\n    final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n\n    // commit the last block and complete it if it has minimum replicas\n    commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n\n    //remove lease, close file\n    finalizeINodeFileUnderConstruction(src, pendingFile,\n        Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID));\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
          "extendedDetails": {
            "oldValue": "String",
            "newValue": "void"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-6481. DatanodeManager#getDatanodeStorageInfos() should check the length of storageIDs. (Contributed by szetszwo)\n",
          "commitDate": "06/11/15 10:15 AM",
          "commitName": "0b18e5e8c69b40c9a446fff448d38e0dd10cb45e",
          "commitAuthor": "Arpit Agarwal",
          "commitDateOld": "03/11/15 5:16 PM",
          "commitNameOld": "194251c85250fcbe80a6ffee88b2cd4689334be3",
          "commitAuthorOld": "Yongjun Zhang",
          "daysBetweenCommits": 2.71,
          "commitsBetweenForRepo": 25,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,15 +1,11 @@\n-  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n-      throws IOException {\n+  void closeFileCommitBlocks(String src, INodeFile pendingFile,\n+      BlockInfo storedBlock) throws IOException {\n     final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n-    final String src \u003d iip.getPath();\n \n     // commit the last block and complete it if it has minimum replicas\n     commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n \n     //remove lease, close file\n     finalizeINodeFileUnderConstruction(src, pendingFile,\n-                                       Snapshot.findLatestSnapshot(pendingFile,\n-                                                                   Snapshot.CURRENT_STATE_ID));\n-\n-    return src;\n+        Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID));\n   }\n\\ No newline at end of file\n",
          "actualSource": "  void closeFileCommitBlocks(String src, INodeFile pendingFile,\n      BlockInfo storedBlock) throws IOException {\n    final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n\n    // commit the last block and complete it if it has minimum replicas\n    commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n\n    //remove lease, close file\n    finalizeINodeFileUnderConstruction(src, pendingFile,\n        Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID));\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
          "extendedDetails": {}
        }
      ]
    },
    "4928f5473394981829e5ffd4b16ea0801baf5c45": {
      "type": "Yparameterchange",
      "commitMessage": "HDFS-8482. Rename BlockInfoContiguous to BlockInfo. Contributed by Zhe Zhang.\n",
      "commitDate": "27/05/15 3:42 PM",
      "commitName": "4928f5473394981829e5ffd4b16ea0801baf5c45",
      "commitAuthor": "Andrew Wang",
      "commitDateOld": "21/05/15 8:08 AM",
      "commitNameOld": "2b6bcfdafa91223a4116e3e9304579f5f91dccac",
      "commitAuthorOld": "Haohui Mai",
      "daysBetweenCommits": 6.32,
      "commitsBetweenForRepo": 32,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,15 +1,15 @@\n-  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfoContiguous storedBlock)\n+  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n       throws IOException {\n     final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n     final String src \u003d iip.getPath();\n \n     // commit the last block and complete it if it has minimum replicas\n     commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n \n     //remove lease, close file\n     finalizeINodeFileUnderConstruction(src, pendingFile,\n                                        Snapshot.findLatestSnapshot(pendingFile,\n                                                                    Snapshot.CURRENT_STATE_ID));\n \n     return src;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n      throws IOException {\n    final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n    final String src \u003d iip.getPath();\n\n    // commit the last block and complete it if it has minimum replicas\n    commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n\n    //remove lease, close file\n    finalizeINodeFileUnderConstruction(src, pendingFile,\n                                       Snapshot.findLatestSnapshot(pendingFile,\n                                                                   Snapshot.CURRENT_STATE_ID));\n\n    return src;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
      "extendedDetails": {
        "oldValue": "[pendingFile-INodeFile, storedBlock-BlockInfoContiguous]",
        "newValue": "[pendingFile-INodeFile, storedBlock-BlockInfo]"
      }
    },
    "9f2f583f401189c3f4a2687795a9e3e0b288322b": {
      "type": "Yparameterchange",
      "commitMessage": "HDFS-7749. Erasure Coding: Add striped block support in INodeFile. Contributed by Jing Zhao.\n",
      "commitDate": "26/05/15 11:07 AM",
      "commitName": "9f2f583f401189c3f4a2687795a9e3e0b288322b",
      "commitAuthor": "Jing Zhao",
      "commitDateOld": "26/05/15 11:07 AM",
      "commitNameOld": "ba9371492036983a9899398907ab41fe548f29b3",
      "commitAuthorOld": "Jing Zhao",
      "daysBetweenCommits": 0.0,
      "commitsBetweenForRepo": 2,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,15 +1,15 @@\n-  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfoContiguous storedBlock)\n+  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n       throws IOException {\n     final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n     final String src \u003d iip.getPath();\n \n     // commit the last block and complete it if it has minimum replicas\n     commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n \n     //remove lease, close file\n     finalizeINodeFileUnderConstruction(src, pendingFile,\n                                        Snapshot.findLatestSnapshot(pendingFile,\n                                                                    Snapshot.CURRENT_STATE_ID));\n \n     return src;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n      throws IOException {\n    final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n    final String src \u003d iip.getPath();\n\n    // commit the last block and complete it if it has minimum replicas\n    commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n\n    //remove lease, close file\n    finalizeINodeFileUnderConstruction(src, pendingFile,\n                                       Snapshot.findLatestSnapshot(pendingFile,\n                                                                   Snapshot.CURRENT_STATE_ID));\n\n    return src;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
      "extendedDetails": {
        "oldValue": "[pendingFile-INodeFile, storedBlock-BlockInfoContiguous]",
        "newValue": "[pendingFile-INodeFile, storedBlock-BlockInfo]"
      }
    },
    "1382ae525c67bf95d8f3a436b547dbc72cfbb177": {
      "type": "Yparameterchange",
      "commitMessage": "HDFS-7743. Code cleanup of BlockInfo and rename BlockInfo to BlockInfoContiguous. Contributed by Jing Zhao.\n",
      "commitDate": "08/02/15 11:51 AM",
      "commitName": "1382ae525c67bf95d8f3a436b547dbc72cfbb177",
      "commitAuthor": "Jing Zhao",
      "commitDateOld": "07/02/15 3:21 PM",
      "commitNameOld": "8f7d4bb09f760780dd193c97796ebf4d22cfd2d7",
      "commitAuthorOld": "Tsz-Wo Nicholas Sze",
      "daysBetweenCommits": 0.85,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,14 +1,14 @@\n-  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n+  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfoContiguous storedBlock)\n       throws IOException {\n     final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n     final String src \u003d iip.getPath();\n \n     // commit the last block and complete it if it has minimum replicas\n     commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n \n     //remove lease, close file\n     finalizeINodeFileUnderConstruction(src, pendingFile,\n         Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID));\n \n     return src;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfoContiguous storedBlock)\n      throws IOException {\n    final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n    final String src \u003d iip.getPath();\n\n    // commit the last block and complete it if it has minimum replicas\n    commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n\n    //remove lease, close file\n    finalizeINodeFileUnderConstruction(src, pendingFile,\n        Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID));\n\n    return src;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
      "extendedDetails": {
        "oldValue": "[pendingFile-INodeFile, storedBlock-BlockInfo]",
        "newValue": "[pendingFile-INodeFile, storedBlock-BlockInfoContiguous]"
      }
    },
    "c78e3a7cdd10c40454e9acb06986ba6d8573cb19": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-7059. Avoid resolving path multiple times. Contributed by Jing Zhao.\n",
      "commitDate": "12/12/14 3:13 PM",
      "commitName": "c78e3a7cdd10c40454e9acb06986ba6d8573cb19",
      "commitAuthor": "Jing Zhao",
      "commitDateOld": "12/12/14 11:51 AM",
      "commitNameOld": "46612c7a5135d20b20403780b47dd00654aab057",
      "commitAuthorOld": "Haohui Mai",
      "daysBetweenCommits": 0.14,
      "commitsBetweenForRepo": 2,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,13 +1,14 @@\n   String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n       throws IOException {\n-    String src \u003d pendingFile.getFullPathName();\n+    final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n+    final String src \u003d iip.getPath();\n \n     // commit the last block and complete it if it has minimum replicas\n-    commitOrCompleteLastBlock(pendingFile, storedBlock);\n+    commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n \n     //remove lease, close file\n     finalizeINodeFileUnderConstruction(src, pendingFile,\n         Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID));\n \n     return src;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n      throws IOException {\n    final INodesInPath iip \u003d INodesInPath.fromINode(pendingFile);\n    final String src \u003d iip.getPath();\n\n    // commit the last block and complete it if it has minimum replicas\n    commitOrCompleteLastBlock(pendingFile, iip, storedBlock);\n\n    //remove lease, close file\n    finalizeINodeFileUnderConstruction(src, pendingFile,\n        Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID));\n\n    return src;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
      "extendedDetails": {}
    },
    "fd2ba4911bec60386a106c85aedd5cc99cd8cab3": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-5790. LeaseManager.findPath is very slow when many leases need recovery. Contributed by Todd Lipcon.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1562970 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "30/01/14 1:21 PM",
      "commitName": "fd2ba4911bec60386a106c85aedd5cc99cd8cab3",
      "commitAuthor": "Todd Lipcon",
      "commitDateOld": "29/01/14 3:59 PM",
      "commitNameOld": "c96d0780335de83a694e93cf8b8fc46d2288fe9d",
      "commitAuthorOld": "Andrew Wang",
      "daysBetweenCommits": 0.89,
      "commitsBetweenForRepo": 13,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,13 +1,13 @@\n   String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n       throws IOException {\n-    String src \u003d leaseManager.findPath(pendingFile);\n+    String src \u003d pendingFile.getFullPathName();\n \n     // commit the last block and complete it if it has minimum replicas\n     commitOrCompleteLastBlock(pendingFile, storedBlock);\n \n     //remove lease, close file\n     finalizeINodeFileUnderConstruction(src, pendingFile,\n         Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID));\n \n     return src;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n      throws IOException {\n    String src \u003d pendingFile.getFullPathName();\n\n    // commit the last block and complete it if it has minimum replicas\n    commitOrCompleteLastBlock(pendingFile, storedBlock);\n\n    //remove lease, close file\n    finalizeINodeFileUnderConstruction(src, pendingFile,\n        Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID));\n\n    return src;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
      "extendedDetails": {}
    },
    "70cff9e2f0c8f78c1dc54a064182971bb2106795": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-5715. Use Snapshot ID to indicate the corresponding Snapshot for a FileDiff/DirectoryDiff. Contributed by Jing Zhao.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1556353 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "07/01/14 12:52 PM",
      "commitName": "70cff9e2f0c8f78c1dc54a064182971bb2106795",
      "commitAuthor": "Jing Zhao",
      "commitDateOld": "02/01/14 6:45 PM",
      "commitNameOld": "d85c017d0488930d806f267141057fc73e68c728",
      "commitAuthorOld": "Andrew Wang",
      "daysBetweenCommits": 4.75,
      "commitsBetweenForRepo": 19,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,13 +1,13 @@\n   String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n       throws IOException {\n     String src \u003d leaseManager.findPath(pendingFile);\n \n     // commit the last block and complete it if it has minimum replicas\n     commitOrCompleteLastBlock(pendingFile, storedBlock);\n \n     //remove lease, close file\n     finalizeINodeFileUnderConstruction(src, pendingFile,\n-        Snapshot.findLatestSnapshot(pendingFile, null));\n+        Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID));\n \n     return src;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n      throws IOException {\n    String src \u003d leaseManager.findPath(pendingFile);\n\n    // commit the last block and complete it if it has minimum replicas\n    commitOrCompleteLastBlock(pendingFile, storedBlock);\n\n    //remove lease, close file\n    finalizeINodeFileUnderConstruction(src, pendingFile,\n        Snapshot.findLatestSnapshot(pendingFile, Snapshot.CURRENT_STATE_ID));\n\n    return src;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
      "extendedDetails": {}
    },
    "ce68f410b05a58ad05965f32ad7f5b246b363a75": {
      "type": "Yparameterchange",
      "commitMessage": "HDFS-5285. Flatten INodeFile hierarchy: Replace INodeFileUnderConstruction and INodeFileUnderConstructionWithSnapshot with FileUnderContructionFeature.  Contributed by jing9\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1544389 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "21/11/13 5:39 PM",
      "commitName": "ce68f410b05a58ad05965f32ad7f5b246b363a75",
      "commitAuthor": "Tsz-wo Sze",
      "commitDateOld": "21/11/13 9:12 AM",
      "commitNameOld": "f91a45a96c21db9e5d40097c7d3f5d005ae10dde",
      "commitAuthorOld": "Colin McCabe",
      "daysBetweenCommits": 0.35,
      "commitsBetweenForRepo": 6,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,15 +1,13 @@\n-  String closeFileCommitBlocks(INodeFileUnderConstruction pendingFile,\n-                                       BlockInfo storedBlock)\n+  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n       throws IOException {\n-\n     String src \u003d leaseManager.findPath(pendingFile);\n \n     // commit the last block and complete it if it has minimum replicas\n     commitOrCompleteLastBlock(pendingFile, storedBlock);\n \n     //remove lease, close file\n     finalizeINodeFileUnderConstruction(src, pendingFile,\n-                                       Snapshot.findLatestSnapshot(pendingFile, null));\n+        Snapshot.findLatestSnapshot(pendingFile, null));\n \n     return src;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  String closeFileCommitBlocks(INodeFile pendingFile, BlockInfo storedBlock)\n      throws IOException {\n    String src \u003d leaseManager.findPath(pendingFile);\n\n    // commit the last block and complete it if it has minimum replicas\n    commitOrCompleteLastBlock(pendingFile, storedBlock);\n\n    //remove lease, close file\n    finalizeINodeFileUnderConstruction(src, pendingFile,\n        Snapshot.findLatestSnapshot(pendingFile, null));\n\n    return src;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
      "extendedDetails": {
        "oldValue": "[pendingFile-INodeFileUnderConstruction, storedBlock-BlockInfo]",
        "newValue": "[pendingFile-INodeFile, storedBlock-BlockInfo]"
      }
    },
    "f138ae68f9be0ae072a6a4ee50e94a1608c90edb": {
      "type": "Yintroduced",
      "commitMessage": "HDFS-5024. Make DatanodeProtocol#commitBlockSynchronization idempotent. Contributed by Arpit Agarwal.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1506789 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "24/07/13 5:32 PM",
      "commitName": "f138ae68f9be0ae072a6a4ee50e94a1608c90edb",
      "commitAuthor": "Jing Zhao",
      "diff": "@@ -0,0 +1,15 @@\n+  String closeFileCommitBlocks(INodeFileUnderConstruction pendingFile,\n+                                       BlockInfo storedBlock)\n+      throws IOException {\n+\n+    String src \u003d leaseManager.findPath(pendingFile);\n+\n+    // commit the last block and complete it if it has minimum replicas\n+    commitOrCompleteLastBlock(pendingFile, storedBlock);\n+\n+    //remove lease, close file\n+    finalizeINodeFileUnderConstruction(src, pendingFile,\n+                                       Snapshot.findLatestSnapshot(pendingFile, null));\n+\n+    return src;\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  String closeFileCommitBlocks(INodeFileUnderConstruction pendingFile,\n                                       BlockInfo storedBlock)\n      throws IOException {\n\n    String src \u003d leaseManager.findPath(pendingFile);\n\n    // commit the last block and complete it if it has minimum replicas\n    commitOrCompleteLastBlock(pendingFile, storedBlock);\n\n    //remove lease, close file\n    finalizeINodeFileUnderConstruction(src, pendingFile,\n                                       Snapshot.findLatestSnapshot(pendingFile, null));\n\n    return src;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java"
    }
  }
}