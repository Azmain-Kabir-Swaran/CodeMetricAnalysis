{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "ReplicationWork.java",
  "functionName": "chooseTargets",
  "functionId": "chooseTargets___blockplacement-BlockPlacementPolicy__storagePolicySuite-BlockStoragePolicySuite__excludedNodes-Set__Node__",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/ReplicationWork.java",
  "functionStartLine": 40,
  "functionEndLine": 60,
  "numCommitsSeen": 641,
  "timeTaken": 9345,
  "changeHistory": [
    "320008bb7cc558b1300398178bd2f48cbf0b6c80",
    "96bb6a51ec4a470e9b287c94e377444a9f97c410",
    "d331762f24b3f22f609366740c9c4f449edc61ac",
    "0a152103f19a3e8e1b7f33aeb9dd115ba231d7b7",
    "6d12cd8d609dec26d44cece9937c35b7d72a3cd1",
    "035ed26147f10620fc6ed3a514d9ebbcc31304b5",
    "4e9307f26dd41270f95fb50166e1a091852e4d58",
    "9b8a35aff6d4bd7bb066ce01fa63a88fa49245ee",
    "073bbd805c6680f47bbfcc6e8efd708ad729bca4"
  ],
  "changeHistoryShort": {
    "320008bb7cc558b1300398178bd2f48cbf0b6c80": "Ybodychange",
    "96bb6a51ec4a470e9b287c94e377444a9f97c410": "Ybodychange",
    "d331762f24b3f22f609366740c9c4f449edc61ac": "Ybodychange",
    "0a152103f19a3e8e1b7f33aeb9dd115ba231d7b7": "Ybodychange",
    "6d12cd8d609dec26d44cece9937c35b7d72a3cd1": "Ymultichange(Ymovefromfile,Ymodifierchange)",
    "035ed26147f10620fc6ed3a514d9ebbcc31304b5": "Ymultichange(Ymovefromfile,Ymodifierchange)",
    "4e9307f26dd41270f95fb50166e1a091852e4d58": "Ymultichange(Ymovefromfile,Ymodifierchange)",
    "9b8a35aff6d4bd7bb066ce01fa63a88fa49245ee": "Ybodychange",
    "073bbd805c6680f47bbfcc6e8efd708ad729bca4": "Yparameterchange"
  },
  "changeHistoryDetails": {
    "320008bb7cc558b1300398178bd2f48cbf0b6c80": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-14720. DataNode shouldn\u0027t report block as bad block if the block length is Long.MAX_VALUE. Contributed by  hemanthboyina.\n",
      "commitDate": "09/11/19 8:44 AM",
      "commitName": "320008bb7cc558b1300398178bd2f48cbf0b6c80",
      "commitAuthor": "Surendra Singh Lilhore",
      "commitDateOld": "30/08/19 2:01 AM",
      "commitNameOld": "96f7dc1992246a16031f613e55dc39ea0d64acd1",
      "commitAuthorOld": "Surendra Singh Lilhore",
      "daysBetweenCommits": 71.32,
      "commitsBetweenForRepo": 447,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,15 +1,21 @@\n   void chooseTargets(BlockPlacementPolicy blockplacement,\n       BlockStoragePolicySuite storagePolicySuite,\n       Set\u003cNode\u003e excludedNodes) {\n     assert getSrcNodes().length \u003e 0\n         : \"At least 1 source node should have been selected\";\n     try {\n-      DatanodeStorageInfo[] chosenTargets \u003d blockplacement.chooseTarget(\n-          getSrcPath(), getAdditionalReplRequired(), getSrcNodes()[0],\n-          getLiveReplicaStorages(), false, excludedNodes, getBlockSize(),\n-          storagePolicySuite.getPolicy(getStoragePolicyID()), null);\n+      DatanodeStorageInfo[] chosenTargets \u003d null;\n+      // HDFS-14720 If the block is deleted, the block size will become\n+      // BlockCommand.NO_ACK (LONG.MAX_VALUE) . This kind of block we don\u0027t need\n+      // to send for replication or reconstruction\n+      if (getBlock().getNumBytes() !\u003d BlockCommand.NO_ACK) {\n+        chosenTargets \u003d blockplacement.chooseTarget(getSrcPath(),\n+            getAdditionalReplRequired(), getSrcNodes()[0],\n+            getLiveReplicaStorages(), false, excludedNodes, getBlockSize(),\n+            storagePolicySuite.getPolicy(getStoragePolicyID()), null);\n+      }\n       setTargets(chosenTargets);\n     } finally {\n       getSrcNodes()[0].decrementPendingReplicationWithoutTargets();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void chooseTargets(BlockPlacementPolicy blockplacement,\n      BlockStoragePolicySuite storagePolicySuite,\n      Set\u003cNode\u003e excludedNodes) {\n    assert getSrcNodes().length \u003e 0\n        : \"At least 1 source node should have been selected\";\n    try {\n      DatanodeStorageInfo[] chosenTargets \u003d null;\n      // HDFS-14720 If the block is deleted, the block size will become\n      // BlockCommand.NO_ACK (LONG.MAX_VALUE) . This kind of block we don\u0027t need\n      // to send for replication or reconstruction\n      if (getBlock().getNumBytes() !\u003d BlockCommand.NO_ACK) {\n        chosenTargets \u003d blockplacement.chooseTarget(getSrcPath(),\n            getAdditionalReplRequired(), getSrcNodes()[0],\n            getLiveReplicaStorages(), false, excludedNodes, getBlockSize(),\n            storagePolicySuite.getPolicy(getStoragePolicyID()), null);\n      }\n      setTargets(chosenTargets);\n    } finally {\n      getSrcNodes()[0].decrementPendingReplicationWithoutTargets();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/ReplicationWork.java",
      "extendedDetails": {}
    },
    "96bb6a51ec4a470e9b287c94e377444a9f97c410": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-10453. ReplicationMonitor thread could stuck for long time due to the race between replication and delete of same file in a large cluster.. Contributed by He Xiaoqiao.\n",
      "commitDate": "12/02/18 7:17 AM",
      "commitName": "96bb6a51ec4a470e9b287c94e377444a9f97c410",
      "commitAuthor": "Arpit Agarwal",
      "commitDateOld": "28/11/17 5:14 PM",
      "commitNameOld": "d331762f24b3f22f609366740c9c4f449edc61ac",
      "commitAuthorOld": "Konstantin V Shvachko",
      "daysBetweenCommits": 75.59,
      "commitsBetweenForRepo": 449,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,17 +1,15 @@\n   void chooseTargets(BlockPlacementPolicy blockplacement,\n       BlockStoragePolicySuite storagePolicySuite,\n       Set\u003cNode\u003e excludedNodes) {\n     assert getSrcNodes().length \u003e 0\n         : \"At least 1 source node should have been selected\";\n     try {\n       DatanodeStorageInfo[] chosenTargets \u003d blockplacement.chooseTarget(\n           getSrcPath(), getAdditionalReplRequired(), getSrcNodes()[0],\n-          getLiveReplicaStorages(), false, excludedNodes,\n-          getBlock().getNumBytes(),\n-          storagePolicySuite.getPolicy(getStoragePolicyID()),\n-          null);\n+          getLiveReplicaStorages(), false, excludedNodes, getBlockSize(),\n+          storagePolicySuite.getPolicy(getStoragePolicyID()), null);\n       setTargets(chosenTargets);\n     } finally {\n       getSrcNodes()[0].decrementPendingReplicationWithoutTargets();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void chooseTargets(BlockPlacementPolicy blockplacement,\n      BlockStoragePolicySuite storagePolicySuite,\n      Set\u003cNode\u003e excludedNodes) {\n    assert getSrcNodes().length \u003e 0\n        : \"At least 1 source node should have been selected\";\n    try {\n      DatanodeStorageInfo[] chosenTargets \u003d blockplacement.chooseTarget(\n          getSrcPath(), getAdditionalReplRequired(), getSrcNodes()[0],\n          getLiveReplicaStorages(), false, excludedNodes, getBlockSize(),\n          storagePolicySuite.getPolicy(getStoragePolicyID()), null);\n      setTargets(chosenTargets);\n    } finally {\n      getSrcNodes()[0].decrementPendingReplicationWithoutTargets();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/ReplicationWork.java",
      "extendedDetails": {}
    },
    "d331762f24b3f22f609366740c9c4f449edc61ac": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-12832. INode.getFullPathName may throw ArrayIndexOutOfBoundsException lead to NameNode exit. Contribuited by Konstantin Shvachko.",
      "commitDate": "28/11/17 5:14 PM",
      "commitName": "d331762f24b3f22f609366740c9c4f449edc61ac",
      "commitAuthor": "Konstantin V Shvachko",
      "commitDateOld": "27/04/16 2:22 PM",
      "commitNameOld": "0a152103f19a3e8e1b7f33aeb9dd115ba231d7b7",
      "commitAuthorOld": "Lei Xu",
      "daysBetweenCommits": 580.16,
      "commitsBetweenForRepo": 3952,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,17 +1,17 @@\n   void chooseTargets(BlockPlacementPolicy blockplacement,\n       BlockStoragePolicySuite storagePolicySuite,\n       Set\u003cNode\u003e excludedNodes) {\n     assert getSrcNodes().length \u003e 0\n         : \"At least 1 source node should have been selected\";\n     try {\n       DatanodeStorageInfo[] chosenTargets \u003d blockplacement.chooseTarget(\n-          getBc().getName(), getAdditionalReplRequired(), getSrcNodes()[0],\n+          getSrcPath(), getAdditionalReplRequired(), getSrcNodes()[0],\n           getLiveReplicaStorages(), false, excludedNodes,\n           getBlock().getNumBytes(),\n-          storagePolicySuite.getPolicy(getBc().getStoragePolicyID()),\n+          storagePolicySuite.getPolicy(getStoragePolicyID()),\n           null);\n       setTargets(chosenTargets);\n     } finally {\n       getSrcNodes()[0].decrementPendingReplicationWithoutTargets();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void chooseTargets(BlockPlacementPolicy blockplacement,\n      BlockStoragePolicySuite storagePolicySuite,\n      Set\u003cNode\u003e excludedNodes) {\n    assert getSrcNodes().length \u003e 0\n        : \"At least 1 source node should have been selected\";\n    try {\n      DatanodeStorageInfo[] chosenTargets \u003d blockplacement.chooseTarget(\n          getSrcPath(), getAdditionalReplRequired(), getSrcNodes()[0],\n          getLiveReplicaStorages(), false, excludedNodes,\n          getBlock().getNumBytes(),\n          storagePolicySuite.getPolicy(getStoragePolicyID()),\n          null);\n      setTargets(chosenTargets);\n    } finally {\n      getSrcNodes()[0].decrementPendingReplicationWithoutTargets();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/ReplicationWork.java",
      "extendedDetails": {}
    },
    "0a152103f19a3e8e1b7f33aeb9dd115ba231d7b7": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-3702. Add an option for NOT writing the blocks locally if there is a datanode on the same box as the client. (Contributed by Lei (Eddy) Xu)\n",
      "commitDate": "27/04/16 2:22 PM",
      "commitName": "0a152103f19a3e8e1b7f33aeb9dd115ba231d7b7",
      "commitAuthor": "Lei Xu",
      "commitDateOld": "08/03/16 10:24 AM",
      "commitNameOld": "743a99f2dbc9a27e19f92ff3551937d90dba2e89",
      "commitAuthorOld": "Jing Zhao",
      "daysBetweenCommits": 50.12,
      "commitsBetweenForRepo": 300,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,16 +1,17 @@\n   void chooseTargets(BlockPlacementPolicy blockplacement,\n       BlockStoragePolicySuite storagePolicySuite,\n       Set\u003cNode\u003e excludedNodes) {\n     assert getSrcNodes().length \u003e 0\n         : \"At least 1 source node should have been selected\";\n     try {\n       DatanodeStorageInfo[] chosenTargets \u003d blockplacement.chooseTarget(\n           getBc().getName(), getAdditionalReplRequired(), getSrcNodes()[0],\n           getLiveReplicaStorages(), false, excludedNodes,\n           getBlock().getNumBytes(),\n-          storagePolicySuite.getPolicy(getBc().getStoragePolicyID()));\n+          storagePolicySuite.getPolicy(getBc().getStoragePolicyID()),\n+          null);\n       setTargets(chosenTargets);\n     } finally {\n       getSrcNodes()[0].decrementPendingReplicationWithoutTargets();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void chooseTargets(BlockPlacementPolicy blockplacement,\n      BlockStoragePolicySuite storagePolicySuite,\n      Set\u003cNode\u003e excludedNodes) {\n    assert getSrcNodes().length \u003e 0\n        : \"At least 1 source node should have been selected\";\n    try {\n      DatanodeStorageInfo[] chosenTargets \u003d blockplacement.chooseTarget(\n          getBc().getName(), getAdditionalReplRequired(), getSrcNodes()[0],\n          getLiveReplicaStorages(), false, excludedNodes,\n          getBlock().getNumBytes(),\n          storagePolicySuite.getPolicy(getBc().getStoragePolicyID()),\n          null);\n      setTargets(chosenTargets);\n    } finally {\n      getSrcNodes()[0].decrementPendingReplicationWithoutTargets();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/ReplicationWork.java",
      "extendedDetails": {}
    },
    "6d12cd8d609dec26d44cece9937c35b7d72a3cd1": {
      "type": "Ymultichange(Ymovefromfile,Ymodifierchange)",
      "commitMessage": "HDFS-8938. Extract BlockToMarkCorrupt and ReplicationWork as standalone classes from BlockManager. Contributed by Mingliang Liu.\n",
      "commitDate": "28/08/15 2:14 PM",
      "commitName": "6d12cd8d609dec26d44cece9937c35b7d72a3cd1",
      "commitAuthor": "Haohui Mai",
      "subchanges": [
        {
          "type": "Ymovefromfile",
          "commitMessage": "HDFS-8938. Extract BlockToMarkCorrupt and ReplicationWork as standalone classes from BlockManager. Contributed by Mingliang Liu.\n",
          "commitDate": "28/08/15 2:14 PM",
          "commitName": "6d12cd8d609dec26d44cece9937c35b7d72a3cd1",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "28/08/15 12:13 PM",
          "commitNameOld": "cbb249534aa72ff6c290c4f99766415aeea9d6f5",
          "commitAuthorOld": "Zhihai Xu",
          "daysBetweenCommits": 0.08,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,12 +1,12 @@\n-    private void chooseTargets(BlockPlacementPolicy blockplacement,\n-        BlockStoragePolicySuite storagePolicySuite,\n-        Set\u003cNode\u003e excludedNodes) {\n-      try {\n-        targets \u003d blockplacement.chooseTarget(bc.getName(),\n-            additionalReplRequired, srcNode, liveReplicaStorages, false,\n-            excludedNodes, block.getNumBytes(),\n-            storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n-      } finally {\n-        srcNode.decrementPendingReplicationWithoutTargets();\n-      }\n-    }\n\\ No newline at end of file\n+  void chooseTargets(BlockPlacementPolicy blockplacement,\n+      BlockStoragePolicySuite storagePolicySuite,\n+      Set\u003cNode\u003e excludedNodes) {\n+    try {\n+      targets \u003d blockplacement.chooseTarget(bc.getName(),\n+          additionalReplRequired, srcNode, liveReplicaStorages, false,\n+          excludedNodes, block.getNumBytes(),\n+          storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n+    } finally {\n+      srcNode.decrementPendingReplicationWithoutTargets();\n+    }\n+  }\n\\ No newline at end of file\n",
          "actualSource": "  void chooseTargets(BlockPlacementPolicy blockplacement,\n      BlockStoragePolicySuite storagePolicySuite,\n      Set\u003cNode\u003e excludedNodes) {\n    try {\n      targets \u003d blockplacement.chooseTarget(bc.getName(),\n          additionalReplRequired, srcNode, liveReplicaStorages, false,\n          excludedNodes, block.getNumBytes(),\n          storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n    } finally {\n      srcNode.decrementPendingReplicationWithoutTargets();\n    }\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/ReplicationWork.java",
          "extendedDetails": {
            "oldPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/BlockManager.java",
            "newPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/ReplicationWork.java",
            "oldMethodName": "chooseTargets",
            "newMethodName": "chooseTargets"
          }
        },
        {
          "type": "Ymodifierchange",
          "commitMessage": "HDFS-8938. Extract BlockToMarkCorrupt and ReplicationWork as standalone classes from BlockManager. Contributed by Mingliang Liu.\n",
          "commitDate": "28/08/15 2:14 PM",
          "commitName": "6d12cd8d609dec26d44cece9937c35b7d72a3cd1",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "28/08/15 12:13 PM",
          "commitNameOld": "cbb249534aa72ff6c290c4f99766415aeea9d6f5",
          "commitAuthorOld": "Zhihai Xu",
          "daysBetweenCommits": 0.08,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,12 +1,12 @@\n-    private void chooseTargets(BlockPlacementPolicy blockplacement,\n-        BlockStoragePolicySuite storagePolicySuite,\n-        Set\u003cNode\u003e excludedNodes) {\n-      try {\n-        targets \u003d blockplacement.chooseTarget(bc.getName(),\n-            additionalReplRequired, srcNode, liveReplicaStorages, false,\n-            excludedNodes, block.getNumBytes(),\n-            storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n-      } finally {\n-        srcNode.decrementPendingReplicationWithoutTargets();\n-      }\n-    }\n\\ No newline at end of file\n+  void chooseTargets(BlockPlacementPolicy blockplacement,\n+      BlockStoragePolicySuite storagePolicySuite,\n+      Set\u003cNode\u003e excludedNodes) {\n+    try {\n+      targets \u003d blockplacement.chooseTarget(bc.getName(),\n+          additionalReplRequired, srcNode, liveReplicaStorages, false,\n+          excludedNodes, block.getNumBytes(),\n+          storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n+    } finally {\n+      srcNode.decrementPendingReplicationWithoutTargets();\n+    }\n+  }\n\\ No newline at end of file\n",
          "actualSource": "  void chooseTargets(BlockPlacementPolicy blockplacement,\n      BlockStoragePolicySuite storagePolicySuite,\n      Set\u003cNode\u003e excludedNodes) {\n    try {\n      targets \u003d blockplacement.chooseTarget(bc.getName(),\n          additionalReplRequired, srcNode, liveReplicaStorages, false,\n          excludedNodes, block.getNumBytes(),\n          storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n    } finally {\n      srcNode.decrementPendingReplicationWithoutTargets();\n    }\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/ReplicationWork.java",
          "extendedDetails": {
            "oldValue": "[private]",
            "newValue": "[]"
          }
        }
      ]
    },
    "035ed26147f10620fc6ed3a514d9ebbcc31304b5": {
      "type": "Ymultichange(Ymovefromfile,Ymodifierchange)",
      "commitMessage": "Revert \"HDFS-8938. Extract BlockToMarkCorrupt and ReplicationWork as standalone classes from BlockManager. Contributed by Mingliang Liu.\"\n\nThis reverts commit 4e9307f26dd41270f95fb50166e1a091852e4d58.\n",
      "commitDate": "27/08/15 4:09 PM",
      "commitName": "035ed26147f10620fc6ed3a514d9ebbcc31304b5",
      "commitAuthor": "Haohui Mai",
      "subchanges": [
        {
          "type": "Ymovefromfile",
          "commitMessage": "Revert \"HDFS-8938. Extract BlockToMarkCorrupt and ReplicationWork as standalone classes from BlockManager. Contributed by Mingliang Liu.\"\n\nThis reverts commit 4e9307f26dd41270f95fb50166e1a091852e4d58.\n",
          "commitDate": "27/08/15 4:09 PM",
          "commitName": "035ed26147f10620fc6ed3a514d9ebbcc31304b5",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "27/08/15 3:36 PM",
          "commitNameOld": "4e9307f26dd41270f95fb50166e1a091852e4d58",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 0.02,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,12 +1,12 @@\n-  void chooseTargets(BlockPlacementPolicy blockplacement,\n-      BlockStoragePolicySuite storagePolicySuite,\n-      Set\u003cNode\u003e excludedNodes) {\n-    try {\n-      targets \u003d blockplacement.chooseTarget(bc.getName(),\n-          additionalReplRequired, srcNode, liveReplicaStorages, false,\n-          excludedNodes, block.getNumBytes(),\n-          storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n-    } finally {\n-      srcNode.decrementPendingReplicationWithoutTargets();\n-    }\n-  }\n\\ No newline at end of file\n+    private void chooseTargets(BlockPlacementPolicy blockplacement,\n+        BlockStoragePolicySuite storagePolicySuite,\n+        Set\u003cNode\u003e excludedNodes) {\n+      try {\n+        targets \u003d blockplacement.chooseTarget(bc.getName(),\n+            additionalReplRequired, srcNode, liveReplicaStorages, false,\n+            excludedNodes, block.getNumBytes(),\n+            storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n+      } finally {\n+        srcNode.decrementPendingReplicationWithoutTargets();\n+      }\n+    }\n\\ No newline at end of file\n",
          "actualSource": "    private void chooseTargets(BlockPlacementPolicy blockplacement,\n        BlockStoragePolicySuite storagePolicySuite,\n        Set\u003cNode\u003e excludedNodes) {\n      try {\n        targets \u003d blockplacement.chooseTarget(bc.getName(),\n            additionalReplRequired, srcNode, liveReplicaStorages, false,\n            excludedNodes, block.getNumBytes(),\n            storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n      } finally {\n        srcNode.decrementPendingReplicationWithoutTargets();\n      }\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/BlockManager.java",
          "extendedDetails": {
            "oldPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/ReplicationWork.java",
            "newPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/BlockManager.java",
            "oldMethodName": "chooseTargets",
            "newMethodName": "chooseTargets"
          }
        },
        {
          "type": "Ymodifierchange",
          "commitMessage": "Revert \"HDFS-8938. Extract BlockToMarkCorrupt and ReplicationWork as standalone classes from BlockManager. Contributed by Mingliang Liu.\"\n\nThis reverts commit 4e9307f26dd41270f95fb50166e1a091852e4d58.\n",
          "commitDate": "27/08/15 4:09 PM",
          "commitName": "035ed26147f10620fc6ed3a514d9ebbcc31304b5",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "27/08/15 3:36 PM",
          "commitNameOld": "4e9307f26dd41270f95fb50166e1a091852e4d58",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 0.02,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,12 +1,12 @@\n-  void chooseTargets(BlockPlacementPolicy blockplacement,\n-      BlockStoragePolicySuite storagePolicySuite,\n-      Set\u003cNode\u003e excludedNodes) {\n-    try {\n-      targets \u003d blockplacement.chooseTarget(bc.getName(),\n-          additionalReplRequired, srcNode, liveReplicaStorages, false,\n-          excludedNodes, block.getNumBytes(),\n-          storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n-    } finally {\n-      srcNode.decrementPendingReplicationWithoutTargets();\n-    }\n-  }\n\\ No newline at end of file\n+    private void chooseTargets(BlockPlacementPolicy blockplacement,\n+        BlockStoragePolicySuite storagePolicySuite,\n+        Set\u003cNode\u003e excludedNodes) {\n+      try {\n+        targets \u003d blockplacement.chooseTarget(bc.getName(),\n+            additionalReplRequired, srcNode, liveReplicaStorages, false,\n+            excludedNodes, block.getNumBytes(),\n+            storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n+      } finally {\n+        srcNode.decrementPendingReplicationWithoutTargets();\n+      }\n+    }\n\\ No newline at end of file\n",
          "actualSource": "    private void chooseTargets(BlockPlacementPolicy blockplacement,\n        BlockStoragePolicySuite storagePolicySuite,\n        Set\u003cNode\u003e excludedNodes) {\n      try {\n        targets \u003d blockplacement.chooseTarget(bc.getName(),\n            additionalReplRequired, srcNode, liveReplicaStorages, false,\n            excludedNodes, block.getNumBytes(),\n            storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n      } finally {\n        srcNode.decrementPendingReplicationWithoutTargets();\n      }\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/BlockManager.java",
          "extendedDetails": {
            "oldValue": "[]",
            "newValue": "[private]"
          }
        }
      ]
    },
    "4e9307f26dd41270f95fb50166e1a091852e4d58": {
      "type": "Ymultichange(Ymovefromfile,Ymodifierchange)",
      "commitMessage": "HDFS-8938. Extract BlockToMarkCorrupt and ReplicationWork as standalone classes from BlockManager. Contributed by Mingliang Liu.\n",
      "commitDate": "27/08/15 3:36 PM",
      "commitName": "4e9307f26dd41270f95fb50166e1a091852e4d58",
      "commitAuthor": "Haohui Mai",
      "subchanges": [
        {
          "type": "Ymovefromfile",
          "commitMessage": "HDFS-8938. Extract BlockToMarkCorrupt and ReplicationWork as standalone classes from BlockManager. Contributed by Mingliang Liu.\n",
          "commitDate": "27/08/15 3:36 PM",
          "commitName": "4e9307f26dd41270f95fb50166e1a091852e4d58",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "27/08/15 1:25 PM",
          "commitNameOld": "a9c8ea71aa427ff5f25caec98be15bc880e578a7",
          "commitAuthorOld": "Jian He",
          "daysBetweenCommits": 0.09,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,12 +1,12 @@\n-    private void chooseTargets(BlockPlacementPolicy blockplacement,\n-        BlockStoragePolicySuite storagePolicySuite,\n-        Set\u003cNode\u003e excludedNodes) {\n-      try {\n-        targets \u003d blockplacement.chooseTarget(bc.getName(),\n-            additionalReplRequired, srcNode, liveReplicaStorages, false,\n-            excludedNodes, block.getNumBytes(),\n-            storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n-      } finally {\n-        srcNode.decrementPendingReplicationWithoutTargets();\n-      }\n-    }\n\\ No newline at end of file\n+  void chooseTargets(BlockPlacementPolicy blockplacement,\n+      BlockStoragePolicySuite storagePolicySuite,\n+      Set\u003cNode\u003e excludedNodes) {\n+    try {\n+      targets \u003d blockplacement.chooseTarget(bc.getName(),\n+          additionalReplRequired, srcNode, liveReplicaStorages, false,\n+          excludedNodes, block.getNumBytes(),\n+          storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n+    } finally {\n+      srcNode.decrementPendingReplicationWithoutTargets();\n+    }\n+  }\n\\ No newline at end of file\n",
          "actualSource": "  void chooseTargets(BlockPlacementPolicy blockplacement,\n      BlockStoragePolicySuite storagePolicySuite,\n      Set\u003cNode\u003e excludedNodes) {\n    try {\n      targets \u003d blockplacement.chooseTarget(bc.getName(),\n          additionalReplRequired, srcNode, liveReplicaStorages, false,\n          excludedNodes, block.getNumBytes(),\n          storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n    } finally {\n      srcNode.decrementPendingReplicationWithoutTargets();\n    }\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/ReplicationWork.java",
          "extendedDetails": {
            "oldPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/BlockManager.java",
            "newPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/ReplicationWork.java",
            "oldMethodName": "chooseTargets",
            "newMethodName": "chooseTargets"
          }
        },
        {
          "type": "Ymodifierchange",
          "commitMessage": "HDFS-8938. Extract BlockToMarkCorrupt and ReplicationWork as standalone classes from BlockManager. Contributed by Mingliang Liu.\n",
          "commitDate": "27/08/15 3:36 PM",
          "commitName": "4e9307f26dd41270f95fb50166e1a091852e4d58",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "27/08/15 1:25 PM",
          "commitNameOld": "a9c8ea71aa427ff5f25caec98be15bc880e578a7",
          "commitAuthorOld": "Jian He",
          "daysBetweenCommits": 0.09,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,12 +1,12 @@\n-    private void chooseTargets(BlockPlacementPolicy blockplacement,\n-        BlockStoragePolicySuite storagePolicySuite,\n-        Set\u003cNode\u003e excludedNodes) {\n-      try {\n-        targets \u003d blockplacement.chooseTarget(bc.getName(),\n-            additionalReplRequired, srcNode, liveReplicaStorages, false,\n-            excludedNodes, block.getNumBytes(),\n-            storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n-      } finally {\n-        srcNode.decrementPendingReplicationWithoutTargets();\n-      }\n-    }\n\\ No newline at end of file\n+  void chooseTargets(BlockPlacementPolicy blockplacement,\n+      BlockStoragePolicySuite storagePolicySuite,\n+      Set\u003cNode\u003e excludedNodes) {\n+    try {\n+      targets \u003d blockplacement.chooseTarget(bc.getName(),\n+          additionalReplRequired, srcNode, liveReplicaStorages, false,\n+          excludedNodes, block.getNumBytes(),\n+          storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n+    } finally {\n+      srcNode.decrementPendingReplicationWithoutTargets();\n+    }\n+  }\n\\ No newline at end of file\n",
          "actualSource": "  void chooseTargets(BlockPlacementPolicy blockplacement,\n      BlockStoragePolicySuite storagePolicySuite,\n      Set\u003cNode\u003e excludedNodes) {\n    try {\n      targets \u003d blockplacement.chooseTarget(bc.getName(),\n          additionalReplRequired, srcNode, liveReplicaStorages, false,\n          excludedNodes, block.getNumBytes(),\n          storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n    } finally {\n      srcNode.decrementPendingReplicationWithoutTargets();\n    }\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/ReplicationWork.java",
          "extendedDetails": {
            "oldValue": "[private]",
            "newValue": "[]"
          }
        }
      ]
    },
    "9b8a35aff6d4bd7bb066ce01fa63a88fa49245ee": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-7128. Decommission slows way down when it gets towards the end. Contributed by Ming Ma.\n",
      "commitDate": "07/10/14 3:01 PM",
      "commitName": "9b8a35aff6d4bd7bb066ce01fa63a88fa49245ee",
      "commitAuthor": "cnauroth",
      "commitDateOld": "06/10/14 2:01 AM",
      "commitNameOld": "ed841dd9a96e54cb84d9cae5507e47ff1c8cdf6e",
      "commitAuthorOld": "Vinayakumar B",
      "daysBetweenCommits": 1.54,
      "commitsBetweenForRepo": 17,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,8 +1,12 @@\n     private void chooseTargets(BlockPlacementPolicy blockplacement,\n         BlockStoragePolicySuite storagePolicySuite,\n         Set\u003cNode\u003e excludedNodes) {\n-      targets \u003d blockplacement.chooseTarget(bc.getName(),\n-          additionalReplRequired, srcNode, liveReplicaStorages, false,\n-          excludedNodes, block.getNumBytes(),\n-          storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n+      try {\n+        targets \u003d blockplacement.chooseTarget(bc.getName(),\n+            additionalReplRequired, srcNode, liveReplicaStorages, false,\n+            excludedNodes, block.getNumBytes(),\n+            storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n+      } finally {\n+        srcNode.decrementPendingReplicationWithoutTargets();\n+      }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    private void chooseTargets(BlockPlacementPolicy blockplacement,\n        BlockStoragePolicySuite storagePolicySuite,\n        Set\u003cNode\u003e excludedNodes) {\n      try {\n        targets \u003d blockplacement.chooseTarget(bc.getName(),\n            additionalReplRequired, srcNode, liveReplicaStorages, false,\n            excludedNodes, block.getNumBytes(),\n            storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n      } finally {\n        srcNode.decrementPendingReplicationWithoutTargets();\n      }\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/BlockManager.java",
      "extendedDetails": {}
    },
    "073bbd805c6680f47bbfcc6e8efd708ad729bca4": {
      "type": "Yparameterchange",
      "commitMessage": "HDFS-7081. Add new DistributedFileSystem API for getting all the existing storage policies. Contributed by Jing Zhao.\n",
      "commitDate": "24/09/14 10:05 AM",
      "commitName": "073bbd805c6680f47bbfcc6e8efd708ad729bca4",
      "commitAuthor": "Jing Zhao",
      "commitDateOld": "11/09/14 1:00 PM",
      "commitNameOld": "0d85f7e59146cc3e9a040c2203995f3efd8ed4eb",
      "commitAuthorOld": "Jing Zhao",
      "daysBetweenCommits": 12.88,
      "commitsBetweenForRepo": 133,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,8 +1,8 @@\n     private void chooseTargets(BlockPlacementPolicy blockplacement,\n-        BlockStoragePolicy.Suite storagePolicySuite,\n+        BlockStoragePolicySuite storagePolicySuite,\n         Set\u003cNode\u003e excludedNodes) {\n       targets \u003d blockplacement.chooseTarget(bc.getName(),\n           additionalReplRequired, srcNode, liveReplicaStorages, false,\n           excludedNodes, block.getNumBytes(),\n           storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n     }\n\\ No newline at end of file\n",
      "actualSource": "    private void chooseTargets(BlockPlacementPolicy blockplacement,\n        BlockStoragePolicySuite storagePolicySuite,\n        Set\u003cNode\u003e excludedNodes) {\n      targets \u003d blockplacement.chooseTarget(bc.getName(),\n          additionalReplRequired, srcNode, liveReplicaStorages, false,\n          excludedNodes, block.getNumBytes(),\n          storagePolicySuite.getPolicy(bc.getStoragePolicyID()));\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/BlockManager.java",
      "extendedDetails": {
        "oldValue": "[blockplacement-BlockPlacementPolicy, storagePolicySuite-BlockStoragePolicy.Suite, excludedNodes-Set\u003cNode\u003e]",
        "newValue": "[blockplacement-BlockPlacementPolicy, storagePolicySuite-BlockStoragePolicySuite, excludedNodes-Set\u003cNode\u003e]"
      }
    }
  }
}