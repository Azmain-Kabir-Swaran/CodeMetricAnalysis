{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "FederationInterceptor.java",
  "functionName": "shutdown",
  "functionId": "shutdown",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/amrmproxy/FederationInterceptor.java",
  "functionStartLine": 840,
  "functionEndLine": 864,
  "numCommitsSeen": 21,
  "timeTaken": 3633,
  "changeHistory": [
    "989715ec5066c6ac7868e25ad9234dc64723e61e",
    "3090922805699b8374a359e92323884a4177dc4e",
    "02b9bfdf9e4bd0b3c05ca5fd75399dedcb656e09",
    "f1525825623a1307b5aa55c456b6afa3e0c61135",
    "d5f66888b8d767ee6706fab9950c194a1bf26d32",
    "70b1a757f13b01a9192ea5fb0820ba7babfd974e",
    "bed1832c934fe4ba44efdcdc49fce06457dc3d4f"
  ],
  "changeHistoryShort": {
    "989715ec5066c6ac7868e25ad9234dc64723e61e": "Ybodychange",
    "3090922805699b8374a359e92323884a4177dc4e": "Ybodychange",
    "02b9bfdf9e4bd0b3c05ca5fd75399dedcb656e09": "Ybodychange",
    "f1525825623a1307b5aa55c456b6afa3e0c61135": "Ybodychange",
    "d5f66888b8d767ee6706fab9950c194a1bf26d32": "Ybodychange",
    "70b1a757f13b01a9192ea5fb0820ba7babfd974e": "Ybodychange",
    "bed1832c934fe4ba44efdcdc49fce06457dc3d4f": "Yintroduced"
  },
  "changeHistoryDetails": {
    "989715ec5066c6ac7868e25ad9234dc64723e61e": {
      "type": "Ybodychange",
      "commitMessage": "YARN-8893. [AMRMProxy] Fix thread leak in AMRMClientRelayer and UAM client. Contributed by Botong Huang.\n",
      "commitDate": "02/11/18 3:30 PM",
      "commitName": "989715ec5066c6ac7868e25ad9234dc64723e61e",
      "commitAuthor": "Giovanni Matteo Fumarola",
      "commitDateOld": "09/10/18 10:29 AM",
      "commitNameOld": "c3d22d3b4569b7f87af4ee4abfcc284deebe90de",
      "commitAuthorOld": "Inigo Goiri",
      "daysBetweenCommits": 24.21,
      "commitsBetweenForRepo": 265,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,20 +1,25 @@\n   public void shutdown() {\n+    LOG.info(\"Shutting down FederationInterceptor for {}\", this.attemptId);\n+\n     // Do not stop uamPool service and kill UAMs here because of possible second\n     // app attempt\n+    try {\n+      this.uamPool.shutDownConnections();\n+    } catch (YarnException e) {\n+      LOG.error(\"Error shutting down all UAM clients without killing them\", e);\n+    }\n+\n     if (this.threadpool !\u003d null) {\n       try {\n         this.threadpool.shutdown();\n       } catch (Throwable ex) {\n       }\n       this.threadpool \u003d null;\n     }\n \n     // Stop the home heartbeat thread\n     this.homeHeartbeartHandler.shutdown();\n     this.homeRMRelayer.shutdown();\n-    for (AMRMClientRelayer relayer : this.secondaryRelayers.values()) {\n-      relayer.shutdown();\n-    }\n \n     super.shutdown();\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void shutdown() {\n    LOG.info(\"Shutting down FederationInterceptor for {}\", this.attemptId);\n\n    // Do not stop uamPool service and kill UAMs here because of possible second\n    // app attempt\n    try {\n      this.uamPool.shutDownConnections();\n    } catch (YarnException e) {\n      LOG.error(\"Error shutting down all UAM clients without killing them\", e);\n    }\n\n    if (this.threadpool !\u003d null) {\n      try {\n        this.threadpool.shutdown();\n      } catch (Throwable ex) {\n      }\n      this.threadpool \u003d null;\n    }\n\n    // Stop the home heartbeat thread\n    this.homeHeartbeartHandler.shutdown();\n    this.homeRMRelayer.shutdown();\n\n    super.shutdown();\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/amrmproxy/FederationInterceptor.java",
      "extendedDetails": {}
    },
    "3090922805699b8374a359e92323884a4177dc4e": {
      "type": "Ybodychange",
      "commitMessage": "YARN-8696. [AMRMProxy] FederationInterceptor upgrade: home sub-cluster heartbeat async. Contributed by Botong Huang.\n",
      "commitDate": "24/09/18 11:37 AM",
      "commitName": "3090922805699b8374a359e92323884a4177dc4e",
      "commitAuthor": "Giovanni Matteo Fumarola",
      "commitDateOld": "12/09/18 11:46 AM",
      "commitNameOld": "02b9bfdf9e4bd0b3c05ca5fd75399dedcb656e09",
      "commitAuthorOld": "Giovanni Matteo Fumarola",
      "daysBetweenCommits": 11.99,
      "commitsBetweenForRepo": 142,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,16 +1,20 @@\n   public void shutdown() {\n     // Do not stop uamPool service and kill UAMs here because of possible second\n     // app attempt\n     if (this.threadpool !\u003d null) {\n       try {\n         this.threadpool.shutdown();\n       } catch (Throwable ex) {\n       }\n       this.threadpool \u003d null;\n     }\n-    homeRMRelayer.shutdown();\n-    for(AMRMClientRelayer relayer : secondaryRelayers.values()){\n+\n+    // Stop the home heartbeat thread\n+    this.homeHeartbeartHandler.shutdown();\n+    this.homeRMRelayer.shutdown();\n+    for (AMRMClientRelayer relayer : this.secondaryRelayers.values()) {\n       relayer.shutdown();\n     }\n+\n     super.shutdown();\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void shutdown() {\n    // Do not stop uamPool service and kill UAMs here because of possible second\n    // app attempt\n    if (this.threadpool !\u003d null) {\n      try {\n        this.threadpool.shutdown();\n      } catch (Throwable ex) {\n      }\n      this.threadpool \u003d null;\n    }\n\n    // Stop the home heartbeat thread\n    this.homeHeartbeartHandler.shutdown();\n    this.homeRMRelayer.shutdown();\n    for (AMRMClientRelayer relayer : this.secondaryRelayers.values()) {\n      relayer.shutdown();\n    }\n\n    super.shutdown();\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/amrmproxy/FederationInterceptor.java",
      "extendedDetails": {}
    },
    "02b9bfdf9e4bd0b3c05ca5fd75399dedcb656e09": {
      "type": "Ybodychange",
      "commitMessage": "YARN-8658. [AMRMProxy] Metrics for AMRMClientRelayer inside FederationInterceptor. Contributed by Young Chen.\n",
      "commitDate": "12/09/18 11:46 AM",
      "commitName": "02b9bfdf9e4bd0b3c05ca5fd75399dedcb656e09",
      "commitAuthor": "Giovanni Matteo Fumarola",
      "commitDateOld": "27/08/18 10:32 AM",
      "commitNameOld": "f1525825623a1307b5aa55c456b6afa3e0c61135",
      "commitAuthorOld": "Giovanni Matteo Fumarola",
      "daysBetweenCommits": 16.05,
      "commitsBetweenForRepo": 142,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,12 +1,16 @@\n   public void shutdown() {\n     // Do not stop uamPool service and kill UAMs here because of possible second\n     // app attempt\n     if (this.threadpool !\u003d null) {\n       try {\n         this.threadpool.shutdown();\n       } catch (Throwable ex) {\n       }\n       this.threadpool \u003d null;\n     }\n+    homeRMRelayer.shutdown();\n+    for(AMRMClientRelayer relayer : secondaryRelayers.values()){\n+      relayer.shutdown();\n+    }\n     super.shutdown();\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void shutdown() {\n    // Do not stop uamPool service and kill UAMs here because of possible second\n    // app attempt\n    if (this.threadpool !\u003d null) {\n      try {\n        this.threadpool.shutdown();\n      } catch (Throwable ex) {\n      }\n      this.threadpool \u003d null;\n    }\n    homeRMRelayer.shutdown();\n    for(AMRMClientRelayer relayer : secondaryRelayers.values()){\n      relayer.shutdown();\n    }\n    super.shutdown();\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/amrmproxy/FederationInterceptor.java",
      "extendedDetails": {}
    },
    "f1525825623a1307b5aa55c456b6afa3e0c61135": {
      "type": "Ybodychange",
      "commitMessage": "YARN-8705. Refactor the UAM heartbeat thread in preparation for YARN-8696. Contributed by Botong Huang.\n",
      "commitDate": "27/08/18 10:32 AM",
      "commitName": "f1525825623a1307b5aa55c456b6afa3e0c61135",
      "commitAuthor": "Giovanni Matteo Fumarola",
      "commitDateOld": "20/08/18 12:22 PM",
      "commitNameOld": "8736fc39ac3b3de168d2c216f3d1c0edb48fb3f9",
      "commitAuthorOld": "Giovanni Matteo Fumarola",
      "daysBetweenCommits": 6.92,
      "commitsBetweenForRepo": 33,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,12 +1,12 @@\n   public void shutdown() {\n     // Do not stop uamPool service and kill UAMs here because of possible second\n     // app attempt\n-    if (threadpool !\u003d null) {\n+    if (this.threadpool !\u003d null) {\n       try {\n-        threadpool.shutdown();\n+        this.threadpool.shutdown();\n       } catch (Throwable ex) {\n       }\n-      threadpool \u003d null;\n+      this.threadpool \u003d null;\n     }\n     super.shutdown();\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void shutdown() {\n    // Do not stop uamPool service and kill UAMs here because of possible second\n    // app attempt\n    if (this.threadpool !\u003d null) {\n      try {\n        this.threadpool.shutdown();\n      } catch (Throwable ex) {\n      }\n      this.threadpool \u003d null;\n    }\n    super.shutdown();\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/amrmproxy/FederationInterceptor.java",
      "extendedDetails": {}
    },
    "d5f66888b8d767ee6706fab9950c194a1bf26d32": {
      "type": "Ybodychange",
      "commitMessage": "YARN-6128. Add support for AMRMProxy HA. (Botong Huang via Subru).\n",
      "commitDate": "17/11/17 5:39 PM",
      "commitName": "d5f66888b8d767ee6706fab9950c194a1bf26d32",
      "commitAuthor": "Subru Krishnan",
      "commitDateOld": "28/09/17 1:04 PM",
      "commitNameOld": "ca669f9f8bc7abe5b7d4648c589aa1756bd336d1",
      "commitAuthorOld": "Subru Krishnan",
      "daysBetweenCommits": 50.23,
      "commitsBetweenForRepo": 444,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,13 +1,12 @@\n   public void shutdown() {\n-    if (this.uamPool !\u003d null) {\n-      this.uamPool.stop();\n-    }\n+    // Do not stop uamPool service and kill UAMs here because of possible second\n+    // app attempt\n     if (threadpool !\u003d null) {\n       try {\n         threadpool.shutdown();\n       } catch (Throwable ex) {\n       }\n       threadpool \u003d null;\n     }\n     super.shutdown();\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void shutdown() {\n    // Do not stop uamPool service and kill UAMs here because of possible second\n    // app attempt\n    if (threadpool !\u003d null) {\n      try {\n        threadpool.shutdown();\n      } catch (Throwable ex) {\n      }\n      threadpool \u003d null;\n    }\n    super.shutdown();\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/amrmproxy/FederationInterceptor.java",
      "extendedDetails": {}
    },
    "70b1a757f13b01a9192ea5fb0820ba7babfd974e": {
      "type": "Ybodychange",
      "commitMessage": "YARN-6511. Federation: transparently spanning application across multiple sub-clusters. (Botong Huang via Subru).\n\n(cherry picked from commit 8c988d235eaf0972783985b1ab24680d029aea79)\n",
      "commitDate": "01/08/17 5:28 PM",
      "commitName": "70b1a757f13b01a9192ea5fb0820ba7babfd974e",
      "commitAuthor": "Subru Krishnan",
      "commitDateOld": "01/08/17 5:28 PM",
      "commitNameOld": "bed1832c934fe4ba44efdcdc49fce06457dc3d4f",
      "commitAuthorOld": "Subru Krishnan",
      "daysBetweenCommits": 0.0,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,3 +1,13 @@\n   public void shutdown() {\n+    if (this.uamPool !\u003d null) {\n+      this.uamPool.stop();\n+    }\n+    if (threadpool !\u003d null) {\n+      try {\n+        threadpool.shutdown();\n+      } catch (Throwable ex) {\n+      }\n+      threadpool \u003d null;\n+    }\n     super.shutdown();\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void shutdown() {\n    if (this.uamPool !\u003d null) {\n      this.uamPool.stop();\n    }\n    if (threadpool !\u003d null) {\n      try {\n        threadpool.shutdown();\n      } catch (Throwable ex) {\n      }\n      threadpool \u003d null;\n    }\n    super.shutdown();\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/amrmproxy/FederationInterceptor.java",
      "extendedDetails": {}
    },
    "bed1832c934fe4ba44efdcdc49fce06457dc3d4f": {
      "type": "Yintroduced",
      "commitMessage": "YARN-3666. Federation Intercepting and propagating AM- home RM communications. (Botong Huang via Subru).\n\n(cherry picked from commit 2399eb8200609246cb623c74450ca4a2032063cc)\n",
      "commitDate": "01/08/17 5:28 PM",
      "commitName": "bed1832c934fe4ba44efdcdc49fce06457dc3d4f",
      "commitAuthor": "Subru Krishnan",
      "diff": "@@ -0,0 +1,3 @@\n+  public void shutdown() {\n+    super.shutdown();\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  public void shutdown() {\n    super.shutdown();\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/amrmproxy/FederationInterceptor.java"
    }
  }
}