{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "NodeAttributesManagerImpl.java",
  "functionName": "removeNodeFromAttributes",
  "functionId": "removeNodeFromAttributes___nodeHost-String__attributeMappings-Set__NodeAttribute__",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/nodelabels/NodeAttributesManagerImpl.java",
  "functionStartLine": 230,
  "functionEndLine": 244,
  "numCommitsSeen": 18,
  "timeTaken": 2012,
  "changeHistory": [
    "8cf6a9a2bde9d4ccad95a514885634792889ec7f",
    "86d024ef2a5844ac723c7b597689afa4b598ee27",
    "2f7712be09d5b68978547f95b1be2352cdd46266"
  ],
  "changeHistoryShort": {
    "8cf6a9a2bde9d4ccad95a514885634792889ec7f": "Ybodychange",
    "86d024ef2a5844ac723c7b597689afa4b598ee27": "Ybodychange",
    "2f7712be09d5b68978547f95b1be2352cdd46266": "Yintroduced"
  },
  "changeHistoryDetails": {
    "8cf6a9a2bde9d4ccad95a514885634792889ec7f": {
      "type": "Ybodychange",
      "commitMessage": "YARN-7892. Revisit NodeAttribute class structure. Contributed by  Naganarasimha G R.\n",
      "commitDate": "12/09/18 3:31 AM",
      "commitName": "8cf6a9a2bde9d4ccad95a514885634792889ec7f",
      "commitAuthor": "bibinchundatt",
      "commitDateOld": "12/09/18 3:31 AM",
      "commitNameOld": "5dc7d6e0f3f46277f0615d61755970a7aa28b8d7",
      "commitAuthorOld": "Naganarasimha",
      "daysBetweenCommits": 0.0,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,14 +1,15 @@\n   private void removeNodeFromAttributes(String nodeHost,\n       Set\u003cNodeAttribute\u003e attributeMappings) {\n     for (NodeAttribute rmAttribute : attributeMappings) {\n-      RMNodeAttribute host \u003d clusterAttributes.get(rmAttribute);\n+      RMNodeAttribute host \u003d\n+          clusterAttributes.get(rmAttribute.getAttributeKey());\n       if (host !\u003d null) {\n         host.removeNode(nodeHost);\n         // If there is no other host has such attribute,\n         // remove it from the global mapping.\n         if (host.getAssociatedNodeIds().isEmpty()) {\n-          clusterAttributes.remove(rmAttribute);\n+          clusterAttributes.remove(rmAttribute.getAttributeKey());\n         }\n       }\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private void removeNodeFromAttributes(String nodeHost,\n      Set\u003cNodeAttribute\u003e attributeMappings) {\n    for (NodeAttribute rmAttribute : attributeMappings) {\n      RMNodeAttribute host \u003d\n          clusterAttributes.get(rmAttribute.getAttributeKey());\n      if (host !\u003d null) {\n        host.removeNode(nodeHost);\n        // If there is no other host has such attribute,\n        // remove it from the global mapping.\n        if (host.getAssociatedNodeIds().isEmpty()) {\n          clusterAttributes.remove(rmAttribute.getAttributeKey());\n        }\n      }\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/nodelabels/NodeAttributesManagerImpl.java",
      "extendedDetails": {}
    },
    "86d024ef2a5844ac723c7b597689afa4b598ee27": {
      "type": "Ybodychange",
      "commitMessage": "YARN-7965. NodeAttributeManager add/get API is not working properly. Contributed by Weiwei Yang.\n",
      "commitDate": "12/09/18 3:31 AM",
      "commitName": "86d024ef2a5844ac723c7b597689afa4b598ee27",
      "commitAuthor": "Naganarasimha",
      "commitDateOld": "12/09/18 3:31 AM",
      "commitNameOld": "2f7712be09d5b68978547f95b1be2352cdd46266",
      "commitAuthorOld": "Sunil G",
      "daysBetweenCommits": 0.0,
      "commitsBetweenForRepo": 2,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,6 +1,14 @@\n   private void removeNodeFromAttributes(String nodeHost,\n       Set\u003cNodeAttribute\u003e attributeMappings) {\n-    for (NodeAttribute attribute : attributeMappings) {\n-      clusterAttributes.get(attribute).removeNode(nodeHost);\n+    for (NodeAttribute rmAttribute : attributeMappings) {\n+      RMNodeAttribute host \u003d clusterAttributes.get(rmAttribute);\n+      if (host !\u003d null) {\n+        host.removeNode(nodeHost);\n+        // If there is no other host has such attribute,\n+        // remove it from the global mapping.\n+        if (host.getAssociatedNodeIds().isEmpty()) {\n+          clusterAttributes.remove(rmAttribute);\n+        }\n+      }\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private void removeNodeFromAttributes(String nodeHost,\n      Set\u003cNodeAttribute\u003e attributeMappings) {\n    for (NodeAttribute rmAttribute : attributeMappings) {\n      RMNodeAttribute host \u003d clusterAttributes.get(rmAttribute);\n      if (host !\u003d null) {\n        host.removeNode(nodeHost);\n        // If there is no other host has such attribute,\n        // remove it from the global mapping.\n        if (host.getAssociatedNodeIds().isEmpty()) {\n          clusterAttributes.remove(rmAttribute);\n        }\n      }\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/nodelabels/NodeAttributesManagerImpl.java",
      "extendedDetails": {}
    },
    "2f7712be09d5b68978547f95b1be2352cdd46266": {
      "type": "Yintroduced",
      "commitMessage": "YARN-6858. Attribute Manager to store and provide node attributes in RM. Contributed by Naganarasimha G R.\n",
      "commitDate": "12/09/18 3:31 AM",
      "commitName": "2f7712be09d5b68978547f95b1be2352cdd46266",
      "commitAuthor": "Sunil G",
      "diff": "@@ -0,0 +1,6 @@\n+  private void removeNodeFromAttributes(String nodeHost,\n+      Set\u003cNodeAttribute\u003e attributeMappings) {\n+    for (NodeAttribute attribute : attributeMappings) {\n+      clusterAttributes.get(attribute).removeNode(nodeHost);\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private void removeNodeFromAttributes(String nodeHost,\n      Set\u003cNodeAttribute\u003e attributeMappings) {\n    for (NodeAttribute attribute : attributeMappings) {\n      clusterAttributes.get(attribute).removeNode(nodeHost);\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/nodelabels/NodeAttributesManagerImpl.java"
    }
  }
}