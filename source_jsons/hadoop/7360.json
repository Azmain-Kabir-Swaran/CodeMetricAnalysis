{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "RollingWindowManager.java",
  "functionName": "getTopUsersForMetric",
  "functionId": "getTopUsersForMetric___time-long__metricName-String__rollingWindows-RollingWindowMap",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/top/window/RollingWindowManager.java",
  "functionStartLine": 226,
  "functionEndLine": 250,
  "numCommitsSeen": 9,
  "timeTaken": 1692,
  "changeHistory": [
    "1ed9fb76645ecd195afe0067497dca10a3fb997d",
    "fa7b9248e415c04bb555772f44fadaf8d9f34974"
  ],
  "changeHistoryShort": {
    "1ed9fb76645ecd195afe0067497dca10a3fb997d": "Ybodychange",
    "fa7b9248e415c04bb555772f44fadaf8d9f34974": "Yintroduced"
  },
  "changeHistoryDetails": {
    "1ed9fb76645ecd195afe0067497dca10a3fb997d": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-7890. Improve information on Top users for metrics in RollingWindowsManager and lower log level (Contributed by J.Andreina)\n",
      "commitDate": "29/03/15 9:32 PM",
      "commitName": "1ed9fb76645ecd195afe0067497dca10a3fb997d",
      "commitAuthor": "Vinayakumar B",
      "commitDateOld": "12/12/14 5:04 PM",
      "commitNameOld": "fa7b9248e415c04bb555772f44fadaf8d9f34974",
      "commitAuthorOld": "Andrew Wang",
      "daysBetweenCommits": 107.14,
      "commitsBetweenForRepo": 836,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,24 +1,24 @@\n   private TopN getTopUsersForMetric(long time, String metricName, \n       RollingWindowMap rollingWindows) {\n     TopN topN \u003d new TopN(topUsersCnt);\n     Iterator\u003cMap.Entry\u003cString, RollingWindow\u003e\u003e iterator \u003d\n         rollingWindows.entrySet().iterator();\n     while (iterator.hasNext()) {\n       Map.Entry\u003cString, RollingWindow\u003e entry \u003d iterator.next();\n       String userName \u003d entry.getKey();\n       RollingWindow aWindow \u003d entry.getValue();\n       long windowSum \u003d aWindow.getSum(time);\n       // do the gc here\n       if (windowSum \u003d\u003d 0) {\n         LOG.debug(\"gc window of metric: {} userName: {}\",\n             metricName, userName);\n         iterator.remove();\n         continue;\n       }\n       LOG.debug(\"offer window of metric: {} userName: {} sum: {}\",\n           metricName, userName, windowSum);\n       topN.offer(new NameValuePair(userName, windowSum));\n     }\n-    LOG.info(\"topN size for command {} is: {}\", metricName, topN.size());\n+    LOG.debug(\"topN users size for command {} is: {}\", metricName, topN.size());\n     return topN;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private TopN getTopUsersForMetric(long time, String metricName, \n      RollingWindowMap rollingWindows) {\n    TopN topN \u003d new TopN(topUsersCnt);\n    Iterator\u003cMap.Entry\u003cString, RollingWindow\u003e\u003e iterator \u003d\n        rollingWindows.entrySet().iterator();\n    while (iterator.hasNext()) {\n      Map.Entry\u003cString, RollingWindow\u003e entry \u003d iterator.next();\n      String userName \u003d entry.getKey();\n      RollingWindow aWindow \u003d entry.getValue();\n      long windowSum \u003d aWindow.getSum(time);\n      // do the gc here\n      if (windowSum \u003d\u003d 0) {\n        LOG.debug(\"gc window of metric: {} userName: {}\",\n            metricName, userName);\n        iterator.remove();\n        continue;\n      }\n      LOG.debug(\"offer window of metric: {} userName: {} sum: {}\",\n          metricName, userName, windowSum);\n      topN.offer(new NameValuePair(userName, windowSum));\n    }\n    LOG.debug(\"topN users size for command {} is: {}\", metricName, topN.size());\n    return topN;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/top/window/RollingWindowManager.java",
      "extendedDetails": {}
    },
    "fa7b9248e415c04bb555772f44fadaf8d9f34974": {
      "type": "Yintroduced",
      "commitMessage": "HDFS-7426. Change nntop JMX format to be a JSON blob.\n",
      "commitDate": "12/12/14 5:04 PM",
      "commitName": "fa7b9248e415c04bb555772f44fadaf8d9f34974",
      "commitAuthor": "Andrew Wang",
      "diff": "@@ -0,0 +1,24 @@\n+  private TopN getTopUsersForMetric(long time, String metricName, \n+      RollingWindowMap rollingWindows) {\n+    TopN topN \u003d new TopN(topUsersCnt);\n+    Iterator\u003cMap.Entry\u003cString, RollingWindow\u003e\u003e iterator \u003d\n+        rollingWindows.entrySet().iterator();\n+    while (iterator.hasNext()) {\n+      Map.Entry\u003cString, RollingWindow\u003e entry \u003d iterator.next();\n+      String userName \u003d entry.getKey();\n+      RollingWindow aWindow \u003d entry.getValue();\n+      long windowSum \u003d aWindow.getSum(time);\n+      // do the gc here\n+      if (windowSum \u003d\u003d 0) {\n+        LOG.debug(\"gc window of metric: {} userName: {}\",\n+            metricName, userName);\n+        iterator.remove();\n+        continue;\n+      }\n+      LOG.debug(\"offer window of metric: {} userName: {} sum: {}\",\n+          metricName, userName, windowSum);\n+      topN.offer(new NameValuePair(userName, windowSum));\n+    }\n+    LOG.info(\"topN size for command {} is: {}\", metricName, topN.size());\n+    return topN;\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private TopN getTopUsersForMetric(long time, String metricName, \n      RollingWindowMap rollingWindows) {\n    TopN topN \u003d new TopN(topUsersCnt);\n    Iterator\u003cMap.Entry\u003cString, RollingWindow\u003e\u003e iterator \u003d\n        rollingWindows.entrySet().iterator();\n    while (iterator.hasNext()) {\n      Map.Entry\u003cString, RollingWindow\u003e entry \u003d iterator.next();\n      String userName \u003d entry.getKey();\n      RollingWindow aWindow \u003d entry.getValue();\n      long windowSum \u003d aWindow.getSum(time);\n      // do the gc here\n      if (windowSum \u003d\u003d 0) {\n        LOG.debug(\"gc window of metric: {} userName: {}\",\n            metricName, userName);\n        iterator.remove();\n        continue;\n      }\n      LOG.debug(\"offer window of metric: {} userName: {} sum: {}\",\n          metricName, userName, windowSum);\n      topN.offer(new NameValuePair(userName, windowSum));\n    }\n    LOG.info(\"topN size for command {} is: {}\", metricName, topN.size());\n    return topN;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/top/window/RollingWindowManager.java"
    }
  }
}