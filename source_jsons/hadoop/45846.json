{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "LogAggregationHtmlBlock.java",
  "functionName": "processContainerLog",
  "functionId": "processContainerLog___html-Block__range-long[]__in-InputStream__bufferSize-int__cbuf-byte[]",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/logaggregation/filecontroller/LogAggregationHtmlBlock.java",
  "functionStartLine": 175,
  "functionEndLine": 205,
  "numCommitsSeen": 3,
  "timeTaken": 1579,
  "changeHistory": [
    "74411ce0ce7336c0f7bb5793939fdd64a5dcdef6"
  ],
  "changeHistoryShort": {
    "74411ce0ce7336c0f7bb5793939fdd64a5dcdef6": "Yintroduced"
  },
  "changeHistoryDetails": {
    "74411ce0ce7336c0f7bb5793939fdd64a5dcdef6": {
      "type": "Yintroduced",
      "commitMessage": "YARN-7417. Remove duplicated code from IndexedFileAggregatedLogsBlock\n           and TFileAggregatedLogsBlock.\n           Contributed by Zian Chen\n",
      "commitDate": "13/08/18 1:50 PM",
      "commitName": "74411ce0ce7336c0f7bb5793939fdd64a5dcdef6",
      "commitAuthor": "Eric Yang",
      "diff": "@@ -0,0 +1,31 @@\n+  protected void processContainerLog(Block html, long[] range, InputStream in,\n+      int bufferSize, byte[] cbuf) throws IOException {\n+    long totalSkipped \u003d 0;\n+    long start \u003d range[0];\n+    long toRead \u003d range[1] - range[0];\n+    while (totalSkipped \u003c start) {\n+      long ret \u003d in.skip(start - totalSkipped);\n+      if (ret \u003d\u003d 0) {\n+        //Read one byte\n+        int nextByte \u003d in.read();\n+        // Check if we have reached EOF\n+        if (nextByte \u003d\u003d -1) {\n+          throw new IOException(\"Premature EOF from container log\");\n+        }\n+        ret \u003d 1;\n+      }\n+      totalSkipped +\u003d ret;\n+    }\n+\n+    int len \u003d 0;\n+    int currentToRead \u003d toRead \u003e bufferSize ? bufferSize : (int) toRead;\n+    Hamlet.PRE\u003cHamlet\u003e pre \u003d html.pre();\n+\n+    while (toRead \u003e 0 \u0026\u0026 (len \u003d in.read(cbuf, 0, currentToRead)) \u003e 0) {\n+      pre.__(new String(cbuf, 0, len, Charset.forName(\"UTF-8\")));\n+      toRead \u003d toRead - len;\n+      currentToRead \u003d toRead \u003e bufferSize ? bufferSize : (int) toRead;\n+    }\n+\n+    pre.__();\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  protected void processContainerLog(Block html, long[] range, InputStream in,\n      int bufferSize, byte[] cbuf) throws IOException {\n    long totalSkipped \u003d 0;\n    long start \u003d range[0];\n    long toRead \u003d range[1] - range[0];\n    while (totalSkipped \u003c start) {\n      long ret \u003d in.skip(start - totalSkipped);\n      if (ret \u003d\u003d 0) {\n        //Read one byte\n        int nextByte \u003d in.read();\n        // Check if we have reached EOF\n        if (nextByte \u003d\u003d -1) {\n          throw new IOException(\"Premature EOF from container log\");\n        }\n        ret \u003d 1;\n      }\n      totalSkipped +\u003d ret;\n    }\n\n    int len \u003d 0;\n    int currentToRead \u003d toRead \u003e bufferSize ? bufferSize : (int) toRead;\n    Hamlet.PRE\u003cHamlet\u003e pre \u003d html.pre();\n\n    while (toRead \u003e 0 \u0026\u0026 (len \u003d in.read(cbuf, 0, currentToRead)) \u003e 0) {\n      pre.__(new String(cbuf, 0, len, Charset.forName(\"UTF-8\")));\n      toRead \u003d toRead - len;\n      currentToRead \u003d toRead \u003e bufferSize ? bufferSize : (int) toRead;\n    }\n\n    pre.__();\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/logaggregation/filecontroller/LogAggregationHtmlBlock.java"
    }
  }
}