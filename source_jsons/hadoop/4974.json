{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "SnapshotFSImageFormat.java",
  "functionName": "loadINodeReferenceWithCount",
  "functionId": "loadINodeReferenceWithCount___isSnapshotINode-boolean__in-DataInput__loader-FSImageFormat.Loader",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/SnapshotFSImageFormat.java",
  "functionStartLine": 353,
  "functionEndLine": 369,
  "numCommitsSeen": 32,
  "timeTaken": 1896,
  "changeHistory": [
    "01f27f5c23fb6286c0e97156d1f09f5f5350aae5",
    "0fa5cad0b27780c27a284c23101b1099d4886506",
    "4c00514ede4e7e028b18f76a9b8edfedab8631d4",
    "1096917649fd951be633e5619518764f23cca645"
  ],
  "changeHistoryShort": {
    "01f27f5c23fb6286c0e97156d1f09f5f5350aae5": "Ybodychange",
    "0fa5cad0b27780c27a284c23101b1099d4886506": "Ybodychange",
    "4c00514ede4e7e028b18f76a9b8edfedab8631d4": "Ybodychange",
    "1096917649fd951be633e5619518764f23cca645": "Yintroduced"
  },
  "changeHistoryDetails": {
    "01f27f5c23fb6286c0e97156d1f09f5f5350aae5": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-4857. Snapshot.Root and AbstractINodeDiff#snapshotINode should not be put into INodeMap when loading FSImage. Contributed by Jing Zhao\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1487655 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "29/05/13 3:22 PM",
      "commitName": "01f27f5c23fb6286c0e97156d1f09f5f5350aae5",
      "commitAuthor": "Jing Zhao",
      "commitDateOld": "24/04/13 1:31 PM",
      "commitNameOld": "0fa5cad0b27780c27a284c23101b1099d4886506",
      "commitAuthorOld": "Tsz-wo Sze",
      "daysBetweenCommits": 35.08,
      "commitsBetweenForRepo": 196,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,16 +1,17 @@\n     public INodeReference.WithCount loadINodeReferenceWithCount(\n         boolean isSnapshotINode, DataInput in, FSImageFormat.Loader loader\n         ) throws IOException {\n       final boolean firstReferred \u003d in.readBoolean();\n \n       final INodeReference.WithCount withCount;\n       if (firstReferred) {\n-        final INode referred \u003d loader.loadINodeWithLocalName(isSnapshotINode, in);\n+        final INode referred \u003d loader.loadINodeWithLocalName(isSnapshotINode,\n+            in, true);\n         withCount \u003d new INodeReference.WithCount(null, referred);\n         referenceMap.put(withCount.getId(), withCount);\n       } else {\n         final long id \u003d in.readLong();\n         withCount \u003d referenceMap.get(id);\n       }\n       return withCount;\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public INodeReference.WithCount loadINodeReferenceWithCount(\n        boolean isSnapshotINode, DataInput in, FSImageFormat.Loader loader\n        ) throws IOException {\n      final boolean firstReferred \u003d in.readBoolean();\n\n      final INodeReference.WithCount withCount;\n      if (firstReferred) {\n        final INode referred \u003d loader.loadINodeWithLocalName(isSnapshotINode,\n            in, true);\n        withCount \u003d new INodeReference.WithCount(null, referred);\n        referenceMap.put(withCount.getId(), withCount);\n      } else {\n        final long id \u003d in.readLong();\n        withCount \u003d referenceMap.get(id);\n      }\n      return withCount;\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/SnapshotFSImageFormat.java",
      "extendedDetails": {}
    },
    "0fa5cad0b27780c27a284c23101b1099d4886506": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-4686. Update quota computation for rename and INodeReference.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1471647 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "24/04/13 1:31 PM",
      "commitName": "0fa5cad0b27780c27a284c23101b1099d4886506",
      "commitAuthor": "Tsz-wo Sze",
      "commitDateOld": "23/04/13 7:11 PM",
      "commitNameOld": "3a812e9f3ae66cfa525faceb5af9085a4cc37232",
      "commitAuthorOld": "Tsz-wo Sze",
      "daysBetweenCommits": 0.76,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,17 +1,16 @@\n     public INodeReference.WithCount loadINodeReferenceWithCount(\n         boolean isSnapshotINode, DataInput in, FSImageFormat.Loader loader\n         ) throws IOException {\n       final boolean firstReferred \u003d in.readBoolean();\n \n       final INodeReference.WithCount withCount;\n       if (firstReferred) {\n         final INode referred \u003d loader.loadINodeWithLocalName(isSnapshotINode, in);\n         withCount \u003d new INodeReference.WithCount(null, referred);\n         referenceMap.put(withCount.getId(), withCount);\n       } else {\n         final long id \u003d in.readLong();\n         withCount \u003d referenceMap.get(id);\n-        withCount.incrementReferenceCount();\n       }\n       return withCount;\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public INodeReference.WithCount loadINodeReferenceWithCount(\n        boolean isSnapshotINode, DataInput in, FSImageFormat.Loader loader\n        ) throws IOException {\n      final boolean firstReferred \u003d in.readBoolean();\n\n      final INodeReference.WithCount withCount;\n      if (firstReferred) {\n        final INode referred \u003d loader.loadINodeWithLocalName(isSnapshotINode, in);\n        withCount \u003d new INodeReference.WithCount(null, referred);\n        referenceMap.put(withCount.getId(), withCount);\n      } else {\n        final long id \u003d in.readLong();\n        withCount \u003d referenceMap.get(id);\n      }\n      return withCount;\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/SnapshotFSImageFormat.java",
      "extendedDetails": {}
    },
    "4c00514ede4e7e028b18f76a9b8edfedab8631d4": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-4684. Use INode id for image serialization when writing INodeReference.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1466718 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "10/04/13 3:24 PM",
      "commitName": "4c00514ede4e7e028b18f76a9b8edfedab8631d4",
      "commitAuthor": "Tsz-wo Sze",
      "commitDateOld": "01/04/13 4:24 PM",
      "commitNameOld": "1096917649fd951be633e5619518764f23cca645",
      "commitAuthorOld": "Tsz-wo Sze",
      "daysBetweenCommits": 8.96,
      "commitsBetweenForRepo": 54,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,17 +1,17 @@\n     public INodeReference.WithCount loadINodeReferenceWithCount(\n         boolean isSnapshotINode, DataInput in, FSImageFormat.Loader loader\n         ) throws IOException {\n       final boolean firstReferred \u003d in.readBoolean();\n \n       final INodeReference.WithCount withCount;\n       if (firstReferred) {\n         final INode referred \u003d loader.loadINodeWithLocalName(isSnapshotINode, in);\n         withCount \u003d new INodeReference.WithCount(null, referred);\n-        referenceMap.put(++referenceId, withCount);\n+        referenceMap.put(withCount.getId(), withCount);\n       } else {\n         final long id \u003d in.readLong();\n         withCount \u003d referenceMap.get(id);\n         withCount.incrementReferenceCount();\n       }\n       return withCount;\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public INodeReference.WithCount loadINodeReferenceWithCount(\n        boolean isSnapshotINode, DataInput in, FSImageFormat.Loader loader\n        ) throws IOException {\n      final boolean firstReferred \u003d in.readBoolean();\n\n      final INodeReference.WithCount withCount;\n      if (firstReferred) {\n        final INode referred \u003d loader.loadINodeWithLocalName(isSnapshotINode, in);\n        withCount \u003d new INodeReference.WithCount(null, referred);\n        referenceMap.put(withCount.getId(), withCount);\n      } else {\n        final long id \u003d in.readLong();\n        withCount \u003d referenceMap.get(id);\n        withCount.incrementReferenceCount();\n      }\n      return withCount;\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/SnapshotFSImageFormat.java",
      "extendedDetails": {}
    },
    "1096917649fd951be633e5619518764f23cca645": {
      "type": "Yintroduced",
      "commitMessage": "HDFS-4611. Update FSImage for INodeReference.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1463332 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "01/04/13 4:24 PM",
      "commitName": "1096917649fd951be633e5619518764f23cca645",
      "commitAuthor": "Tsz-wo Sze",
      "diff": "@@ -0,0 +1,17 @@\n+    public INodeReference.WithCount loadINodeReferenceWithCount(\n+        boolean isSnapshotINode, DataInput in, FSImageFormat.Loader loader\n+        ) throws IOException {\n+      final boolean firstReferred \u003d in.readBoolean();\n+\n+      final INodeReference.WithCount withCount;\n+      if (firstReferred) {\n+        final INode referred \u003d loader.loadINodeWithLocalName(isSnapshotINode, in);\n+        withCount \u003d new INodeReference.WithCount(null, referred);\n+        referenceMap.put(++referenceId, withCount);\n+      } else {\n+        final long id \u003d in.readLong();\n+        withCount \u003d referenceMap.get(id);\n+        withCount.incrementReferenceCount();\n+      }\n+      return withCount;\n+    }\n\\ No newline at end of file\n",
      "actualSource": "    public INodeReference.WithCount loadINodeReferenceWithCount(\n        boolean isSnapshotINode, DataInput in, FSImageFormat.Loader loader\n        ) throws IOException {\n      final boolean firstReferred \u003d in.readBoolean();\n\n      final INodeReference.WithCount withCount;\n      if (firstReferred) {\n        final INode referred \u003d loader.loadINodeWithLocalName(isSnapshotINode, in);\n        withCount \u003d new INodeReference.WithCount(null, referred);\n        referenceMap.put(++referenceId, withCount);\n      } else {\n        final long id \u003d in.readLong();\n        withCount \u003d referenceMap.get(id);\n        withCount.incrementReferenceCount();\n      }\n      return withCount;\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/SnapshotFSImageFormat.java"
    }
  }
}