{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "MRAppMaster.java",
  "functionName": "serviceStop",
  "functionId": "serviceStop",
  "sourceFilePath": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
  "functionStartLine": 1867,
  "functionEndLine": 1869,
  "numCommitsSeen": 179,
  "timeTaken": 3939,
  "changeHistory": [
    "6b4a9970f187ab399adf7469e494a530f08993b5",
    "eac1d1894354e90d314087af8e7fb168ddef9a3d",
    "122be11c1497b183f18079adf97a4f0396ea66ee",
    "0928502029ef141759008997335ea2cd836a7154",
    "25e96e455b3473387df865fbc1c3ad7ebf9ff1e4",
    "cfafd8c29dc3679e503c6155bcbf26f377b0ea8f",
    "61900651b1b85cf235e01142acf2a51727fc5537"
  ],
  "changeHistoryShort": {
    "6b4a9970f187ab399adf7469e494a530f08993b5": "Ybodychange",
    "eac1d1894354e90d314087af8e7fb168ddef9a3d": "Ybodychange",
    "122be11c1497b183f18079adf97a4f0396ea66ee": "Ybodychange",
    "0928502029ef141759008997335ea2cd836a7154": "Ymultichange(Yrename,Ymodifierchange,Yexceptionschange,Ybodychange)",
    "25e96e455b3473387df865fbc1c3ad7ebf9ff1e4": "Ybodychange",
    "cfafd8c29dc3679e503c6155bcbf26f377b0ea8f": "Ybodychange",
    "61900651b1b85cf235e01142acf2a51727fc5537": "Yintroduced"
  },
  "changeHistoryDetails": {
    "6b4a9970f187ab399adf7469e494a530f08993b5": {
      "type": "Ybodychange",
      "commitMessage": "MAPREDUCE-6571. JobEndNotification info logs are missing in AM container syslog (haibochen via rkanter)\n",
      "commitDate": "06/12/16 1:11 PM",
      "commitName": "6b4a9970f187ab399adf7469e494a530f08993b5",
      "commitAuthor": "Robert Kanter",
      "commitDateOld": "29/11/16 3:51 PM",
      "commitNameOld": "8f6e14399a3e77e1bdcc5034f7601e9f62163dea",
      "commitAuthorOld": "Junping Du",
      "daysBetweenCommits": 6.89,
      "commitsBetweenForRepo": 47,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,4 +1,3 @@\n   protected void serviceStop() throws Exception {\n     super.serviceStop();\n-    shutdownLogManager();\n   }\n\\ No newline at end of file\n",
      "actualSource": "  protected void serviceStop() throws Exception {\n    super.serviceStop();\n  }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
      "extendedDetails": {}
    },
    "eac1d1894354e90d314087af8e7fb168ddef9a3d": {
      "type": "Ybodychange",
      "commitMessage": "MAPREDUCE-6418. MRApp should not shutdown LogManager during shutdown. Contributed by Chang Li\n",
      "commitDate": "01/07/15 11:01 AM",
      "commitName": "eac1d1894354e90d314087af8e7fb168ddef9a3d",
      "commitAuthor": "Jason Lowe",
      "commitDateOld": "19/06/15 2:22 AM",
      "commitNameOld": "10107243be66bae2212a2cd8575f9f5ade13fe9e",
      "commitAuthorOld": "Gera Shegalov",
      "daysBetweenCommits": 12.36,
      "commitsBetweenForRepo": 92,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,4 +1,4 @@\n   protected void serviceStop() throws Exception {\n     super.serviceStop();\n-    LogManager.shutdown();\n+    shutdownLogManager();\n   }\n\\ No newline at end of file\n",
      "actualSource": "  protected void serviceStop() throws Exception {\n    super.serviceStop();\n    shutdownLogManager();\n  }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
      "extendedDetails": {}
    },
    "122be11c1497b183f18079adf97a4f0396ea66ee": {
      "type": "Ybodychange",
      "commitMessage": "MAPREDUCE-5723. MR AM container log can be truncated or empty. (Mohammad Kamrul Islam via kasha)\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1560592 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "22/01/14 10:06 PM",
      "commitName": "122be11c1497b183f18079adf97a4f0396ea66ee",
      "commitAuthor": "Karthik Kambatla",
      "commitDateOld": "21/01/14 11:23 AM",
      "commitNameOld": "d1963ad4bd1fb735bfa39e2b70773bdf1f623a87",
      "commitAuthorOld": "Jason Darrell Lowe",
      "daysBetweenCommits": 1.45,
      "commitsBetweenForRepo": 11,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,13 +1,4 @@\n-    protected void serviceStop() throws Exception {\n-      try {\n-        if(isLastAMRetry) {\n-          cleanupStagingDir();\n-        } else {\n-          LOG.info(\"Skipping cleaning up the staging dir. \"\n-              + \"assuming AM will be retried.\");\n-        }\n-      } catch (IOException io) {\n-        LOG.error(\"Failed to cleanup staging dir: \", io);\n-      }\n-      super.serviceStop();\n-    }\n\\ No newline at end of file\n+  protected void serviceStop() throws Exception {\n+    super.serviceStop();\n+    LogManager.shutdown();\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  protected void serviceStop() throws Exception {\n    super.serviceStop();\n    LogManager.shutdown();\n  }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
      "extendedDetails": {}
    },
    "0928502029ef141759008997335ea2cd836a7154": {
      "type": "Ymultichange(Yrename,Ymodifierchange,Yexceptionschange,Ybodychange)",
      "commitMessage": "YARN-530. Defined Service model strictly, implemented AbstractService for robust subclassing and migrated yarn-common services. Contributed by Steve Loughran.\nYARN-117. Migrated rest of YARN to the new service model. Contributed by Steve Louhran.\nMAPREDUCE-5298. Moved MapReduce services to YARN-530 stricter lifecycle. Contributed by Steve Loughran.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1492718 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "13/06/13 8:54 AM",
      "commitName": "0928502029ef141759008997335ea2cd836a7154",
      "commitAuthor": "Vinod Kumar Vavilapalli",
      "subchanges": [
        {
          "type": "Yrename",
          "commitMessage": "YARN-530. Defined Service model strictly, implemented AbstractService for robust subclassing and migrated yarn-common services. Contributed by Steve Loughran.\nYARN-117. Migrated rest of YARN to the new service model. Contributed by Steve Louhran.\nMAPREDUCE-5298. Moved MapReduce services to YARN-530 stricter lifecycle. Contributed by Steve Loughran.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1492718 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "13/06/13 8:54 AM",
          "commitName": "0928502029ef141759008997335ea2cd836a7154",
          "commitAuthor": "Vinod Kumar Vavilapalli",
          "commitDateOld": "03/06/13 9:05 PM",
          "commitNameOld": "a83fb61ac07c0468cbc7a38526e92683883dd932",
          "commitAuthorOld": "Vinod Kumar Vavilapalli",
          "daysBetweenCommits": 9.49,
          "commitsBetweenForRepo": 61,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,13 @@\n-    public synchronized void stop() {\n+    protected void serviceStop() throws Exception {\n       try {\n         if(isLastAMRetry) {\n           cleanupStagingDir();\n         } else {\n           LOG.info(\"Skipping cleaning up the staging dir. \"\n               + \"assuming AM will be retried.\");\n         }\n       } catch (IOException io) {\n         LOG.error(\"Failed to cleanup staging dir: \", io);\n       }\n-      super.stop();\n+      super.serviceStop();\n     }\n\\ No newline at end of file\n",
          "actualSource": "    protected void serviceStop() throws Exception {\n      try {\n        if(isLastAMRetry) {\n          cleanupStagingDir();\n        } else {\n          LOG.info(\"Skipping cleaning up the staging dir. \"\n              + \"assuming AM will be retried.\");\n        }\n      } catch (IOException io) {\n        LOG.error(\"Failed to cleanup staging dir: \", io);\n      }\n      super.serviceStop();\n    }",
          "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
          "extendedDetails": {
            "oldValue": "stop",
            "newValue": "serviceStop"
          }
        },
        {
          "type": "Ymodifierchange",
          "commitMessage": "YARN-530. Defined Service model strictly, implemented AbstractService for robust subclassing and migrated yarn-common services. Contributed by Steve Loughran.\nYARN-117. Migrated rest of YARN to the new service model. Contributed by Steve Louhran.\nMAPREDUCE-5298. Moved MapReduce services to YARN-530 stricter lifecycle. Contributed by Steve Loughran.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1492718 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "13/06/13 8:54 AM",
          "commitName": "0928502029ef141759008997335ea2cd836a7154",
          "commitAuthor": "Vinod Kumar Vavilapalli",
          "commitDateOld": "03/06/13 9:05 PM",
          "commitNameOld": "a83fb61ac07c0468cbc7a38526e92683883dd932",
          "commitAuthorOld": "Vinod Kumar Vavilapalli",
          "daysBetweenCommits": 9.49,
          "commitsBetweenForRepo": 61,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,13 @@\n-    public synchronized void stop() {\n+    protected void serviceStop() throws Exception {\n       try {\n         if(isLastAMRetry) {\n           cleanupStagingDir();\n         } else {\n           LOG.info(\"Skipping cleaning up the staging dir. \"\n               + \"assuming AM will be retried.\");\n         }\n       } catch (IOException io) {\n         LOG.error(\"Failed to cleanup staging dir: \", io);\n       }\n-      super.stop();\n+      super.serviceStop();\n     }\n\\ No newline at end of file\n",
          "actualSource": "    protected void serviceStop() throws Exception {\n      try {\n        if(isLastAMRetry) {\n          cleanupStagingDir();\n        } else {\n          LOG.info(\"Skipping cleaning up the staging dir. \"\n              + \"assuming AM will be retried.\");\n        }\n      } catch (IOException io) {\n        LOG.error(\"Failed to cleanup staging dir: \", io);\n      }\n      super.serviceStop();\n    }",
          "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
          "extendedDetails": {
            "oldValue": "[public, synchronized]",
            "newValue": "[protected]"
          }
        },
        {
          "type": "Yexceptionschange",
          "commitMessage": "YARN-530. Defined Service model strictly, implemented AbstractService for robust subclassing and migrated yarn-common services. Contributed by Steve Loughran.\nYARN-117. Migrated rest of YARN to the new service model. Contributed by Steve Louhran.\nMAPREDUCE-5298. Moved MapReduce services to YARN-530 stricter lifecycle. Contributed by Steve Loughran.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1492718 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "13/06/13 8:54 AM",
          "commitName": "0928502029ef141759008997335ea2cd836a7154",
          "commitAuthor": "Vinod Kumar Vavilapalli",
          "commitDateOld": "03/06/13 9:05 PM",
          "commitNameOld": "a83fb61ac07c0468cbc7a38526e92683883dd932",
          "commitAuthorOld": "Vinod Kumar Vavilapalli",
          "daysBetweenCommits": 9.49,
          "commitsBetweenForRepo": 61,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,13 @@\n-    public synchronized void stop() {\n+    protected void serviceStop() throws Exception {\n       try {\n         if(isLastAMRetry) {\n           cleanupStagingDir();\n         } else {\n           LOG.info(\"Skipping cleaning up the staging dir. \"\n               + \"assuming AM will be retried.\");\n         }\n       } catch (IOException io) {\n         LOG.error(\"Failed to cleanup staging dir: \", io);\n       }\n-      super.stop();\n+      super.serviceStop();\n     }\n\\ No newline at end of file\n",
          "actualSource": "    protected void serviceStop() throws Exception {\n      try {\n        if(isLastAMRetry) {\n          cleanupStagingDir();\n        } else {\n          LOG.info(\"Skipping cleaning up the staging dir. \"\n              + \"assuming AM will be retried.\");\n        }\n      } catch (IOException io) {\n        LOG.error(\"Failed to cleanup staging dir: \", io);\n      }\n      super.serviceStop();\n    }",
          "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
          "extendedDetails": {
            "oldValue": "[]",
            "newValue": "[Exception]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "YARN-530. Defined Service model strictly, implemented AbstractService for robust subclassing and migrated yarn-common services. Contributed by Steve Loughran.\nYARN-117. Migrated rest of YARN to the new service model. Contributed by Steve Louhran.\nMAPREDUCE-5298. Moved MapReduce services to YARN-530 stricter lifecycle. Contributed by Steve Loughran.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1492718 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "13/06/13 8:54 AM",
          "commitName": "0928502029ef141759008997335ea2cd836a7154",
          "commitAuthor": "Vinod Kumar Vavilapalli",
          "commitDateOld": "03/06/13 9:05 PM",
          "commitNameOld": "a83fb61ac07c0468cbc7a38526e92683883dd932",
          "commitAuthorOld": "Vinod Kumar Vavilapalli",
          "daysBetweenCommits": 9.49,
          "commitsBetweenForRepo": 61,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,13 @@\n-    public synchronized void stop() {\n+    protected void serviceStop() throws Exception {\n       try {\n         if(isLastAMRetry) {\n           cleanupStagingDir();\n         } else {\n           LOG.info(\"Skipping cleaning up the staging dir. \"\n               + \"assuming AM will be retried.\");\n         }\n       } catch (IOException io) {\n         LOG.error(\"Failed to cleanup staging dir: \", io);\n       }\n-      super.stop();\n+      super.serviceStop();\n     }\n\\ No newline at end of file\n",
          "actualSource": "    protected void serviceStop() throws Exception {\n      try {\n        if(isLastAMRetry) {\n          cleanupStagingDir();\n        } else {\n          LOG.info(\"Skipping cleaning up the staging dir. \"\n              + \"assuming AM will be retried.\");\n        }\n      } catch (IOException io) {\n        LOG.error(\"Failed to cleanup staging dir: \", io);\n      }\n      super.serviceStop();\n    }",
          "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
          "extendedDetails": {}
        }
      ]
    },
    "25e96e455b3473387df865fbc1c3ad7ebf9ff1e4": {
      "type": "Ybodychange",
      "commitMessage": "MAPREDUCE-4611. MR AM dies badly when Node is decommissioned (Robert Evans via tgraves)\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1379599 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "31/08/12 1:43 PM",
      "commitName": "25e96e455b3473387df865fbc1c3ad7ebf9ff1e4",
      "commitAuthor": "Thomas Graves",
      "commitDateOld": "30/08/12 12:58 PM",
      "commitNameOld": "6f6e170325d39f9f7b543a39791b2cb54692f83d",
      "commitAuthorOld": "Robert Joseph Evans",
      "daysBetweenCommits": 1.03,
      "commitsBetweenForRepo": 14,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,8 +1,13 @@\n     public synchronized void stop() {\n       try {\n-        cleanupStagingDir();\n+        if(isLastAMRetry) {\n+          cleanupStagingDir();\n+        } else {\n+          LOG.info(\"Skipping cleaning up the staging dir. \"\n+              + \"assuming AM will be retried.\");\n+        }\n       } catch (IOException io) {\n         LOG.error(\"Failed to cleanup staging dir: \", io);\n       }\n       super.stop();\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public synchronized void stop() {\n      try {\n        if(isLastAMRetry) {\n          cleanupStagingDir();\n        } else {\n          LOG.info(\"Skipping cleaning up the staging dir. \"\n              + \"assuming AM will be retried.\");\n        }\n      } catch (IOException io) {\n        LOG.error(\"Failed to cleanup staging dir: \", io);\n      }\n      super.stop();\n    }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
      "extendedDetails": {}
    },
    "cfafd8c29dc3679e503c6155bcbf26f377b0ea8f": {
      "type": "Ybodychange",
      "commitMessage": "MAPREDUCE-4099 amendment. ApplicationMaster will remove staging directory after the history service is stopped. (Contributed by Jason Lowe)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1324866 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "11/04/12 10:09 AM",
      "commitName": "cfafd8c29dc3679e503c6155bcbf26f377b0ea8f",
      "commitAuthor": "Siddharth Seth",
      "commitDateOld": "10/04/12 11:57 AM",
      "commitNameOld": "793746870b704a30fa0595d09da3d176ada75c35",
      "commitAuthorOld": "Robert Joseph Evans",
      "daysBetweenCommits": 0.93,
      "commitsBetweenForRepo": 14,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,4 +1,8 @@\n     public synchronized void stop() {\n-      ((Service)this.containerLauncher).stop();\n+      try {\n+        cleanupStagingDir();\n+      } catch (IOException io) {\n+        LOG.error(\"Failed to cleanup staging dir: \", io);\n+      }\n       super.stop();\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public synchronized void stop() {\n      try {\n        cleanupStagingDir();\n      } catch (IOException io) {\n        LOG.error(\"Failed to cleanup staging dir: \", io);\n      }\n      super.stop();\n    }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
      "extendedDetails": {}
    },
    "61900651b1b85cf235e01142acf2a51727fc5537": {
      "type": "Yintroduced",
      "commitMessage": "MAPREDUCE-3006. Fixed MapReduce AM to exit only after properly writing out history file. (vinodkv)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1172206 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "18/09/11 12:16 AM",
      "commitName": "61900651b1b85cf235e01142acf2a51727fc5537",
      "commitAuthor": "Vinod Kumar Vavilapalli",
      "diff": "@@ -0,0 +1,4 @@\n+    public synchronized void stop() {\n+      ((Service)this.containerLauncher).stop();\n+      super.stop();\n+    }\n\\ No newline at end of file\n",
      "actualSource": "    public synchronized void stop() {\n      ((Service)this.containerLauncher).stop();\n      super.stop();\n    }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java"
    }
  }
}