{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "HttpServer2.java",
  "functionName": "doFilter",
  "functionId": "doFilter___request-ServletRequest__response-ServletResponse__chain-FilterChain",
  "sourceFilePath": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/http/HttpServer2.java",
  "functionStartLine": 1677,
  "functionEndLine": 1699,
  "numCommitsSeen": 116,
  "timeTaken": 3589,
  "changeHistory": [
    "aa23d49fc8b9c2537529dbdc13512000e2ab295a",
    "ef30bf3c3f2688f803b3e9d16cc7e9f61a1ab0de",
    "042a3ae960883c263adc76f16d0ea3438d8b12be",
    "33a47743a5f4263bc21b345587370c5ecf43f5b4",
    "cd7157784e5e5ddc4e77144d042e54dd0d04bac1",
    "0f6dfeeacbab65a31a33927a4eb84871d371fe52",
    "a196766ea07775f18ded69bd9e8d239f8cfd3ccc",
    "ee27b8ea643ecf2345dee0950b266dcb39fa21cc",
    "f7105a2773048be8229b80ca74a889c9b15348b6",
    "875c9d62c6db32aca16201c369d972bcf4a38dbd",
    "366b1b1dd6f1ade1996c7c0eec1aca185c68d6cb"
  ],
  "changeHistoryShort": {
    "aa23d49fc8b9c2537529dbdc13512000e2ab295a": "Ybodychange",
    "ef30bf3c3f2688f803b3e9d16cc7e9f61a1ab0de": "Ybodychange",
    "042a3ae960883c263adc76f16d0ea3438d8b12be": "Ybodychange",
    "33a47743a5f4263bc21b345587370c5ecf43f5b4": "Yfilerename",
    "cd7157784e5e5ddc4e77144d042e54dd0d04bac1": "Yfilerename",
    "0f6dfeeacbab65a31a33927a4eb84871d371fe52": "Yfilerename",
    "a196766ea07775f18ded69bd9e8d239f8cfd3ccc": "Yfilerename",
    "ee27b8ea643ecf2345dee0950b266dcb39fa21cc": "Ybodychange",
    "f7105a2773048be8229b80ca74a889c9b15348b6": "Ybodychange",
    "875c9d62c6db32aca16201c369d972bcf4a38dbd": "Ybodychange",
    "366b1b1dd6f1ade1996c7c0eec1aca185c68d6cb": "Yintroduced"
  },
  "changeHistoryDetails": {
    "aa23d49fc8b9c2537529dbdc13512000e2ab295a": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-15457. Add Security-Related HTTP Response Header in WEBUIs. (kanwaljeets via rkanter)\n",
      "commitDate": "23/05/18 10:24 AM",
      "commitName": "aa23d49fc8b9c2537529dbdc13512000e2ab295a",
      "commitAuthor": "Robert Kanter",
      "commitDateOld": "14/03/18 1:36 PM",
      "commitNameOld": "252c2b4d52e0dd8984d6f2a8f292f40e1c347fab",
      "commitAuthorOld": "Wangda Tan",
      "daysBetweenCommits": 69.87,
      "commitsBetweenForRepo": 1117,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,27 +1,23 @@\n     public void doFilter(ServletRequest request,\n                          ServletResponse response,\n                          FilterChain chain\n                          ) throws IOException, ServletException {\n       HttpServletRequestWrapper quoted \u003d\n         new RequestQuoter((HttpServletRequest) request);\n       HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n \n       String mime \u003d inferMimeType(request);\n       if (mime \u003d\u003d null) {\n         httpResponse.setContentType(\"text/plain; charset\u003dutf-8\");\n       } else if (mime.startsWith(\"text/html\")) {\n         // HTML with unspecified encoding, we want to\n         // force HTML with utf-8 encoding\n         // This is to avoid the following security issue:\n         // http://openmya.hacker.jp/hasegawa/security/utf7cs.html\n         httpResponse.setContentType(\"text/html; charset\u003dutf-8\");\n       } else if (mime.startsWith(\"application/xml\")) {\n         httpResponse.setContentType(\"text/xml; charset\u003dutf-8\");\n       }\n-\n-      if(Boolean.valueOf(this.config.getInitParameter(X_FRAME_ENABLED))) {\n-        httpResponse.addHeader(\"X-FRAME-OPTIONS\",\n-            this.config.getInitParameter(X_FRAME_VALUE));\n-      }\n+      headerMap.forEach((k, v) -\u003e httpResponse.addHeader(k, v));\n       chain.doFilter(quoted, httpResponse);\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void doFilter(ServletRequest request,\n                         ServletResponse response,\n                         FilterChain chain\n                         ) throws IOException, ServletException {\n      HttpServletRequestWrapper quoted \u003d\n        new RequestQuoter((HttpServletRequest) request);\n      HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n\n      String mime \u003d inferMimeType(request);\n      if (mime \u003d\u003d null) {\n        httpResponse.setContentType(\"text/plain; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"text/html\")) {\n        // HTML with unspecified encoding, we want to\n        // force HTML with utf-8 encoding\n        // This is to avoid the following security issue:\n        // http://openmya.hacker.jp/hasegawa/security/utf7cs.html\n        httpResponse.setContentType(\"text/html; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"application/xml\")) {\n        httpResponse.setContentType(\"text/xml; charset\u003dutf-8\");\n      }\n      headerMap.forEach((k, v) -\u003e httpResponse.addHeader(k, v));\n      chain.doFilter(quoted, httpResponse);\n    }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/http/HttpServer2.java",
      "extendedDetails": {}
    },
    "ef30bf3c3f2688f803b3e9d16cc7e9f61a1ab0de": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-13352. Make X-FRAME-OPTIONS configurable in HttpServer2. Contributed by Anu Engineer.\n",
      "commitDate": "08/07/16 2:17 PM",
      "commitName": "ef30bf3c3f2688f803b3e9d16cc7e9f61a1ab0de",
      "commitAuthor": "Jitendra Pandey",
      "commitDateOld": "04/05/16 6:52 AM",
      "commitNameOld": "36972d61d1cf0b8248a4887df780d9863b27b7c1",
      "commitAuthorOld": "Akira Ajisaka",
      "daysBetweenCommits": 65.31,
      "commitsBetweenForRepo": 452,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,23 +1,27 @@\n     public void doFilter(ServletRequest request,\n                          ServletResponse response,\n                          FilterChain chain\n                          ) throws IOException, ServletException {\n       HttpServletRequestWrapper quoted \u003d\n         new RequestQuoter((HttpServletRequest) request);\n       HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n \n       String mime \u003d inferMimeType(request);\n       if (mime \u003d\u003d null) {\n         httpResponse.setContentType(\"text/plain; charset\u003dutf-8\");\n       } else if (mime.startsWith(\"text/html\")) {\n         // HTML with unspecified encoding, we want to\n         // force HTML with utf-8 encoding\n         // This is to avoid the following security issue:\n         // http://openmya.hacker.jp/hasegawa/security/utf7cs.html\n         httpResponse.setContentType(\"text/html; charset\u003dutf-8\");\n       } else if (mime.startsWith(\"application/xml\")) {\n         httpResponse.setContentType(\"text/xml; charset\u003dutf-8\");\n       }\n-      httpResponse.addHeader(\"X-FRAME-OPTIONS\", X_FRAME_OPTION.toString());\n+\n+      if(Boolean.valueOf(this.config.getInitParameter(X_FRAME_ENABLED))) {\n+        httpResponse.addHeader(\"X-FRAME-OPTIONS\",\n+            this.config.getInitParameter(X_FRAME_VALUE));\n+      }\n       chain.doFilter(quoted, httpResponse);\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void doFilter(ServletRequest request,\n                         ServletResponse response,\n                         FilterChain chain\n                         ) throws IOException, ServletException {\n      HttpServletRequestWrapper quoted \u003d\n        new RequestQuoter((HttpServletRequest) request);\n      HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n\n      String mime \u003d inferMimeType(request);\n      if (mime \u003d\u003d null) {\n        httpResponse.setContentType(\"text/plain; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"text/html\")) {\n        // HTML with unspecified encoding, we want to\n        // force HTML with utf-8 encoding\n        // This is to avoid the following security issue:\n        // http://openmya.hacker.jp/hasegawa/security/utf7cs.html\n        httpResponse.setContentType(\"text/html; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"application/xml\")) {\n        httpResponse.setContentType(\"text/xml; charset\u003dutf-8\");\n      }\n\n      if(Boolean.valueOf(this.config.getInitParameter(X_FRAME_ENABLED))) {\n        httpResponse.addHeader(\"X-FRAME-OPTIONS\",\n            this.config.getInitParameter(X_FRAME_VALUE));\n      }\n      chain.doFilter(quoted, httpResponse);\n    }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/http/HttpServer2.java",
      "extendedDetails": {}
    },
    "042a3ae960883c263adc76f16d0ea3438d8b12be": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-12964. Http server vulnerable to clickjacking (haibochen via rkanter)\n",
      "commitDate": "12/04/16 2:40 PM",
      "commitName": "042a3ae960883c263adc76f16d0ea3438d8b12be",
      "commitAuthor": "Robert Kanter",
      "commitDateOld": "22/02/16 2:13 PM",
      "commitNameOld": "a2fdfff02daef85b651eda31e99868986aab5b28",
      "commitAuthorOld": "Zhe Zhang",
      "daysBetweenCommits": 49.98,
      "commitsBetweenForRepo": 307,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,22 +1,23 @@\n     public void doFilter(ServletRequest request,\n                          ServletResponse response,\n                          FilterChain chain\n                          ) throws IOException, ServletException {\n       HttpServletRequestWrapper quoted \u003d\n         new RequestQuoter((HttpServletRequest) request);\n       HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n \n       String mime \u003d inferMimeType(request);\n       if (mime \u003d\u003d null) {\n         httpResponse.setContentType(\"text/plain; charset\u003dutf-8\");\n       } else if (mime.startsWith(\"text/html\")) {\n         // HTML with unspecified encoding, we want to\n         // force HTML with utf-8 encoding\n         // This is to avoid the following security issue:\n         // http://openmya.hacker.jp/hasegawa/security/utf7cs.html\n         httpResponse.setContentType(\"text/html; charset\u003dutf-8\");\n       } else if (mime.startsWith(\"application/xml\")) {\n         httpResponse.setContentType(\"text/xml; charset\u003dutf-8\");\n       }\n+      httpResponse.addHeader(\"X-FRAME-OPTIONS\", X_FRAME_OPTION.toString());\n       chain.doFilter(quoted, httpResponse);\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void doFilter(ServletRequest request,\n                         ServletResponse response,\n                         FilterChain chain\n                         ) throws IOException, ServletException {\n      HttpServletRequestWrapper quoted \u003d\n        new RequestQuoter((HttpServletRequest) request);\n      HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n\n      String mime \u003d inferMimeType(request);\n      if (mime \u003d\u003d null) {\n        httpResponse.setContentType(\"text/plain; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"text/html\")) {\n        // HTML with unspecified encoding, we want to\n        // force HTML with utf-8 encoding\n        // This is to avoid the following security issue:\n        // http://openmya.hacker.jp/hasegawa/security/utf7cs.html\n        httpResponse.setContentType(\"text/html; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"application/xml\")) {\n        httpResponse.setContentType(\"text/xml; charset\u003dutf-8\");\n      }\n      httpResponse.addHeader(\"X-FRAME-OPTIONS\", X_FRAME_OPTION.toString());\n      chain.doFilter(quoted, httpResponse);\n    }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/http/HttpServer2.java",
      "extendedDetails": {}
    },
    "33a47743a5f4263bc21b345587370c5ecf43f5b4": {
      "type": "Yfilerename",
      "commitMessage": "HADOOP-10255. Rename HttpServer to HttpServer2 to retain older HttpServer in branch-2 for compatibility. Contributed by Haohui Mai.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1561959 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "27/01/14 11:32 PM",
      "commitName": "33a47743a5f4263bc21b345587370c5ecf43f5b4",
      "commitAuthor": "Suresh Srinivas",
      "commitDateOld": "27/01/14 10:41 PM",
      "commitNameOld": "87166f1ee81dbad579508c2bdbc7dda96b1ef809",
      "commitAuthorOld": "Arpit Agarwal",
      "daysBetweenCommits": 0.04,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,22 +1,22 @@\n-    public void doFilter(ServletRequest request, \n+    public void doFilter(ServletRequest request,\n                          ServletResponse response,\n                          FilterChain chain\n                          ) throws IOException, ServletException {\n-      HttpServletRequestWrapper quoted \u003d \n+      HttpServletRequestWrapper quoted \u003d\n         new RequestQuoter((HttpServletRequest) request);\n       HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n \n       String mime \u003d inferMimeType(request);\n       if (mime \u003d\u003d null) {\n         httpResponse.setContentType(\"text/plain; charset\u003dutf-8\");\n       } else if (mime.startsWith(\"text/html\")) {\n         // HTML with unspecified encoding, we want to\n         // force HTML with utf-8 encoding\n         // This is to avoid the following security issue:\n         // http://openmya.hacker.jp/hasegawa/security/utf7cs.html\n         httpResponse.setContentType(\"text/html; charset\u003dutf-8\");\n       } else if (mime.startsWith(\"application/xml\")) {\n         httpResponse.setContentType(\"text/xml; charset\u003dutf-8\");\n       }\n       chain.doFilter(quoted, httpResponse);\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void doFilter(ServletRequest request,\n                         ServletResponse response,\n                         FilterChain chain\n                         ) throws IOException, ServletException {\n      HttpServletRequestWrapper quoted \u003d\n        new RequestQuoter((HttpServletRequest) request);\n      HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n\n      String mime \u003d inferMimeType(request);\n      if (mime \u003d\u003d null) {\n        httpResponse.setContentType(\"text/plain; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"text/html\")) {\n        // HTML with unspecified encoding, we want to\n        // force HTML with utf-8 encoding\n        // This is to avoid the following security issue:\n        // http://openmya.hacker.jp/hasegawa/security/utf7cs.html\n        httpResponse.setContentType(\"text/html; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"application/xml\")) {\n        httpResponse.setContentType(\"text/xml; charset\u003dutf-8\");\n      }\n      chain.doFilter(quoted, httpResponse);\n    }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/http/HttpServer2.java",
      "extendedDetails": {
        "oldPath": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/http/HttpServer.java",
        "newPath": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/http/HttpServer2.java"
      }
    },
    "cd7157784e5e5ddc4e77144d042e54dd0d04bac1": {
      "type": "Yfilerename",
      "commitMessage": "HADOOP-7560. Change src layout to be heirarchical. Contributed by Alejandro Abdelnur.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1161332 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "24/08/11 5:14 PM",
      "commitName": "cd7157784e5e5ddc4e77144d042e54dd0d04bac1",
      "commitAuthor": "Arun Murthy",
      "commitDateOld": "24/08/11 5:06 PM",
      "commitNameOld": "bb0005cfec5fd2861600ff5babd259b48ba18b63",
      "commitAuthorOld": "Arun Murthy",
      "daysBetweenCommits": 0.01,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "",
      "actualSource": "    public void doFilter(ServletRequest request, \n                         ServletResponse response,\n                         FilterChain chain\n                         ) throws IOException, ServletException {\n      HttpServletRequestWrapper quoted \u003d \n        new RequestQuoter((HttpServletRequest) request);\n      HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n\n      String mime \u003d inferMimeType(request);\n      if (mime \u003d\u003d null) {\n        httpResponse.setContentType(\"text/plain; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"text/html\")) {\n        // HTML with unspecified encoding, we want to\n        // force HTML with utf-8 encoding\n        // This is to avoid the following security issue:\n        // http://openmya.hacker.jp/hasegawa/security/utf7cs.html\n        httpResponse.setContentType(\"text/html; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"application/xml\")) {\n        httpResponse.setContentType(\"text/xml; charset\u003dutf-8\");\n      }\n      chain.doFilter(quoted, httpResponse);\n    }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/http/HttpServer.java",
      "extendedDetails": {
        "oldPath": "hadoop-common/src/main/java/org/apache/hadoop/http/HttpServer.java",
        "newPath": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/http/HttpServer.java"
      }
    },
    "0f6dfeeacbab65a31a33927a4eb84871d371fe52": {
      "type": "Yfilerename",
      "commitMessage": "HADOOP-6671. Use maven for hadoop common builds. Contributed by Alejandro Abdelnur.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1153184 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "02/08/11 9:37 AM",
      "commitName": "0f6dfeeacbab65a31a33927a4eb84871d371fe52",
      "commitAuthor": "Thomas White",
      "commitDateOld": "01/08/11 3:53 PM",
      "commitNameOld": "9bac807cedbcff34e1a144fb475eff267e5ed86d",
      "commitAuthorOld": "Arun Murthy",
      "daysBetweenCommits": 0.74,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "",
      "actualSource": "    public void doFilter(ServletRequest request, \n                         ServletResponse response,\n                         FilterChain chain\n                         ) throws IOException, ServletException {\n      HttpServletRequestWrapper quoted \u003d \n        new RequestQuoter((HttpServletRequest) request);\n      HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n\n      String mime \u003d inferMimeType(request);\n      if (mime \u003d\u003d null) {\n        httpResponse.setContentType(\"text/plain; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"text/html\")) {\n        // HTML with unspecified encoding, we want to\n        // force HTML with utf-8 encoding\n        // This is to avoid the following security issue:\n        // http://openmya.hacker.jp/hasegawa/security/utf7cs.html\n        httpResponse.setContentType(\"text/html; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"application/xml\")) {\n        httpResponse.setContentType(\"text/xml; charset\u003dutf-8\");\n      }\n      chain.doFilter(quoted, httpResponse);\n    }",
      "path": "hadoop-common/src/main/java/org/apache/hadoop/http/HttpServer.java",
      "extendedDetails": {
        "oldPath": "common/src/java/org/apache/hadoop/http/HttpServer.java",
        "newPath": "hadoop-common/src/main/java/org/apache/hadoop/http/HttpServer.java"
      }
    },
    "a196766ea07775f18ded69bd9e8d239f8cfd3ccc": {
      "type": "Yfilerename",
      "commitMessage": "HADOOP-7106. Reorganize SVN layout to combine HDFS, Common, and MR in a single tree (project unsplit)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1134994 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "12/06/11 3:00 PM",
      "commitName": "a196766ea07775f18ded69bd9e8d239f8cfd3ccc",
      "commitAuthor": "Todd Lipcon",
      "commitDateOld": "11/06/11 9:13 PM",
      "commitNameOld": "a285fb5effe9ba3be4ec5f942afaf5ddd1186151",
      "commitAuthorOld": "Eli Collins",
      "daysBetweenCommits": 0.74,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "",
      "actualSource": "    public void doFilter(ServletRequest request, \n                         ServletResponse response,\n                         FilterChain chain\n                         ) throws IOException, ServletException {\n      HttpServletRequestWrapper quoted \u003d \n        new RequestQuoter((HttpServletRequest) request);\n      HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n\n      String mime \u003d inferMimeType(request);\n      if (mime \u003d\u003d null) {\n        httpResponse.setContentType(\"text/plain; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"text/html\")) {\n        // HTML with unspecified encoding, we want to\n        // force HTML with utf-8 encoding\n        // This is to avoid the following security issue:\n        // http://openmya.hacker.jp/hasegawa/security/utf7cs.html\n        httpResponse.setContentType(\"text/html; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"application/xml\")) {\n        httpResponse.setContentType(\"text/xml; charset\u003dutf-8\");\n      }\n      chain.doFilter(quoted, httpResponse);\n    }",
      "path": "common/src/java/org/apache/hadoop/http/HttpServer.java",
      "extendedDetails": {
        "oldPath": "src/java/org/apache/hadoop/http/HttpServer.java",
        "newPath": "common/src/java/org/apache/hadoop/http/HttpServer.java"
      }
    },
    "ee27b8ea643ecf2345dee0950b266dcb39fa21cc": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-7093. Servlets should default to text/plain. Contributed by Todd Lipcon\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1058822 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "13/01/11 5:08 PM",
      "commitName": "ee27b8ea643ecf2345dee0950b266dcb39fa21cc",
      "commitAuthor": "Todd Lipcon",
      "commitDateOld": "15/11/10 9:01 AM",
      "commitNameOld": "f7105a2773048be8229b80ca74a889c9b15348b6",
      "commitAuthorOld": "Thomas White",
      "daysBetweenCommits": 59.34,
      "commitsBetweenForRepo": 45,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,18 +1,22 @@\n     public void doFilter(ServletRequest request, \n                          ServletResponse response,\n                          FilterChain chain\n                          ) throws IOException, ServletException {\n       HttpServletRequestWrapper quoted \u003d \n         new RequestQuoter((HttpServletRequest) request);\n       HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n \n       String mime \u003d inferMimeType(request);\n-      if (mime \u003d\u003d null || mime.equals(\"text/html\")) {\n-        // no extension or HTML with unspecified encoding, we want to\n+      if (mime \u003d\u003d null) {\n+        httpResponse.setContentType(\"text/plain; charset\u003dutf-8\");\n+      } else if (mime.startsWith(\"text/html\")) {\n+        // HTML with unspecified encoding, we want to\n         // force HTML with utf-8 encoding\n         // This is to avoid the following security issue:\n         // http://openmya.hacker.jp/hasegawa/security/utf7cs.html\n         httpResponse.setContentType(\"text/html; charset\u003dutf-8\");\n+      } else if (mime.startsWith(\"application/xml\")) {\n+        httpResponse.setContentType(\"text/xml; charset\u003dutf-8\");\n       }\n       chain.doFilter(quoted, httpResponse);\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void doFilter(ServletRequest request, \n                         ServletResponse response,\n                         FilterChain chain\n                         ) throws IOException, ServletException {\n      HttpServletRequestWrapper quoted \u003d \n        new RequestQuoter((HttpServletRequest) request);\n      HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n\n      String mime \u003d inferMimeType(request);\n      if (mime \u003d\u003d null) {\n        httpResponse.setContentType(\"text/plain; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"text/html\")) {\n        // HTML with unspecified encoding, we want to\n        // force HTML with utf-8 encoding\n        // This is to avoid the following security issue:\n        // http://openmya.hacker.jp/hasegawa/security/utf7cs.html\n        httpResponse.setContentType(\"text/html; charset\u003dutf-8\");\n      } else if (mime.startsWith(\"application/xml\")) {\n        httpResponse.setContentType(\"text/xml; charset\u003dutf-8\");\n      }\n      chain.doFilter(quoted, httpResponse);\n    }",
      "path": "src/java/org/apache/hadoop/http/HttpServer.java",
      "extendedDetails": {}
    },
    "f7105a2773048be8229b80ca74a889c9b15348b6": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-6496. HttpServer sends wrong content-type for CSS files (and others). Contributed by Todd Lipcon.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1035353 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "15/11/10 9:01 AM",
      "commitName": "f7105a2773048be8229b80ca74a889c9b15348b6",
      "commitAuthor": "Thomas White",
      "commitDateOld": "11/08/10 11:34 PM",
      "commitNameOld": "4c940af71438361b47876ac681a974123652d01c",
      "commitAuthorOld": "Amareshwari Sri Ramadasu",
      "daysBetweenCommits": 95.44,
      "commitsBetweenForRepo": 69,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,12 +1,18 @@\n     public void doFilter(ServletRequest request, \n                          ServletResponse response,\n                          FilterChain chain\n                          ) throws IOException, ServletException {\n       HttpServletRequestWrapper quoted \u003d \n         new RequestQuoter((HttpServletRequest) request);\n-      final HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n-      // set the default to UTF-8 so that we don\u0027t need to worry about IE7\n-      // choosing to interpret the special characters as UTF-7\n-      httpResponse.setContentType(\"text/html;charset\u003dutf-8\");\n-      chain.doFilter(quoted, response);\n+      HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n+\n+      String mime \u003d inferMimeType(request);\n+      if (mime \u003d\u003d null || mime.equals(\"text/html\")) {\n+        // no extension or HTML with unspecified encoding, we want to\n+        // force HTML with utf-8 encoding\n+        // This is to avoid the following security issue:\n+        // http://openmya.hacker.jp/hasegawa/security/utf7cs.html\n+        httpResponse.setContentType(\"text/html; charset\u003dutf-8\");\n+      }\n+      chain.doFilter(quoted, httpResponse);\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void doFilter(ServletRequest request, \n                         ServletResponse response,\n                         FilterChain chain\n                         ) throws IOException, ServletException {\n      HttpServletRequestWrapper quoted \u003d \n        new RequestQuoter((HttpServletRequest) request);\n      HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n\n      String mime \u003d inferMimeType(request);\n      if (mime \u003d\u003d null || mime.equals(\"text/html\")) {\n        // no extension or HTML with unspecified encoding, we want to\n        // force HTML with utf-8 encoding\n        // This is to avoid the following security issue:\n        // http://openmya.hacker.jp/hasegawa/security/utf7cs.html\n        httpResponse.setContentType(\"text/html; charset\u003dutf-8\");\n      }\n      chain.doFilter(quoted, httpResponse);\n    }",
      "path": "src/java/org/apache/hadoop/http/HttpServer.java",
      "extendedDetails": {}
    },
    "875c9d62c6db32aca16201c369d972bcf4a38dbd": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-6441. Protect web ui from cross site scripting attacks (XSS) on\nthe host http header and using encoded utf-7. (omalley)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@891132 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "15/12/09 10:31 PM",
      "commitName": "875c9d62c6db32aca16201c369d972bcf4a38dbd",
      "commitAuthor": "Owen O\u0027Malley",
      "commitDateOld": "10/12/09 11:26 AM",
      "commitNameOld": "d7fb2d3c859c852e303bb002d56e72813a1af7b2",
      "commitAuthorOld": "Konstantin Boudnik",
      "daysBetweenCommits": 5.46,
      "commitsBetweenForRepo": 14,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,8 +1,12 @@\n     public void doFilter(ServletRequest request, \n                          ServletResponse response,\n                          FilterChain chain\n                          ) throws IOException, ServletException {\n       HttpServletRequestWrapper quoted \u003d \n         new RequestQuoter((HttpServletRequest) request);\n+      final HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n+      // set the default to UTF-8 so that we don\u0027t need to worry about IE7\n+      // choosing to interpret the special characters as UTF-7\n+      httpResponse.setContentType(\"text/html;charset\u003dutf-8\");\n       chain.doFilter(quoted, response);\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void doFilter(ServletRequest request, \n                         ServletResponse response,\n                         FilterChain chain\n                         ) throws IOException, ServletException {\n      HttpServletRequestWrapper quoted \u003d \n        new RequestQuoter((HttpServletRequest) request);\n      final HttpServletResponse httpResponse \u003d (HttpServletResponse) response;\n      // set the default to UTF-8 so that we don\u0027t need to worry about IE7\n      // choosing to interpret the special characters as UTF-7\n      httpResponse.setContentType(\"text/html;charset\u003dutf-8\");\n      chain.doFilter(quoted, response);\n    }",
      "path": "src/java/org/apache/hadoop/http/HttpServer.java",
      "extendedDetails": {}
    },
    "366b1b1dd6f1ade1996c7c0eec1aca185c68d6cb": {
      "type": "Yintroduced",
      "commitMessage": "HADOOP-6151. Added a input filter to all of the http servlets that quotes\nhtml characters in the parameters, to prevent cross site scripting \nattacks. (omalley)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@816703 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "18/09/09 9:31 AM",
      "commitName": "366b1b1dd6f1ade1996c7c0eec1aca185c68d6cb",
      "commitAuthor": "Owen O\u0027Malley",
      "diff": "@@ -0,0 +1,8 @@\n+    public void doFilter(ServletRequest request, \n+                         ServletResponse response,\n+                         FilterChain chain\n+                         ) throws IOException, ServletException {\n+      HttpServletRequestWrapper quoted \u003d \n+        new RequestQuoter((HttpServletRequest) request);\n+      chain.doFilter(quoted, response);\n+    }\n\\ No newline at end of file\n",
      "actualSource": "    public void doFilter(ServletRequest request, \n                         ServletResponse response,\n                         FilterChain chain\n                         ) throws IOException, ServletException {\n      HttpServletRequestWrapper quoted \u003d \n        new RequestQuoter((HttpServletRequest) request);\n      chain.doFilter(quoted, response);\n    }",
      "path": "src/java/org/apache/hadoop/http/HttpServer.java"
    }
  }
}