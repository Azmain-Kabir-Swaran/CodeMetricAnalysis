{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "JobImpl.java",
  "functionName": "getExternalState",
  "functionId": "getExternalState___smState-JobStateInternal",
  "sourceFilePath": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/job/impl/JobImpl.java",
  "functionStartLine": 1055,
  "functionEndLine": 1077,
  "numCommitsSeen": 94,
  "timeTaken": 3141,
  "changeHistory": [
    "5d4b684c02ef8b702c68345d7306be2d19195161",
    "0939c49368f1bc9dc08cec9913b21ddea30d4e45",
    "44ea6e3ad5656d6edbaa8f3a510ab800e42694e3",
    "8a037edbfbbf1db74303c6d37c73153bc1922292",
    "fc75d3f3dc2733d6c783eb4d4f1c5c6ae680f08e",
    "402eb1851341fce72c8e46266a2578bb67b5b684",
    "022f7b4a25c73b8c43985e8d1bac717b96373ac6"
  ],
  "changeHistoryShort": {
    "5d4b684c02ef8b702c68345d7306be2d19195161": "Ymultichange(Ymodifierchange,Ybodychange)",
    "0939c49368f1bc9dc08cec9913b21ddea30d4e45": "Ybodychange",
    "44ea6e3ad5656d6edbaa8f3a510ab800e42694e3": "Ybodychange",
    "8a037edbfbbf1db74303c6d37c73153bc1922292": "Ybodychange",
    "fc75d3f3dc2733d6c783eb4d4f1c5c6ae680f08e": "Ybodychange",
    "402eb1851341fce72c8e46266a2578bb67b5b684": "Ybodychange",
    "022f7b4a25c73b8c43985e8d1bac717b96373ac6": "Yintroduced"
  },
  "changeHistoryDetails": {
    "5d4b684c02ef8b702c68345d7306be2d19195161": {
      "type": "Ymultichange(Ymodifierchange,Ybodychange)",
      "commitMessage": "MAPREDUCE-5441. Changed MR AM to return RUNNING state if exiting when RM commands to reboot, so that client can continue to track the overall job. Contributed by xJian He.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1518821 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "29/08/13 2:07 PM",
      "commitName": "5d4b684c02ef8b702c68345d7306be2d19195161",
      "commitAuthor": "Vinod Kumar Vavilapalli",
      "subchanges": [
        {
          "type": "Ymodifierchange",
          "commitMessage": "MAPREDUCE-5441. Changed MR AM to return RUNNING state if exiting when RM commands to reboot, so that client can continue to track the overall job. Contributed by xJian He.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1518821 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "29/08/13 2:07 PM",
          "commitName": "5d4b684c02ef8b702c68345d7306be2d19195161",
          "commitAuthor": "Vinod Kumar Vavilapalli",
          "commitDateOld": "23/07/13 9:52 AM",
          "commitNameOld": "0939c49368f1bc9dc08cec9913b21ddea30d4e45",
          "commitAuthorOld": "Jason Darrell Lowe",
          "daysBetweenCommits": 37.18,
          "commitsBetweenForRepo": 232,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,17 +1,23 @@\n-  private static JobState getExternalState(JobStateInternal smState) {\n+  private JobState getExternalState(JobStateInternal smState) {\n     switch (smState) {\n     case KILL_WAIT:\n     case KILL_ABORT:\n       return JobState.KILLED;\n     case SETUP:\n     case COMMITTING:\n       return JobState.RUNNING;\n     case FAIL_WAIT:\n     case FAIL_ABORT:\n       return JobState.FAILED;\n     case REBOOT:\n-      return JobState.ERROR;\n+      if (appContext.isLastAMRetry()) {\n+        return JobState.ERROR;\n+      } else {\n+        // In case of not last retry, return the external state as RUNNING since\n+        // otherwise JobClient will exit when it polls the AM for job state\n+        return JobState.RUNNING;\n+      }\n     default:\n       return JobState.valueOf(smState.name());\n     }\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private JobState getExternalState(JobStateInternal smState) {\n    switch (smState) {\n    case KILL_WAIT:\n    case KILL_ABORT:\n      return JobState.KILLED;\n    case SETUP:\n    case COMMITTING:\n      return JobState.RUNNING;\n    case FAIL_WAIT:\n    case FAIL_ABORT:\n      return JobState.FAILED;\n    case REBOOT:\n      if (appContext.isLastAMRetry()) {\n        return JobState.ERROR;\n      } else {\n        // In case of not last retry, return the external state as RUNNING since\n        // otherwise JobClient will exit when it polls the AM for job state\n        return JobState.RUNNING;\n      }\n    default:\n      return JobState.valueOf(smState.name());\n    }\n  }",
          "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/job/impl/JobImpl.java",
          "extendedDetails": {
            "oldValue": "[private, static]",
            "newValue": "[private]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "MAPREDUCE-5441. Changed MR AM to return RUNNING state if exiting when RM commands to reboot, so that client can continue to track the overall job. Contributed by xJian He.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1518821 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "29/08/13 2:07 PM",
          "commitName": "5d4b684c02ef8b702c68345d7306be2d19195161",
          "commitAuthor": "Vinod Kumar Vavilapalli",
          "commitDateOld": "23/07/13 9:52 AM",
          "commitNameOld": "0939c49368f1bc9dc08cec9913b21ddea30d4e45",
          "commitAuthorOld": "Jason Darrell Lowe",
          "daysBetweenCommits": 37.18,
          "commitsBetweenForRepo": 232,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,17 +1,23 @@\n-  private static JobState getExternalState(JobStateInternal smState) {\n+  private JobState getExternalState(JobStateInternal smState) {\n     switch (smState) {\n     case KILL_WAIT:\n     case KILL_ABORT:\n       return JobState.KILLED;\n     case SETUP:\n     case COMMITTING:\n       return JobState.RUNNING;\n     case FAIL_WAIT:\n     case FAIL_ABORT:\n       return JobState.FAILED;\n     case REBOOT:\n-      return JobState.ERROR;\n+      if (appContext.isLastAMRetry()) {\n+        return JobState.ERROR;\n+      } else {\n+        // In case of not last retry, return the external state as RUNNING since\n+        // otherwise JobClient will exit when it polls the AM for job state\n+        return JobState.RUNNING;\n+      }\n     default:\n       return JobState.valueOf(smState.name());\n     }\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private JobState getExternalState(JobStateInternal smState) {\n    switch (smState) {\n    case KILL_WAIT:\n    case KILL_ABORT:\n      return JobState.KILLED;\n    case SETUP:\n    case COMMITTING:\n      return JobState.RUNNING;\n    case FAIL_WAIT:\n    case FAIL_ABORT:\n      return JobState.FAILED;\n    case REBOOT:\n      if (appContext.isLastAMRetry()) {\n        return JobState.ERROR;\n      } else {\n        // In case of not last retry, return the external state as RUNNING since\n        // otherwise JobClient will exit when it polls the AM for job state\n        return JobState.RUNNING;\n      }\n    default:\n      return JobState.valueOf(smState.name());\n    }\n  }",
          "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/job/impl/JobImpl.java",
          "extendedDetails": {}
        }
      ]
    },
    "0939c49368f1bc9dc08cec9913b21ddea30d4e45": {
      "type": "Ybodychange",
      "commitMessage": "MAPREDUCE-5317. Stale files left behind for failed jobs. Contributed by Ravi Prakash\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1506154 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "23/07/13 9:52 AM",
      "commitName": "0939c49368f1bc9dc08cec9913b21ddea30d4e45",
      "commitAuthor": "Jason Darrell Lowe",
      "commitDateOld": "16/07/13 8:05 AM",
      "commitNameOld": "44ea6e3ad5656d6edbaa8f3a510ab800e42694e3",
      "commitAuthorOld": "Jason Darrell Lowe",
      "daysBetweenCommits": 7.07,
      "commitsBetweenForRepo": 50,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,16 +1,17 @@\n   private static JobState getExternalState(JobStateInternal smState) {\n     switch (smState) {\n     case KILL_WAIT:\n     case KILL_ABORT:\n       return JobState.KILLED;\n     case SETUP:\n     case COMMITTING:\n       return JobState.RUNNING;\n+    case FAIL_WAIT:\n     case FAIL_ABORT:\n       return JobState.FAILED;\n     case REBOOT:\n       return JobState.ERROR;\n     default:\n       return JobState.valueOf(smState.name());\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private static JobState getExternalState(JobStateInternal smState) {\n    switch (smState) {\n    case KILL_WAIT:\n    case KILL_ABORT:\n      return JobState.KILLED;\n    case SETUP:\n    case COMMITTING:\n      return JobState.RUNNING;\n    case FAIL_WAIT:\n    case FAIL_ABORT:\n      return JobState.FAILED;\n    case REBOOT:\n      return JobState.ERROR;\n    default:\n      return JobState.valueOf(smState.name());\n    }\n  }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/job/impl/JobImpl.java",
      "extendedDetails": {}
    },
    "44ea6e3ad5656d6edbaa8f3a510ab800e42694e3": {
      "type": "Ybodychange",
      "commitMessage": "Back out revision 1503499 for MAPREDUCE-5317. Stale files left behind for failed jobs\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1503744 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "16/07/13 8:05 AM",
      "commitName": "44ea6e3ad5656d6edbaa8f3a510ab800e42694e3",
      "commitAuthor": "Jason Darrell Lowe",
      "commitDateOld": "15/07/13 3:24 PM",
      "commitNameOld": "8a037edbfbbf1db74303c6d37c73153bc1922292",
      "commitAuthorOld": "Jason Darrell Lowe",
      "daysBetweenCommits": 0.69,
      "commitsBetweenForRepo": 6,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,17 +1,16 @@\n   private static JobState getExternalState(JobStateInternal smState) {\n     switch (smState) {\n     case KILL_WAIT:\n     case KILL_ABORT:\n       return JobState.KILLED;\n     case SETUP:\n     case COMMITTING:\n       return JobState.RUNNING;\n-    case FAIL_WAIT:\n     case FAIL_ABORT:\n       return JobState.FAILED;\n     case REBOOT:\n       return JobState.ERROR;\n     default:\n       return JobState.valueOf(smState.name());\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private static JobState getExternalState(JobStateInternal smState) {\n    switch (smState) {\n    case KILL_WAIT:\n    case KILL_ABORT:\n      return JobState.KILLED;\n    case SETUP:\n    case COMMITTING:\n      return JobState.RUNNING;\n    case FAIL_ABORT:\n      return JobState.FAILED;\n    case REBOOT:\n      return JobState.ERROR;\n    default:\n      return JobState.valueOf(smState.name());\n    }\n  }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/job/impl/JobImpl.java",
      "extendedDetails": {}
    },
    "8a037edbfbbf1db74303c6d37c73153bc1922292": {
      "type": "Ybodychange",
      "commitMessage": "MAPREDUCE-5317. Stale files left behind for failed jobs. Contributed by Ravi Prakash\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1503499 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "15/07/13 3:24 PM",
      "commitName": "8a037edbfbbf1db74303c6d37c73153bc1922292",
      "commitAuthor": "Jason Darrell Lowe",
      "commitDateOld": "03/07/13 7:41 AM",
      "commitNameOld": "cf4d0cf189d18b29a5dbac00663e5edd8c408cae",
      "commitAuthorOld": "Jason Darrell Lowe",
      "daysBetweenCommits": 12.32,
      "commitsBetweenForRepo": 51,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,16 +1,17 @@\n   private static JobState getExternalState(JobStateInternal smState) {\n     switch (smState) {\n     case KILL_WAIT:\n     case KILL_ABORT:\n       return JobState.KILLED;\n     case SETUP:\n     case COMMITTING:\n       return JobState.RUNNING;\n+    case FAIL_WAIT:\n     case FAIL_ABORT:\n       return JobState.FAILED;\n     case REBOOT:\n       return JobState.ERROR;\n     default:\n       return JobState.valueOf(smState.name());\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private static JobState getExternalState(JobStateInternal smState) {\n    switch (smState) {\n    case KILL_WAIT:\n    case KILL_ABORT:\n      return JobState.KILLED;\n    case SETUP:\n    case COMMITTING:\n      return JobState.RUNNING;\n    case FAIL_WAIT:\n    case FAIL_ABORT:\n      return JobState.FAILED;\n    case REBOOT:\n      return JobState.ERROR;\n    default:\n      return JobState.valueOf(smState.name());\n    }\n  }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/job/impl/JobImpl.java",
      "extendedDetails": {}
    },
    "fc75d3f3dc2733d6c783eb4d4f1c5c6ae680f08e": {
      "type": "Ybodychange",
      "commitMessage": "MAPREDUCE-5086. MR app master deletes staging dir when sent a reboot command from the RM. Contributed by Jian He\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1464255 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "03/04/13 6:56 PM",
      "commitName": "fc75d3f3dc2733d6c783eb4d4f1c5c6ae680f08e",
      "commitAuthor": "Jason Darrell Lowe",
      "commitDateOld": "15/03/13 2:09 PM",
      "commitNameOld": "7d7553c4eb7d9a282410a3213d26a89fea9b7865",
      "commitAuthorOld": "Robert Joseph Evans",
      "daysBetweenCommits": 19.2,
      "commitsBetweenForRepo": 100,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,14 +1,16 @@\n   private static JobState getExternalState(JobStateInternal smState) {\n     switch (smState) {\n     case KILL_WAIT:\n     case KILL_ABORT:\n       return JobState.KILLED;\n     case SETUP:\n     case COMMITTING:\n       return JobState.RUNNING;\n     case FAIL_ABORT:\n       return JobState.FAILED;\n+    case REBOOT:\n+      return JobState.ERROR;\n     default:\n       return JobState.valueOf(smState.name());\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private static JobState getExternalState(JobStateInternal smState) {\n    switch (smState) {\n    case KILL_WAIT:\n    case KILL_ABORT:\n      return JobState.KILLED;\n    case SETUP:\n    case COMMITTING:\n      return JobState.RUNNING;\n    case FAIL_ABORT:\n      return JobState.FAILED;\n    case REBOOT:\n      return JobState.ERROR;\n    default:\n      return JobState.valueOf(smState.name());\n    }\n  }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/job/impl/JobImpl.java",
      "extendedDetails": {}
    },
    "402eb1851341fce72c8e46266a2578bb67b5b684": {
      "type": "Ybodychange",
      "commitMessage": "MAPREDUCE-4813. AM timing out during job commit (jlowe via bobby)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1426536 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "28/12/12 7:01 AM",
      "commitName": "402eb1851341fce72c8e46266a2578bb67b5b684",
      "commitAuthor": "Robert Joseph Evans",
      "commitDateOld": "28/11/12 9:52 AM",
      "commitNameOld": "b43deb9af85575ee71e29b385737436139ec5b13",
      "commitAuthorOld": "Robert Joseph Evans",
      "daysBetweenCommits": 29.88,
      "commitsBetweenForRepo": 109,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,7 +1,14 @@\n   private static JobState getExternalState(JobStateInternal smState) {\n-    if (smState \u003d\u003d JobStateInternal.KILL_WAIT) {\n+    switch (smState) {\n+    case KILL_WAIT:\n+    case KILL_ABORT:\n       return JobState.KILLED;\n-    } else {\n+    case SETUP:\n+    case COMMITTING:\n+      return JobState.RUNNING;\n+    case FAIL_ABORT:\n+      return JobState.FAILED;\n+    default:\n       return JobState.valueOf(smState.name());\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private static JobState getExternalState(JobStateInternal smState) {\n    switch (smState) {\n    case KILL_WAIT:\n    case KILL_ABORT:\n      return JobState.KILLED;\n    case SETUP:\n    case COMMITTING:\n      return JobState.RUNNING;\n    case FAIL_ABORT:\n      return JobState.FAILED;\n    default:\n      return JobState.valueOf(smState.name());\n    }\n  }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/job/impl/JobImpl.java",
      "extendedDetails": {}
    },
    "022f7b4a25c73b8c43985e8d1bac717b96373ac6": {
      "type": "Yintroduced",
      "commitMessage": "MAPREDUCE-4596. Split StateMachine state from states seen by MRClientProtocol for Job, Task and TaskAttempt. Contributed by Siddarth Seth.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1399976 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "18/10/12 10:57 PM",
      "commitName": "022f7b4a25c73b8c43985e8d1bac717b96373ac6",
      "commitAuthor": "Vinod Kumar Vavilapalli",
      "diff": "@@ -0,0 +1,7 @@\n+  private static JobState getExternalState(JobStateInternal smState) {\n+    if (smState \u003d\u003d JobStateInternal.KILL_WAIT) {\n+      return JobState.KILLED;\n+    } else {\n+      return JobState.valueOf(smState.name());\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private static JobState getExternalState(JobStateInternal smState) {\n    if (smState \u003d\u003d JobStateInternal.KILL_WAIT) {\n      return JobState.KILLED;\n    } else {\n      return JobState.valueOf(smState.name());\n    }\n  }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/job/impl/JobImpl.java"
    }
  }
}