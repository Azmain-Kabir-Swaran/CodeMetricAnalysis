{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "DomainSocketWatcher.java",
  "functionName": "handle",
  "functionId": "handle___sock-DomainSocket",
  "sourceFilePath": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/unix/DomainSocketWatcher.java",
  "functionStartLine": 103,
  "functionEndLine": 130,
  "numCommitsSeen": 15,
  "timeTaken": 1272,
  "changeHistory": [
    "86e3993def01223f92b8d1dd35f6c1f8ab6033f5",
    "687d83c9e10a4432c8d54c2cd406c7ccb4392187",
    "8099de259fb91a29674bf17cb1382c038b707a90",
    "140246bad816ae7bf06eda193cc624e1e62923e0"
  ],
  "changeHistoryShort": {
    "86e3993def01223f92b8d1dd35f6c1f8ab6033f5": "Ybodychange",
    "687d83c9e10a4432c8d54c2cd406c7ccb4392187": "Ybodychange",
    "8099de259fb91a29674bf17cb1382c038b707a90": "Ybodychange",
    "140246bad816ae7bf06eda193cc624e1e62923e0": "Yintroduced"
  },
  "changeHistoryDetails": {
    "86e3993def01223f92b8d1dd35f6c1f8ab6033f5": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-11333. Fix deadlock in DomainSocketWatcher when the notification pipe is full (zhaoyunjiong via cmccabe)\n",
      "commitDate": "01/12/14 11:42 AM",
      "commitName": "86e3993def01223f92b8d1dd35f6c1f8ab6033f5",
      "commitAuthor": "Colin Patrick Mccabe",
      "commitDateOld": "06/10/14 2:44 PM",
      "commitNameOld": "687d83c9e10a4432c8d54c2cd406c7ccb4392187",
      "commitAuthorOld": "Colin Patrick Mccabe",
      "daysBetweenCommits": 55.92,
      "commitsBetweenForRepo": 459,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,27 +1,28 @@\n     public boolean handle(DomainSocket sock) {\n       assert(lock.isHeldByCurrentThread());\n       try {\n+        kicked \u003d false;\n         if (LOG.isTraceEnabled()) {\n           LOG.trace(this + \": NotificationHandler: doing a read on \" +\n             sock.fd);\n         }\n         if (sock.getInputStream().read() \u003d\u003d -1) {\n           if (LOG.isTraceEnabled()) {\n             LOG.trace(this + \": NotificationHandler: got EOF on \" + sock.fd);\n           }\n           throw new EOFException();\n         }\n         if (LOG.isTraceEnabled()) {\n           LOG.trace(this + \": NotificationHandler: read succeeded on \" +\n             sock.fd);\n         }\n         return false;\n       } catch (IOException e) {\n         if (LOG.isTraceEnabled()) {\n           LOG.trace(this + \": NotificationHandler: setting closed to \" +\n               \"true for \" + sock.fd);\n         }\n         closed \u003d true;\n         return true;\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public boolean handle(DomainSocket sock) {\n      assert(lock.isHeldByCurrentThread());\n      try {\n        kicked \u003d false;\n        if (LOG.isTraceEnabled()) {\n          LOG.trace(this + \": NotificationHandler: doing a read on \" +\n            sock.fd);\n        }\n        if (sock.getInputStream().read() \u003d\u003d -1) {\n          if (LOG.isTraceEnabled()) {\n            LOG.trace(this + \": NotificationHandler: got EOF on \" + sock.fd);\n          }\n          throw new EOFException();\n        }\n        if (LOG.isTraceEnabled()) {\n          LOG.trace(this + \": NotificationHandler: read succeeded on \" +\n            sock.fd);\n        }\n        return false;\n      } catch (IOException e) {\n        if (LOG.isTraceEnabled()) {\n          LOG.trace(this + \": NotificationHandler: setting closed to \" +\n              \"true for \" + sock.fd);\n        }\n        closed \u003d true;\n        return true;\n      }\n    }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/unix/DomainSocketWatcher.java",
      "extendedDetails": {}
    },
    "687d83c9e10a4432c8d54c2cd406c7ccb4392187": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-10404.  Commit correct version of patch (cmccabe)\n",
      "commitDate": "06/10/14 2:44 PM",
      "commitName": "687d83c9e10a4432c8d54c2cd406c7ccb4392187",
      "commitAuthor": "Colin Patrick Mccabe",
      "commitDateOld": "06/10/14 2:40 PM",
      "commitNameOld": "8099de259fb91a29674bf17cb1382c038b707a90",
      "commitAuthorOld": "Colin Patrick Mccabe",
      "daysBetweenCommits": 0.0,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,29 +1,27 @@\n     public boolean handle(DomainSocket sock) {\n-      lock.lock();\n+      assert(lock.isHeldByCurrentThread());\n       try {\n         if (LOG.isTraceEnabled()) {\n           LOG.trace(this + \": NotificationHandler: doing a read on \" +\n             sock.fd);\n         }\n         if (sock.getInputStream().read() \u003d\u003d -1) {\n           if (LOG.isTraceEnabled()) {\n             LOG.trace(this + \": NotificationHandler: got EOF on \" + sock.fd);\n           }\n           throw new EOFException();\n         }\n         if (LOG.isTraceEnabled()) {\n           LOG.trace(this + \": NotificationHandler: read succeeded on \" +\n             sock.fd);\n         }\n         return false;\n       } catch (IOException e) {\n         if (LOG.isTraceEnabled()) {\n           LOG.trace(this + \": NotificationHandler: setting closed to \" +\n               \"true for \" + sock.fd);\n         }\n         closed \u003d true;\n         return true;\n-      } finally {\n-        lock.unlock();\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public boolean handle(DomainSocket sock) {\n      assert(lock.isHeldByCurrentThread());\n      try {\n        if (LOG.isTraceEnabled()) {\n          LOG.trace(this + \": NotificationHandler: doing a read on \" +\n            sock.fd);\n        }\n        if (sock.getInputStream().read() \u003d\u003d -1) {\n          if (LOG.isTraceEnabled()) {\n            LOG.trace(this + \": NotificationHandler: got EOF on \" + sock.fd);\n          }\n          throw new EOFException();\n        }\n        if (LOG.isTraceEnabled()) {\n          LOG.trace(this + \": NotificationHandler: read succeeded on \" +\n            sock.fd);\n        }\n        return false;\n      } catch (IOException e) {\n        if (LOG.isTraceEnabled()) {\n          LOG.trace(this + \": NotificationHandler: setting closed to \" +\n              \"true for \" + sock.fd);\n        }\n        closed \u003d true;\n        return true;\n      }\n    }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/unix/DomainSocketWatcher.java",
      "extendedDetails": {}
    },
    "8099de259fb91a29674bf17cb1382c038b707a90": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-10404. Some accesses to DomainSocketWatcher#closed are not protected by the lock (cmccabe)\n",
      "commitDate": "06/10/14 2:40 PM",
      "commitName": "8099de259fb91a29674bf17cb1382c038b707a90",
      "commitAuthor": "Colin Patrick Mccabe",
      "commitDateOld": "05/03/14 11:57 PM",
      "commitNameOld": "95e0f616b96371824e653e761f3188c06615fe35",
      "commitAuthorOld": "Colin McCabe",
      "daysBetweenCommits": 214.57,
      "commitsBetweenForRepo": 1712,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,26 +1,29 @@\n     public boolean handle(DomainSocket sock) {\n+      lock.lock();\n       try {\n         if (LOG.isTraceEnabled()) {\n           LOG.trace(this + \": NotificationHandler: doing a read on \" +\n             sock.fd);\n         }\n         if (sock.getInputStream().read() \u003d\u003d -1) {\n           if (LOG.isTraceEnabled()) {\n             LOG.trace(this + \": NotificationHandler: got EOF on \" + sock.fd);\n           }\n           throw new EOFException();\n         }\n         if (LOG.isTraceEnabled()) {\n           LOG.trace(this + \": NotificationHandler: read succeeded on \" +\n             sock.fd);\n         }\n         return false;\n       } catch (IOException e) {\n         if (LOG.isTraceEnabled()) {\n           LOG.trace(this + \": NotificationHandler: setting closed to \" +\n               \"true for \" + sock.fd);\n         }\n         closed \u003d true;\n         return true;\n+      } finally {\n+        lock.unlock();\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public boolean handle(DomainSocket sock) {\n      lock.lock();\n      try {\n        if (LOG.isTraceEnabled()) {\n          LOG.trace(this + \": NotificationHandler: doing a read on \" +\n            sock.fd);\n        }\n        if (sock.getInputStream().read() \u003d\u003d -1) {\n          if (LOG.isTraceEnabled()) {\n            LOG.trace(this + \": NotificationHandler: got EOF on \" + sock.fd);\n          }\n          throw new EOFException();\n        }\n        if (LOG.isTraceEnabled()) {\n          LOG.trace(this + \": NotificationHandler: read succeeded on \" +\n            sock.fd);\n        }\n        return false;\n      } catch (IOException e) {\n        if (LOG.isTraceEnabled()) {\n          LOG.trace(this + \": NotificationHandler: setting closed to \" +\n              \"true for \" + sock.fd);\n        }\n        closed \u003d true;\n        return true;\n      } finally {\n        lock.unlock();\n      }\n    }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/unix/DomainSocketWatcher.java",
      "extendedDetails": {}
    },
    "140246bad816ae7bf06eda193cc624e1e62923e0": {
      "type": "Yintroduced",
      "commitMessage": "HDFS-5746.  Add ShortCircuitSharedMemorySegment (cmccabe)\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1563362 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "31/01/14 6:25 PM",
      "commitName": "140246bad816ae7bf06eda193cc624e1e62923e0",
      "commitAuthor": "Colin McCabe",
      "diff": "@@ -0,0 +1,26 @@\n+    public boolean handle(DomainSocket sock) {\n+      try {\n+        if (LOG.isTraceEnabled()) {\n+          LOG.trace(this + \": NotificationHandler: doing a read on \" +\n+            sock.fd);\n+        }\n+        if (sock.getInputStream().read() \u003d\u003d -1) {\n+          if (LOG.isTraceEnabled()) {\n+            LOG.trace(this + \": NotificationHandler: got EOF on \" + sock.fd);\n+          }\n+          throw new EOFException();\n+        }\n+        if (LOG.isTraceEnabled()) {\n+          LOG.trace(this + \": NotificationHandler: read succeeded on \" +\n+            sock.fd);\n+        }\n+        return false;\n+      } catch (IOException e) {\n+        if (LOG.isTraceEnabled()) {\n+          LOG.trace(this + \": NotificationHandler: setting closed to \" +\n+              \"true for \" + sock.fd);\n+        }\n+        closed \u003d true;\n+        return true;\n+      }\n+    }\n\\ No newline at end of file\n",
      "actualSource": "    public boolean handle(DomainSocket sock) {\n      try {\n        if (LOG.isTraceEnabled()) {\n          LOG.trace(this + \": NotificationHandler: doing a read on \" +\n            sock.fd);\n        }\n        if (sock.getInputStream().read() \u003d\u003d -1) {\n          if (LOG.isTraceEnabled()) {\n            LOG.trace(this + \": NotificationHandler: got EOF on \" + sock.fd);\n          }\n          throw new EOFException();\n        }\n        if (LOG.isTraceEnabled()) {\n          LOG.trace(this + \": NotificationHandler: read succeeded on \" +\n            sock.fd);\n        }\n        return false;\n      } catch (IOException e) {\n        if (LOG.isTraceEnabled()) {\n          LOG.trace(this + \": NotificationHandler: setting closed to \" +\n              \"true for \" + sock.fd);\n        }\n        closed \u003d true;\n        return true;\n      }\n    }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/net/unix/DomainSocketWatcher.java"
    }
  }
}