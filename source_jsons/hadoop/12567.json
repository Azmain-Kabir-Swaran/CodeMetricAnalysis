{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "Balancer.java",
  "functionName": "run",
  "functionId": "run___args-String[]",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
  "functionStartLine": 857,
  "functionEndLine": 879,
  "numCommitsSeen": 100,
  "timeTaken": 8080,
  "changeHistory": [
    "a3f44dacc1fa19acc4eefd1e2505e54f8629e603",
    "15ed080e3610b7526eff12391de780948a75fa7b",
    "75ead273bea8a7dad61c4f99c3a16cab2697c498",
    "e60673697d5046c29c52bbabdfe80506f99773e4",
    "83b9933db3349e6a6faf23bce35c9d4ce3f7bcf2",
    "f40a36758bb183b23181fd59a99d9ab87a428166",
    "4a5ba3b7bd2360fd9605863630b477d362874e1e",
    "0d7de507a5d6e9292aeabe357fab6976f81f5be4",
    "9318ff425019b9f88e154a80f3aeb23e6c69cb69",
    "01b17c40cf20df576fb18315c2019645d5050ddf",
    "9146ad23f3f1af7c5547fba08e2a867cee49e015",
    "cd7157784e5e5ddc4e77144d042e54dd0d04bac1",
    "d86f3183d93714ba078416af4f609d26376eadb0",
    "a196766ea07775f18ded69bd9e8d239f8cfd3ccc"
  ],
  "changeHistoryShort": {
    "a3f44dacc1fa19acc4eefd1e2505e54f8629e603": "Ybodychange",
    "15ed080e3610b7526eff12391de780948a75fa7b": "Ybodychange",
    "75ead273bea8a7dad61c4f99c3a16cab2697c498": "Ybodychange",
    "e60673697d5046c29c52bbabdfe80506f99773e4": "Ybodychange",
    "83b9933db3349e6a6faf23bce35c9d4ce3f7bcf2": "Ybodychange",
    "f40a36758bb183b23181fd59a99d9ab87a428166": "Ybodychange",
    "4a5ba3b7bd2360fd9605863630b477d362874e1e": "Ybodychange",
    "0d7de507a5d6e9292aeabe357fab6976f81f5be4": "Ybodychange",
    "9318ff425019b9f88e154a80f3aeb23e6c69cb69": "Ybodychange",
    "01b17c40cf20df576fb18315c2019645d5050ddf": "Ybodychange",
    "9146ad23f3f1af7c5547fba08e2a867cee49e015": "Ybodychange",
    "cd7157784e5e5ddc4e77144d042e54dd0d04bac1": "Yfilerename",
    "d86f3183d93714ba078416af4f609d26376eadb0": "Yfilerename",
    "a196766ea07775f18ded69bd9e8d239f8cfd3ccc": "Yintroduced"
  },
  "changeHistoryDetails": {
    "a3f44dacc1fa19acc4eefd1e2505e54f8629e603": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-13183. Standby NameNode process getBlocks request to reduce Active load. Contributed by Xiaoqiao He.\n\nSigned-off-by: Wei-Chiu Chuang \u003cweichiu@apache.org\u003e\n",
      "commitDate": "18/05/20 7:09 AM",
      "commitName": "a3f44dacc1fa19acc4eefd1e2505e54f8629e603",
      "commitAuthor": "He Xiaoqiao",
      "commitDateOld": "06/11/19 8:15 AM",
      "commitNameOld": "dcf55838ae41aecfa8a7b37d9b95478ce6acf0a7",
      "commitAuthorOld": "Ayush Saxena",
      "daysBetweenCommits": 193.91,
      "commitsBetweenForRepo": 665,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,22 +1,23 @@\n     public int run(String[] args) {\n       final long startTime \u003d Time.monotonicNow();\n       final Configuration conf \u003d getConf();\n \n       try {\n         checkReplicationPolicyCompatibility(conf);\n \n         final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getInternalNsRpcUris(conf);\n-        return Balancer.run(namenodes, parse(args), conf);\n+        final Collection\u003cString\u003e nsIds \u003d DFSUtilClient.getNameServiceIds(conf);\n+        return Balancer.run(namenodes, nsIds, parse(args), conf);\n       } catch (IOException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ExitStatus.IO_EXCEPTION.getExitCode();\n       } catch (InterruptedException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ExitStatus.INTERRUPTED.getExitCode();\n       } finally {\n         System.out.format(\"%-24s \",\n             DateFormat.getDateTimeInstance().format(new Date()));\n         System.out.println(\"Balancing took \"\n             + time2Str(Time.monotonicNow() - startTime));\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public int run(String[] args) {\n      final long startTime \u003d Time.monotonicNow();\n      final Configuration conf \u003d getConf();\n\n      try {\n        checkReplicationPolicyCompatibility(conf);\n\n        final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getInternalNsRpcUris(conf);\n        final Collection\u003cString\u003e nsIds \u003d DFSUtilClient.getNameServiceIds(conf);\n        return Balancer.run(namenodes, nsIds, parse(args), conf);\n      } catch (IOException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ExitStatus.IO_EXCEPTION.getExitCode();\n      } catch (InterruptedException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ExitStatus.INTERRUPTED.getExitCode();\n      } finally {\n        System.out.format(\"%-24s \",\n            DateFormat.getDateTimeInstance().format(new Date()));\n        System.out.println(\"Balancing took \"\n            + time2Str(Time.monotonicNow() - startTime));\n      }\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
      "extendedDetails": {}
    },
    "15ed080e3610b7526eff12391de780948a75fa7b": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-9365. Balaner does not work with the HDFS-6376 HA setup.\n",
      "commitDate": "24/05/16 12:49 PM",
      "commitName": "15ed080e3610b7526eff12391de780948a75fa7b",
      "commitAuthor": "Tsz-Wo Nicholas Sze",
      "commitDateOld": "21/04/16 3:41 PM",
      "commitNameOld": "14ab7a81e2519935ff28ad40519649599e204732",
      "commitAuthorOld": "Tsz-Wo Nicholas Sze",
      "daysBetweenCommits": 32.88,
      "commitsBetweenForRepo": 210,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,22 +1,22 @@\n     public int run(String[] args) {\n       final long startTime \u003d Time.monotonicNow();\n       final Configuration conf \u003d getConf();\n \n       try {\n         checkReplicationPolicyCompatibility(conf);\n \n-        final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n+        final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getInternalNsRpcUris(conf);\n         return Balancer.run(namenodes, parse(args), conf);\n       } catch (IOException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ExitStatus.IO_EXCEPTION.getExitCode();\n       } catch (InterruptedException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ExitStatus.INTERRUPTED.getExitCode();\n       } finally {\n         System.out.format(\"%-24s \",\n             DateFormat.getDateTimeInstance().format(new Date()));\n         System.out.println(\"Balancing took \"\n             + time2Str(Time.monotonicNow() - startTime));\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public int run(String[] args) {\n      final long startTime \u003d Time.monotonicNow();\n      final Configuration conf \u003d getConf();\n\n      try {\n        checkReplicationPolicyCompatibility(conf);\n\n        final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getInternalNsRpcUris(conf);\n        return Balancer.run(namenodes, parse(args), conf);\n      } catch (IOException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ExitStatus.IO_EXCEPTION.getExitCode();\n      } catch (InterruptedException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ExitStatus.INTERRUPTED.getExitCode();\n      } finally {\n        System.out.format(\"%-24s \",\n            DateFormat.getDateTimeInstance().format(new Date()));\n        System.out.println(\"Balancing took \"\n            + time2Str(Time.monotonicNow() - startTime));\n      }\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
      "extendedDetails": {}
    },
    "75ead273bea8a7dad61c4f99c3a16cab2697c498": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-6841. Use Time.monotonicNow() wherever applicable instead of Time.now(). Contributed by Vinayakumar B\n",
      "commitDate": "20/03/15 12:02 PM",
      "commitName": "75ead273bea8a7dad61c4f99c3a16cab2697c498",
      "commitAuthor": "Kihwal Lee",
      "commitDateOld": "21/02/15 3:38 PM",
      "commitNameOld": "8b465b4b8caed31ca9daeaae108f9a868a30a455",
      "commitAuthorOld": "Arpit Agarwal",
      "daysBetweenCommits": 26.81,
      "commitsBetweenForRepo": 229,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,20 +1,22 @@\n     public int run(String[] args) {\n-      final long startTime \u003d Time.now();\n+      final long startTime \u003d Time.monotonicNow();\n       final Configuration conf \u003d getConf();\n \n       try {\n         checkReplicationPolicyCompatibility(conf);\n \n         final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n         return Balancer.run(namenodes, parse(args), conf);\n       } catch (IOException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ExitStatus.IO_EXCEPTION.getExitCode();\n       } catch (InterruptedException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ExitStatus.INTERRUPTED.getExitCode();\n       } finally {\n-        System.out.format(\"%-24s \", DateFormat.getDateTimeInstance().format(new Date()));\n-        System.out.println(\"Balancing took \" + time2Str(Time.now()-startTime));\n+        System.out.format(\"%-24s \",\n+            DateFormat.getDateTimeInstance().format(new Date()));\n+        System.out.println(\"Balancing took \"\n+            + time2Str(Time.monotonicNow() - startTime));\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public int run(String[] args) {\n      final long startTime \u003d Time.monotonicNow();\n      final Configuration conf \u003d getConf();\n\n      try {\n        checkReplicationPolicyCompatibility(conf);\n\n        final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n        return Balancer.run(namenodes, parse(args), conf);\n      } catch (IOException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ExitStatus.IO_EXCEPTION.getExitCode();\n      } catch (InterruptedException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ExitStatus.INTERRUPTED.getExitCode();\n      } finally {\n        System.out.format(\"%-24s \",\n            DateFormat.getDateTimeInstance().format(new Date()));\n        System.out.println(\"Balancing took \"\n            + time2Str(Time.monotonicNow() - startTime));\n      }\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
      "extendedDetails": {}
    },
    "e60673697d5046c29c52bbabdfe80506f99773e4": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-6837. Code cleanup for Balancer and Dispatcher. Contributed by Tsz Wo Nicholas Sze.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1617337 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "11/08/14 11:01 AM",
      "commitName": "e60673697d5046c29c52bbabdfe80506f99773e4",
      "commitAuthor": "Jing Zhao",
      "commitDateOld": "08/08/14 2:33 PM",
      "commitNameOld": "c3cf331dc91e2beef2afeed11105084843b02858",
      "commitAuthorOld": "Jing Zhao",
      "daysBetweenCommits": 2.85,
      "commitsBetweenForRepo": 12,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,20 +1,20 @@\n     public int run(String[] args) {\n       final long startTime \u003d Time.now();\n       final Configuration conf \u003d getConf();\n \n       try {\n         checkReplicationPolicyCompatibility(conf);\n \n         final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n         return Balancer.run(namenodes, parse(args), conf);\n       } catch (IOException e) {\n         System.out.println(e + \".  Exiting ...\");\n-        return ReturnStatus.IO_EXCEPTION.code;\n+        return ExitStatus.IO_EXCEPTION.getExitCode();\n       } catch (InterruptedException e) {\n         System.out.println(e + \".  Exiting ...\");\n-        return ReturnStatus.INTERRUPTED.code;\n+        return ExitStatus.INTERRUPTED.getExitCode();\n       } finally {\n         System.out.format(\"%-24s \", DateFormat.getDateTimeInstance().format(new Date()));\n         System.out.println(\"Balancing took \" + time2Str(Time.now()-startTime));\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public int run(String[] args) {\n      final long startTime \u003d Time.now();\n      final Configuration conf \u003d getConf();\n\n      try {\n        checkReplicationPolicyCompatibility(conf);\n\n        final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n        return Balancer.run(namenodes, parse(args), conf);\n      } catch (IOException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ExitStatus.IO_EXCEPTION.getExitCode();\n      } catch (InterruptedException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ExitStatus.INTERRUPTED.getExitCode();\n      } finally {\n        System.out.format(\"%-24s \", DateFormat.getDateTimeInstance().format(new Date()));\n        System.out.println(\"Balancing took \" + time2Str(Time.now()-startTime));\n      }\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
      "extendedDetails": {}
    },
    "83b9933db3349e6a6faf23bce35c9d4ce3f7bcf2": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-6809. Move Balancer\u0027s inner classes MovedBlocks and Matcher as to standalone classes and separates KeyManager from NameNodeConnector.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1616422 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "07/08/14 12:18 AM",
      "commitName": "83b9933db3349e6a6faf23bce35c9d4ce3f7bcf2",
      "commitAuthor": "Tsz-wo Sze",
      "commitDateOld": "01/08/14 7:12 AM",
      "commitNameOld": "7e12b1912f8cdbe6d88ac0b8eb71d7c4dc1bf78e",
      "commitAuthorOld": "Tsz-wo Sze",
      "daysBetweenCommits": 5.71,
      "commitsBetweenForRepo": 41,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,23 +1,20 @@\n     public int run(String[] args) {\n       final long startTime \u003d Time.now();\n       final Configuration conf \u003d getConf();\n-      WIN_WIDTH \u003d conf.getLong(\n-          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n-          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n \n       try {\n         checkReplicationPolicyCompatibility(conf);\n \n         final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n         return Balancer.run(namenodes, parse(args), conf);\n       } catch (IOException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ReturnStatus.IO_EXCEPTION.code;\n       } catch (InterruptedException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ReturnStatus.INTERRUPTED.code;\n       } finally {\n         System.out.format(\"%-24s \", DateFormat.getDateTimeInstance().format(new Date()));\n         System.out.println(\"Balancing took \" + time2Str(Time.now()-startTime));\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public int run(String[] args) {\n      final long startTime \u003d Time.now();\n      final Configuration conf \u003d getConf();\n\n      try {\n        checkReplicationPolicyCompatibility(conf);\n\n        final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n        return Balancer.run(namenodes, parse(args), conf);\n      } catch (IOException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.IO_EXCEPTION.code;\n      } catch (InterruptedException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.INTERRUPTED.code;\n      } finally {\n        System.out.format(\"%-24s \", DateFormat.getDateTimeInstance().format(new Date()));\n        System.out.println(\"Balancing took \" + time2Str(Time.now()-startTime));\n      }\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
      "extendedDetails": {}
    },
    "f40a36758bb183b23181fd59a99d9ab87a428166": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-6447. balancer should timestamp the completion message. Contributed by Juan Yu.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1598411 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "29/05/14 2:38 PM",
      "commitName": "f40a36758bb183b23181fd59a99d9ab87a428166",
      "commitAuthor": "Andrew Wang",
      "commitDateOld": "21/05/14 9:50 PM",
      "commitNameOld": "6b2e615f5fa034d679be0de8fb300b878a2d801a",
      "commitAuthorOld": "Chris Nauroth",
      "daysBetweenCommits": 7.7,
      "commitsBetweenForRepo": 37,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,22 +1,23 @@\n     public int run(String[] args) {\n       final long startTime \u003d Time.now();\n       final Configuration conf \u003d getConf();\n       WIN_WIDTH \u003d conf.getLong(\n           DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n           DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n \n       try {\n         checkReplicationPolicyCompatibility(conf);\n \n         final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n         return Balancer.run(namenodes, parse(args), conf);\n       } catch (IOException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ReturnStatus.IO_EXCEPTION.code;\n       } catch (InterruptedException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ReturnStatus.INTERRUPTED.code;\n       } finally {\n+        System.out.format(\"%-24s \", DateFormat.getDateTimeInstance().format(new Date()));\n         System.out.println(\"Balancing took \" + time2Str(Time.now()-startTime));\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public int run(String[] args) {\n      final long startTime \u003d Time.now();\n      final Configuration conf \u003d getConf();\n      WIN_WIDTH \u003d conf.getLong(\n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n\n      try {\n        checkReplicationPolicyCompatibility(conf);\n\n        final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n        return Balancer.run(namenodes, parse(args), conf);\n      } catch (IOException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.IO_EXCEPTION.code;\n      } catch (InterruptedException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.INTERRUPTED.code;\n      } finally {\n        System.out.format(\"%-24s \", DateFormat.getDateTimeInstance().format(new Date()));\n        System.out.println(\"Balancing took \" + time2Str(Time.now()-startTime));\n      }\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
      "extendedDetails": {}
    },
    "4a5ba3b7bd2360fd9605863630b477d362874e1e": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-3641. Move server Util time methods to common and use now instead of System#currentTimeMillis. Contributed by Eli Collins\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1360858 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "12/07/12 12:01 PM",
      "commitName": "4a5ba3b7bd2360fd9605863630b477d362874e1e",
      "commitAuthor": "Eli Collins",
      "commitDateOld": "08/07/12 11:39 AM",
      "commitNameOld": "07295260b10cd2376660a673ceb9d8ce0570b528",
      "commitAuthorOld": "Uma Maheswara Rao G",
      "daysBetweenCommits": 4.02,
      "commitsBetweenForRepo": 36,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,22 +1,22 @@\n     public int run(String[] args) {\n-      final long startTime \u003d Util.now();\n+      final long startTime \u003d Time.now();\n       final Configuration conf \u003d getConf();\n       WIN_WIDTH \u003d conf.getLong(\n           DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n           DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n \n       try {\n         checkReplicationPolicyCompatibility(conf);\n \n         final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n         return Balancer.run(namenodes, parse(args), conf);\n       } catch (IOException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ReturnStatus.IO_EXCEPTION.code;\n       } catch (InterruptedException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ReturnStatus.INTERRUPTED.code;\n       } finally {\n-        System.out.println(\"Balancing took \" + time2Str(Util.now()-startTime));\n+        System.out.println(\"Balancing took \" + time2Str(Time.now()-startTime));\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public int run(String[] args) {\n      final long startTime \u003d Time.now();\n      final Configuration conf \u003d getConf();\n      WIN_WIDTH \u003d conf.getLong(\n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n\n      try {\n        checkReplicationPolicyCompatibility(conf);\n\n        final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n        return Balancer.run(namenodes, parse(args), conf);\n      } catch (IOException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.IO_EXCEPTION.code;\n      } catch (InterruptedException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.INTERRUPTED.code;\n      } finally {\n        System.out.println(\"Balancing took \" + time2Str(Time.now()-startTime));\n      }\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
      "extendedDetails": {}
    },
    "0d7de507a5d6e9292aeabe357fab6976f81f5be4": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-2979. Balancer should use logical uri for creating failover proxy with HA enabled. Contributed by Aaron T. Myers.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1295473 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "01/03/12 12:50 AM",
      "commitName": "0d7de507a5d6e9292aeabe357fab6976f81f5be4",
      "commitAuthor": "Aaron Myers",
      "commitDateOld": "29/02/12 11:03 PM",
      "commitNameOld": "9318ff425019b9f88e154a80f3aeb23e6c69cb69",
      "commitAuthorOld": "Aaron Myers",
      "daysBetweenCommits": 0.07,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,23 +1,22 @@\n     public int run(String[] args) {\n       final long startTime \u003d Util.now();\n       final Configuration conf \u003d getConf();\n       WIN_WIDTH \u003d conf.getLong(\n           DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n           DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n \n       try {\n         checkReplicationPolicyCompatibility(conf);\n \n-        final Map\u003cString, Map\u003cString, InetSocketAddress\u003e\u003e namenodes \u003d\n-          DFSUtil.getNNServiceRpcAddresses(conf);\n+        final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n         return Balancer.run(namenodes, parse(args), conf);\n       } catch (IOException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ReturnStatus.IO_EXCEPTION.code;\n       } catch (InterruptedException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ReturnStatus.INTERRUPTED.code;\n       } finally {\n         System.out.println(\"Balancing took \" + time2Str(Util.now()-startTime));\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public int run(String[] args) {\n      final long startTime \u003d Util.now();\n      final Configuration conf \u003d getConf();\n      WIN_WIDTH \u003d conf.getLong(\n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n\n      try {\n        checkReplicationPolicyCompatibility(conf);\n\n        final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n        return Balancer.run(namenodes, parse(args), conf);\n      } catch (IOException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.IO_EXCEPTION.code;\n      } catch (InterruptedException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.INTERRUPTED.code;\n      } finally {\n        System.out.println(\"Balancing took \" + time2Str(Util.now()-startTime));\n      }\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
      "extendedDetails": {}
    },
    "9318ff425019b9f88e154a80f3aeb23e6c69cb69": {
      "type": "Ybodychange",
      "commitMessage": "Revert commit of HDFS-2979.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1295435 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "29/02/12 11:03 PM",
      "commitName": "9318ff425019b9f88e154a80f3aeb23e6c69cb69",
      "commitAuthor": "Aaron Myers",
      "commitDateOld": "29/02/12 3:42 PM",
      "commitNameOld": "01b17c40cf20df576fb18315c2019645d5050ddf",
      "commitAuthorOld": "Aaron Myers",
      "daysBetweenCommits": 0.31,
      "commitsBetweenForRepo": 3,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,22 +1,23 @@\n     public int run(String[] args) {\n       final long startTime \u003d Util.now();\n       final Configuration conf \u003d getConf();\n       WIN_WIDTH \u003d conf.getLong(\n           DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n           DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n \n       try {\n         checkReplicationPolicyCompatibility(conf);\n \n-        final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n+        final Map\u003cString, Map\u003cString, InetSocketAddress\u003e\u003e namenodes \u003d\n+          DFSUtil.getNNServiceRpcAddresses(conf);\n         return Balancer.run(namenodes, parse(args), conf);\n       } catch (IOException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ReturnStatus.IO_EXCEPTION.code;\n       } catch (InterruptedException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ReturnStatus.INTERRUPTED.code;\n       } finally {\n         System.out.println(\"Balancing took \" + time2Str(Util.now()-startTime));\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public int run(String[] args) {\n      final long startTime \u003d Util.now();\n      final Configuration conf \u003d getConf();\n      WIN_WIDTH \u003d conf.getLong(\n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n\n      try {\n        checkReplicationPolicyCompatibility(conf);\n\n        final Map\u003cString, Map\u003cString, InetSocketAddress\u003e\u003e namenodes \u003d\n          DFSUtil.getNNServiceRpcAddresses(conf);\n        return Balancer.run(namenodes, parse(args), conf);\n      } catch (IOException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.IO_EXCEPTION.code;\n      } catch (InterruptedException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.INTERRUPTED.code;\n      } finally {\n        System.out.println(\"Balancing took \" + time2Str(Util.now()-startTime));\n      }\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
      "extendedDetails": {}
    },
    "01b17c40cf20df576fb18315c2019645d5050ddf": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-2979. Balancer should use logical uri for creating failover proxy with HA enabled. Contributed by Aaron T. Myers.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1295340 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "29/02/12 3:42 PM",
      "commitName": "01b17c40cf20df576fb18315c2019645d5050ddf",
      "commitAuthor": "Aaron Myers",
      "commitDateOld": "28/11/11 6:27 PM",
      "commitNameOld": "9146ad23f3f1af7c5547fba08e2a867cee49e015",
      "commitAuthorOld": "Todd Lipcon",
      "daysBetweenCommits": 92.89,
      "commitsBetweenForRepo": 661,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,23 +1,22 @@\n     public int run(String[] args) {\n       final long startTime \u003d Util.now();\n       final Configuration conf \u003d getConf();\n       WIN_WIDTH \u003d conf.getLong(\n           DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n           DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n \n       try {\n         checkReplicationPolicyCompatibility(conf);\n \n-        final Map\u003cString, Map\u003cString, InetSocketAddress\u003e\u003e namenodes \u003d\n-          DFSUtil.getNNServiceRpcAddresses(conf);\n+        final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n         return Balancer.run(namenodes, parse(args), conf);\n       } catch (IOException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ReturnStatus.IO_EXCEPTION.code;\n       } catch (InterruptedException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ReturnStatus.INTERRUPTED.code;\n       } finally {\n         System.out.println(\"Balancing took \" + time2Str(Util.now()-startTime));\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public int run(String[] args) {\n      final long startTime \u003d Util.now();\n      final Configuration conf \u003d getConf();\n      WIN_WIDTH \u003d conf.getLong(\n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n\n      try {\n        checkReplicationPolicyCompatibility(conf);\n\n        final Collection\u003cURI\u003e namenodes \u003d DFSUtil.getNsServiceRpcUris(conf);\n        return Balancer.run(namenodes, parse(args), conf);\n      } catch (IOException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.IO_EXCEPTION.code;\n      } catch (InterruptedException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.INTERRUPTED.code;\n      } finally {\n        System.out.println(\"Balancing took \" + time2Str(Util.now()-startTime));\n      }\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
      "extendedDetails": {}
    },
    "9146ad23f3f1af7c5547fba08e2a867cee49e015": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-2582. Scope dfs.ha.namenodes config by nameservice. Contributed by Todd Lipcon.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1207738 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "28/11/11 6:27 PM",
      "commitName": "9146ad23f3f1af7c5547fba08e2a867cee49e015",
      "commitAuthor": "Todd Lipcon",
      "commitDateOld": "19/11/11 7:58 PM",
      "commitNameOld": "b2313021fd03d9803a04b120d97bfd91fcbd4d36",
      "commitAuthorOld": "Eli Collins",
      "daysBetweenCommits": 8.94,
      "commitsBetweenForRepo": 47,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,22 +1,23 @@\n     public int run(String[] args) {\n       final long startTime \u003d Util.now();\n       final Configuration conf \u003d getConf();\n       WIN_WIDTH \u003d conf.getLong(\n           DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n           DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n \n       try {\n         checkReplicationPolicyCompatibility(conf);\n \n-        final List\u003cInetSocketAddress\u003e namenodes \u003d DFSUtil.getNNServiceRpcAddresses(conf);\n+        final Map\u003cString, Map\u003cString, InetSocketAddress\u003e\u003e namenodes \u003d\n+          DFSUtil.getNNServiceRpcAddresses(conf);\n         return Balancer.run(namenodes, parse(args), conf);\n       } catch (IOException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ReturnStatus.IO_EXCEPTION.code;\n       } catch (InterruptedException e) {\n         System.out.println(e + \".  Exiting ...\");\n         return ReturnStatus.INTERRUPTED.code;\n       } finally {\n         System.out.println(\"Balancing took \" + time2Str(Util.now()-startTime));\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public int run(String[] args) {\n      final long startTime \u003d Util.now();\n      final Configuration conf \u003d getConf();\n      WIN_WIDTH \u003d conf.getLong(\n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n\n      try {\n        checkReplicationPolicyCompatibility(conf);\n\n        final Map\u003cString, Map\u003cString, InetSocketAddress\u003e\u003e namenodes \u003d\n          DFSUtil.getNNServiceRpcAddresses(conf);\n        return Balancer.run(namenodes, parse(args), conf);\n      } catch (IOException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.IO_EXCEPTION.code;\n      } catch (InterruptedException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.INTERRUPTED.code;\n      } finally {\n        System.out.println(\"Balancing took \" + time2Str(Util.now()-startTime));\n      }\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
      "extendedDetails": {}
    },
    "cd7157784e5e5ddc4e77144d042e54dd0d04bac1": {
      "type": "Yfilerename",
      "commitMessage": "HADOOP-7560. Change src layout to be heirarchical. Contributed by Alejandro Abdelnur.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1161332 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "24/08/11 5:14 PM",
      "commitName": "cd7157784e5e5ddc4e77144d042e54dd0d04bac1",
      "commitAuthor": "Arun Murthy",
      "commitDateOld": "24/08/11 5:06 PM",
      "commitNameOld": "bb0005cfec5fd2861600ff5babd259b48ba18b63",
      "commitAuthorOld": "Arun Murthy",
      "daysBetweenCommits": 0.01,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "",
      "actualSource": "    public int run(String[] args) {\n      final long startTime \u003d Util.now();\n      final Configuration conf \u003d getConf();\n      WIN_WIDTH \u003d conf.getLong(\n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n\n      try {\n        checkReplicationPolicyCompatibility(conf);\n\n        final List\u003cInetSocketAddress\u003e namenodes \u003d DFSUtil.getNNServiceRpcAddresses(conf);\n        return Balancer.run(namenodes, parse(args), conf);\n      } catch (IOException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.IO_EXCEPTION.code;\n      } catch (InterruptedException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.INTERRUPTED.code;\n      } finally {\n        System.out.println(\"Balancing took \" + time2Str(Util.now()-startTime));\n      }\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
      "extendedDetails": {
        "oldPath": "hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
        "newPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java"
      }
    },
    "d86f3183d93714ba078416af4f609d26376eadb0": {
      "type": "Yfilerename",
      "commitMessage": "HDFS-2096. Mavenization of hadoop-hdfs. Contributed by Alejandro Abdelnur.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1159702 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "19/08/11 10:36 AM",
      "commitName": "d86f3183d93714ba078416af4f609d26376eadb0",
      "commitAuthor": "Thomas White",
      "commitDateOld": "19/08/11 10:26 AM",
      "commitNameOld": "6ee5a73e0e91a2ef27753a32c576835e951d8119",
      "commitAuthorOld": "Thomas White",
      "daysBetweenCommits": 0.01,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "",
      "actualSource": "    public int run(String[] args) {\n      final long startTime \u003d Util.now();\n      final Configuration conf \u003d getConf();\n      WIN_WIDTH \u003d conf.getLong(\n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n\n      try {\n        checkReplicationPolicyCompatibility(conf);\n\n        final List\u003cInetSocketAddress\u003e namenodes \u003d DFSUtil.getNNServiceRpcAddresses(conf);\n        return Balancer.run(namenodes, parse(args), conf);\n      } catch (IOException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.IO_EXCEPTION.code;\n      } catch (InterruptedException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.INTERRUPTED.code;\n      } finally {\n        System.out.println(\"Balancing took \" + time2Str(Util.now()-startTime));\n      }\n    }",
      "path": "hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
      "extendedDetails": {
        "oldPath": "hdfs/src/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java",
        "newPath": "hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java"
      }
    },
    "a196766ea07775f18ded69bd9e8d239f8cfd3ccc": {
      "type": "Yintroduced",
      "commitMessage": "HADOOP-7106. Reorganize SVN layout to combine HDFS, Common, and MR in a single tree (project unsplit)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1134994 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "12/06/11 3:00 PM",
      "commitName": "a196766ea07775f18ded69bd9e8d239f8cfd3ccc",
      "commitAuthor": "Todd Lipcon",
      "diff": "@@ -0,0 +1,22 @@\n+    public int run(String[] args) {\n+      final long startTime \u003d Util.now();\n+      final Configuration conf \u003d getConf();\n+      WIN_WIDTH \u003d conf.getLong(\n+          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n+          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n+\n+      try {\n+        checkReplicationPolicyCompatibility(conf);\n+\n+        final List\u003cInetSocketAddress\u003e namenodes \u003d DFSUtil.getNNServiceRpcAddresses(conf);\n+        return Balancer.run(namenodes, parse(args), conf);\n+      } catch (IOException e) {\n+        System.out.println(e + \".  Exiting ...\");\n+        return ReturnStatus.IO_EXCEPTION.code;\n+      } catch (InterruptedException e) {\n+        System.out.println(e + \".  Exiting ...\");\n+        return ReturnStatus.INTERRUPTED.code;\n+      } finally {\n+        System.out.println(\"Balancing took \" + time2Str(Util.now()-startTime));\n+      }\n+    }\n\\ No newline at end of file\n",
      "actualSource": "    public int run(String[] args) {\n      final long startTime \u003d Util.now();\n      final Configuration conf \u003d getConf();\n      WIN_WIDTH \u003d conf.getLong(\n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_KEY, \n          DFSConfigKeys.DFS_BALANCER_MOVEDWINWIDTH_DEFAULT);\n\n      try {\n        checkReplicationPolicyCompatibility(conf);\n\n        final List\u003cInetSocketAddress\u003e namenodes \u003d DFSUtil.getNNServiceRpcAddresses(conf);\n        return Balancer.run(namenodes, parse(args), conf);\n      } catch (IOException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.IO_EXCEPTION.code;\n      } catch (InterruptedException e) {\n        System.out.println(e + \".  Exiting ...\");\n        return ReturnStatus.INTERRUPTED.code;\n      } finally {\n        System.out.println(\"Balancing took \" + time2Str(Util.now()-startTime));\n      }\n    }",
      "path": "hdfs/src/java/org/apache/hadoop/hdfs/server/balancer/Balancer.java"
    }
  }
}