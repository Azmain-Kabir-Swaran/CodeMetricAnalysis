{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "DynamoDBMetadataStoreTableManager.java",
  "functionName": "getSseSpecFromConfig",
  "functionId": "getSseSpecFromConfig",
  "sourceFilePath": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/DynamoDBMetadataStoreTableManager.java",
  "functionStartLine": 339,
  "functionEndLine": 367,
  "numCommitsSeen": 3,
  "timeTaken": 1319,
  "changeHistory": [
    "6c1fa24ac02b82b5e267dc966e34fb7d4f9556db"
  ],
  "changeHistoryShort": {
    "6c1fa24ac02b82b5e267dc966e34fb7d4f9556db": "Yintroduced"
  },
  "changeHistoryDetails": {
    "6c1fa24ac02b82b5e267dc966e34fb7d4f9556db": {
      "type": "Yintroduced",
      "commitMessage": "HADOOP-16732. S3Guard to support encrypted DynamoDB table (#1752). Contributed by Mingliang Liu.\n\n",
      "commitDate": "23/01/20 5:21 AM",
      "commitName": "6c1fa24ac02b82b5e267dc966e34fb7d4f9556db",
      "commitAuthor": "Mingliang Liu",
      "diff": "@@ -0,0 +1,29 @@\n+  private SSESpecification getSseSpecFromConfig() {\n+    final SSESpecification sseSpecification \u003d new SSESpecification();\n+    boolean enabled \u003d conf.getBoolean(S3GUARD_DDB_TABLE_SSE_ENABLED, false);\n+    if (!enabled) {\n+      // Do not set other options if SSE is disabled. Otherwise it will throw\n+      // ValidationException.\n+      return sseSpecification;\n+    }\n+    sseSpecification.setEnabled(Boolean.TRUE);\n+    String cmk \u003d null;\n+    try {\n+      // Get DynamoDB table SSE CMK from a configuration/credential provider.\n+      cmk \u003d lookupPassword(\"\", conf, S3GUARD_DDB_TABLE_SSE_CMK);\n+    } catch (IOException e) {\n+      LOG.error(\"Cannot retrieve \" + S3GUARD_DDB_TABLE_SSE_CMK, e);\n+    }\n+    if (isEmpty(cmk)) {\n+      // Using Amazon managed default master key for DynamoDB table\n+      return sseSpecification;\n+    }\n+    if (SSE_DEFAULT_MASTER_KEY.equals(cmk)) {\n+      LOG.warn(\"Ignoring default DynamoDB table KMS Master Key {}\",\n+          SSE_DEFAULT_MASTER_KEY);\n+    } else {\n+      sseSpecification.setSSEType(\"KMS\");\n+      sseSpecification.setKMSMasterKeyId(cmk);\n+    }\n+    return sseSpecification;\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private SSESpecification getSseSpecFromConfig() {\n    final SSESpecification sseSpecification \u003d new SSESpecification();\n    boolean enabled \u003d conf.getBoolean(S3GUARD_DDB_TABLE_SSE_ENABLED, false);\n    if (!enabled) {\n      // Do not set other options if SSE is disabled. Otherwise it will throw\n      // ValidationException.\n      return sseSpecification;\n    }\n    sseSpecification.setEnabled(Boolean.TRUE);\n    String cmk \u003d null;\n    try {\n      // Get DynamoDB table SSE CMK from a configuration/credential provider.\n      cmk \u003d lookupPassword(\"\", conf, S3GUARD_DDB_TABLE_SSE_CMK);\n    } catch (IOException e) {\n      LOG.error(\"Cannot retrieve \" + S3GUARD_DDB_TABLE_SSE_CMK, e);\n    }\n    if (isEmpty(cmk)) {\n      // Using Amazon managed default master key for DynamoDB table\n      return sseSpecification;\n    }\n    if (SSE_DEFAULT_MASTER_KEY.equals(cmk)) {\n      LOG.warn(\"Ignoring default DynamoDB table KMS Master Key {}\",\n          SSE_DEFAULT_MASTER_KEY);\n    } else {\n      sseSpecification.setSSEType(\"KMS\");\n      sseSpecification.setKMSMasterKeyId(cmk);\n    }\n    return sseSpecification;\n  }",
      "path": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/DynamoDBMetadataStoreTableManager.java"
    }
  }
}