{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "FSDirectory.java",
  "functionName": "reset",
  "functionId": "reset",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java",
  "functionStartLine": 1552,
  "functionEndLine": 1563,
  "numCommitsSeen": 330,
  "timeTaken": 10859,
  "changeHistory": [
    "185e0c7b4c056b88f606362c71e4a22aae7076e0",
    "a4e0ff5e052abad498595ee198b49c5310c9ec0d",
    "3a3e0f573129c8308332d4b301a9319ee579d85a",
    "75b4231a8cf7c7d569111d3014d45585caad99e9",
    "506938f0b323784f58f1ca398ac2475b473d1670",
    "59e4199d842d8590d2c73c6dba805a9746e1ef4a",
    "deaf979d4122a0a0e4ae0557abbb7f17d18a9380",
    "cd7157784e5e5ddc4e77144d042e54dd0d04bac1",
    "d86f3183d93714ba078416af4f609d26376eadb0",
    "a196766ea07775f18ded69bd9e8d239f8cfd3ccc"
  ],
  "changeHistoryShort": {
    "185e0c7b4c056b88f606362c71e4a22aae7076e0": "Ybodychange",
    "a4e0ff5e052abad498595ee198b49c5310c9ec0d": "Ybodychange",
    "3a3e0f573129c8308332d4b301a9319ee579d85a": "Ybodychange",
    "75b4231a8cf7c7d569111d3014d45585caad99e9": "Ybodychange",
    "506938f0b323784f58f1ca398ac2475b473d1670": "Ybodychange",
    "59e4199d842d8590d2c73c6dba805a9746e1ef4a": "Ybodychange",
    "deaf979d4122a0a0e4ae0557abbb7f17d18a9380": "Ybodychange",
    "cd7157784e5e5ddc4e77144d042e54dd0d04bac1": "Yfilerename",
    "d86f3183d93714ba078416af4f609d26376eadb0": "Yfilerename",
    "a196766ea07775f18ded69bd9e8d239f8cfd3ccc": "Yintroduced"
  },
  "changeHistoryDetails": {
    "185e0c7b4c056b88f606362c71e4a22aae7076e0": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-7462. Consolidate implementation of mkdirs() into a single class. Contributed by Haohui Mai.\n",
      "commitDate": "02/12/14 2:53 PM",
      "commitName": "185e0c7b4c056b88f606362c71e4a22aae7076e0",
      "commitAuthor": "Haohui Mai",
      "commitDateOld": "01/12/14 9:48 PM",
      "commitNameOld": "042699401ebe5186fa5556a79f8f9a206e5ebcd7",
      "commitAuthorOld": "Haohui Mai",
      "daysBetweenCommits": 0.71,
      "commitsBetweenForRepo": 10,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,11 +1,12 @@\n   void reset() {\n     writeLock();\n     try {\n       rootDir \u003d createRoot(getFSNamesystem());\n       inodeMap.clear();\n       addToInodeMap(rootDir);\n       nameCache.reset();\n+      inodeId.setCurrentValue(INodeId.LAST_RESERVED_ID);\n     } finally {\n       writeUnlock();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void reset() {\n    writeLock();\n    try {\n      rootDir \u003d createRoot(getFSNamesystem());\n      inodeMap.clear();\n      addToInodeMap(rootDir);\n      nameCache.reset();\n      inodeId.setCurrentValue(INodeId.LAST_RESERVED_ID);\n    } finally {\n      writeUnlock();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java",
      "extendedDetails": {}
    },
    "a4e0ff5e052abad498595ee198b49c5310c9ec0d": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-6480. Move waitForReady() from FSDirectory to FSNamesystem. Contributed by Haohui Mai.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1603705 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "18/06/14 9:13 PM",
      "commitName": "a4e0ff5e052abad498595ee198b49c5310c9ec0d",
      "commitAuthor": "Haohui Mai",
      "commitDateOld": "18/06/14 12:57 PM",
      "commitNameOld": "4cf94aaf809c77b3b7dc925faa39a72d53e4246e",
      "commitAuthorOld": "Jing Zhao",
      "daysBetweenCommits": 0.35,
      "commitsBetweenForRepo": 8,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,12 +1,11 @@\n   void reset() {\n     writeLock();\n     try {\n-      setReady(false);\n       rootDir \u003d createRoot(getFSNamesystem());\n       inodeMap.clear();\n       addToInodeMap(rootDir);\n       nameCache.reset();\n     } finally {\n       writeUnlock();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void reset() {\n    writeLock();\n    try {\n      rootDir \u003d createRoot(getFSNamesystem());\n      inodeMap.clear();\n      addToInodeMap(rootDir);\n      nameCache.reset();\n    } finally {\n      writeUnlock();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java",
      "extendedDetails": {}
    },
    "3a3e0f573129c8308332d4b301a9319ee579d85a": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-4760. Update inodeMap after node replacement.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1477827 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "30/04/13 2:05 PM",
      "commitName": "3a3e0f573129c8308332d4b301a9319ee579d85a",
      "commitAuthor": "Tsz-wo Sze",
      "commitDateOld": "26/04/13 5:05 PM",
      "commitNameOld": "5276f4e04dbeabe4dbcddafaa1cd386b912f6345",
      "commitAuthorOld": "Tsz-wo Sze",
      "daysBetweenCommits": 3.87,
      "commitsBetweenForRepo": 3,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,12 +1,12 @@\n   void reset() {\n     writeLock();\n     try {\n       setReady(false);\n       rootDir \u003d createRoot(getFSNamesystem());\n       inodeMap.clear();\n-      addToInodeMapUnprotected(rootDir);\n+      addToInodeMap(rootDir);\n       nameCache.reset();\n     } finally {\n       writeUnlock();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void reset() {\n    writeLock();\n    try {\n      setReady(false);\n      rootDir \u003d createRoot(getFSNamesystem());\n      inodeMap.clear();\n      addToInodeMap(rootDir);\n      nameCache.reset();\n    } finally {\n      writeUnlock();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java",
      "extendedDetails": {}
    },
    "75b4231a8cf7c7d569111d3014d45585caad99e9": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-4761. When resetting FSDirectory, the inodeMap should also be reset.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1476452 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "26/04/13 4:47 PM",
      "commitName": "75b4231a8cf7c7d569111d3014d45585caad99e9",
      "commitAuthor": "Tsz-wo Sze",
      "commitDateOld": "25/04/13 5:50 PM",
      "commitNameOld": "06fb184d4d0278cfb57df70ec3c264ec3e8886eb",
      "commitAuthorOld": "Tsz-wo Sze",
      "daysBetweenCommits": 0.96,
      "commitsBetweenForRepo": 7,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,10 +1,12 @@\n   void reset() {\n     writeLock();\n     try {\n       setReady(false);\n       rootDir \u003d createRoot(getFSNamesystem());\n+      inodeMap.clear();\n+      addToInodeMapUnprotected(rootDir);\n       nameCache.reset();\n     } finally {\n       writeUnlock();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void reset() {\n    writeLock();\n    try {\n      setReady(false);\n      rootDir \u003d createRoot(getFSNamesystem());\n      inodeMap.clear();\n      addToInodeMapUnprotected(rootDir);\n      nameCache.reset();\n    } finally {\n      writeUnlock();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java",
      "extendedDetails": {}
    },
    "506938f0b323784f58f1ca398ac2475b473d1670": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-4215. Remove locking from addToParent(..) since it is used in image loading, and add INode.isFile().\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1411947 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "20/11/12 4:13 PM",
      "commitName": "506938f0b323784f58f1ca398ac2475b473d1670",
      "commitAuthor": "Tsz-wo Sze",
      "commitDateOld": "18/11/12 2:03 PM",
      "commitNameOld": "d66f9e8269424f588180f2659c8cf132a2a7dfc9",
      "commitAuthorOld": "Tsz-wo Sze",
      "daysBetweenCommits": 2.09,
      "commitsBetweenForRepo": 9,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,12 +1,10 @@\n   void reset() {\n     writeLock();\n     try {\n       setReady(false);\n-      rootDir \u003d new INodeDirectoryWithQuota(INodeDirectory.ROOT_NAME,\n-          getFSNamesystem().createFsOwnerPermissions(new FsPermission((short)0755)),\n-          Integer.MAX_VALUE, -1);\n+      rootDir \u003d createRoot(getFSNamesystem());\n       nameCache.reset();\n     } finally {\n       writeUnlock();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void reset() {\n    writeLock();\n    try {\n      setReady(false);\n      rootDir \u003d createRoot(getFSNamesystem());\n      nameCache.reset();\n    } finally {\n      writeUnlock();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java",
      "extendedDetails": {}
    },
    "59e4199d842d8590d2c73c6dba805a9746e1ef4a": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-4182. SecondaryNameNode leaks NameCache entries (bobby)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1409311 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "14/11/12 11:21 AM",
      "commitName": "59e4199d842d8590d2c73c6dba805a9746e1ef4a",
      "commitAuthor": "Robert Joseph Evans",
      "commitDateOld": "08/11/12 11:54 AM",
      "commitNameOld": "0f7a4337ac96141db4a3400fd8308436d87042f4",
      "commitAuthorOld": "Suresh Srinivas",
      "daysBetweenCommits": 5.98,
      "commitsBetweenForRepo": 39,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,5 +1,12 @@\n   void reset() {\n-    rootDir \u003d new INodeDirectoryWithQuota(INodeDirectory.ROOT_NAME,\n-        getFSNamesystem().createFsOwnerPermissions(new FsPermission((short)0755)),\n-        Integer.MAX_VALUE, -1);\n+    writeLock();\n+    try {\n+      setReady(false);\n+      rootDir \u003d new INodeDirectoryWithQuota(INodeDirectory.ROOT_NAME,\n+          getFSNamesystem().createFsOwnerPermissions(new FsPermission((short)0755)),\n+          Integer.MAX_VALUE, -1);\n+      nameCache.reset();\n+    } finally {\n+      writeUnlock();\n+    }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void reset() {\n    writeLock();\n    try {\n      setReady(false);\n      rootDir \u003d new INodeDirectoryWithQuota(INodeDirectory.ROOT_NAME,\n          getFSNamesystem().createFsOwnerPermissions(new FsPermission((short)0755)),\n          Integer.MAX_VALUE, -1);\n      nameCache.reset();\n    } finally {\n      writeUnlock();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java",
      "extendedDetails": {}
    },
    "deaf979d4122a0a0e4ae0557abbb7f17d18a9380": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-4146. Use getter and setter in INodeFileWithLink to access blocks and initialize root directory as snapshottable.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1405648 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "04/11/12 2:00 PM",
      "commitName": "deaf979d4122a0a0e4ae0557abbb7f17d18a9380",
      "commitAuthor": "Tsz-wo Sze",
      "commitDateOld": "02/11/12 6:38 PM",
      "commitNameOld": "554fb4d2b24a46ba1f6e1693acf7df0b21d6f677",
      "commitAuthorOld": "",
      "daysBetweenCommits": 1.85,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,5 +1,7 @@\n   void reset() {\n-    rootDir \u003d new INodeDirectoryWithQuota(INodeDirectory.ROOT_NAME,\n+    final INodeDirectoryWithQuota r \u003d new INodeDirectoryWithQuota(\n+        INodeDirectory.ROOT_NAME,\n         getFSNamesystem().createFsOwnerPermissions(new FsPermission((short)0755)),\n-        Integer.MAX_VALUE, -1);\n+        Long.MAX_VALUE, UNKNOWN_DISK_SPACE);\n+    rootDir \u003d INodeDirectorySnapshottable.newInstance(r, 0);\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void reset() {\n    final INodeDirectoryWithQuota r \u003d new INodeDirectoryWithQuota(\n        INodeDirectory.ROOT_NAME,\n        getFSNamesystem().createFsOwnerPermissions(new FsPermission((short)0755)),\n        Long.MAX_VALUE, UNKNOWN_DISK_SPACE);\n    rootDir \u003d INodeDirectorySnapshottable.newInstance(r, 0);\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java",
      "extendedDetails": {}
    },
    "cd7157784e5e5ddc4e77144d042e54dd0d04bac1": {
      "type": "Yfilerename",
      "commitMessage": "HADOOP-7560. Change src layout to be heirarchical. Contributed by Alejandro Abdelnur.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1161332 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "24/08/11 5:14 PM",
      "commitName": "cd7157784e5e5ddc4e77144d042e54dd0d04bac1",
      "commitAuthor": "Arun Murthy",
      "commitDateOld": "24/08/11 5:06 PM",
      "commitNameOld": "bb0005cfec5fd2861600ff5babd259b48ba18b63",
      "commitAuthorOld": "Arun Murthy",
      "daysBetweenCommits": 0.01,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "",
      "actualSource": "  void reset() {\n    rootDir \u003d new INodeDirectoryWithQuota(INodeDirectory.ROOT_NAME,\n        getFSNamesystem().createFsOwnerPermissions(new FsPermission((short)0755)),\n        Integer.MAX_VALUE, -1);\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java",
      "extendedDetails": {
        "oldPath": "hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java",
        "newPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java"
      }
    },
    "d86f3183d93714ba078416af4f609d26376eadb0": {
      "type": "Yfilerename",
      "commitMessage": "HDFS-2096. Mavenization of hadoop-hdfs. Contributed by Alejandro Abdelnur.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1159702 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "19/08/11 10:36 AM",
      "commitName": "d86f3183d93714ba078416af4f609d26376eadb0",
      "commitAuthor": "Thomas White",
      "commitDateOld": "19/08/11 10:26 AM",
      "commitNameOld": "6ee5a73e0e91a2ef27753a32c576835e951d8119",
      "commitAuthorOld": "Thomas White",
      "daysBetweenCommits": 0.01,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "",
      "actualSource": "  void reset() {\n    rootDir \u003d new INodeDirectoryWithQuota(INodeDirectory.ROOT_NAME,\n        getFSNamesystem().createFsOwnerPermissions(new FsPermission((short)0755)),\n        Integer.MAX_VALUE, -1);\n  }",
      "path": "hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java",
      "extendedDetails": {
        "oldPath": "hdfs/src/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java",
        "newPath": "hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java"
      }
    },
    "a196766ea07775f18ded69bd9e8d239f8cfd3ccc": {
      "type": "Yintroduced",
      "commitMessage": "HADOOP-7106. Reorganize SVN layout to combine HDFS, Common, and MR in a single tree (project unsplit)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1134994 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "12/06/11 3:00 PM",
      "commitName": "a196766ea07775f18ded69bd9e8d239f8cfd3ccc",
      "commitAuthor": "Todd Lipcon",
      "diff": "@@ -0,0 +1,5 @@\n+  void reset() {\n+    rootDir \u003d new INodeDirectoryWithQuota(INodeDirectory.ROOT_NAME,\n+        getFSNamesystem().createFsOwnerPermissions(new FsPermission((short)0755)),\n+        Integer.MAX_VALUE, -1);\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  void reset() {\n    rootDir \u003d new INodeDirectoryWithQuota(INodeDirectory.ROOT_NAME,\n        getFSNamesystem().createFsOwnerPermissions(new FsPermission((short)0755)),\n        Integer.MAX_VALUE, -1);\n  }",
      "path": "hdfs/src/java/org/apache/hadoop/hdfs/server/namenode/FSDirectory.java"
    }
  }
}