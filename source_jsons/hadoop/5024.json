{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "DirectoryWithSnapshotFeature.java",
  "functionName": "destroyDeletedList",
  "functionId": "destroyDeletedList___reclaimContext-INode.ReclaimContext",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
  "functionStartLine": 83,
  "functionEndLine": 88,
  "numCommitsSeen": 272,
  "timeTaken": 7754,
  "changeHistory": [
    "ba0da2785d251745969f88a50d33ce61876d91aa",
    "b2c85db86c9a62b0a03ee87547265077f664970a",
    "4536399d47f6c061e149e2504600804a0f1e093d",
    "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
    "5dae97a584d30cef3e34141edfaca49c4ec57913",
    "44a6560b5da3f79d2299579a36e7a2a60a91f823",
    "72d783374c1e302492d7ce537222b563241038bb",
    "0fa5cad0b27780c27a284c23101b1099d4886506",
    "92e0416ced279a910616985bf11fa3f8b1b1de9b",
    "9c6a7bebe23ffb85d7fd95607f3b7bb4fe82dbe4",
    "9701555899315c94584b24d8717c1d7540a4a491",
    "3b3ea5c4220e674064c7603a449f63904c10bac1",
    "f29fa9e820e25730d00a1a00c51c6f11028fb5a7"
  ],
  "changeHistoryShort": {
    "ba0da2785d251745969f88a50d33ce61876d91aa": "Ybodychange",
    "b2c85db86c9a62b0a03ee87547265077f664970a": "Ymultichange(Yreturntypechange,Ybodychange)",
    "4536399d47f6c061e149e2504600804a0f1e093d": "Ymultichange(Yparameterchange,Ybodychange)",
    "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63": "Ymultichange(Yparameterchange,Ybodychange)",
    "5dae97a584d30cef3e34141edfaca49c4ec57913": "Ymultichange(Yparameterchange,Yreturntypechange,Ybodychange)",
    "44a6560b5da3f79d2299579a36e7a2a60a91f823": "Yfilerename",
    "72d783374c1e302492d7ce537222b563241038bb": "Ymultichange(Yparameterchange,Ybodychange)",
    "0fa5cad0b27780c27a284c23101b1099d4886506": "Ybodychange",
    "92e0416ced279a910616985bf11fa3f8b1b1de9b": "Ymultichange(Yparameterchange,Ybodychange)",
    "9c6a7bebe23ffb85d7fd95607f3b7bb4fe82dbe4": "Ymultichange(Yparameterchange,Ybodychange)",
    "9701555899315c94584b24d8717c1d7540a4a491": "Ybodychange",
    "3b3ea5c4220e674064c7603a449f63904c10bac1": "Ymultichange(Yreturntypechange,Ybodychange)",
    "f29fa9e820e25730d00a1a00c51c6f11028fb5a7": "Yintroduced"
  },
  "changeHistoryDetails": {
    "ba0da2785d251745969f88a50d33ce61876d91aa": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-13252. Code refactoring: Remove Diff.ListType.\n",
      "commitDate": "09/03/18 3:50 PM",
      "commitName": "ba0da2785d251745969f88a50d33ce61876d91aa",
      "commitAuthor": "Tsz-Wo Nicholas Sze",
      "commitDateOld": "06/03/18 1:35 PM",
      "commitNameOld": "346caa209571dedf1331b2658d5702b45dd40bfe",
      "commitAuthorOld": "Tsz-Wo Nicholas Sze",
      "daysBetweenCommits": 3.09,
      "commitsBetweenForRepo": 27,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,7 +1,6 @@\n     private void destroyDeletedList(INode.ReclaimContext reclaimContext) {\n-      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n-      for (INode d : deletedList) {\n+      for (INode d : getDeletedUnmodifiable()) {\n         d.destroyAndCollectBlocks(reclaimContext);\n       }\n-      deletedList.clear();\n+      clearDeleted();\n     }\n\\ No newline at end of file\n",
      "actualSource": "    private void destroyDeletedList(INode.ReclaimContext reclaimContext) {\n      for (INode d : getDeletedUnmodifiable()) {\n        d.destroyAndCollectBlocks(reclaimContext);\n      }\n      clearDeleted();\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
      "extendedDetails": {}
    },
    "b2c85db86c9a62b0a03ee87547265077f664970a": {
      "type": "Ymultichange(Yreturntypechange,Ybodychange)",
      "commitMessage": "HDFS-7728. Avoid updating quota usage while loading edits. Contributed by Jing Zhao.\n",
      "commitDate": "13/05/15 9:50 PM",
      "commitName": "b2c85db86c9a62b0a03ee87547265077f664970a",
      "commitAuthor": "Haohui Mai",
      "subchanges": [
        {
          "type": "Yreturntypechange",
          "commitMessage": "HDFS-7728. Avoid updating quota usage while loading edits. Contributed by Jing Zhao.\n",
          "commitDate": "13/05/15 9:50 PM",
          "commitName": "b2c85db86c9a62b0a03ee87547265077f664970a",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "09/05/15 10:51 PM",
          "commitNameOld": "4536399d47f6c061e149e2504600804a0f1e093d",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 3.96,
          "commitsBetweenForRepo": 43,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,10 +1,7 @@\n-    private QuotaCounts destroyDeletedList(INode.ReclaimContext reclaimContext) {\n-      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n+    private void destroyDeletedList(INode.ReclaimContext reclaimContext) {\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n-        d.computeQuotaUsage(reclaimContext.storagePolicySuite(), counts, false);\n         d.destroyAndCollectBlocks(reclaimContext);\n       }\n       deletedList.clear();\n-      return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private void destroyDeletedList(INode.ReclaimContext reclaimContext) {\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        d.destroyAndCollectBlocks(reclaimContext);\n      }\n      deletedList.clear();\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {
            "oldValue": "QuotaCounts",
            "newValue": "void"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-7728. Avoid updating quota usage while loading edits. Contributed by Jing Zhao.\n",
          "commitDate": "13/05/15 9:50 PM",
          "commitName": "b2c85db86c9a62b0a03ee87547265077f664970a",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "09/05/15 10:51 PM",
          "commitNameOld": "4536399d47f6c061e149e2504600804a0f1e093d",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 3.96,
          "commitsBetweenForRepo": 43,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,10 +1,7 @@\n-    private QuotaCounts destroyDeletedList(INode.ReclaimContext reclaimContext) {\n-      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n+    private void destroyDeletedList(INode.ReclaimContext reclaimContext) {\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n-        d.computeQuotaUsage(reclaimContext.storagePolicySuite(), counts, false);\n         d.destroyAndCollectBlocks(reclaimContext);\n       }\n       deletedList.clear();\n-      return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private void destroyDeletedList(INode.ReclaimContext reclaimContext) {\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        d.destroyAndCollectBlocks(reclaimContext);\n      }\n      deletedList.clear();\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {}
        }
      ]
    },
    "4536399d47f6c061e149e2504600804a0f1e093d": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HDFS-8357. Consolidate parameters of INode.CleanSubtree() into a parameter objects. Contributed by Li Lu.\n",
      "commitDate": "09/05/15 10:51 PM",
      "commitName": "4536399d47f6c061e149e2504600804a0f1e093d",
      "commitAuthor": "Haohui Mai",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-8357. Consolidate parameters of INode.CleanSubtree() into a parameter objects. Contributed by Li Lu.\n",
          "commitDate": "09/05/15 10:51 PM",
          "commitName": "4536399d47f6c061e149e2504600804a0f1e093d",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "08/05/15 11:04 PM",
          "commitNameOld": "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 0.99,
          "commitsBetweenForRepo": 7,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,14 +1,10 @@\n-    private QuotaCounts destroyDeletedList(\n-        final BlockStoragePolicySuite bsps,\n-        final BlocksMapUpdateInfo collectedBlocks,\n-        final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n+    private QuotaCounts destroyDeletedList(INode.ReclaimContext reclaimContext) {\n       QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n-        d.computeQuotaUsage(bsps, counts, false);\n-        d.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes,\n-                                  removedUCFiles);\n+        d.computeQuotaUsage(reclaimContext.storagePolicySuite(), counts, false);\n+        d.destroyAndCollectBlocks(reclaimContext);\n       }\n       deletedList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private QuotaCounts destroyDeletedList(INode.ReclaimContext reclaimContext) {\n      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        d.computeQuotaUsage(reclaimContext.storagePolicySuite(), counts, false);\n        d.destroyAndCollectBlocks(reclaimContext);\n      }\n      deletedList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {
            "oldValue": "[bsps-BlockStoragePolicySuite(modifiers-final), collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final), removedUCFiles-List\u003cLong\u003e]",
            "newValue": "[reclaimContext-INode.ReclaimContext]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-8357. Consolidate parameters of INode.CleanSubtree() into a parameter objects. Contributed by Li Lu.\n",
          "commitDate": "09/05/15 10:51 PM",
          "commitName": "4536399d47f6c061e149e2504600804a0f1e093d",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "08/05/15 11:04 PM",
          "commitNameOld": "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 0.99,
          "commitsBetweenForRepo": 7,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,14 +1,10 @@\n-    private QuotaCounts destroyDeletedList(\n-        final BlockStoragePolicySuite bsps,\n-        final BlocksMapUpdateInfo collectedBlocks,\n-        final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n+    private QuotaCounts destroyDeletedList(INode.ReclaimContext reclaimContext) {\n       QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n-        d.computeQuotaUsage(bsps, counts, false);\n-        d.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes,\n-                                  removedUCFiles);\n+        d.computeQuotaUsage(reclaimContext.storagePolicySuite(), counts, false);\n+        d.destroyAndCollectBlocks(reclaimContext);\n       }\n       deletedList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private QuotaCounts destroyDeletedList(INode.ReclaimContext reclaimContext) {\n      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        d.computeQuotaUsage(reclaimContext.storagePolicySuite(), counts, false);\n        d.destroyAndCollectBlocks(reclaimContext);\n      }\n      deletedList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {}
        }
      ]
    },
    "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HDFS-6757. Simplify lease manager with INodeID. Contributed by Haohui Mai.\n",
      "commitDate": "08/05/15 11:04 PM",
      "commitName": "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
      "commitAuthor": "Haohui Mai",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-6757. Simplify lease manager with INodeID. Contributed by Haohui Mai.\n",
          "commitDate": "08/05/15 11:04 PM",
          "commitName": "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "02/04/15 9:20 PM",
          "commitNameOld": "72f6bd4893dcf10d6dad24753f9be99505a87a1f",
          "commitAuthorOld": "Jing Zhao",
          "daysBetweenCommits": 36.07,
          "commitsBetweenForRepo": 375,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,14 @@\n     private QuotaCounts destroyDeletedList(\n         final BlockStoragePolicySuite bsps,\n         final BlocksMapUpdateInfo collectedBlocks,\n-        final List\u003cINode\u003e removedINodes) {\n+        final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n       QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n         d.computeQuotaUsage(bsps, counts, false);\n-        d.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n+        d.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes,\n+                                  removedUCFiles);\n       }\n       deletedList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private QuotaCounts destroyDeletedList(\n        final BlockStoragePolicySuite bsps,\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        d.computeQuotaUsage(bsps, counts, false);\n        d.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes,\n                                  removedUCFiles);\n      }\n      deletedList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {
            "oldValue": "[bsps-BlockStoragePolicySuite(modifiers-final), collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final)]",
            "newValue": "[bsps-BlockStoragePolicySuite(modifiers-final), collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final), removedUCFiles-List\u003cLong\u003e]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-6757. Simplify lease manager with INodeID. Contributed by Haohui Mai.\n",
          "commitDate": "08/05/15 11:04 PM",
          "commitName": "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "02/04/15 9:20 PM",
          "commitNameOld": "72f6bd4893dcf10d6dad24753f9be99505a87a1f",
          "commitAuthorOld": "Jing Zhao",
          "daysBetweenCommits": 36.07,
          "commitsBetweenForRepo": 375,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,14 @@\n     private QuotaCounts destroyDeletedList(\n         final BlockStoragePolicySuite bsps,\n         final BlocksMapUpdateInfo collectedBlocks,\n-        final List\u003cINode\u003e removedINodes) {\n+        final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n       QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n         d.computeQuotaUsage(bsps, counts, false);\n-        d.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n+        d.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes,\n+                                  removedUCFiles);\n       }\n       deletedList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private QuotaCounts destroyDeletedList(\n        final BlockStoragePolicySuite bsps,\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        d.computeQuotaUsage(bsps, counts, false);\n        d.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes,\n                                  removedUCFiles);\n      }\n      deletedList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {}
        }
      ]
    },
    "5dae97a584d30cef3e34141edfaca49c4ec57913": {
      "type": "Ymultichange(Yparameterchange,Yreturntypechange,Ybodychange)",
      "commitMessage": "HDFS-7723. Quota By Storage Type namenode implemenation. (Contributed by Xiaoyu Yao)\n",
      "commitDate": "11/02/15 10:41 AM",
      "commitName": "5dae97a584d30cef3e34141edfaca49c4ec57913",
      "commitAuthor": "Arpit Agarwal",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-7723. Quota By Storage Type namenode implemenation. (Contributed by Xiaoyu Yao)\n",
          "commitDate": "11/02/15 10:41 AM",
          "commitName": "5dae97a584d30cef3e34141edfaca49c4ec57913",
          "commitAuthor": "Arpit Agarwal",
          "commitDateOld": "02/02/15 4:32 PM",
          "commitNameOld": "8cb473124c1cf1c6f68ead7bde06558ebf7ce47e",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 8.76,
          "commitsBetweenForRepo": 109,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,12 +1,13 @@\n-    private Quota.Counts destroyDeletedList(\n+    private QuotaCounts destroyDeletedList(\n+        final BlockStoragePolicySuite bsps,\n         final BlocksMapUpdateInfo collectedBlocks,\n         final List\u003cINode\u003e removedINodes) {\n-      Quota.Counts counts \u003d Quota.Counts.newInstance();\n+      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n-        d.computeQuotaUsage(counts, false);\n-        d.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n+        d.computeQuotaUsage(bsps, counts, false);\n+        d.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n       }\n       deletedList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private QuotaCounts destroyDeletedList(\n        final BlockStoragePolicySuite bsps,\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes) {\n      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        d.computeQuotaUsage(bsps, counts, false);\n        d.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n      }\n      deletedList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {
            "oldValue": "[collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final)]",
            "newValue": "[bsps-BlockStoragePolicySuite(modifiers-final), collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final)]"
          }
        },
        {
          "type": "Yreturntypechange",
          "commitMessage": "HDFS-7723. Quota By Storage Type namenode implemenation. (Contributed by Xiaoyu Yao)\n",
          "commitDate": "11/02/15 10:41 AM",
          "commitName": "5dae97a584d30cef3e34141edfaca49c4ec57913",
          "commitAuthor": "Arpit Agarwal",
          "commitDateOld": "02/02/15 4:32 PM",
          "commitNameOld": "8cb473124c1cf1c6f68ead7bde06558ebf7ce47e",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 8.76,
          "commitsBetweenForRepo": 109,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,12 +1,13 @@\n-    private Quota.Counts destroyDeletedList(\n+    private QuotaCounts destroyDeletedList(\n+        final BlockStoragePolicySuite bsps,\n         final BlocksMapUpdateInfo collectedBlocks,\n         final List\u003cINode\u003e removedINodes) {\n-      Quota.Counts counts \u003d Quota.Counts.newInstance();\n+      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n-        d.computeQuotaUsage(counts, false);\n-        d.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n+        d.computeQuotaUsage(bsps, counts, false);\n+        d.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n       }\n       deletedList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private QuotaCounts destroyDeletedList(\n        final BlockStoragePolicySuite bsps,\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes) {\n      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        d.computeQuotaUsage(bsps, counts, false);\n        d.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n      }\n      deletedList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {
            "oldValue": "Quota.Counts",
            "newValue": "QuotaCounts"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-7723. Quota By Storage Type namenode implemenation. (Contributed by Xiaoyu Yao)\n",
          "commitDate": "11/02/15 10:41 AM",
          "commitName": "5dae97a584d30cef3e34141edfaca49c4ec57913",
          "commitAuthor": "Arpit Agarwal",
          "commitDateOld": "02/02/15 4:32 PM",
          "commitNameOld": "8cb473124c1cf1c6f68ead7bde06558ebf7ce47e",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 8.76,
          "commitsBetweenForRepo": 109,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,12 +1,13 @@\n-    private Quota.Counts destroyDeletedList(\n+    private QuotaCounts destroyDeletedList(\n+        final BlockStoragePolicySuite bsps,\n         final BlocksMapUpdateInfo collectedBlocks,\n         final List\u003cINode\u003e removedINodes) {\n-      Quota.Counts counts \u003d Quota.Counts.newInstance();\n+      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n-        d.computeQuotaUsage(counts, false);\n-        d.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n+        d.computeQuotaUsage(bsps, counts, false);\n+        d.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n       }\n       deletedList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private QuotaCounts destroyDeletedList(\n        final BlockStoragePolicySuite bsps,\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes) {\n      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        d.computeQuotaUsage(bsps, counts, false);\n        d.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n      }\n      deletedList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {}
        }
      ]
    },
    "44a6560b5da3f79d2299579a36e7a2a60a91f823": {
      "type": "Yfilerename",
      "commitMessage": "HDFS-5632. Flatten INodeDirectory hierarchy: Replace INodeDirectoryWithSnapshot with DirectoryWithSnapshotFeature.  Contributed by jing9 \n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1550917 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "14/12/13 2:13 AM",
      "commitName": "44a6560b5da3f79d2299579a36e7a2a60a91f823",
      "commitAuthor": "Tsz-wo Sze",
      "commitDateOld": "13/12/13 6:00 PM",
      "commitNameOld": "d63cfdbf1a5389acb27e8cd61f4c14d8eaedb26f",
      "commitAuthorOld": "Zhijie Shen",
      "daysBetweenCommits": 0.34,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "",
      "actualSource": "    private Quota.Counts destroyDeletedList(\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        d.computeQuotaUsage(counts, false);\n        d.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n      }\n      deletedList.clear();\n      return counts;\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
      "extendedDetails": {
        "oldPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
        "newPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java"
      }
    },
    "72d783374c1e302492d7ce537222b563241038bb": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HDFS-4791. Update and fix deletion of reference inode.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1479198 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "04/05/13 3:10 PM",
      "commitName": "72d783374c1e302492d7ce537222b563241038bb",
      "commitAuthor": "Tsz-wo Sze",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-4791. Update and fix deletion of reference inode.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1479198 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "04/05/13 3:10 PM",
          "commitName": "72d783374c1e302492d7ce537222b563241038bb",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "30/04/13 2:05 PM",
          "commitNameOld": "3a3e0f573129c8308332d4b301a9319ee579d85a",
          "commitAuthorOld": "Tsz-wo Sze",
          "daysBetweenCommits": 4.05,
          "commitsBetweenForRepo": 5,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,19 +1,12 @@\n     private Quota.Counts destroyDeletedList(\n-        final BlocksMapUpdateInfo collectedBlocks, \n-        final List\u003cINode\u003e removedINodes, final List\u003cINodeReference\u003e refNodes) {\n+        final BlocksMapUpdateInfo collectedBlocks,\n+        final List\u003cINode\u003e removedINodes) {\n       Quota.Counts counts \u003d Quota.Counts.newInstance();\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n         d.computeQuotaUsage(counts, false);\n         d.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n-        if (d.isReference()) {\n-          INodeReference.WithCount wc \u003d \n-              (INodeReference.WithCount) d.asReference().getReferredINode();\n-          if (wc.getReferenceCount() \u003e 0) {\n-            refNodes.add(d.asReference());\n-          }\n-        }\n       }\n       deletedList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private Quota.Counts destroyDeletedList(\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        d.computeQuotaUsage(counts, false);\n        d.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n      }\n      deletedList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
          "extendedDetails": {
            "oldValue": "[collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final), refNodes-List\u003cINodeReference\u003e(modifiers-final)]",
            "newValue": "[collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final)]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-4791. Update and fix deletion of reference inode.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1479198 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "04/05/13 3:10 PM",
          "commitName": "72d783374c1e302492d7ce537222b563241038bb",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "30/04/13 2:05 PM",
          "commitNameOld": "3a3e0f573129c8308332d4b301a9319ee579d85a",
          "commitAuthorOld": "Tsz-wo Sze",
          "daysBetweenCommits": 4.05,
          "commitsBetweenForRepo": 5,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,19 +1,12 @@\n     private Quota.Counts destroyDeletedList(\n-        final BlocksMapUpdateInfo collectedBlocks, \n-        final List\u003cINode\u003e removedINodes, final List\u003cINodeReference\u003e refNodes) {\n+        final BlocksMapUpdateInfo collectedBlocks,\n+        final List\u003cINode\u003e removedINodes) {\n       Quota.Counts counts \u003d Quota.Counts.newInstance();\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n         d.computeQuotaUsage(counts, false);\n         d.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n-        if (d.isReference()) {\n-          INodeReference.WithCount wc \u003d \n-              (INodeReference.WithCount) d.asReference().getReferredINode();\n-          if (wc.getReferenceCount() \u003e 0) {\n-            refNodes.add(d.asReference());\n-          }\n-        }\n       }\n       deletedList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private Quota.Counts destroyDeletedList(\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        d.computeQuotaUsage(counts, false);\n        d.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n      }\n      deletedList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
          "extendedDetails": {}
        }
      ]
    },
    "0fa5cad0b27780c27a284c23101b1099d4886506": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-4686. Update quota computation for rename and INodeReference.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1471647 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "24/04/13 1:31 PM",
      "commitName": "0fa5cad0b27780c27a284c23101b1099d4886506",
      "commitAuthor": "Tsz-wo Sze",
      "commitDateOld": "23/04/13 7:11 PM",
      "commitNameOld": "3a812e9f3ae66cfa525faceb5af9085a4cc37232",
      "commitAuthorOld": "Tsz-wo Sze",
      "daysBetweenCommits": 0.76,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,16 +1,19 @@\n     private Quota.Counts destroyDeletedList(\n         final BlocksMapUpdateInfo collectedBlocks, \n         final List\u003cINode\u003e removedINodes, final List\u003cINodeReference\u003e refNodes) {\n       Quota.Counts counts \u003d Quota.Counts.newInstance();\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n-        if (INodeReference.tryRemoveReference(d) \u003c\u003d 0) {\n-          d.computeQuotaUsage(counts, false);\n-          d.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n-        } else {\n-          refNodes.add(d.asReference());\n+        d.computeQuotaUsage(counts, false);\n+        d.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n+        if (d.isReference()) {\n+          INodeReference.WithCount wc \u003d \n+              (INodeReference.WithCount) d.asReference().getReferredINode();\n+          if (wc.getReferenceCount() \u003e 0) {\n+            refNodes.add(d.asReference());\n+          }\n         }\n       }\n       deletedList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
      "actualSource": "    private Quota.Counts destroyDeletedList(\n        final BlocksMapUpdateInfo collectedBlocks, \n        final List\u003cINode\u003e removedINodes, final List\u003cINodeReference\u003e refNodes) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        d.computeQuotaUsage(counts, false);\n        d.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n        if (d.isReference()) {\n          INodeReference.WithCount wc \u003d \n              (INodeReference.WithCount) d.asReference().getReferredINode();\n          if (wc.getReferenceCount() \u003e 0) {\n            refNodes.add(d.asReference());\n          }\n        }\n      }\n      deletedList.clear();\n      return counts;\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
      "extendedDetails": {}
    },
    "92e0416ced279a910616985bf11fa3f8b1b1de9b": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HDFS-4727. Update inodeMap after deleting files/directories/snapshots.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1470756 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "22/04/13 5:00 PM",
      "commitName": "92e0416ced279a910616985bf11fa3f8b1b1de9b",
      "commitAuthor": "Tsz-wo Sze",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-4727. Update inodeMap after deleting files/directories/snapshots.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1470756 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "22/04/13 5:00 PM",
          "commitName": "92e0416ced279a910616985bf11fa3f8b1b1de9b",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "22/04/13 3:13 PM",
          "commitNameOld": "43bdc22e9207a74678665de5f109dd7e56fe979a",
          "commitAuthorOld": "Tsz-wo Sze",
          "daysBetweenCommits": 0.07,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,16 +1,16 @@\n     private Quota.Counts destroyDeletedList(\n         final BlocksMapUpdateInfo collectedBlocks, \n-        final List\u003cINodeReference\u003e refNodes) {\n+        final List\u003cINode\u003e removedINodes, final List\u003cINodeReference\u003e refNodes) {\n       Quota.Counts counts \u003d Quota.Counts.newInstance();\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n         if (INodeReference.tryRemoveReference(d) \u003c\u003d 0) {\n           d.computeQuotaUsage(counts, false);\n-          d.destroyAndCollectBlocks(collectedBlocks);\n+          d.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n         } else {\n           refNodes.add(d.asReference());\n         }\n       }\n       deletedList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private Quota.Counts destroyDeletedList(\n        final BlocksMapUpdateInfo collectedBlocks, \n        final List\u003cINode\u003e removedINodes, final List\u003cINodeReference\u003e refNodes) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        if (INodeReference.tryRemoveReference(d) \u003c\u003d 0) {\n          d.computeQuotaUsage(counts, false);\n          d.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n        } else {\n          refNodes.add(d.asReference());\n        }\n      }\n      deletedList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
          "extendedDetails": {
            "oldValue": "[collectedBlocks-BlocksMapUpdateInfo(modifiers-final), refNodes-List\u003cINodeReference\u003e(modifiers-final)]",
            "newValue": "[collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final), refNodes-List\u003cINodeReference\u003e(modifiers-final)]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-4727. Update inodeMap after deleting files/directories/snapshots.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1470756 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "22/04/13 5:00 PM",
          "commitName": "92e0416ced279a910616985bf11fa3f8b1b1de9b",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "22/04/13 3:13 PM",
          "commitNameOld": "43bdc22e9207a74678665de5f109dd7e56fe979a",
          "commitAuthorOld": "Tsz-wo Sze",
          "daysBetweenCommits": 0.07,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,16 +1,16 @@\n     private Quota.Counts destroyDeletedList(\n         final BlocksMapUpdateInfo collectedBlocks, \n-        final List\u003cINodeReference\u003e refNodes) {\n+        final List\u003cINode\u003e removedINodes, final List\u003cINodeReference\u003e refNodes) {\n       Quota.Counts counts \u003d Quota.Counts.newInstance();\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n         if (INodeReference.tryRemoveReference(d) \u003c\u003d 0) {\n           d.computeQuotaUsage(counts, false);\n-          d.destroyAndCollectBlocks(collectedBlocks);\n+          d.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n         } else {\n           refNodes.add(d.asReference());\n         }\n       }\n       deletedList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private Quota.Counts destroyDeletedList(\n        final BlocksMapUpdateInfo collectedBlocks, \n        final List\u003cINode\u003e removedINodes, final List\u003cINodeReference\u003e refNodes) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        if (INodeReference.tryRemoveReference(d) \u003c\u003d 0) {\n          d.computeQuotaUsage(counts, false);\n          d.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n        } else {\n          refNodes.add(d.asReference());\n        }\n      }\n      deletedList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
          "extendedDetails": {}
        }
      ]
    },
    "9c6a7bebe23ffb85d7fd95607f3b7bb4fe82dbe4": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HDFS-4675. Fix rename across snapshottable directories.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1467540 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "12/04/13 7:48 PM",
      "commitName": "9c6a7bebe23ffb85d7fd95607f3b7bb4fe82dbe4",
      "commitAuthor": "Tsz-wo Sze",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-4675. Fix rename across snapshottable directories.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1467540 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "12/04/13 7:48 PM",
          "commitName": "9c6a7bebe23ffb85d7fd95607f3b7bb4fe82dbe4",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "04/04/13 4:52 PM",
          "commitNameOld": "ca848beb533790ae8abb6498f5d4676594fbae4c",
          "commitAuthorOld": "Tsz-wo Sze",
          "daysBetweenCommits": 8.12,
          "commitsBetweenForRepo": 24,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,16 @@\n     private Quota.Counts destroyDeletedList(\n-        final BlocksMapUpdateInfo collectedBlocks) {\n+        final BlocksMapUpdateInfo collectedBlocks, \n+        final List\u003cINodeReference\u003e refNodes) {\n       Quota.Counts counts \u003d Quota.Counts.newInstance();\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n         if (INodeReference.tryRemoveReference(d) \u003c\u003d 0) {\n           d.computeQuotaUsage(counts, false);\n           d.destroyAndCollectBlocks(collectedBlocks);\n+        } else {\n+          refNodes.add(d.asReference());\n         }\n       }\n       deletedList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private Quota.Counts destroyDeletedList(\n        final BlocksMapUpdateInfo collectedBlocks, \n        final List\u003cINodeReference\u003e refNodes) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        if (INodeReference.tryRemoveReference(d) \u003c\u003d 0) {\n          d.computeQuotaUsage(counts, false);\n          d.destroyAndCollectBlocks(collectedBlocks);\n        } else {\n          refNodes.add(d.asReference());\n        }\n      }\n      deletedList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
          "extendedDetails": {
            "oldValue": "[collectedBlocks-BlocksMapUpdateInfo(modifiers-final)]",
            "newValue": "[collectedBlocks-BlocksMapUpdateInfo(modifiers-final), refNodes-List\u003cINodeReference\u003e(modifiers-final)]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-4675. Fix rename across snapshottable directories.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1467540 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "12/04/13 7:48 PM",
          "commitName": "9c6a7bebe23ffb85d7fd95607f3b7bb4fe82dbe4",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "04/04/13 4:52 PM",
          "commitNameOld": "ca848beb533790ae8abb6498f5d4676594fbae4c",
          "commitAuthorOld": "Tsz-wo Sze",
          "daysBetweenCommits": 8.12,
          "commitsBetweenForRepo": 24,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,16 @@\n     private Quota.Counts destroyDeletedList(\n-        final BlocksMapUpdateInfo collectedBlocks) {\n+        final BlocksMapUpdateInfo collectedBlocks, \n+        final List\u003cINodeReference\u003e refNodes) {\n       Quota.Counts counts \u003d Quota.Counts.newInstance();\n       final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n         if (INodeReference.tryRemoveReference(d) \u003c\u003d 0) {\n           d.computeQuotaUsage(counts, false);\n           d.destroyAndCollectBlocks(collectedBlocks);\n+        } else {\n+          refNodes.add(d.asReference());\n         }\n       }\n       deletedList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private Quota.Counts destroyDeletedList(\n        final BlocksMapUpdateInfo collectedBlocks, \n        final List\u003cINodeReference\u003e refNodes) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        if (INodeReference.tryRemoveReference(d) \u003c\u003d 0) {\n          d.computeQuotaUsage(counts, false);\n          d.destroyAndCollectBlocks(collectedBlocks);\n        } else {\n          refNodes.add(d.asReference());\n        }\n      }\n      deletedList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
          "extendedDetails": {}
        }
      ]
    },
    "9701555899315c94584b24d8717c1d7540a4a491": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-4534. Add INodeReference in order to support rename with snapshots.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1458164 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "18/03/13 11:27 PM",
      "commitName": "9701555899315c94584b24d8717c1d7540a4a491",
      "commitAuthor": "Tsz-wo Sze",
      "commitDateOld": "11/03/13 7:41 PM",
      "commitNameOld": "3b3ea5c4220e674064c7603a449f63904c10bac1",
      "commitAuthorOld": "Tsz-wo Sze",
      "daysBetweenCommits": 7.16,
      "commitsBetweenForRepo": 42,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,11 +1,13 @@\n     private Quota.Counts destroyDeletedList(\n         final BlocksMapUpdateInfo collectedBlocks) {\n       Quota.Counts counts \u003d Quota.Counts.newInstance();\n-      List\u003cINode\u003e deletedList \u003d getDeletedList();\n+      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n       for (INode d : deletedList) {\n-        d.computeQuotaUsage(counts, false);\n-        d.destroyAndCollectBlocks(collectedBlocks);\n+        if (INodeReference.tryRemoveReference(d) \u003c\u003d 0) {\n+          d.computeQuotaUsage(counts, false);\n+          d.destroyAndCollectBlocks(collectedBlocks);\n+        }\n       }\n       deletedList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
      "actualSource": "    private Quota.Counts destroyDeletedList(\n        final BlocksMapUpdateInfo collectedBlocks) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      final List\u003cINode\u003e deletedList \u003d getList(ListType.DELETED);\n      for (INode d : deletedList) {\n        if (INodeReference.tryRemoveReference(d) \u003c\u003d 0) {\n          d.computeQuotaUsage(counts, false);\n          d.destroyAndCollectBlocks(collectedBlocks);\n        }\n      }\n      deletedList.clear();\n      return counts;\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
      "extendedDetails": {}
    },
    "3b3ea5c4220e674064c7603a449f63904c10bac1": {
      "type": "Ymultichange(Yreturntypechange,Ybodychange)",
      "commitMessage": "HDFS-4563. Update namespace/diskspace usage after deleting snapshots.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1455396 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "11/03/13 7:41 PM",
      "commitName": "3b3ea5c4220e674064c7603a449f63904c10bac1",
      "commitAuthor": "Tsz-wo Sze",
      "subchanges": [
        {
          "type": "Yreturntypechange",
          "commitMessage": "HDFS-4563. Update namespace/diskspace usage after deleting snapshots.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1455396 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "11/03/13 7:41 PM",
          "commitName": "3b3ea5c4220e674064c7603a449f63904c10bac1",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "10/03/13 8:45 PM",
          "commitNameOld": "43f8d0b9c9e209eb503451613c2f8d3fed07c203",
          "commitAuthorOld": "Tsz-wo Sze",
          "daysBetweenCommits": 0.96,
          "commitsBetweenForRepo": 4,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,9 +1,11 @@\n-    private int destroyDeletedList(final BlocksMapUpdateInfo collectedBlocks) {\n-      int removedNum  \u003d 0;\n+    private Quota.Counts destroyDeletedList(\n+        final BlocksMapUpdateInfo collectedBlocks) {\n+      Quota.Counts counts \u003d Quota.Counts.newInstance();\n       List\u003cINode\u003e deletedList \u003d getDeletedList();\n       for (INode d : deletedList) {\n-        removedNum +\u003d d.destroyAndCollectBlocks(collectedBlocks);\n+        d.computeQuotaUsage(counts, false);\n+        d.destroyAndCollectBlocks(collectedBlocks);\n       }\n       deletedList.clear();\n-      return removedNum;\n+      return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private Quota.Counts destroyDeletedList(\n        final BlocksMapUpdateInfo collectedBlocks) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      List\u003cINode\u003e deletedList \u003d getDeletedList();\n      for (INode d : deletedList) {\n        d.computeQuotaUsage(counts, false);\n        d.destroyAndCollectBlocks(collectedBlocks);\n      }\n      deletedList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
          "extendedDetails": {
            "oldValue": "int",
            "newValue": "Quota.Counts"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-4563. Update namespace/diskspace usage after deleting snapshots.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1455396 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "11/03/13 7:41 PM",
          "commitName": "3b3ea5c4220e674064c7603a449f63904c10bac1",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "10/03/13 8:45 PM",
          "commitNameOld": "43f8d0b9c9e209eb503451613c2f8d3fed07c203",
          "commitAuthorOld": "Tsz-wo Sze",
          "daysBetweenCommits": 0.96,
          "commitsBetweenForRepo": 4,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,9 +1,11 @@\n-    private int destroyDeletedList(final BlocksMapUpdateInfo collectedBlocks) {\n-      int removedNum  \u003d 0;\n+    private Quota.Counts destroyDeletedList(\n+        final BlocksMapUpdateInfo collectedBlocks) {\n+      Quota.Counts counts \u003d Quota.Counts.newInstance();\n       List\u003cINode\u003e deletedList \u003d getDeletedList();\n       for (INode d : deletedList) {\n-        removedNum +\u003d d.destroyAndCollectBlocks(collectedBlocks);\n+        d.computeQuotaUsage(counts, false);\n+        d.destroyAndCollectBlocks(collectedBlocks);\n       }\n       deletedList.clear();\n-      return removedNum;\n+      return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private Quota.Counts destroyDeletedList(\n        final BlocksMapUpdateInfo collectedBlocks) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      List\u003cINode\u003e deletedList \u003d getDeletedList();\n      for (INode d : deletedList) {\n        d.computeQuotaUsage(counts, false);\n        d.destroyAndCollectBlocks(collectedBlocks);\n      }\n      deletedList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
          "extendedDetails": {}
        }
      ]
    },
    "f29fa9e820e25730d00a1a00c51c6f11028fb5a7": {
      "type": "Yintroduced",
      "commitMessage": "HDFS-4499. Fix file/directory/snapshot deletion for file diff.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1448504 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "20/02/13 7:27 PM",
      "commitName": "f29fa9e820e25730d00a1a00c51c6f11028fb5a7",
      "commitAuthor": "Tsz-wo Sze",
      "diff": "@@ -0,0 +1,9 @@\n+    private int destroyDeletedList(final BlocksMapUpdateInfo collectedBlocks) {\n+      int removedNum  \u003d 0;\n+      List\u003cINode\u003e deletedList \u003d getDeletedList();\n+      for (INode d : deletedList) {\n+        removedNum +\u003d d.destroyAndCollectBlocks(collectedBlocks);\n+      }\n+      deletedList.clear();\n+      return removedNum;\n+    }\n\\ No newline at end of file\n",
      "actualSource": "    private int destroyDeletedList(final BlocksMapUpdateInfo collectedBlocks) {\n      int removedNum  \u003d 0;\n      List\u003cINode\u003e deletedList \u003d getDeletedList();\n      for (INode d : deletedList) {\n        removedNum +\u003d d.destroyAndCollectBlocks(collectedBlocks);\n      }\n      deletedList.clear();\n      return removedNum;\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java"
    }
  }
}