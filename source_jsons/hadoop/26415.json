{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "MRAppMaster.java",
  "functionName": "handle",
  "functionId": "handle___event-SpeculatorEvent(modifiers-final)",
  "sourceFilePath": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
  "functionStartLine": 1578,
  "functionEndLine": 1612,
  "numCommitsSeen": 126,
  "timeTaken": 8509,
  "changeHistory": [
    "9e62bcca4e2ee4aaa3844d1d975dc0adc93ab602",
    "b62c1b8563c7b870ace40bed424b4e1f90a058d7",
    "b7ae5a6cb7b2d3e3112ac53007e984caeb07de58",
    "61900651b1b85cf235e01142acf2a51727fc5537",
    "cd7157784e5e5ddc4e77144d042e54dd0d04bac1",
    "dbecbe5dfe50f834fc3b8401709079e9470cc517"
  ],
  "changeHistoryShort": {
    "9e62bcca4e2ee4aaa3844d1d975dc0adc93ab602": "Ymultichange(Ybodychange,Yparametermetachange)",
    "b62c1b8563c7b870ace40bed424b4e1f90a058d7": "Ybodychange",
    "b7ae5a6cb7b2d3e3112ac53007e984caeb07de58": "Ybodychange",
    "61900651b1b85cf235e01142acf2a51727fc5537": "Ybodychange",
    "cd7157784e5e5ddc4e77144d042e54dd0d04bac1": "Yfilerename",
    "dbecbe5dfe50f834fc3b8401709079e9470cc517": "Yintroduced"
  },
  "changeHistoryDetails": {
    "9e62bcca4e2ee4aaa3844d1d975dc0adc93ab602": {
      "type": "Ymultichange(Ybodychange,Yparametermetachange)",
      "commitMessage": "MAPREDUCE-5957. AM throws ClassNotFoundException with job classloader enabled if custom output format/committer is used. Contributed by Sangjin Lee\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1612358 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "21/07/14 10:54 AM",
      "commitName": "9e62bcca4e2ee4aaa3844d1d975dc0adc93ab602",
      "commitAuthor": "Jason Darrell Lowe",
      "subchanges": [
        {
          "type": "Ybodychange",
          "commitMessage": "MAPREDUCE-5957. AM throws ClassNotFoundException with job classloader enabled if custom output format/committer is used. Contributed by Sangjin Lee\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1612358 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "21/07/14 10:54 AM",
          "commitName": "9e62bcca4e2ee4aaa3844d1d975dc0adc93ab602",
          "commitAuthor": "Jason Darrell Lowe",
          "commitDateOld": "11/07/14 1:45 AM",
          "commitNameOld": "64306aa1b5f280e5ffaf2186bef706acd93b1412",
          "commitAuthorOld": "Zhijie Shen",
          "daysBetweenCommits": 10.38,
          "commitsBetweenForRepo": 64,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,30 +1,35 @@\n-    public void handle(SpeculatorEvent event) {\n+    public void handle(final SpeculatorEvent event) {\n       if (disabled) {\n         return;\n       }\n \n       TaskId tId \u003d event.getTaskID();\n       TaskType tType \u003d null;\n       /* event\u0027s TaskId will be null if the event type is JOB_CREATE or\n        * ATTEMPT_STATUS_UPDATE\n        */\n       if (tId !\u003d null) {\n         tType \u003d tId.getTaskType(); \n       }\n       boolean shouldMapSpec \u003d\n               conf.getBoolean(MRJobConfig.MAP_SPECULATIVE, false);\n       boolean shouldReduceSpec \u003d\n               conf.getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false);\n \n       /* The point of the following is to allow the MAP and REDUCE speculative\n        * config values to be independent:\n        * IF spec-exec is turned on for maps AND the task is a map task\n        * OR IF spec-exec is turned on for reduces AND the task is a reduce task\n        * THEN call the speculator to handle the event.\n        */\n       if ( (shouldMapSpec \u0026\u0026 (tType \u003d\u003d null || tType \u003d\u003d TaskType.MAP))\n         || (shouldReduceSpec \u0026\u0026 (tType \u003d\u003d null || tType \u003d\u003d TaskType.REDUCE))) {\n         // Speculator IS enabled, direct the event to there.\n-        speculator.handle(event);\n+        callWithJobClassLoader(conf, new Action\u003cVoid\u003e() {\n+          public Void call(Configuration conf) {\n+            speculator.handle(event);\n+            return null;\n+          }\n+        });\n       }\n     }\n\\ No newline at end of file\n",
          "actualSource": "    public void handle(final SpeculatorEvent event) {\n      if (disabled) {\n        return;\n      }\n\n      TaskId tId \u003d event.getTaskID();\n      TaskType tType \u003d null;\n      /* event\u0027s TaskId will be null if the event type is JOB_CREATE or\n       * ATTEMPT_STATUS_UPDATE\n       */\n      if (tId !\u003d null) {\n        tType \u003d tId.getTaskType(); \n      }\n      boolean shouldMapSpec \u003d\n              conf.getBoolean(MRJobConfig.MAP_SPECULATIVE, false);\n      boolean shouldReduceSpec \u003d\n              conf.getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false);\n\n      /* The point of the following is to allow the MAP and REDUCE speculative\n       * config values to be independent:\n       * IF spec-exec is turned on for maps AND the task is a map task\n       * OR IF spec-exec is turned on for reduces AND the task is a reduce task\n       * THEN call the speculator to handle the event.\n       */\n      if ( (shouldMapSpec \u0026\u0026 (tType \u003d\u003d null || tType \u003d\u003d TaskType.MAP))\n        || (shouldReduceSpec \u0026\u0026 (tType \u003d\u003d null || tType \u003d\u003d TaskType.REDUCE))) {\n        // Speculator IS enabled, direct the event to there.\n        callWithJobClassLoader(conf, new Action\u003cVoid\u003e() {\n          public Void call(Configuration conf) {\n            speculator.handle(event);\n            return null;\n          }\n        });\n      }\n    }",
          "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
          "extendedDetails": {}
        },
        {
          "type": "Yparametermetachange",
          "commitMessage": "MAPREDUCE-5957. AM throws ClassNotFoundException with job classloader enabled if custom output format/committer is used. Contributed by Sangjin Lee\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1612358 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "21/07/14 10:54 AM",
          "commitName": "9e62bcca4e2ee4aaa3844d1d975dc0adc93ab602",
          "commitAuthor": "Jason Darrell Lowe",
          "commitDateOld": "11/07/14 1:45 AM",
          "commitNameOld": "64306aa1b5f280e5ffaf2186bef706acd93b1412",
          "commitAuthorOld": "Zhijie Shen",
          "daysBetweenCommits": 10.38,
          "commitsBetweenForRepo": 64,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,30 +1,35 @@\n-    public void handle(SpeculatorEvent event) {\n+    public void handle(final SpeculatorEvent event) {\n       if (disabled) {\n         return;\n       }\n \n       TaskId tId \u003d event.getTaskID();\n       TaskType tType \u003d null;\n       /* event\u0027s TaskId will be null if the event type is JOB_CREATE or\n        * ATTEMPT_STATUS_UPDATE\n        */\n       if (tId !\u003d null) {\n         tType \u003d tId.getTaskType(); \n       }\n       boolean shouldMapSpec \u003d\n               conf.getBoolean(MRJobConfig.MAP_SPECULATIVE, false);\n       boolean shouldReduceSpec \u003d\n               conf.getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false);\n \n       /* The point of the following is to allow the MAP and REDUCE speculative\n        * config values to be independent:\n        * IF spec-exec is turned on for maps AND the task is a map task\n        * OR IF spec-exec is turned on for reduces AND the task is a reduce task\n        * THEN call the speculator to handle the event.\n        */\n       if ( (shouldMapSpec \u0026\u0026 (tType \u003d\u003d null || tType \u003d\u003d TaskType.MAP))\n         || (shouldReduceSpec \u0026\u0026 (tType \u003d\u003d null || tType \u003d\u003d TaskType.REDUCE))) {\n         // Speculator IS enabled, direct the event to there.\n-        speculator.handle(event);\n+        callWithJobClassLoader(conf, new Action\u003cVoid\u003e() {\n+          public Void call(Configuration conf) {\n+            speculator.handle(event);\n+            return null;\n+          }\n+        });\n       }\n     }\n\\ No newline at end of file\n",
          "actualSource": "    public void handle(final SpeculatorEvent event) {\n      if (disabled) {\n        return;\n      }\n\n      TaskId tId \u003d event.getTaskID();\n      TaskType tType \u003d null;\n      /* event\u0027s TaskId will be null if the event type is JOB_CREATE or\n       * ATTEMPT_STATUS_UPDATE\n       */\n      if (tId !\u003d null) {\n        tType \u003d tId.getTaskType(); \n      }\n      boolean shouldMapSpec \u003d\n              conf.getBoolean(MRJobConfig.MAP_SPECULATIVE, false);\n      boolean shouldReduceSpec \u003d\n              conf.getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false);\n\n      /* The point of the following is to allow the MAP and REDUCE speculative\n       * config values to be independent:\n       * IF spec-exec is turned on for maps AND the task is a map task\n       * OR IF spec-exec is turned on for reduces AND the task is a reduce task\n       * THEN call the speculator to handle the event.\n       */\n      if ( (shouldMapSpec \u0026\u0026 (tType \u003d\u003d null || tType \u003d\u003d TaskType.MAP))\n        || (shouldReduceSpec \u0026\u0026 (tType \u003d\u003d null || tType \u003d\u003d TaskType.REDUCE))) {\n        // Speculator IS enabled, direct the event to there.\n        callWithJobClassLoader(conf, new Action\u003cVoid\u003e() {\n          public Void call(Configuration conf) {\n            speculator.handle(event);\n            return null;\n          }\n        });\n      }\n    }",
          "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
          "extendedDetails": {
            "oldValue": "[event-SpeculatorEvent]",
            "newValue": "[event-SpeculatorEvent(modifiers-final)]"
          }
        }
      ]
    },
    "b62c1b8563c7b870ace40bed424b4e1f90a058d7": {
      "type": "Ybodychange",
      "commitMessage": "MAPREDUCE-3404. Corrected MR AM to honor speculative configuration and enable speculating either maps or reduces. Contributed by Eric Payne.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1231395 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "13/01/12 3:41 PM",
      "commitName": "b62c1b8563c7b870ace40bed424b4e1f90a058d7",
      "commitAuthor": "Vinod Kumar Vavilapalli",
      "commitDateOld": "27/12/11 11:54 AM",
      "commitNameOld": "fcbad14a3da7fadbb601bf245552ecca2fbc5026",
      "commitAuthorOld": "Vinod Kumar Vavilapalli",
      "daysBetweenCommits": 17.16,
      "commitsBetweenForRepo": 77,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,8 +1,30 @@\n     public void handle(SpeculatorEvent event) {\n-      if (!disabled \u0026\u0026 \n-          (conf.getBoolean(MRJobConfig.MAP_SPECULATIVE, false)\n-          || conf.getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false))) {\n+      if (disabled) {\n+        return;\n+      }\n+\n+      TaskId tId \u003d event.getTaskID();\n+      TaskType tType \u003d null;\n+      /* event\u0027s TaskId will be null if the event type is JOB_CREATE or\n+       * ATTEMPT_STATUS_UPDATE\n+       */\n+      if (tId !\u003d null) {\n+        tType \u003d tId.getTaskType(); \n+      }\n+      boolean shouldMapSpec \u003d\n+              conf.getBoolean(MRJobConfig.MAP_SPECULATIVE, false);\n+      boolean shouldReduceSpec \u003d\n+              conf.getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false);\n+\n+      /* The point of the following is to allow the MAP and REDUCE speculative\n+       * config values to be independent:\n+       * IF spec-exec is turned on for maps AND the task is a map task\n+       * OR IF spec-exec is turned on for reduces AND the task is a reduce task\n+       * THEN call the speculator to handle the event.\n+       */\n+      if ( (shouldMapSpec \u0026\u0026 (tType \u003d\u003d null || tType \u003d\u003d TaskType.MAP))\n+        || (shouldReduceSpec \u0026\u0026 (tType \u003d\u003d null || tType \u003d\u003d TaskType.REDUCE))) {\n         // Speculator IS enabled, direct the event to there.\n         speculator.handle(event);\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void handle(SpeculatorEvent event) {\n      if (disabled) {\n        return;\n      }\n\n      TaskId tId \u003d event.getTaskID();\n      TaskType tType \u003d null;\n      /* event\u0027s TaskId will be null if the event type is JOB_CREATE or\n       * ATTEMPT_STATUS_UPDATE\n       */\n      if (tId !\u003d null) {\n        tType \u003d tId.getTaskType(); \n      }\n      boolean shouldMapSpec \u003d\n              conf.getBoolean(MRJobConfig.MAP_SPECULATIVE, false);\n      boolean shouldReduceSpec \u003d\n              conf.getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false);\n\n      /* The point of the following is to allow the MAP and REDUCE speculative\n       * config values to be independent:\n       * IF spec-exec is turned on for maps AND the task is a map task\n       * OR IF spec-exec is turned on for reduces AND the task is a reduce task\n       * THEN call the speculator to handle the event.\n       */\n      if ( (shouldMapSpec \u0026\u0026 (tType \u003d\u003d null || tType \u003d\u003d TaskType.MAP))\n        || (shouldReduceSpec \u0026\u0026 (tType \u003d\u003d null || tType \u003d\u003d TaskType.REDUCE))) {\n        // Speculator IS enabled, direct the event to there.\n        speculator.handle(event);\n      }\n    }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
      "extendedDetails": {}
    },
    "b7ae5a6cb7b2d3e3112ac53007e984caeb07de58": {
      "type": "Ybodychange",
      "commitMessage": "MAPREDUCE-3426. Fixed MR AM in uber mode to write map intermediate outputs in the correct directory to work properly in secure mode. Contributed by Hitesh Shah.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1213987 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "13/12/11 3:35 PM",
      "commitName": "b7ae5a6cb7b2d3e3112ac53007e984caeb07de58",
      "commitAuthor": "Vinod Kumar Vavilapalli",
      "commitDateOld": "01/12/11 12:35 AM",
      "commitNameOld": "08da8ea5db5359fc04010be486b842a5d2e6b9c2",
      "commitAuthorOld": "Mahadev Konar",
      "daysBetweenCommits": 12.62,
      "commitsBetweenForRepo": 81,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,7 +1,8 @@\n     public void handle(SpeculatorEvent event) {\n-      if (conf.getBoolean(MRJobConfig.MAP_SPECULATIVE, false)\n-          || conf.getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false)) {\n+      if (!disabled \u0026\u0026 \n+          (conf.getBoolean(MRJobConfig.MAP_SPECULATIVE, false)\n+          || conf.getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false))) {\n         // Speculator IS enabled, direct the event to there.\n         speculator.handle(event);\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void handle(SpeculatorEvent event) {\n      if (!disabled \u0026\u0026 \n          (conf.getBoolean(MRJobConfig.MAP_SPECULATIVE, false)\n          || conf.getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false))) {\n        // Speculator IS enabled, direct the event to there.\n        speculator.handle(event);\n      }\n    }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
      "extendedDetails": {}
    },
    "61900651b1b85cf235e01142acf2a51727fc5537": {
      "type": "Ybodychange",
      "commitMessage": "MAPREDUCE-3006. Fixed MapReduce AM to exit only after properly writing out history file. (vinodkv)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1172206 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "18/09/11 12:16 AM",
      "commitName": "61900651b1b85cf235e01142acf2a51727fc5537",
      "commitAuthor": "Vinod Kumar Vavilapalli",
      "commitDateOld": "14/09/11 10:57 AM",
      "commitNameOld": "4ba2acf3363bdfd7fcdd9de496cd57f8af6f03ad",
      "commitAuthorOld": "Vinod Kumar Vavilapalli",
      "daysBetweenCommits": 3.55,
      "commitsBetweenForRepo": 22,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,7 +1,7 @@\n     public void handle(SpeculatorEvent event) {\n-      if (getConfig().getBoolean(MRJobConfig.MAP_SPECULATIVE, false)\n-          || getConfig().getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false)) {\n+      if (conf.getBoolean(MRJobConfig.MAP_SPECULATIVE, false)\n+          || conf.getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false)) {\n         // Speculator IS enabled, direct the event to there.\n         speculator.handle(event);\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void handle(SpeculatorEvent event) {\n      if (conf.getBoolean(MRJobConfig.MAP_SPECULATIVE, false)\n          || conf.getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false)) {\n        // Speculator IS enabled, direct the event to there.\n        speculator.handle(event);\n      }\n    }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
      "extendedDetails": {}
    },
    "cd7157784e5e5ddc4e77144d042e54dd0d04bac1": {
      "type": "Yfilerename",
      "commitMessage": "HADOOP-7560. Change src layout to be heirarchical. Contributed by Alejandro Abdelnur.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1161332 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "24/08/11 5:14 PM",
      "commitName": "cd7157784e5e5ddc4e77144d042e54dd0d04bac1",
      "commitAuthor": "Arun Murthy",
      "commitDateOld": "24/08/11 5:06 PM",
      "commitNameOld": "bb0005cfec5fd2861600ff5babd259b48ba18b63",
      "commitAuthorOld": "Arun Murthy",
      "daysBetweenCommits": 0.01,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "",
      "actualSource": "    public void handle(SpeculatorEvent event) {\n      if (getConfig().getBoolean(MRJobConfig.MAP_SPECULATIVE, false)\n          || getConfig().getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false)) {\n        // Speculator IS enabled, direct the event to there.\n        speculator.handle(event);\n      }\n    }",
      "path": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
      "extendedDetails": {
        "oldPath": "hadoop-mapreduce/hadoop-mr-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java",
        "newPath": "hadoop-mapreduce-project/hadoop-mapreduce-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java"
      }
    },
    "dbecbe5dfe50f834fc3b8401709079e9470cc517": {
      "type": "Yintroduced",
      "commitMessage": "MAPREDUCE-279. MapReduce 2.0. Merging MR-279 branch into trunk. Contributed by Arun C Murthy, Christopher Douglas, Devaraj Das, Greg Roelofs, Jeffrey Naisbitt, Josh Wills, Jonathan Eagles, Krishna Ramachandran, Luke Lu, Mahadev Konar, Robert Evans, Sharad Agarwal, Siddharth Seth, Thomas Graves, and Vinod Kumar Vavilapalli.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1159166 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "18/08/11 4:07 AM",
      "commitName": "dbecbe5dfe50f834fc3b8401709079e9470cc517",
      "commitAuthor": "Vinod Kumar Vavilapalli",
      "diff": "@@ -0,0 +1,7 @@\n+    public void handle(SpeculatorEvent event) {\n+      if (getConfig().getBoolean(MRJobConfig.MAP_SPECULATIVE, false)\n+          || getConfig().getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false)) {\n+        // Speculator IS enabled, direct the event to there.\n+        speculator.handle(event);\n+      }\n+    }\n\\ No newline at end of file\n",
      "actualSource": "    public void handle(SpeculatorEvent event) {\n      if (getConfig().getBoolean(MRJobConfig.MAP_SPECULATIVE, false)\n          || getConfig().getBoolean(MRJobConfig.REDUCE_SPECULATIVE, false)) {\n        // Speculator IS enabled, direct the event to there.\n        speculator.handle(event);\n      }\n    }",
      "path": "hadoop-mapreduce/hadoop-mr-client/hadoop-mapreduce-client-app/src/main/java/org/apache/hadoop/mapreduce/v2/app/MRAppMaster.java"
    }
  }
}