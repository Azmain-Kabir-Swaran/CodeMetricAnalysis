{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "PathMetadata.java",
  "functionName": "tombstone",
  "functionId": "tombstone___path-Path__lastUpdated-long",
  "sourceFilePath": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/PathMetadata.java",
  "functionStartLine": 51,
  "functionEndLine": 56,
  "numCommitsSeen": 7,
  "timeTaken": 3100,
  "changeHistory": [
    "7b219778e05a50e33cca75d727e62783322b7f80",
    "a36274d69947648dbe82721220cc5240ec5d396d",
    "621b43e254afaff708cd6fc4698b29628f6abc33"
  ],
  "changeHistoryShort": {
    "7b219778e05a50e33cca75d727e62783322b7f80": "Ymultichange(Yparameterchange,Ybodychange)",
    "a36274d69947648dbe82721220cc5240ec5d396d": "Ybodychange",
    "621b43e254afaff708cd6fc4698b29628f6abc33": "Yintroduced"
  },
  "changeHistoryDetails": {
    "7b219778e05a50e33cca75d727e62783322b7f80": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HADOOP-16433. S3Guard: Filter expired entries and tombstones when listing with MetadataStore.listChildren().\n\nContributed by Gabor Bota.\n\nThis pulls the tracking of the lastUpdated timestamp of metadata entries up from the DDB metastore into all s3guard stores, and then uses this to filter out expired tombstones from listings.\n\nChange-Id: I80f121236b49c75a024116f65a3ef29d3580b462\n",
      "commitDate": "24/07/19 10:11 AM",
      "commitName": "7b219778e05a50e33cca75d727e62783322b7f80",
      "commitAuthor": "Gabor Bota",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HADOOP-16433. S3Guard: Filter expired entries and tombstones when listing with MetadataStore.listChildren().\n\nContributed by Gabor Bota.\n\nThis pulls the tracking of the lastUpdated timestamp of metadata entries up from the DDB metastore into all s3guard stores, and then uses this to filter out expired tombstones from listings.\n\nChange-Id: I80f121236b49c75a024116f65a3ef29d3580b462\n",
          "commitDate": "24/07/19 10:11 AM",
          "commitName": "7b219778e05a50e33cca75d727e62783322b7f80",
          "commitAuthor": "Gabor Bota",
          "commitDateOld": "19/05/19 2:29 PM",
          "commitNameOld": "a36274d69947648dbe82721220cc5240ec5d396d",
          "commitAuthorOld": "Ben Roling",
          "daysBetweenCommits": 65.82,
          "commitsBetweenForRepo": 524,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,6 +1,6 @@\n-  public static PathMetadata tombstone(Path path) {\n+  public static PathMetadata tombstone(Path path, long lastUpdated) {\n     S3AFileStatus s3aStatus \u003d new S3AFileStatus(0,\n         System.currentTimeMillis(), path, 0, null,\n         null, null);\n-    return new PathMetadata(s3aStatus, Tristate.UNKNOWN, true);\n+    return new PathMetadata(s3aStatus, Tristate.UNKNOWN, true, lastUpdated);\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public static PathMetadata tombstone(Path path, long lastUpdated) {\n    S3AFileStatus s3aStatus \u003d new S3AFileStatus(0,\n        System.currentTimeMillis(), path, 0, null,\n        null, null);\n    return new PathMetadata(s3aStatus, Tristate.UNKNOWN, true, lastUpdated);\n  }",
          "path": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/PathMetadata.java",
          "extendedDetails": {
            "oldValue": "[path-Path]",
            "newValue": "[path-Path, lastUpdated-long]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HADOOP-16433. S3Guard: Filter expired entries and tombstones when listing with MetadataStore.listChildren().\n\nContributed by Gabor Bota.\n\nThis pulls the tracking of the lastUpdated timestamp of metadata entries up from the DDB metastore into all s3guard stores, and then uses this to filter out expired tombstones from listings.\n\nChange-Id: I80f121236b49c75a024116f65a3ef29d3580b462\n",
          "commitDate": "24/07/19 10:11 AM",
          "commitName": "7b219778e05a50e33cca75d727e62783322b7f80",
          "commitAuthor": "Gabor Bota",
          "commitDateOld": "19/05/19 2:29 PM",
          "commitNameOld": "a36274d69947648dbe82721220cc5240ec5d396d",
          "commitAuthorOld": "Ben Roling",
          "daysBetweenCommits": 65.82,
          "commitsBetweenForRepo": 524,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,6 +1,6 @@\n-  public static PathMetadata tombstone(Path path) {\n+  public static PathMetadata tombstone(Path path, long lastUpdated) {\n     S3AFileStatus s3aStatus \u003d new S3AFileStatus(0,\n         System.currentTimeMillis(), path, 0, null,\n         null, null);\n-    return new PathMetadata(s3aStatus, Tristate.UNKNOWN, true);\n+    return new PathMetadata(s3aStatus, Tristate.UNKNOWN, true, lastUpdated);\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public static PathMetadata tombstone(Path path, long lastUpdated) {\n    S3AFileStatus s3aStatus \u003d new S3AFileStatus(0,\n        System.currentTimeMillis(), path, 0, null,\n        null, null);\n    return new PathMetadata(s3aStatus, Tristate.UNKNOWN, true, lastUpdated);\n  }",
          "path": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/PathMetadata.java",
          "extendedDetails": {}
        }
      ]
    },
    "a36274d69947648dbe82721220cc5240ec5d396d": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-16085. S3Guard: use object version or etags to protect against inconsistent read after replace/overwrite.\n\nContributed by Ben Roling.\n\nS3Guard will now track the etag of uploaded files and, if an S3\nbucket is versioned, the object version.\n\nYou can then control how to react to a mismatch between the data\nin the DynamoDB table and that in the store: warn, fail, or, when\nusing versions, return the original value.\n\nThis adds two new columns to the table: etag and version.\nThis is transparent to older S3A clients -but when such clients\nadd/update data to the S3Guard table, they will not add these values.\nAs a result, the etag/version checks will not work with files uploaded by older clients.\n\nFor a consistent experience, upgrade all clients to use the latest hadoop version.\n",
      "commitDate": "19/05/19 2:29 PM",
      "commitName": "a36274d69947648dbe82721220cc5240ec5d396d",
      "commitAuthor": "Ben Roling",
      "commitDateOld": "02/10/18 9:22 PM",
      "commitNameOld": "046b8768af8a07a9e10ce43f538d6ac16e7fa5f3",
      "commitAuthorOld": "Aaron Fabbri",
      "daysBetweenCommits": 228.71,
      "commitsBetweenForRepo": 1662,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,5 +1,6 @@\n   public static PathMetadata tombstone(Path path) {\n-    long now \u003d System.currentTimeMillis();\n-    FileStatus status \u003d new FileStatus(0, false, 0, 0, now, path);\n-    return new PathMetadata(status, Tristate.UNKNOWN, true);\n+    S3AFileStatus s3aStatus \u003d new S3AFileStatus(0,\n+        System.currentTimeMillis(), path, 0, null,\n+        null, null);\n+    return new PathMetadata(s3aStatus, Tristate.UNKNOWN, true);\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public static PathMetadata tombstone(Path path) {\n    S3AFileStatus s3aStatus \u003d new S3AFileStatus(0,\n        System.currentTimeMillis(), path, 0, null,\n        null, null);\n    return new PathMetadata(s3aStatus, Tristate.UNKNOWN, true);\n  }",
      "path": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/PathMetadata.java",
      "extendedDetails": {}
    },
    "621b43e254afaff708cd6fc4698b29628f6abc33": {
      "type": "Yintroduced",
      "commitMessage": "HADOOP-13345 HS3Guard: Improved Consistency for S3A.\nContributed by: Chris Nauroth, Aaron Fabbri, Mingliang Liu, Lei (Eddy) Xu,\nSean Mackrory, Steve Loughran and others.\n",
      "commitDate": "01/09/17 6:13 AM",
      "commitName": "621b43e254afaff708cd6fc4698b29628f6abc33",
      "commitAuthor": "Steve Loughran",
      "diff": "@@ -0,0 +1,5 @@\n+  public static PathMetadata tombstone(Path path) {\n+    long now \u003d System.currentTimeMillis();\n+    FileStatus status \u003d new FileStatus(0, false, 0, 0, now, path);\n+    return new PathMetadata(status, Tristate.UNKNOWN, true);\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  public static PathMetadata tombstone(Path path) {\n    long now \u003d System.currentTimeMillis();\n    FileStatus status \u003d new FileStatus(0, false, 0, 0, now, path);\n    return new PathMetadata(status, Tristate.UNKNOWN, true);\n  }",
      "path": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/PathMetadata.java"
    }
  }
}