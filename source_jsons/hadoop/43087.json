{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "ApiServiceClient.java",
  "functionName": "actionCleanUp",
  "functionId": "actionCleanUp___appName-String__userName-String",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-services/hadoop-yarn-services-api/src/main/java/org/apache/hadoop/yarn/service/client/ApiServiceClient.java",
  "functionStartLine": 660,
  "functionEndLine": 681,
  "numCommitsSeen": 18,
  "timeTaken": 2138,
  "changeHistory": [
    "fe7d67a8a27ba49f12ce69c5af3908b95da4a348",
    "ff583d3fa3325029bc691ec22d817aee37e5e85d"
  ],
  "changeHistoryShort": {
    "fe7d67a8a27ba49f12ce69c5af3908b95da4a348": "Ymultichange(Yexceptionschange,Ybodychange)",
    "ff583d3fa3325029bc691ec22d817aee37e5e85d": "Yintroduced"
  },
  "changeHistoryDetails": {
    "fe7d67a8a27ba49f12ce69c5af3908b95da4a348": {
      "type": "Ymultichange(Yexceptionschange,Ybodychange)",
      "commitMessage": "YARN-9521. Handle FileSystem close in ApiServiceClient\n\nContributed by kyungwan nam. Reviewed by Eric Yang.\n",
      "commitDate": "12/02/20 8:09 PM",
      "commitName": "fe7d67a8a27ba49f12ce69c5af3908b95da4a348",
      "commitAuthor": "Prabhu Joseph",
      "subchanges": [
        {
          "type": "Yexceptionschange",
          "commitMessage": "YARN-9521. Handle FileSystem close in ApiServiceClient\n\nContributed by kyungwan nam. Reviewed by Eric Yang.\n",
          "commitDate": "12/02/20 8:09 PM",
          "commitName": "fe7d67a8a27ba49f12ce69c5af3908b95da4a348",
          "commitAuthor": "Prabhu Joseph",
          "commitDateOld": "06/01/20 10:24 AM",
          "commitNameOld": "d81d45ff2fc9a1c424222e021f9306bf64c916b2",
          "commitAuthorOld": "Eric Yang",
          "daysBetweenCommits": 37.41,
          "commitsBetweenForRepo": 135,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,9 +1,22 @@\n   public int actionCleanUp(String appName, String userName) throws\n-      IOException, YarnException {\n-    ServiceClient sc \u003d new ServiceClient();\n-    sc.init(getConfig());\n-    sc.start();\n-    int result \u003d sc.actionCleanUp(appName, userName);\n-    sc.close();\n-    return result;\n+      IOException, YarnException, InterruptedException {\n+    UserGroupInformation proxyUser;\n+    UserGroupInformation ugi;\n+    if (UserGroupInformation.isSecurityEnabled()) {\n+      proxyUser \u003d UserGroupInformation.getLoginUser();\n+      ugi \u003d UserGroupInformation.createProxyUser(userName, proxyUser);\n+    } else {\n+      ugi \u003d UserGroupInformation.createRemoteUser(userName);\n+    }\n+    return ugi.doAs((PrivilegedExceptionAction\u003cInteger\u003e) () -\u003e {\n+      ServiceClient sc \u003d new ServiceClient();\n+      try {\n+        sc.init(getConfig());\n+        sc.start();\n+        int result \u003d sc.actionCleanUp(appName, userName);\n+        return result;\n+      } finally {\n+        sc.close();\n+      }\n+    });\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public int actionCleanUp(String appName, String userName) throws\n      IOException, YarnException, InterruptedException {\n    UserGroupInformation proxyUser;\n    UserGroupInformation ugi;\n    if (UserGroupInformation.isSecurityEnabled()) {\n      proxyUser \u003d UserGroupInformation.getLoginUser();\n      ugi \u003d UserGroupInformation.createProxyUser(userName, proxyUser);\n    } else {\n      ugi \u003d UserGroupInformation.createRemoteUser(userName);\n    }\n    return ugi.doAs((PrivilegedExceptionAction\u003cInteger\u003e) () -\u003e {\n      ServiceClient sc \u003d new ServiceClient();\n      try {\n        sc.init(getConfig());\n        sc.start();\n        int result \u003d sc.actionCleanUp(appName, userName);\n        return result;\n      } finally {\n        sc.close();\n      }\n    });\n  }",
          "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-services/hadoop-yarn-services-api/src/main/java/org/apache/hadoop/yarn/service/client/ApiServiceClient.java",
          "extendedDetails": {
            "oldValue": "[IOException, YarnException]",
            "newValue": "[IOException, YarnException, InterruptedException]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "YARN-9521. Handle FileSystem close in ApiServiceClient\n\nContributed by kyungwan nam. Reviewed by Eric Yang.\n",
          "commitDate": "12/02/20 8:09 PM",
          "commitName": "fe7d67a8a27ba49f12ce69c5af3908b95da4a348",
          "commitAuthor": "Prabhu Joseph",
          "commitDateOld": "06/01/20 10:24 AM",
          "commitNameOld": "d81d45ff2fc9a1c424222e021f9306bf64c916b2",
          "commitAuthorOld": "Eric Yang",
          "daysBetweenCommits": 37.41,
          "commitsBetweenForRepo": 135,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,9 +1,22 @@\n   public int actionCleanUp(String appName, String userName) throws\n-      IOException, YarnException {\n-    ServiceClient sc \u003d new ServiceClient();\n-    sc.init(getConfig());\n-    sc.start();\n-    int result \u003d sc.actionCleanUp(appName, userName);\n-    sc.close();\n-    return result;\n+      IOException, YarnException, InterruptedException {\n+    UserGroupInformation proxyUser;\n+    UserGroupInformation ugi;\n+    if (UserGroupInformation.isSecurityEnabled()) {\n+      proxyUser \u003d UserGroupInformation.getLoginUser();\n+      ugi \u003d UserGroupInformation.createProxyUser(userName, proxyUser);\n+    } else {\n+      ugi \u003d UserGroupInformation.createRemoteUser(userName);\n+    }\n+    return ugi.doAs((PrivilegedExceptionAction\u003cInteger\u003e) () -\u003e {\n+      ServiceClient sc \u003d new ServiceClient();\n+      try {\n+        sc.init(getConfig());\n+        sc.start();\n+        int result \u003d sc.actionCleanUp(appName, userName);\n+        return result;\n+      } finally {\n+        sc.close();\n+      }\n+    });\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public int actionCleanUp(String appName, String userName) throws\n      IOException, YarnException, InterruptedException {\n    UserGroupInformation proxyUser;\n    UserGroupInformation ugi;\n    if (UserGroupInformation.isSecurityEnabled()) {\n      proxyUser \u003d UserGroupInformation.getLoginUser();\n      ugi \u003d UserGroupInformation.createProxyUser(userName, proxyUser);\n    } else {\n      ugi \u003d UserGroupInformation.createRemoteUser(userName);\n    }\n    return ugi.doAs((PrivilegedExceptionAction\u003cInteger\u003e) () -\u003e {\n      ServiceClient sc \u003d new ServiceClient();\n      try {\n        sc.init(getConfig());\n        sc.start();\n        int result \u003d sc.actionCleanUp(appName, userName);\n        return result;\n      } finally {\n        sc.close();\n      }\n    });\n  }",
          "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-services/hadoop-yarn-services-api/src/main/java/org/apache/hadoop/yarn/service/client/ApiServiceClient.java",
          "extendedDetails": {}
        }
      ]
    },
    "ff583d3fa3325029bc691ec22d817aee37e5e85d": {
      "type": "Yintroduced",
      "commitMessage": "YARN-8349. Remove YARN registry entries when a service is killed by the RM. (Billie Rinaldi via wangda)\n\nChange-Id: Ia58db3637789a8921482f564aa9bdf99c45cc36c\n",
      "commitDate": "01/06/18 2:49 PM",
      "commitName": "ff583d3fa3325029bc691ec22d817aee37e5e85d",
      "commitAuthor": "Wangda Tan",
      "diff": "@@ -0,0 +1,9 @@\n+  public int actionCleanUp(String appName, String userName) throws\n+      IOException, YarnException {\n+    ServiceClient sc \u003d new ServiceClient();\n+    sc.init(getConfig());\n+    sc.start();\n+    int result \u003d sc.actionCleanUp(appName, userName);\n+    sc.close();\n+    return result;\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  public int actionCleanUp(String appName, String userName) throws\n      IOException, YarnException {\n    ServiceClient sc \u003d new ServiceClient();\n    sc.init(getConfig());\n    sc.start();\n    int result \u003d sc.actionCleanUp(appName, userName);\n    sc.close();\n    return result;\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-services/hadoop-yarn-services-api/src/main/java/org/apache/hadoop/yarn/service/client/ApiServiceClient.java"
    }
  }
}