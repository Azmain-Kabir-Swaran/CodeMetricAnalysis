{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "INodeFile.java",
  "functionName": "clearFile",
  "functionId": "clearFile___reclaimContext-ReclaimContext",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
  "functionStartLine": 784,
  "functionEndLine": 796,
  "numCommitsSeen": 568,
  "timeTaken": 8432,
  "changeHistory": [
    "972782d9568e0849484c027f27c1638ba50ec56e",
    "4cbbfa2220e884e91bf18ad1cc2f3b11f895f8c9",
    "7e091de1366f4b57b5433bc19d738199dc05313d",
    "47f4c54106ebb234a7d3dc71320aa584ecba161a",
    "4928f5473394981829e5ffd4b16ea0801baf5c45",
    "9f2f583f401189c3f4a2687795a9e3e0b288322b",
    "b2c85db86c9a62b0a03ee87547265077f664970a",
    "4536399d47f6c061e149e2504600804a0f1e093d",
    "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
    "5dae97a584d30cef3e34141edfaca49c4ec57913",
    "1382ae525c67bf95d8f3a436b547dbc72cfbb177",
    "08ac06283a3e9bf0d49d873823aabd419b08e41f",
    "50ae1a6664a92619aa683d2a864d0da9fb4af026",
    "4c87a27ad851ffaa3cc3e2074a9ef7073b5a164a",
    "8df119da214babde03e73243c7ca4cfe6d0ca562"
  ],
  "changeHistoryShort": {
    "972782d9568e0849484c027f27c1638ba50ec56e": "Ybodychange",
    "4cbbfa2220e884e91bf18ad1cc2f3b11f895f8c9": "Ybodychange",
    "7e091de1366f4b57b5433bc19d738199dc05313d": "Ybodychange",
    "47f4c54106ebb234a7d3dc71320aa584ecba161a": "Ybodychange",
    "4928f5473394981829e5ffd4b16ea0801baf5c45": "Ybodychange",
    "9f2f583f401189c3f4a2687795a9e3e0b288322b": "Ybodychange",
    "b2c85db86c9a62b0a03ee87547265077f664970a": "Ymultichange(Yrename,Ybodychange)",
    "4536399d47f6c061e149e2504600804a0f1e093d": "Ymultichange(Yparameterchange,Ybodychange)",
    "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63": "Ymultichange(Yparameterchange,Ybodychange)",
    "5dae97a584d30cef3e34141edfaca49c4ec57913": "Yparameterchange",
    "1382ae525c67bf95d8f3a436b547dbc72cfbb177": "Ybodychange",
    "08ac06283a3e9bf0d49d873823aabd419b08e41f": "Ybodychange",
    "50ae1a6664a92619aa683d2a864d0da9fb4af026": "Ybodychange",
    "4c87a27ad851ffaa3cc3e2074a9ef7073b5a164a": "Ybodychange",
    "8df119da214babde03e73243c7ca4cfe6d0ca562": "Ybodychange"
  },
  "changeHistoryDetails": {
    "972782d9568e0849484c027f27c1638ba50ec56e": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-9754. Avoid unnecessary getBlockCollection calls in BlockManager. Contributed by Jing Zhao.\n",
      "commitDate": "12/02/16 11:07 AM",
      "commitName": "972782d9568e0849484c027f27c1638ba50ec56e",
      "commitAuthor": "Jing Zhao",
      "commitDateOld": "01/02/16 1:56 PM",
      "commitNameOld": "34ab50ea92370cc7440a8f7649286b148c2fde65",
      "commitAuthorOld": "Yongjun Zhang",
      "daysBetweenCommits": 10.88,
      "commitsBetweenForRepo": 93,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,14 +1,13 @@\n   public void clearFile(ReclaimContext reclaimContext) {\n     if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n       for (BlockInfo blk : blocks) {\n         reclaimContext.collectedBlocks.addDeleteBlock(blk);\n-        blk.setBlockCollectionId(INodeId.INVALID_INODE_ID);\n       }\n     }\n     clearBlocks();\n     if (getAclFeature() !\u003d null) {\n       AclStorage.removeAclFeature(getAclFeature());\n     }\n     clear();\n     reclaimContext.removedINodes.add(this);\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void clearFile(ReclaimContext reclaimContext) {\n    if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n      for (BlockInfo blk : blocks) {\n        reclaimContext.collectedBlocks.addDeleteBlock(blk);\n      }\n    }\n    clearBlocks();\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    reclaimContext.removedINodes.add(this);\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
      "extendedDetails": {}
    },
    "4cbbfa2220e884e91bf18ad1cc2f3b11f895f8c9": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-8248. Store INodeId instead of the INodeFile object in BlockInfoContiguous. Contributed by Haohui Mai.\n",
      "commitDate": "26/08/15 6:14 PM",
      "commitName": "4cbbfa2220e884e91bf18ad1cc2f3b11f895f8c9",
      "commitAuthor": "Haohui Mai",
      "commitDateOld": "22/08/15 12:09 AM",
      "commitNameOld": "745d04be59accf80feda0ad38efcc74ba362f2ca",
      "commitAuthorOld": "Haohui Mai",
      "daysBetweenCommits": 4.75,
      "commitsBetweenForRepo": 18,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,14 +1,14 @@\n   public void clearFile(ReclaimContext reclaimContext) {\n     if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n       for (BlockInfo blk : blocks) {\n         reclaimContext.collectedBlocks.addDeleteBlock(blk);\n-        blk.setBlockCollection(null);\n+        blk.setBlockCollectionId(INodeId.INVALID_INODE_ID);\n       }\n     }\n     clearBlocks();\n     if (getAclFeature() !\u003d null) {\n       AclStorage.removeAclFeature(getAclFeature());\n     }\n     clear();\n     reclaimContext.removedINodes.add(this);\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void clearFile(ReclaimContext reclaimContext) {\n    if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n      for (BlockInfo blk : blocks) {\n        reclaimContext.collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollectionId(INodeId.INVALID_INODE_ID);\n      }\n    }\n    clearBlocks();\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    reclaimContext.removedINodes.add(this);\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
      "extendedDetails": {}
    },
    "7e091de1366f4b57b5433bc19d738199dc05313d": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-8058. Erasure coding: use BlockInfo[] for both striped and contiguous blocks in INodeFile. Contributed by Zhe Zhang and Yi Liu.\n",
      "commitDate": "15/07/15 9:49 AM",
      "commitName": "7e091de1366f4b57b5433bc19d738199dc05313d",
      "commitAuthor": "Zhe Zhang",
      "commitDateOld": "06/07/15 4:14 AM",
      "commitNameOld": "ee01a09500224136464f2c3e0a5d9ba53242d93f",
      "commitAuthorOld": "yliu",
      "daysBetweenCommits": 9.23,
      "commitsBetweenForRepo": 11,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,20 +1,14 @@\n   public void clearFile(ReclaimContext reclaimContext) {\n-    BlockInfo[] blks \u003d getBlocks();\n-    if (blks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n-      for (BlockInfo blk : blks) {\n+    if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n+      for (BlockInfo blk : blocks) {\n         reclaimContext.collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n-    setContiguousBlocks(null);\n-\n-    FileWithStripedBlocksFeature sb \u003d getStripedBlocksFeature();\n-    if (sb !\u003d null) {\n-      sb.clear();\n-    }\n+    clearBlocks();\n     if (getAclFeature() !\u003d null) {\n       AclStorage.removeAclFeature(getAclFeature());\n     }\n     clear();\n     reclaimContext.removedINodes.add(this);\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void clearFile(ReclaimContext reclaimContext) {\n    if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n      for (BlockInfo blk : blocks) {\n        reclaimContext.collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    clearBlocks();\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    reclaimContext.removedINodes.add(this);\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
      "extendedDetails": {}
    },
    "47f4c54106ebb234a7d3dc71320aa584ecba161a": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-8751. Remove setBlocks API from INodeFile and misc code cleanup. Contributed by Zhe Zhang\n",
      "commitDate": "10/07/15 2:15 PM",
      "commitName": "47f4c54106ebb234a7d3dc71320aa584ecba161a",
      "commitAuthor": "Jing Zhao",
      "commitDateOld": "17/06/15 8:05 AM",
      "commitNameOld": "6e3fcffe291faec40fa9214f4880a35a952836c4",
      "commitAuthorOld": "Andrew Wang",
      "daysBetweenCommits": 23.26,
      "commitsBetweenForRepo": 160,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,14 +1,14 @@\n   public void clearFile(ReclaimContext reclaimContext) {\n     if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n       for (BlockInfo blk : blocks) {\n         reclaimContext.collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n-    setBlocks(null);\n+    clearBlocks();\n     if (getAclFeature() !\u003d null) {\n       AclStorage.removeAclFeature(getAclFeature());\n     }\n     clear();\n     reclaimContext.removedINodes.add(this);\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void clearFile(ReclaimContext reclaimContext) {\n    if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n      for (BlockInfo blk : blocks) {\n        reclaimContext.collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    clearBlocks();\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    reclaimContext.removedINodes.add(this);\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
      "extendedDetails": {}
    },
    "4928f5473394981829e5ffd4b16ea0801baf5c45": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-8482. Rename BlockInfoContiguous to BlockInfo. Contributed by Zhe Zhang.\n",
      "commitDate": "27/05/15 3:42 PM",
      "commitName": "4928f5473394981829e5ffd4b16ea0801baf5c45",
      "commitAuthor": "Andrew Wang",
      "commitDateOld": "13/05/15 9:50 PM",
      "commitNameOld": "b2c85db86c9a62b0a03ee87547265077f664970a",
      "commitAuthorOld": "Haohui Mai",
      "daysBetweenCommits": 13.74,
      "commitsBetweenForRepo": 96,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,14 +1,14 @@\n   public void clearFile(ReclaimContext reclaimContext) {\n     if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n-      for (BlockInfoContiguous blk : blocks) {\n+      for (BlockInfo blk : blocks) {\n         reclaimContext.collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n     setBlocks(null);\n     if (getAclFeature() !\u003d null) {\n       AclStorage.removeAclFeature(getAclFeature());\n     }\n     clear();\n     reclaimContext.removedINodes.add(this);\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void clearFile(ReclaimContext reclaimContext) {\n    if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n      for (BlockInfo blk : blocks) {\n        reclaimContext.collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    setBlocks(null);\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    reclaimContext.removedINodes.add(this);\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
      "extendedDetails": {}
    },
    "9f2f583f401189c3f4a2687795a9e3e0b288322b": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-7749. Erasure Coding: Add striped block support in INodeFile. Contributed by Jing Zhao.\n",
      "commitDate": "26/05/15 11:07 AM",
      "commitName": "9f2f583f401189c3f4a2687795a9e3e0b288322b",
      "commitAuthor": "Jing Zhao",
      "commitDateOld": "26/05/15 11:03 AM",
      "commitNameOld": "bc2833b1c91e107d090619d755c584f6eae82327",
      "commitAuthorOld": "Zhe Zhang",
      "daysBetweenCommits": 0.0,
      "commitsBetweenForRepo": 8,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,14 +1,20 @@\n   public void clearFile(ReclaimContext reclaimContext) {\n-    if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n-      for (BlockInfoContiguous blk : blocks) {\n+    BlockInfo[] blks \u003d getBlocks();\n+    if (blks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n+      for (BlockInfo blk : blks) {\n         reclaimContext.collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n-    setBlocks(null);\n+    setContiguousBlocks(null);\n+\n+    FileWithStripedBlocksFeature sb \u003d getStripedBlocksFeature();\n+    if (sb !\u003d null) {\n+      sb.clear();\n+    }\n     if (getAclFeature() !\u003d null) {\n       AclStorage.removeAclFeature(getAclFeature());\n     }\n     clear();\n     reclaimContext.removedINodes.add(this);\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void clearFile(ReclaimContext reclaimContext) {\n    BlockInfo[] blks \u003d getBlocks();\n    if (blks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n      for (BlockInfo blk : blks) {\n        reclaimContext.collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    setContiguousBlocks(null);\n\n    FileWithStripedBlocksFeature sb \u003d getStripedBlocksFeature();\n    if (sb !\u003d null) {\n      sb.clear();\n    }\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    reclaimContext.removedINodes.add(this);\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
      "extendedDetails": {}
    },
    "b2c85db86c9a62b0a03ee87547265077f664970a": {
      "type": "Ymultichange(Yrename,Ybodychange)",
      "commitMessage": "HDFS-7728. Avoid updating quota usage while loading edits. Contributed by Jing Zhao.\n",
      "commitDate": "13/05/15 9:50 PM",
      "commitName": "b2c85db86c9a62b0a03ee87547265077f664970a",
      "commitAuthor": "Haohui Mai",
      "subchanges": [
        {
          "type": "Yrename",
          "commitMessage": "HDFS-7728. Avoid updating quota usage while loading edits. Contributed by Jing Zhao.\n",
          "commitDate": "13/05/15 9:50 PM",
          "commitName": "b2c85db86c9a62b0a03ee87547265077f664970a",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "12/05/15 6:29 AM",
          "commitNameOld": "6d5da9484185ca9f585195d6da069b9cd5be4044",
          "commitAuthorOld": "yliu",
          "daysBetweenCommits": 1.64,
          "commitsBetweenForRepo": 24,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,23 +1,14 @@\n-  public void destroyAndCollectBlocks(ReclaimContext reclaimContext) {\n+  public void clearFile(ReclaimContext reclaimContext) {\n     if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n       for (BlockInfoContiguous blk : blocks) {\n         reclaimContext.collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n     setBlocks(null);\n     if (getAclFeature() !\u003d null) {\n       AclStorage.removeAclFeature(getAclFeature());\n     }\n     clear();\n     reclaimContext.removedINodes.add(this);\n-    FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n-    if (sf !\u003d null) {\n-      sf.getDiffs().destroyAndCollectSnapshotBlocks(\n-          reclaimContext.collectedBlocks);\n-      sf.clearDiffs();\n-    }\n-    if (isUnderConstruction() \u0026\u0026 reclaimContext.removedUCFiles !\u003d null) {\n-      reclaimContext.removedUCFiles.add(getId());\n-    }\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public void clearFile(ReclaimContext reclaimContext) {\n    if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n      for (BlockInfoContiguous blk : blocks) {\n        reclaimContext.collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    setBlocks(null);\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    reclaimContext.removedINodes.add(this);\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
          "extendedDetails": {
            "oldValue": "destroyAndCollectBlocks",
            "newValue": "clearFile"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-7728. Avoid updating quota usage while loading edits. Contributed by Jing Zhao.\n",
          "commitDate": "13/05/15 9:50 PM",
          "commitName": "b2c85db86c9a62b0a03ee87547265077f664970a",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "12/05/15 6:29 AM",
          "commitNameOld": "6d5da9484185ca9f585195d6da069b9cd5be4044",
          "commitAuthorOld": "yliu",
          "daysBetweenCommits": 1.64,
          "commitsBetweenForRepo": 24,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,23 +1,14 @@\n-  public void destroyAndCollectBlocks(ReclaimContext reclaimContext) {\n+  public void clearFile(ReclaimContext reclaimContext) {\n     if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n       for (BlockInfoContiguous blk : blocks) {\n         reclaimContext.collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n     setBlocks(null);\n     if (getAclFeature() !\u003d null) {\n       AclStorage.removeAclFeature(getAclFeature());\n     }\n     clear();\n     reclaimContext.removedINodes.add(this);\n-    FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n-    if (sf !\u003d null) {\n-      sf.getDiffs().destroyAndCollectSnapshotBlocks(\n-          reclaimContext.collectedBlocks);\n-      sf.clearDiffs();\n-    }\n-    if (isUnderConstruction() \u0026\u0026 reclaimContext.removedUCFiles !\u003d null) {\n-      reclaimContext.removedUCFiles.add(getId());\n-    }\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public void clearFile(ReclaimContext reclaimContext) {\n    if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n      for (BlockInfoContiguous blk : blocks) {\n        reclaimContext.collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    setBlocks(null);\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    reclaimContext.removedINodes.add(this);\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
          "extendedDetails": {}
        }
      ]
    },
    "4536399d47f6c061e149e2504600804a0f1e093d": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HDFS-8357. Consolidate parameters of INode.CleanSubtree() into a parameter objects. Contributed by Li Lu.\n",
      "commitDate": "09/05/15 10:51 PM",
      "commitName": "4536399d47f6c061e149e2504600804a0f1e093d",
      "commitAuthor": "Haohui Mai",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-8357. Consolidate parameters of INode.CleanSubtree() into a parameter objects. Contributed by Li Lu.\n",
          "commitDate": "09/05/15 10:51 PM",
          "commitName": "4536399d47f6c061e149e2504600804a0f1e093d",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "08/05/15 11:09 PM",
          "commitNameOld": "02a4a22b9c0e22c2e7dd6ec85edd5c5a167fe19f",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 0.99,
          "commitsBetweenForRepo": 5,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,24 +1,23 @@\n-  public void destroyAndCollectBlocks(\n-      BlockStoragePolicySuite bsps, BlocksMapUpdateInfo collectedBlocks,\n-      final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n-    if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n+  public void destroyAndCollectBlocks(ReclaimContext reclaimContext) {\n+    if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n       for (BlockInfoContiguous blk : blocks) {\n-        collectedBlocks.addDeleteBlock(blk);\n+        reclaimContext.collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n     setBlocks(null);\n     if (getAclFeature() !\u003d null) {\n       AclStorage.removeAclFeature(getAclFeature());\n     }\n     clear();\n-    removedINodes.add(this);\n+    reclaimContext.removedINodes.add(this);\n     FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n     if (sf !\u003d null) {\n-      sf.getDiffs().destroyAndCollectSnapshotBlocks(collectedBlocks);\n+      sf.getDiffs().destroyAndCollectSnapshotBlocks(\n+          reclaimContext.collectedBlocks);\n       sf.clearDiffs();\n     }\n-    if (isUnderConstruction() \u0026\u0026 removedUCFiles !\u003d null) {\n-      removedUCFiles.add(getId());\n+    if (isUnderConstruction() \u0026\u0026 reclaimContext.removedUCFiles !\u003d null) {\n+      reclaimContext.removedUCFiles.add(getId());\n     }\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public void destroyAndCollectBlocks(ReclaimContext reclaimContext) {\n    if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n      for (BlockInfoContiguous blk : blocks) {\n        reclaimContext.collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    setBlocks(null);\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    reclaimContext.removedINodes.add(this);\n    FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n    if (sf !\u003d null) {\n      sf.getDiffs().destroyAndCollectSnapshotBlocks(\n          reclaimContext.collectedBlocks);\n      sf.clearDiffs();\n    }\n    if (isUnderConstruction() \u0026\u0026 reclaimContext.removedUCFiles !\u003d null) {\n      reclaimContext.removedUCFiles.add(getId());\n    }\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
          "extendedDetails": {
            "oldValue": "[bsps-BlockStoragePolicySuite, collectedBlocks-BlocksMapUpdateInfo, removedINodes-List\u003cINode\u003e(modifiers-final), removedUCFiles-List\u003cLong\u003e]",
            "newValue": "[reclaimContext-ReclaimContext]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-8357. Consolidate parameters of INode.CleanSubtree() into a parameter objects. Contributed by Li Lu.\n",
          "commitDate": "09/05/15 10:51 PM",
          "commitName": "4536399d47f6c061e149e2504600804a0f1e093d",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "08/05/15 11:09 PM",
          "commitNameOld": "02a4a22b9c0e22c2e7dd6ec85edd5c5a167fe19f",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 0.99,
          "commitsBetweenForRepo": 5,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,24 +1,23 @@\n-  public void destroyAndCollectBlocks(\n-      BlockStoragePolicySuite bsps, BlocksMapUpdateInfo collectedBlocks,\n-      final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n-    if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n+  public void destroyAndCollectBlocks(ReclaimContext reclaimContext) {\n+    if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n       for (BlockInfoContiguous blk : blocks) {\n-        collectedBlocks.addDeleteBlock(blk);\n+        reclaimContext.collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n     setBlocks(null);\n     if (getAclFeature() !\u003d null) {\n       AclStorage.removeAclFeature(getAclFeature());\n     }\n     clear();\n-    removedINodes.add(this);\n+    reclaimContext.removedINodes.add(this);\n     FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n     if (sf !\u003d null) {\n-      sf.getDiffs().destroyAndCollectSnapshotBlocks(collectedBlocks);\n+      sf.getDiffs().destroyAndCollectSnapshotBlocks(\n+          reclaimContext.collectedBlocks);\n       sf.clearDiffs();\n     }\n-    if (isUnderConstruction() \u0026\u0026 removedUCFiles !\u003d null) {\n-      removedUCFiles.add(getId());\n+    if (isUnderConstruction() \u0026\u0026 reclaimContext.removedUCFiles !\u003d null) {\n+      reclaimContext.removedUCFiles.add(getId());\n     }\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public void destroyAndCollectBlocks(ReclaimContext reclaimContext) {\n    if (blocks !\u003d null \u0026\u0026 reclaimContext.collectedBlocks !\u003d null) {\n      for (BlockInfoContiguous blk : blocks) {\n        reclaimContext.collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    setBlocks(null);\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    reclaimContext.removedINodes.add(this);\n    FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n    if (sf !\u003d null) {\n      sf.getDiffs().destroyAndCollectSnapshotBlocks(\n          reclaimContext.collectedBlocks);\n      sf.clearDiffs();\n    }\n    if (isUnderConstruction() \u0026\u0026 reclaimContext.removedUCFiles !\u003d null) {\n      reclaimContext.removedUCFiles.add(getId());\n    }\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
          "extendedDetails": {}
        }
      ]
    },
    "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HDFS-6757. Simplify lease manager with INodeID. Contributed by Haohui Mai.\n",
      "commitDate": "08/05/15 11:04 PM",
      "commitName": "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
      "commitAuthor": "Haohui Mai",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-6757. Simplify lease manager with INodeID. Contributed by Haohui Mai.\n",
          "commitDate": "08/05/15 11:04 PM",
          "commitName": "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "02/05/15 10:03 AM",
          "commitNameOld": "6ae2a0d048e133b43249c248a75a4d77d9abb80d",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 6.54,
          "commitsBetweenForRepo": 129,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,20 +1,24 @@\n-  public void destroyAndCollectBlocks(BlockStoragePolicySuite bsps,\n-      BlocksMapUpdateInfo collectedBlocks, final List\u003cINode\u003e removedINodes) {\n+  public void destroyAndCollectBlocks(\n+      BlockStoragePolicySuite bsps, BlocksMapUpdateInfo collectedBlocks,\n+      final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n     if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n       for (BlockInfoContiguous blk : blocks) {\n         collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n     setBlocks(null);\n     if (getAclFeature() !\u003d null) {\n       AclStorage.removeAclFeature(getAclFeature());\n     }\n     clear();\n     removedINodes.add(this);\n     FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n     if (sf !\u003d null) {\n       sf.getDiffs().destroyAndCollectSnapshotBlocks(collectedBlocks);\n       sf.clearDiffs();\n     }\n+    if (isUnderConstruction() \u0026\u0026 removedUCFiles !\u003d null) {\n+      removedUCFiles.add(getId());\n+    }\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public void destroyAndCollectBlocks(\n      BlockStoragePolicySuite bsps, BlocksMapUpdateInfo collectedBlocks,\n      final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n    if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n      for (BlockInfoContiguous blk : blocks) {\n        collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    setBlocks(null);\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    removedINodes.add(this);\n    FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n    if (sf !\u003d null) {\n      sf.getDiffs().destroyAndCollectSnapshotBlocks(collectedBlocks);\n      sf.clearDiffs();\n    }\n    if (isUnderConstruction() \u0026\u0026 removedUCFiles !\u003d null) {\n      removedUCFiles.add(getId());\n    }\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
          "extendedDetails": {
            "oldValue": "[bsps-BlockStoragePolicySuite, collectedBlocks-BlocksMapUpdateInfo, removedINodes-List\u003cINode\u003e(modifiers-final)]",
            "newValue": "[bsps-BlockStoragePolicySuite, collectedBlocks-BlocksMapUpdateInfo, removedINodes-List\u003cINode\u003e(modifiers-final), removedUCFiles-List\u003cLong\u003e]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-6757. Simplify lease manager with INodeID. Contributed by Haohui Mai.\n",
          "commitDate": "08/05/15 11:04 PM",
          "commitName": "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "02/05/15 10:03 AM",
          "commitNameOld": "6ae2a0d048e133b43249c248a75a4d77d9abb80d",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 6.54,
          "commitsBetweenForRepo": 129,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,20 +1,24 @@\n-  public void destroyAndCollectBlocks(BlockStoragePolicySuite bsps,\n-      BlocksMapUpdateInfo collectedBlocks, final List\u003cINode\u003e removedINodes) {\n+  public void destroyAndCollectBlocks(\n+      BlockStoragePolicySuite bsps, BlocksMapUpdateInfo collectedBlocks,\n+      final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n     if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n       for (BlockInfoContiguous blk : blocks) {\n         collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n     setBlocks(null);\n     if (getAclFeature() !\u003d null) {\n       AclStorage.removeAclFeature(getAclFeature());\n     }\n     clear();\n     removedINodes.add(this);\n     FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n     if (sf !\u003d null) {\n       sf.getDiffs().destroyAndCollectSnapshotBlocks(collectedBlocks);\n       sf.clearDiffs();\n     }\n+    if (isUnderConstruction() \u0026\u0026 removedUCFiles !\u003d null) {\n+      removedUCFiles.add(getId());\n+    }\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public void destroyAndCollectBlocks(\n      BlockStoragePolicySuite bsps, BlocksMapUpdateInfo collectedBlocks,\n      final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n    if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n      for (BlockInfoContiguous blk : blocks) {\n        collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    setBlocks(null);\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    removedINodes.add(this);\n    FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n    if (sf !\u003d null) {\n      sf.getDiffs().destroyAndCollectSnapshotBlocks(collectedBlocks);\n      sf.clearDiffs();\n    }\n    if (isUnderConstruction() \u0026\u0026 removedUCFiles !\u003d null) {\n      removedUCFiles.add(getId());\n    }\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
          "extendedDetails": {}
        }
      ]
    },
    "5dae97a584d30cef3e34141edfaca49c4ec57913": {
      "type": "Yparameterchange",
      "commitMessage": "HDFS-7723. Quota By Storage Type namenode implemenation. (Contributed by Xiaoyu Yao)\n",
      "commitDate": "11/02/15 10:41 AM",
      "commitName": "5dae97a584d30cef3e34141edfaca49c4ec57913",
      "commitAuthor": "Arpit Agarwal",
      "commitDateOld": "08/02/15 11:51 AM",
      "commitNameOld": "1382ae525c67bf95d8f3a436b547dbc72cfbb177",
      "commitAuthorOld": "Jing Zhao",
      "daysBetweenCommits": 2.95,
      "commitsBetweenForRepo": 40,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,20 +1,20 @@\n-  public void destroyAndCollectBlocks(BlocksMapUpdateInfo collectedBlocks,\n-      final List\u003cINode\u003e removedINodes) {\n+  public void destroyAndCollectBlocks(BlockStoragePolicySuite bsps,\n+      BlocksMapUpdateInfo collectedBlocks, final List\u003cINode\u003e removedINodes) {\n     if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n       for (BlockInfoContiguous blk : blocks) {\n         collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n     setBlocks(null);\n     if (getAclFeature() !\u003d null) {\n       AclStorage.removeAclFeature(getAclFeature());\n     }\n     clear();\n     removedINodes.add(this);\n     FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n     if (sf !\u003d null) {\n       sf.getDiffs().destroyAndCollectSnapshotBlocks(collectedBlocks);\n       sf.clearDiffs();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void destroyAndCollectBlocks(BlockStoragePolicySuite bsps,\n      BlocksMapUpdateInfo collectedBlocks, final List\u003cINode\u003e removedINodes) {\n    if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n      for (BlockInfoContiguous blk : blocks) {\n        collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    setBlocks(null);\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    removedINodes.add(this);\n    FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n    if (sf !\u003d null) {\n      sf.getDiffs().destroyAndCollectSnapshotBlocks(collectedBlocks);\n      sf.clearDiffs();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
      "extendedDetails": {
        "oldValue": "[collectedBlocks-BlocksMapUpdateInfo, removedINodes-List\u003cINode\u003e(modifiers-final)]",
        "newValue": "[bsps-BlockStoragePolicySuite, collectedBlocks-BlocksMapUpdateInfo, removedINodes-List\u003cINode\u003e(modifiers-final)]"
      }
    },
    "1382ae525c67bf95d8f3a436b547dbc72cfbb177": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-7743. Code cleanup of BlockInfo and rename BlockInfo to BlockInfoContiguous. Contributed by Jing Zhao.\n",
      "commitDate": "08/02/15 11:51 AM",
      "commitName": "1382ae525c67bf95d8f3a436b547dbc72cfbb177",
      "commitAuthor": "Jing Zhao",
      "commitDateOld": "02/02/15 4:32 PM",
      "commitNameOld": "8cb473124c1cf1c6f68ead7bde06558ebf7ce47e",
      "commitAuthorOld": "Haohui Mai",
      "daysBetweenCommits": 5.8,
      "commitsBetweenForRepo": 69,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,20 +1,20 @@\n   public void destroyAndCollectBlocks(BlocksMapUpdateInfo collectedBlocks,\n       final List\u003cINode\u003e removedINodes) {\n     if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n-      for (BlockInfo blk : blocks) {\n+      for (BlockInfoContiguous blk : blocks) {\n         collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n     setBlocks(null);\n     if (getAclFeature() !\u003d null) {\n       AclStorage.removeAclFeature(getAclFeature());\n     }\n     clear();\n     removedINodes.add(this);\n     FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n     if (sf !\u003d null) {\n       sf.getDiffs().destroyAndCollectSnapshotBlocks(collectedBlocks);\n       sf.clearDiffs();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void destroyAndCollectBlocks(BlocksMapUpdateInfo collectedBlocks,\n      final List\u003cINode\u003e removedINodes) {\n    if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n      for (BlockInfoContiguous blk : blocks) {\n        collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    setBlocks(null);\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    removedINodes.add(this);\n    FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n    if (sf !\u003d null) {\n      sf.getDiffs().destroyAndCollectSnapshotBlocks(collectedBlocks);\n      sf.clearDiffs();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
      "extendedDetails": {}
    },
    "08ac06283a3e9bf0d49d873823aabd419b08e41f": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-7056. Snapshot support for truncate. Contributed by Konstantin Shvachko and Plamen Jeliazkov.",
      "commitDate": "13/01/15 12:24 AM",
      "commitName": "08ac06283a3e9bf0d49d873823aabd419b08e41f",
      "commitAuthor": "Konstantin V Shvachko",
      "commitDateOld": "12/01/15 10:50 PM",
      "commitNameOld": "7e9358feb326d48b8c4f00249e7af5023cebd2e2",
      "commitAuthorOld": "Plamen Jeliazkov",
      "daysBetweenCommits": 0.07,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,20 +1,20 @@\n   public void destroyAndCollectBlocks(BlocksMapUpdateInfo collectedBlocks,\n       final List\u003cINode\u003e removedINodes) {\n     if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n       for (BlockInfo blk : blocks) {\n         collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n     setBlocks(null);\n     if (getAclFeature() !\u003d null) {\n       AclStorage.removeAclFeature(getAclFeature());\n     }\n     clear();\n     removedINodes.add(this);\n-    \n     FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n     if (sf !\u003d null) {\n+      sf.getDiffs().destroyAndCollectSnapshotBlocks(collectedBlocks);\n       sf.clearDiffs();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void destroyAndCollectBlocks(BlocksMapUpdateInfo collectedBlocks,\n      final List\u003cINode\u003e removedINodes) {\n    if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n      for (BlockInfo blk : blocks) {\n        collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    setBlocks(null);\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    removedINodes.add(this);\n    FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n    if (sf !\u003d null) {\n      sf.getDiffs().destroyAndCollectSnapshotBlocks(collectedBlocks);\n      sf.clearDiffs();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
      "extendedDetails": {}
    },
    "50ae1a6664a92619aa683d2a864d0da9fb4af026": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-7456. De-duplicate AclFeature instances with same AclEntries do reduce memory footprint of NameNode (Contributed by Vinayakumar B)\n",
      "commitDate": "22/12/14 11:05 PM",
      "commitName": "50ae1a6664a92619aa683d2a864d0da9fb4af026",
      "commitAuthor": "Vinayakumar B",
      "commitDateOld": "26/11/14 10:37 AM",
      "commitNameOld": "f5b163117986886eaba8a0cc255ec741dd14c4c6",
      "commitAuthorOld": "Haohui Mai",
      "daysBetweenCommits": 26.52,
      "commitsBetweenForRepo": 185,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,17 +1,20 @@\n   public void destroyAndCollectBlocks(BlocksMapUpdateInfo collectedBlocks,\n       final List\u003cINode\u003e removedINodes) {\n     if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n       for (BlockInfo blk : blocks) {\n         collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n     setBlocks(null);\n+    if (getAclFeature() !\u003d null) {\n+      AclStorage.removeAclFeature(getAclFeature());\n+    }\n     clear();\n     removedINodes.add(this);\n     \n     FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n     if (sf !\u003d null) {\n       sf.clearDiffs();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void destroyAndCollectBlocks(BlocksMapUpdateInfo collectedBlocks,\n      final List\u003cINode\u003e removedINodes) {\n    if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n      for (BlockInfo blk : blocks) {\n        collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    setBlocks(null);\n    if (getAclFeature() !\u003d null) {\n      AclStorage.removeAclFeature(getAclFeature());\n    }\n    clear();\n    removedINodes.add(this);\n    \n    FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n    if (sf !\u003d null) {\n      sf.clearDiffs();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
      "extendedDetails": {}
    },
    "4c87a27ad851ffaa3cc3e2074a9ef7073b5a164a": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-5554. Flatten INodeFile hierarchy: Replace INodeFileWithSnapshot with FileWithSnapshotFeature.  Contributed by jing9\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1548796 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "06/12/13 10:17 PM",
      "commitName": "4c87a27ad851ffaa3cc3e2074a9ef7073b5a164a",
      "commitAuthor": "Tsz-wo Sze",
      "commitDateOld": "27/11/13 12:32 PM",
      "commitNameOld": "8df119da214babde03e73243c7ca4cfe6d0ca562",
      "commitAuthorOld": "Tsz-wo Sze",
      "daysBetweenCommits": 9.41,
      "commitsBetweenForRepo": 53,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,16 +1,17 @@\n   public void destroyAndCollectBlocks(BlocksMapUpdateInfo collectedBlocks,\n       final List\u003cINode\u003e removedINodes) {\n     if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n       for (BlockInfo blk : blocks) {\n         collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n     setBlocks(null);\n     clear();\n     removedINodes.add(this);\n     \n-    if (this instanceof INodeFileWithSnapshot) {\n-      ((INodeFileWithSnapshot) this).getDiffs().clear();\n+    FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n+    if (sf !\u003d null) {\n+      sf.clearDiffs();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void destroyAndCollectBlocks(BlocksMapUpdateInfo collectedBlocks,\n      final List\u003cINode\u003e removedINodes) {\n    if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n      for (BlockInfo blk : blocks) {\n        collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    setBlocks(null);\n    clear();\n    removedINodes.add(this);\n    \n    FileWithSnapshotFeature sf \u003d getFileWithSnapshotFeature();\n    if (sf !\u003d null) {\n      sf.clearDiffs();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
      "extendedDetails": {}
    },
    "8df119da214babde03e73243c7ca4cfe6d0ca562": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-5537. Remove FileWithSnapshot interface.  Contributed by jing9\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1546184 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "27/11/13 12:32 PM",
      "commitName": "8df119da214babde03e73243c7ca4cfe6d0ca562",
      "commitAuthor": "Tsz-wo Sze",
      "commitDateOld": "26/11/13 10:33 AM",
      "commitNameOld": "82ff2d3f2e569879500d851f4d67dfa2d02b5c9b",
      "commitAuthorOld": "Tsz-wo Sze",
      "daysBetweenCommits": 1.08,
      "commitsBetweenForRepo": 6,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,16 +1,16 @@\n   public void destroyAndCollectBlocks(BlocksMapUpdateInfo collectedBlocks,\n       final List\u003cINode\u003e removedINodes) {\n     if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n       for (BlockInfo blk : blocks) {\n         collectedBlocks.addDeleteBlock(blk);\n         blk.setBlockCollection(null);\n       }\n     }\n     setBlocks(null);\n     clear();\n     removedINodes.add(this);\n     \n-    if (this instanceof FileWithSnapshot) {\n-      ((FileWithSnapshot) this).getDiffs().clear();\n+    if (this instanceof INodeFileWithSnapshot) {\n+      ((INodeFileWithSnapshot) this).getDiffs().clear();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void destroyAndCollectBlocks(BlocksMapUpdateInfo collectedBlocks,\n      final List\u003cINode\u003e removedINodes) {\n    if (blocks !\u003d null \u0026\u0026 collectedBlocks !\u003d null) {\n      for (BlockInfo blk : blocks) {\n        collectedBlocks.addDeleteBlock(blk);\n        blk.setBlockCollection(null);\n      }\n    }\n    setBlocks(null);\n    clear();\n    removedINodes.add(this);\n    \n    if (this instanceof INodeFileWithSnapshot) {\n      ((INodeFileWithSnapshot) this).getDiffs().clear();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/INodeFile.java",
      "extendedDetails": {}
    }
  }
}