{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "FSDirStatAndListingOp.java",
  "functionName": "getQuotaUsageInt",
  "functionId": "getQuotaUsageInt___fsd-FSDirectory__iip-INodesInPath",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirStatAndListingOp.java",
  "functionStartLine": 554,
  "functionEndLine": 583,
  "numCommitsSeen": 61,
  "timeTaken": 2553,
  "changeHistory": [
    "b09828145432c8d986ac8f05ec33608d8e611328",
    "2fd19b9674420e025af54a5bed12eb96478f8c48"
  ],
  "changeHistoryShort": {
    "b09828145432c8d986ac8f05ec33608d8e611328": "Ybodychange",
    "2fd19b9674420e025af54a5bed12eb96478f8c48": "Yintroduced"
  },
  "changeHistoryDetails": {
    "b09828145432c8d986ac8f05ec33608d8e611328": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-13816. dfs.getQuotaUsage() throws NPE on non-existent dir instead of FileNotFoundException. Contributed by Vinayakumar B.\n",
      "commitDate": "26/11/18 4:52 AM",
      "commitName": "b09828145432c8d986ac8f05ec33608d8e611328",
      "commitAuthor": "Vinayakumar B",
      "commitDateOld": "12/08/18 3:06 AM",
      "commitNameOld": "4402f3f8557527d5c6cdad6f5bdcbd707b8cbf52",
      "commitAuthorOld": "Uma Maheswara Rao G",
      "daysBetweenCommits": 106.12,
      "commitsBetweenForRepo": 913,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,26 +1,30 @@\n   private static QuotaUsage getQuotaUsageInt(FSDirectory fsd, INodesInPath iip)\n     throws IOException {\n     fsd.readLock();\n     try {\n       INode targetNode \u003d iip.getLastINode();\n+      if (targetNode \u003d\u003d null) {\n+        throw new FileNotFoundException(\n+            \"File/Directory does not exist: \" + iip.getPath());\n+      }\n       QuotaUsage usage \u003d null;\n       if (targetNode.isDirectory()) {\n         DirectoryWithQuotaFeature feature \u003d\n             targetNode.asDirectory().getDirectoryWithQuotaFeature();\n         if (feature !\u003d null) {\n           QuotaCounts counts \u003d feature.getSpaceConsumed();\n           QuotaCounts quotas \u003d feature.getQuota();\n           usage \u003d new QuotaUsage.Builder().\n               fileAndDirectoryCount(counts.getNameSpace()).\n               quota(quotas.getNameSpace()).\n               spaceConsumed(counts.getStorageSpace()).\n               spaceQuota(quotas.getStorageSpace()).\n               typeConsumed(counts.getTypeSpaces().asArray()).\n               typeQuota(quotas.getTypeSpaces().asArray()).build();\n         }\n       }\n       return usage;\n     } finally {\n       fsd.readUnlock();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private static QuotaUsage getQuotaUsageInt(FSDirectory fsd, INodesInPath iip)\n    throws IOException {\n    fsd.readLock();\n    try {\n      INode targetNode \u003d iip.getLastINode();\n      if (targetNode \u003d\u003d null) {\n        throw new FileNotFoundException(\n            \"File/Directory does not exist: \" + iip.getPath());\n      }\n      QuotaUsage usage \u003d null;\n      if (targetNode.isDirectory()) {\n        DirectoryWithQuotaFeature feature \u003d\n            targetNode.asDirectory().getDirectoryWithQuotaFeature();\n        if (feature !\u003d null) {\n          QuotaCounts counts \u003d feature.getSpaceConsumed();\n          QuotaCounts quotas \u003d feature.getQuota();\n          usage \u003d new QuotaUsage.Builder().\n              fileAndDirectoryCount(counts.getNameSpace()).\n              quota(quotas.getNameSpace()).\n              spaceConsumed(counts.getStorageSpace()).\n              spaceQuota(quotas.getStorageSpace()).\n              typeConsumed(counts.getTypeSpaces().asArray()).\n              typeQuota(quotas.getTypeSpaces().asArray()).build();\n        }\n      }\n      return usage;\n    } finally {\n      fsd.readUnlock();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirStatAndListingOp.java",
      "extendedDetails": {}
    },
    "2fd19b9674420e025af54a5bed12eb96478f8c48": {
      "type": "Yintroduced",
      "commitMessage": "HDFS-8898. Create API and command-line argument to get quota and quota usage without detailed content summary. Contributed by Ming Ma.\n",
      "commitDate": "22/01/16 7:10 AM",
      "commitName": "2fd19b9674420e025af54a5bed12eb96478f8c48",
      "commitAuthor": "Kihwal Lee",
      "diff": "@@ -0,0 +1,26 @@\n+  private static QuotaUsage getQuotaUsageInt(FSDirectory fsd, INodesInPath iip)\n+    throws IOException {\n+    fsd.readLock();\n+    try {\n+      INode targetNode \u003d iip.getLastINode();\n+      QuotaUsage usage \u003d null;\n+      if (targetNode.isDirectory()) {\n+        DirectoryWithQuotaFeature feature \u003d\n+            targetNode.asDirectory().getDirectoryWithQuotaFeature();\n+        if (feature !\u003d null) {\n+          QuotaCounts counts \u003d feature.getSpaceConsumed();\n+          QuotaCounts quotas \u003d feature.getQuota();\n+          usage \u003d new QuotaUsage.Builder().\n+              fileAndDirectoryCount(counts.getNameSpace()).\n+              quota(quotas.getNameSpace()).\n+              spaceConsumed(counts.getStorageSpace()).\n+              spaceQuota(quotas.getStorageSpace()).\n+              typeConsumed(counts.getTypeSpaces().asArray()).\n+              typeQuota(quotas.getTypeSpaces().asArray()).build();\n+        }\n+      }\n+      return usage;\n+    } finally {\n+      fsd.readUnlock();\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private static QuotaUsage getQuotaUsageInt(FSDirectory fsd, INodesInPath iip)\n    throws IOException {\n    fsd.readLock();\n    try {\n      INode targetNode \u003d iip.getLastINode();\n      QuotaUsage usage \u003d null;\n      if (targetNode.isDirectory()) {\n        DirectoryWithQuotaFeature feature \u003d\n            targetNode.asDirectory().getDirectoryWithQuotaFeature();\n        if (feature !\u003d null) {\n          QuotaCounts counts \u003d feature.getSpaceConsumed();\n          QuotaCounts quotas \u003d feature.getQuota();\n          usage \u003d new QuotaUsage.Builder().\n              fileAndDirectoryCount(counts.getNameSpace()).\n              quota(quotas.getNameSpace()).\n              spaceConsumed(counts.getStorageSpace()).\n              spaceQuota(quotas.getStorageSpace()).\n              typeConsumed(counts.getTypeSpaces().asArray()).\n              typeQuota(quotas.getTypeSpaces().asArray()).build();\n        }\n      }\n      return usage;\n    } finally {\n      fsd.readUnlock();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSDirStatAndListingOp.java"
    }
  }
}