{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "NativeAzureFileSystem.java",
  "functionName": "performStickyBitCheckForRenameOperation",
  "functionId": "performStickyBitCheckForRenameOperation___srcPath-Path__srcParentPath-Path",
  "sourceFilePath": "hadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azure/NativeAzureFileSystem.java",
  "functionStartLine": 3412,
  "functionEndLine": 3438,
  "numCommitsSeen": 66,
  "timeTaken": 1443,
  "changeHistory": [
    "3de574413c4d5554213d02bd0ad343ba82cf82aa"
  ],
  "changeHistoryShort": {
    "3de574413c4d5554213d02bd0ad343ba82cf82aa": "Yintroduced"
  },
  "changeHistoryDetails": {
    "3de574413c4d5554213d02bd0ad343ba82cf82aa": {
      "type": "Yintroduced",
      "commitMessage": "HADOOP-14913. Sticky bit implementation for rename() operation in Azure WASB.\nContributed by Varada Hemeswari.\n",
      "commitDate": "11/10/17 10:06 AM",
      "commitName": "3de574413c4d5554213d02bd0ad343ba82cf82aa",
      "commitAuthor": "Steve Loughran",
      "diff": "@@ -0,0 +1,27 @@\n+  private void performStickyBitCheckForRenameOperation(Path srcPath,\n+      Path srcParentPath)\n+    throws FileNotFoundException, WasbAuthorizationException, IOException {\n+\n+    String srcKey \u003d pathToKey(srcPath);\n+    FileMetadata srcMetadata \u003d null;\n+    srcMetadata \u003d store.retrieveMetadata(srcKey);\n+    if (srcMetadata \u003d\u003d null) {\n+      LOG.debug(\"Source {} doesn\u0027t exist. Failing rename.\", srcPath);\n+      throw new FileNotFoundException(\n+        String.format(\"%s does not exist.\", srcPath));\n+    }\n+\n+    String parentkey \u003d pathToKey(srcParentPath);\n+    FileMetadata parentMetadata \u003d store.retrieveMetadata(parentkey);\n+    if (parentMetadata \u003d\u003d null) {\n+      LOG.debug(\"Path {} doesn\u0027t exist, failing rename.\", srcParentPath);\n+      throw new FileNotFoundException(\n+        String.format(\"%s does not exist.\", parentkey));\n+    }\n+\n+    if (isStickyBitCheckViolated(srcMetadata, parentMetadata)) {\n+      throw new WasbAuthorizationException(\n+        String.format(\"Rename operation for %s is not permitted.\"\n+        + \" Details : Stickybit check failed.\", srcPath));\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private void performStickyBitCheckForRenameOperation(Path srcPath,\n      Path srcParentPath)\n    throws FileNotFoundException, WasbAuthorizationException, IOException {\n\n    String srcKey \u003d pathToKey(srcPath);\n    FileMetadata srcMetadata \u003d null;\n    srcMetadata \u003d store.retrieveMetadata(srcKey);\n    if (srcMetadata \u003d\u003d null) {\n      LOG.debug(\"Source {} doesn\u0027t exist. Failing rename.\", srcPath);\n      throw new FileNotFoundException(\n        String.format(\"%s does not exist.\", srcPath));\n    }\n\n    String parentkey \u003d pathToKey(srcParentPath);\n    FileMetadata parentMetadata \u003d store.retrieveMetadata(parentkey);\n    if (parentMetadata \u003d\u003d null) {\n      LOG.debug(\"Path {} doesn\u0027t exist, failing rename.\", srcParentPath);\n      throw new FileNotFoundException(\n        String.format(\"%s does not exist.\", parentkey));\n    }\n\n    if (isStickyBitCheckViolated(srcMetadata, parentMetadata)) {\n      throw new WasbAuthorizationException(\n        String.format(\"Rename operation for %s is not permitted.\"\n        + \" Details : Stickybit check failed.\", srcPath));\n    }\n  }",
      "path": "hadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azure/NativeAzureFileSystem.java"
    }
  }
}