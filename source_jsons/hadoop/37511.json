{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "ResourceManager.java",
  "functionName": "handleTransitionToStandByInNewThread",
  "functionId": "handleTransitionToStandByInNewThread",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/ResourceManager.java",
  "functionStartLine": 1011,
  "functionEndLine": 1016,
  "numCommitsSeen": 328,
  "timeTaken": 5214,
  "changeHistory": [
    "166be0ee95d5ef976f074342656b289b41a11ccd",
    "652679aa8ad6f9e61b8ed8e2b04b3e0332025e94",
    "a6410a542e59acd9827457df4a257a843f785c29",
    "89022f8d4bac0e9d0b848fd91e9c4d700fe1cdbe",
    "395275af8622c780b9071c243422b0780e096202"
  ],
  "changeHistoryShort": {
    "166be0ee95d5ef976f074342656b289b41a11ccd": "Ymodifierchange",
    "652679aa8ad6f9e61b8ed8e2b04b3e0332025e94": "Ymultichange(Yrename,Ybodychange)",
    "a6410a542e59acd9827457df4a257a843f785c29": "Ybodychange",
    "89022f8d4bac0e9d0b848fd91e9c4d700fe1cdbe": "Ybodychange",
    "395275af8622c780b9071c243422b0780e096202": "Yintroduced"
  },
  "changeHistoryDetails": {
    "166be0ee95d5ef976f074342656b289b41a11ccd": {
      "type": "Ymodifierchange",
      "commitMessage": "YARN-3742. YARN RM will shut down if ZKClient creation times out. (Daniel Templeton via kasha)\n",
      "commitDate": "09/05/17 2:44 PM",
      "commitName": "166be0ee95d5ef976f074342656b289b41a11ccd",
      "commitAuthor": "Karthik Kambatla",
      "commitDateOld": "19/04/17 11:44 AM",
      "commitNameOld": "dd43b895c2e50fa97cb7327be77509b87dad1823",
      "commitAuthorOld": "Daniel Templeton",
      "daysBetweenCommits": 20.12,
      "commitsBetweenForRepo": 111,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,6 +1,6 @@\n-  public void handleTransitionToStandByInNewThread() {\n+  private void handleTransitionToStandByInNewThread() {\n     Thread standByTransitionThread \u003d\n         new Thread(activeServices.standByTransitionRunnable);\n     standByTransitionThread.setName(\"StandByTransitionThread\");\n     standByTransitionThread.start();\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private void handleTransitionToStandByInNewThread() {\n    Thread standByTransitionThread \u003d\n        new Thread(activeServices.standByTransitionRunnable);\n    standByTransitionThread.setName(\"StandByTransitionThread\");\n    standByTransitionThread.start();\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/ResourceManager.java",
      "extendedDetails": {
        "oldValue": "[public]",
        "newValue": "[private]"
      }
    },
    "652679aa8ad6f9e61b8ed8e2b04b3e0332025e94": {
      "type": "Ymultichange(Yrename,Ybodychange)",
      "commitMessage": "YARN-6061. Add an UncaughtExceptionHandler for critical threads in RM. (Yufei Gu via kasha)\n",
      "commitDate": "14/02/17 1:39 PM",
      "commitName": "652679aa8ad6f9e61b8ed8e2b04b3e0332025e94",
      "commitAuthor": "Karthik Kambatla",
      "subchanges": [
        {
          "type": "Yrename",
          "commitMessage": "YARN-6061. Add an UncaughtExceptionHandler for critical threads in RM. (Yufei Gu via kasha)\n",
          "commitDate": "14/02/17 1:39 PM",
          "commitName": "652679aa8ad6f9e61b8ed8e2b04b3e0332025e94",
          "commitAuthor": "Karthik Kambatla",
          "commitDateOld": "11/01/17 5:10 PM",
          "commitNameOld": "a6b06f71797ad1ed9edbcef279bcf7d9e569f955",
          "commitAuthorOld": "Naganarasimha",
          "daysBetweenCommits": 33.85,
          "commitsBetweenForRepo": 150,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,16 +1,6 @@\n-  public void handleTransitionToStandBy() {\n-    if (rmContext.isHAEnabled()) {\n-      try {\n-        // Transition to standby and reinit active services\n-        LOG.info(\"Transitioning RM to Standby mode\");\n-        transitionToStandby(true);\n-        EmbeddedElector elector \u003d rmContext.getLeaderElectorService();\n-        if (elector !\u003d null) {\n-          elector.rejoinElection();\n-        }\n-      } catch (Exception e) {\n-        LOG.fatal(\"Failed to transition RM to Standby mode.\", e);\n-        ExitUtil.terminate(1, e);\n-      }\n-    }\n+  public void handleTransitionToStandByInNewThread() {\n+    Thread standByTransitionThread \u003d\n+        new Thread(activeServices.standByTransitionRunnable);\n+    standByTransitionThread.setName(\"StandByTransitionThread\");\n+    standByTransitionThread.start();\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public void handleTransitionToStandByInNewThread() {\n    Thread standByTransitionThread \u003d\n        new Thread(activeServices.standByTransitionRunnable);\n    standByTransitionThread.setName(\"StandByTransitionThread\");\n    standByTransitionThread.start();\n  }",
          "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/ResourceManager.java",
          "extendedDetails": {
            "oldValue": "handleTransitionToStandBy",
            "newValue": "handleTransitionToStandByInNewThread"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "YARN-6061. Add an UncaughtExceptionHandler for critical threads in RM. (Yufei Gu via kasha)\n",
          "commitDate": "14/02/17 1:39 PM",
          "commitName": "652679aa8ad6f9e61b8ed8e2b04b3e0332025e94",
          "commitAuthor": "Karthik Kambatla",
          "commitDateOld": "11/01/17 5:10 PM",
          "commitNameOld": "a6b06f71797ad1ed9edbcef279bcf7d9e569f955",
          "commitAuthorOld": "Naganarasimha",
          "daysBetweenCommits": 33.85,
          "commitsBetweenForRepo": 150,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,16 +1,6 @@\n-  public void handleTransitionToStandBy() {\n-    if (rmContext.isHAEnabled()) {\n-      try {\n-        // Transition to standby and reinit active services\n-        LOG.info(\"Transitioning RM to Standby mode\");\n-        transitionToStandby(true);\n-        EmbeddedElector elector \u003d rmContext.getLeaderElectorService();\n-        if (elector !\u003d null) {\n-          elector.rejoinElection();\n-        }\n-      } catch (Exception e) {\n-        LOG.fatal(\"Failed to transition RM to Standby mode.\", e);\n-        ExitUtil.terminate(1, e);\n-      }\n-    }\n+  public void handleTransitionToStandByInNewThread() {\n+    Thread standByTransitionThread \u003d\n+        new Thread(activeServices.standByTransitionRunnable);\n+    standByTransitionThread.setName(\"StandByTransitionThread\");\n+    standByTransitionThread.start();\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public void handleTransitionToStandByInNewThread() {\n    Thread standByTransitionThread \u003d\n        new Thread(activeServices.standByTransitionRunnable);\n    standByTransitionThread.setName(\"StandByTransitionThread\");\n    standByTransitionThread.start();\n  }",
          "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/ResourceManager.java",
          "extendedDetails": {}
        }
      ]
    },
    "a6410a542e59acd9827457df4a257a843f785c29": {
      "type": "Ybodychange",
      "commitMessage": "YARN-5709. Cleanup leader election configs and pluggability. Contribtued by Karthik Kambatla\n",
      "commitDate": "09/12/16 5:00 PM",
      "commitName": "a6410a542e59acd9827457df4a257a843f785c29",
      "commitAuthor": "Jian He",
      "commitDateOld": "14/11/16 9:28 PM",
      "commitNameOld": "b7070f3308fc4c6a8a9a25021562169cae87d223",
      "commitAuthorOld": "Rohith Sharma K S",
      "daysBetweenCommits": 24.81,
      "commitsBetweenForRepo": 166,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,18 +1,16 @@\n   public void handleTransitionToStandBy() {\n     if (rmContext.isHAEnabled()) {\n       try {\n         // Transition to standby and reinit active services\n         LOG.info(\"Transitioning RM to Standby mode\");\n         transitionToStandby(true);\n-        if (curatorEnabled) {\n-          rmContext.getLeaderElectorService().reJoinElection();\n-        } else {\n-          adminService.resetLeaderElection();\n+        EmbeddedElector elector \u003d rmContext.getLeaderElectorService();\n+        if (elector !\u003d null) {\n+          elector.rejoinElection();\n         }\n-        return;\n       } catch (Exception e) {\n-        LOG.fatal(\"Failed to transition RM to Standby mode.\");\n+        LOG.fatal(\"Failed to transition RM to Standby mode.\", e);\n         ExitUtil.terminate(1, e);\n       }\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void handleTransitionToStandBy() {\n    if (rmContext.isHAEnabled()) {\n      try {\n        // Transition to standby and reinit active services\n        LOG.info(\"Transitioning RM to Standby mode\");\n        transitionToStandby(true);\n        EmbeddedElector elector \u003d rmContext.getLeaderElectorService();\n        if (elector !\u003d null) {\n          elector.rejoinElection();\n        }\n      } catch (Exception e) {\n        LOG.fatal(\"Failed to transition RM to Standby mode.\", e);\n        ExitUtil.terminate(1, e);\n      }\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/ResourceManager.java",
      "extendedDetails": {}
    },
    "89022f8d4bac0e9d0b848fd91e9c4d700fe1cdbe": {
      "type": "Ybodychange",
      "commitMessage": "YARN-4438. Implement RM leader election with curator. Contributed by Jian He\n",
      "commitDate": "07/01/16 2:33 PM",
      "commitName": "89022f8d4bac0e9d0b848fd91e9c4d700fe1cdbe",
      "commitAuthor": "Xuan",
      "commitDateOld": "29/12/15 3:58 PM",
      "commitNameOld": "52734134116eb4b18686e308d00e71e7e903383e",
      "commitAuthorOld": "Jian He",
      "daysBetweenCommits": 8.94,
      "commitsBetweenForRepo": 40,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,14 +1,18 @@\n   public void handleTransitionToStandBy() {\n     if (rmContext.isHAEnabled()) {\n       try {\n         // Transition to standby and reinit active services\n         LOG.info(\"Transitioning RM to Standby mode\");\n         transitionToStandby(true);\n-        adminService.resetLeaderElection();\n+        if (curatorEnabled) {\n+          rmContext.getLeaderElectorService().reJoinElection();\n+        } else {\n+          adminService.resetLeaderElection();\n+        }\n         return;\n       } catch (Exception e) {\n         LOG.fatal(\"Failed to transition RM to Standby mode.\");\n         ExitUtil.terminate(1, e);\n       }\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void handleTransitionToStandBy() {\n    if (rmContext.isHAEnabled()) {\n      try {\n        // Transition to standby and reinit active services\n        LOG.info(\"Transitioning RM to Standby mode\");\n        transitionToStandby(true);\n        if (curatorEnabled) {\n          rmContext.getLeaderElectorService().reJoinElection();\n        } else {\n          adminService.resetLeaderElection();\n        }\n        return;\n      } catch (Exception e) {\n        LOG.fatal(\"Failed to transition RM to Standby mode.\");\n        ExitUtil.terminate(1, e);\n      }\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/ResourceManager.java",
      "extendedDetails": {}
    },
    "395275af8622c780b9071c243422b0780e096202": {
      "type": "Yintroduced",
      "commitMessage": "YARN-2579. Fixed a deadlock issue when EmbeddedElectorService and FatalEventDispatcher try to transition RM to StandBy at the same time. Contributed by Rohith Sharmaks\n",
      "commitDate": "05/11/14 4:59 PM",
      "commitName": "395275af8622c780b9071c243422b0780e096202",
      "commitAuthor": "Jian He",
      "diff": "@@ -0,0 +1,14 @@\n+  public void handleTransitionToStandBy() {\n+    if (rmContext.isHAEnabled()) {\n+      try {\n+        // Transition to standby and reinit active services\n+        LOG.info(\"Transitioning RM to Standby mode\");\n+        transitionToStandby(true);\n+        adminService.resetLeaderElection();\n+        return;\n+      } catch (Exception e) {\n+        LOG.fatal(\"Failed to transition RM to Standby mode.\");\n+        ExitUtil.terminate(1, e);\n+      }\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  public void handleTransitionToStandBy() {\n    if (rmContext.isHAEnabled()) {\n      try {\n        // Transition to standby and reinit active services\n        LOG.info(\"Transitioning RM to Standby mode\");\n        transitionToStandby(true);\n        adminService.resetLeaderElection();\n        return;\n      } catch (Exception e) {\n        LOG.fatal(\"Failed to transition RM to Standby mode.\");\n        ExitUtil.terminate(1, e);\n      }\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/ResourceManager.java"
    }
  }
}