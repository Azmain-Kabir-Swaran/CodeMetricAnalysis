{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "FileUtil.java",
  "functionName": "unTarUsingJava",
  "functionId": "unTarUsingJava___inFile-File__untarDir-File__gzipped-boolean",
  "sourceFilePath": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java",
  "functionStartLine": 918,
  "functionEndLine": 941,
  "numCommitsSeen": 52,
  "timeTaken": 3231,
  "changeHistory": [
    "7a3188d054481b9bd563e337901e93476303ce7f",
    "57198bc51122a36db8cb4788fcb7b55edc788b3b",
    "460d77bd646d03d3eb7670f9017aeeb5410c4a95",
    "ccaf036662e22da14583942054898c99fa51dae5",
    "3628553736b148f7be8b13d2e629b1c0c3806f6b",
    "71a57ded39a605166d616fe68f36017cdb0abe3e"
  ],
  "changeHistoryShort": {
    "7a3188d054481b9bd563e337901e93476303ce7f": "Ybodychange",
    "57198bc51122a36db8cb4788fcb7b55edc788b3b": "Ybodychange",
    "460d77bd646d03d3eb7670f9017aeeb5410c4a95": "Ymodifierchange",
    "ccaf036662e22da14583942054898c99fa51dae5": "Ybodychange",
    "3628553736b148f7be8b13d2e629b1c0c3806f6b": "Ybodychange",
    "71a57ded39a605166d616fe68f36017cdb0abe3e": "Yintroduced"
  },
  "changeHistoryDetails": {
    "7a3188d054481b9bd563e337901e93476303ce7f": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-16282. Avoid FileStream to improve performance. Contributed by Ayush Saxena.\n",
      "commitDate": "02/05/19 12:58 PM",
      "commitName": "7a3188d054481b9bd563e337901e93476303ce7f",
      "commitAuthor": "Giovanni Matteo Fumarola",
      "commitDateOld": "11/01/19 10:54 AM",
      "commitNameOld": "fb8932a727f757b2e9c1c61a18145878d0eb77bd",
      "commitAuthorOld": "Giovanni Matteo Fumarola",
      "daysBetweenCommits": 111.04,
      "commitsBetweenForRepo": 826,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,23 +1,24 @@\n   static void unTarUsingJava(File inFile, File untarDir,\n       boolean gzipped) throws IOException {\n     InputStream inputStream \u003d null;\n     TarArchiveInputStream tis \u003d null;\n     try {\n       if (gzipped) {\n-        inputStream \u003d new GZIPInputStream(new FileInputStream(inFile));\n+        inputStream \u003d\n+            new GZIPInputStream(Files.newInputStream(inFile.toPath()));\n       } else {\n-        inputStream \u003d new FileInputStream(inFile);\n+        inputStream \u003d Files.newInputStream(inFile.toPath());\n       }\n \n       inputStream \u003d new BufferedInputStream(inputStream);\n \n       tis \u003d new TarArchiveInputStream(inputStream);\n \n       for (TarArchiveEntry entry \u003d tis.getNextTarEntry(); entry !\u003d null;) {\n         unpackEntries(tis, entry, untarDir);\n         entry \u003d tis.getNextTarEntry();\n       }\n     } finally {\n       IOUtils.cleanupWithLogger(LOG, tis, inputStream);\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  static void unTarUsingJava(File inFile, File untarDir,\n      boolean gzipped) throws IOException {\n    InputStream inputStream \u003d null;\n    TarArchiveInputStream tis \u003d null;\n    try {\n      if (gzipped) {\n        inputStream \u003d\n            new GZIPInputStream(Files.newInputStream(inFile.toPath()));\n      } else {\n        inputStream \u003d Files.newInputStream(inFile.toPath());\n      }\n\n      inputStream \u003d new BufferedInputStream(inputStream);\n\n      tis \u003d new TarArchiveInputStream(inputStream);\n\n      for (TarArchiveEntry entry \u003d tis.getNextTarEntry(); entry !\u003d null;) {\n        unpackEntries(tis, entry, untarDir);\n        entry \u003d tis.getNextTarEntry();\n      }\n    } finally {\n      IOUtils.cleanupWithLogger(LOG, tis, inputStream);\n    }\n  }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java",
      "extendedDetails": {}
    },
    "57198bc51122a36db8cb4788fcb7b55edc788b3b": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-15962. The buffer size is small when unpacking tar archives. Contributed by BELUGA BEHR.\n",
      "commitDate": "27/12/18 10:38 PM",
      "commitName": "57198bc51122a36db8cb4788fcb7b55edc788b3b",
      "commitAuthor": "Akira Ajisaka",
      "commitDateOld": "10/10/18 9:51 PM",
      "commitNameOld": "7b57f2f71fbaa5af4897309597cca70a95b04edd",
      "commitAuthorOld": "Takanobu Asanuma",
      "daysBetweenCommits": 78.07,
      "commitsBetweenForRepo": 608,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,22 +1,23 @@\n   static void unTarUsingJava(File inFile, File untarDir,\n       boolean gzipped) throws IOException {\n     InputStream inputStream \u003d null;\n     TarArchiveInputStream tis \u003d null;\n     try {\n       if (gzipped) {\n-        inputStream \u003d new BufferedInputStream(new GZIPInputStream(\n-            new FileInputStream(inFile)));\n+        inputStream \u003d new GZIPInputStream(new FileInputStream(inFile));\n       } else {\n-        inputStream \u003d new BufferedInputStream(new FileInputStream(inFile));\n+        inputStream \u003d new FileInputStream(inFile);\n       }\n \n+      inputStream \u003d new BufferedInputStream(inputStream);\n+\n       tis \u003d new TarArchiveInputStream(inputStream);\n \n       for (TarArchiveEntry entry \u003d tis.getNextTarEntry(); entry !\u003d null;) {\n         unpackEntries(tis, entry, untarDir);\n         entry \u003d tis.getNextTarEntry();\n       }\n     } finally {\n       IOUtils.cleanupWithLogger(LOG, tis, inputStream);\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  static void unTarUsingJava(File inFile, File untarDir,\n      boolean gzipped) throws IOException {\n    InputStream inputStream \u003d null;\n    TarArchiveInputStream tis \u003d null;\n    try {\n      if (gzipped) {\n        inputStream \u003d new GZIPInputStream(new FileInputStream(inFile));\n      } else {\n        inputStream \u003d new FileInputStream(inFile);\n      }\n\n      inputStream \u003d new BufferedInputStream(inputStream);\n\n      tis \u003d new TarArchiveInputStream(inputStream);\n\n      for (TarArchiveEntry entry \u003d tis.getNextTarEntry(); entry !\u003d null;) {\n        unpackEntries(tis, entry, untarDir);\n        entry \u003d tis.getNextTarEntry();\n      }\n    } finally {\n      IOUtils.cleanupWithLogger(LOG, tis, inputStream);\n    }\n  }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java",
      "extendedDetails": {}
    },
    "460d77bd646d03d3eb7670f9017aeeb5410c4a95": {
      "type": "Ymodifierchange",
      "commitMessage": "HADOOP-15170. Add symlink support to FileUtil#unTarUsingJava. Contributed by Ajay Kumar\n",
      "commitDate": "02/02/18 9:33 AM",
      "commitName": "460d77bd646d03d3eb7670f9017aeeb5410c4a95",
      "commitAuthor": "Jason Lowe",
      "commitDateOld": "31/01/18 7:39 AM",
      "commitNameOld": "7288b08330001102f944124d18e02bf0585d3e96",
      "commitAuthorOld": "Jason Lowe",
      "daysBetweenCommits": 2.08,
      "commitsBetweenForRepo": 16,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,22 +1,22 @@\n-  private static void unTarUsingJava(File inFile, File untarDir,\n+  static void unTarUsingJava(File inFile, File untarDir,\n       boolean gzipped) throws IOException {\n     InputStream inputStream \u003d null;\n     TarArchiveInputStream tis \u003d null;\n     try {\n       if (gzipped) {\n         inputStream \u003d new BufferedInputStream(new GZIPInputStream(\n             new FileInputStream(inFile)));\n       } else {\n         inputStream \u003d new BufferedInputStream(new FileInputStream(inFile));\n       }\n \n       tis \u003d new TarArchiveInputStream(inputStream);\n \n       for (TarArchiveEntry entry \u003d tis.getNextTarEntry(); entry !\u003d null;) {\n         unpackEntries(tis, entry, untarDir);\n         entry \u003d tis.getNextTarEntry();\n       }\n     } finally {\n       IOUtils.cleanupWithLogger(LOG, tis, inputStream);\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  static void unTarUsingJava(File inFile, File untarDir,\n      boolean gzipped) throws IOException {\n    InputStream inputStream \u003d null;\n    TarArchiveInputStream tis \u003d null;\n    try {\n      if (gzipped) {\n        inputStream \u003d new BufferedInputStream(new GZIPInputStream(\n            new FileInputStream(inFile)));\n      } else {\n        inputStream \u003d new BufferedInputStream(new FileInputStream(inFile));\n      }\n\n      tis \u003d new TarArchiveInputStream(inputStream);\n\n      for (TarArchiveEntry entry \u003d tis.getNextTarEntry(); entry !\u003d null;) {\n        unpackEntries(tis, entry, untarDir);\n        entry \u003d tis.getNextTarEntry();\n      }\n    } finally {\n      IOUtils.cleanupWithLogger(LOG, tis, inputStream);\n    }\n  }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java",
      "extendedDetails": {
        "oldValue": "[private, static]",
        "newValue": "[static]"
      }
    },
    "ccaf036662e22da14583942054898c99fa51dae5": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-14539. Move commons logging APIs over to slf4j in hadoop-common. Contributed by Wenxin He.\n",
      "commitDate": "17/07/17 9:32 PM",
      "commitName": "ccaf036662e22da14583942054898c99fa51dae5",
      "commitAuthor": "Akira Ajisaka",
      "commitDateOld": "22/06/17 6:28 PM",
      "commitNameOld": "092ebdf885468a2bf79cbfb168286b7cddc4a0db",
      "commitAuthorOld": "Akira Ajisaka",
      "daysBetweenCommits": 25.13,
      "commitsBetweenForRepo": 116,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,22 +1,22 @@\n   private static void unTarUsingJava(File inFile, File untarDir,\n       boolean gzipped) throws IOException {\n     InputStream inputStream \u003d null;\n     TarArchiveInputStream tis \u003d null;\n     try {\n       if (gzipped) {\n         inputStream \u003d new BufferedInputStream(new GZIPInputStream(\n             new FileInputStream(inFile)));\n       } else {\n         inputStream \u003d new BufferedInputStream(new FileInputStream(inFile));\n       }\n \n       tis \u003d new TarArchiveInputStream(inputStream);\n \n       for (TarArchiveEntry entry \u003d tis.getNextTarEntry(); entry !\u003d null;) {\n         unpackEntries(tis, entry, untarDir);\n         entry \u003d tis.getNextTarEntry();\n       }\n     } finally {\n-      IOUtils.cleanup(LOG, tis, inputStream);\n+      IOUtils.cleanupWithLogger(LOG, tis, inputStream);\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private static void unTarUsingJava(File inFile, File untarDir,\n      boolean gzipped) throws IOException {\n    InputStream inputStream \u003d null;\n    TarArchiveInputStream tis \u003d null;\n    try {\n      if (gzipped) {\n        inputStream \u003d new BufferedInputStream(new GZIPInputStream(\n            new FileInputStream(inFile)));\n      } else {\n        inputStream \u003d new BufferedInputStream(new FileInputStream(inFile));\n      }\n\n      tis \u003d new TarArchiveInputStream(inputStream);\n\n      for (TarArchiveEntry entry \u003d tis.getNextTarEntry(); entry !\u003d null;) {\n        unpackEntries(tis, entry, untarDir);\n        entry \u003d tis.getNextTarEntry();\n      }\n    } finally {\n      IOUtils.cleanupWithLogger(LOG, tis, inputStream);\n    }\n  }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java",
      "extendedDetails": {}
    },
    "3628553736b148f7be8b13d2e629b1c0c3806f6b": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-9681. FileUtil.unTarUsingJava() should close the InputStream upon finishing. Contributed by Chuan Liu.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1499069 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "02/07/13 12:22 PM",
      "commitName": "3628553736b148f7be8b13d2e629b1c0c3806f6b",
      "commitAuthor": "Chris Nauroth",
      "commitDateOld": "14/06/13 2:23 PM",
      "commitNameOld": "5e72bfc521b1525b6232f2e685d57bb2dee95823",
      "commitAuthorOld": "Colin McCabe",
      "daysBetweenCommits": 17.92,
      "commitsBetweenForRepo": 107,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,17 +1,22 @@\n   private static void unTarUsingJava(File inFile, File untarDir,\n       boolean gzipped) throws IOException {\n     InputStream inputStream \u003d null;\n-    if (gzipped) {\n-      inputStream \u003d new BufferedInputStream(new GZIPInputStream(\n-          new FileInputStream(inFile)));\n-    } else {\n-      inputStream \u003d new BufferedInputStream(new FileInputStream(inFile));\n-    }\n+    TarArchiveInputStream tis \u003d null;\n+    try {\n+      if (gzipped) {\n+        inputStream \u003d new BufferedInputStream(new GZIPInputStream(\n+            new FileInputStream(inFile)));\n+      } else {\n+        inputStream \u003d new BufferedInputStream(new FileInputStream(inFile));\n+      }\n \n-    TarArchiveInputStream tis \u003d new TarArchiveInputStream(inputStream);\n+      tis \u003d new TarArchiveInputStream(inputStream);\n \n-    for (TarArchiveEntry entry \u003d tis.getNextTarEntry(); entry !\u003d null;) {\n-      unpackEntries(tis, entry, untarDir);\n-      entry \u003d tis.getNextTarEntry();\n+      for (TarArchiveEntry entry \u003d tis.getNextTarEntry(); entry !\u003d null;) {\n+        unpackEntries(tis, entry, untarDir);\n+        entry \u003d tis.getNextTarEntry();\n+      }\n+    } finally {\n+      IOUtils.cleanup(LOG, tis, inputStream);\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private static void unTarUsingJava(File inFile, File untarDir,\n      boolean gzipped) throws IOException {\n    InputStream inputStream \u003d null;\n    TarArchiveInputStream tis \u003d null;\n    try {\n      if (gzipped) {\n        inputStream \u003d new BufferedInputStream(new GZIPInputStream(\n            new FileInputStream(inFile)));\n      } else {\n        inputStream \u003d new BufferedInputStream(new FileInputStream(inFile));\n      }\n\n      tis \u003d new TarArchiveInputStream(inputStream);\n\n      for (TarArchiveEntry entry \u003d tis.getNextTarEntry(); entry !\u003d null;) {\n        unpackEntries(tis, entry, untarDir);\n        entry \u003d tis.getNextTarEntry();\n      }\n    } finally {\n      IOUtils.cleanup(LOG, tis, inputStream);\n    }\n  }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java",
      "extendedDetails": {}
    },
    "71a57ded39a605166d616fe68f36017cdb0abe3e": {
      "type": "Yintroduced",
      "commitMessage": "HADOOP-9264. Port change to use Java untar API on Windows from branch-1-win to trunk. Contributed by Chris Nauroth.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1441172 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "31/01/13 12:13 PM",
      "commitName": "71a57ded39a605166d616fe68f36017cdb0abe3e",
      "commitAuthor": "Suresh Srinivas",
      "diff": "@@ -0,0 +1,17 @@\n+  private static void unTarUsingJava(File inFile, File untarDir,\n+      boolean gzipped) throws IOException {\n+    InputStream inputStream \u003d null;\n+    if (gzipped) {\n+      inputStream \u003d new BufferedInputStream(new GZIPInputStream(\n+          new FileInputStream(inFile)));\n+    } else {\n+      inputStream \u003d new BufferedInputStream(new FileInputStream(inFile));\n+    }\n+\n+    TarArchiveInputStream tis \u003d new TarArchiveInputStream(inputStream);\n+\n+    for (TarArchiveEntry entry \u003d tis.getNextTarEntry(); entry !\u003d null;) {\n+      unpackEntries(tis, entry, untarDir);\n+      entry \u003d tis.getNextTarEntry();\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private static void unTarUsingJava(File inFile, File untarDir,\n      boolean gzipped) throws IOException {\n    InputStream inputStream \u003d null;\n    if (gzipped) {\n      inputStream \u003d new BufferedInputStream(new GZIPInputStream(\n          new FileInputStream(inFile)));\n    } else {\n      inputStream \u003d new BufferedInputStream(new FileInputStream(inFile));\n    }\n\n    TarArchiveInputStream tis \u003d new TarArchiveInputStream(inputStream);\n\n    for (TarArchiveEntry entry \u003d tis.getNextTarEntry(); entry !\u003d null;) {\n      unpackEntries(tis, entry, untarDir);\n      entry \u003d tis.getNextTarEntry();\n    }\n  }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java"
    }
  }
}