{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "IncrementalBlockReportManager.java",
  "functionName": "triggerDeletionReportForTests",
  "functionId": "triggerDeletionReportForTests",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/IncrementalBlockReportManager.java",
  "functionStartLine": 287,
  "functionEndLine": 297,
  "numCommitsSeen": 88,
  "timeTaken": 5012,
  "changeHistory": [
    "d1d4e16690cc85f7f22fbead9cf596260819b561",
    "4e5e1c0f9938e51699c0437731e7b2eef699d6da",
    "60882ab26d49f05cbf0686944af6559f86b3417d",
    "01f37e42f050207b7659bf74e2484cf8bdae2d89",
    "6c0ccb5989c2053f5a1ebab0dd9fdb7b4019fda8",
    "7527e943e6c8ea909f22d9d66246ac6c8bc2d6a0",
    "31c91706f7d17da006ef2d6c541f8dd092fae077"
  ],
  "changeHistoryShort": {
    "d1d4e16690cc85f7f22fbead9cf596260819b561": "Ybodychange",
    "4e5e1c0f9938e51699c0437731e7b2eef699d6da": "Ymultichange(Ymovefromfile,Ymodifierchange,Ybodychange)",
    "60882ab26d49f05cbf0686944af6559f86b3417d": "Ybodychange",
    "01f37e42f050207b7659bf74e2484cf8bdae2d89": "Ybodychange",
    "6c0ccb5989c2053f5a1ebab0dd9fdb7b4019fda8": "Yexceptionschange",
    "7527e943e6c8ea909f22d9d66246ac6c8bc2d6a0": "Ybodychange",
    "31c91706f7d17da006ef2d6c541f8dd092fae077": "Yintroduced"
  },
  "changeHistoryDetails": {
    "d1d4e16690cc85f7f22fbead9cf596260819b561": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-9710. DN can be configured to send block receipt IBRs in batches.\n",
      "commitDate": "26/02/16 3:32 PM",
      "commitName": "d1d4e16690cc85f7f22fbead9cf596260819b561",
      "commitAuthor": "Tsz-Wo Nicholas Sze",
      "commitDateOld": "05/02/16 7:17 AM",
      "commitNameOld": "4e5e1c0f9938e51699c0437731e7b2eef699d6da",
      "commitAuthorOld": "Tsz-Wo Nicholas Sze",
      "daysBetweenCommits": 21.34,
      "commitsBetweenForRepo": 151,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,11 +1,11 @@\n   synchronized void triggerDeletionReportForTests() {\n-    triggerIBR();\n+    triggerIBR(true);\n \n     while (sendImmediately()) {\n       try {\n         wait(100);\n       } catch (InterruptedException e) {\n         return;\n       }\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  synchronized void triggerDeletionReportForTests() {\n    triggerIBR(true);\n\n    while (sendImmediately()) {\n      try {\n        wait(100);\n      } catch (InterruptedException e) {\n        return;\n      }\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/IncrementalBlockReportManager.java",
      "extendedDetails": {}
    },
    "4e5e1c0f9938e51699c0437731e7b2eef699d6da": {
      "type": "Ymultichange(Ymovefromfile,Ymodifierchange,Ybodychange)",
      "commitMessage": "HDFS-9726. Refactor IBR code to a new class.\n",
      "commitDate": "05/02/16 7:17 AM",
      "commitName": "4e5e1c0f9938e51699c0437731e7b2eef699d6da",
      "commitAuthor": "Tsz-Wo Nicholas Sze",
      "subchanges": [
        {
          "type": "Ymovefromfile",
          "commitMessage": "HDFS-9726. Refactor IBR code to a new class.\n",
          "commitDate": "05/02/16 7:17 AM",
          "commitName": "4e5e1c0f9938e51699c0437731e7b2eef699d6da",
          "commitAuthor": "Tsz-Wo Nicholas Sze",
          "commitDateOld": "04/02/16 11:34 AM",
          "commitNameOld": "1bcfab8e7fd8562f1829ac484d2f6c91f7afe3d6",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 0.82,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,14 +1,11 @@\n-  void triggerDeletionReportForTests() {\n-    synchronized (pendingIncrementalBRperStorage) {\n-      sendImmediateIBR \u003d true;\n-      pendingIncrementalBRperStorage.notifyAll();\n+  synchronized void triggerDeletionReportForTests() {\n+    triggerIBR();\n \n-      while (sendImmediateIBR) {\n-        try {\n-          pendingIncrementalBRperStorage.wait(100);\n-        } catch (InterruptedException e) {\n-          return;\n-        }\n+    while (sendImmediately()) {\n+      try {\n+        wait(100);\n+      } catch (InterruptedException e) {\n+        return;\n       }\n     }\n   }\n\\ No newline at end of file\n",
          "actualSource": "  synchronized void triggerDeletionReportForTests() {\n    triggerIBR();\n\n    while (sendImmediately()) {\n      try {\n        wait(100);\n      } catch (InterruptedException e) {\n        return;\n      }\n    }\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/IncrementalBlockReportManager.java",
          "extendedDetails": {
            "oldPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/BPServiceActor.java",
            "newPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/IncrementalBlockReportManager.java",
            "oldMethodName": "triggerDeletionReportForTests",
            "newMethodName": "triggerDeletionReportForTests"
          }
        },
        {
          "type": "Ymodifierchange",
          "commitMessage": "HDFS-9726. Refactor IBR code to a new class.\n",
          "commitDate": "05/02/16 7:17 AM",
          "commitName": "4e5e1c0f9938e51699c0437731e7b2eef699d6da",
          "commitAuthor": "Tsz-Wo Nicholas Sze",
          "commitDateOld": "04/02/16 11:34 AM",
          "commitNameOld": "1bcfab8e7fd8562f1829ac484d2f6c91f7afe3d6",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 0.82,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,14 +1,11 @@\n-  void triggerDeletionReportForTests() {\n-    synchronized (pendingIncrementalBRperStorage) {\n-      sendImmediateIBR \u003d true;\n-      pendingIncrementalBRperStorage.notifyAll();\n+  synchronized void triggerDeletionReportForTests() {\n+    triggerIBR();\n \n-      while (sendImmediateIBR) {\n-        try {\n-          pendingIncrementalBRperStorage.wait(100);\n-        } catch (InterruptedException e) {\n-          return;\n-        }\n+    while (sendImmediately()) {\n+      try {\n+        wait(100);\n+      } catch (InterruptedException e) {\n+        return;\n       }\n     }\n   }\n\\ No newline at end of file\n",
          "actualSource": "  synchronized void triggerDeletionReportForTests() {\n    triggerIBR();\n\n    while (sendImmediately()) {\n      try {\n        wait(100);\n      } catch (InterruptedException e) {\n        return;\n      }\n    }\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/IncrementalBlockReportManager.java",
          "extendedDetails": {
            "oldValue": "[]",
            "newValue": "[synchronized]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-9726. Refactor IBR code to a new class.\n",
          "commitDate": "05/02/16 7:17 AM",
          "commitName": "4e5e1c0f9938e51699c0437731e7b2eef699d6da",
          "commitAuthor": "Tsz-Wo Nicholas Sze",
          "commitDateOld": "04/02/16 11:34 AM",
          "commitNameOld": "1bcfab8e7fd8562f1829ac484d2f6c91f7afe3d6",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 0.82,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,14 +1,11 @@\n-  void triggerDeletionReportForTests() {\n-    synchronized (pendingIncrementalBRperStorage) {\n-      sendImmediateIBR \u003d true;\n-      pendingIncrementalBRperStorage.notifyAll();\n+  synchronized void triggerDeletionReportForTests() {\n+    triggerIBR();\n \n-      while (sendImmediateIBR) {\n-        try {\n-          pendingIncrementalBRperStorage.wait(100);\n-        } catch (InterruptedException e) {\n-          return;\n-        }\n+    while (sendImmediately()) {\n+      try {\n+        wait(100);\n+      } catch (InterruptedException e) {\n+        return;\n       }\n     }\n   }\n\\ No newline at end of file\n",
          "actualSource": "  synchronized void triggerDeletionReportForTests() {\n    triggerIBR();\n\n    while (sendImmediately()) {\n      try {\n        wait(100);\n      } catch (InterruptedException e) {\n        return;\n      }\n    }\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/IncrementalBlockReportManager.java",
          "extendedDetails": {}
        }
      ]
    },
    "60882ab26d49f05cbf0686944af6559f86b3417d": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-7990. IBR delete ack should not be delayed. Contributed by Daryn Sharp.\n",
      "commitDate": "27/03/15 7:05 AM",
      "commitName": "60882ab26d49f05cbf0686944af6559f86b3417d",
      "commitAuthor": "Kihwal Lee",
      "commitDateOld": "23/03/15 10:00 PM",
      "commitNameOld": "50ee8f4e67a66aa77c5359182f61f3e951844db6",
      "commitAuthorOld": "Andrew Wang",
      "daysBetweenCommits": 3.38,
      "commitsBetweenForRepo": 39,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,14 +1,14 @@\n   void triggerDeletionReportForTests() {\n     synchronized (pendingIncrementalBRperStorage) {\n-      lastDeletedReport \u003d 0;\n+      sendImmediateIBR \u003d true;\n       pendingIncrementalBRperStorage.notifyAll();\n \n-      while (lastDeletedReport \u003d\u003d 0) {\n+      while (sendImmediateIBR) {\n         try {\n           pendingIncrementalBRperStorage.wait(100);\n         } catch (InterruptedException e) {\n           return;\n         }\n       }\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void triggerDeletionReportForTests() {\n    synchronized (pendingIncrementalBRperStorage) {\n      sendImmediateIBR \u003d true;\n      pendingIncrementalBRperStorage.notifyAll();\n\n      while (sendImmediateIBR) {\n        try {\n          pendingIncrementalBRperStorage.wait(100);\n        } catch (InterruptedException e) {\n          return;\n        }\n      }\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/BPServiceActor.java",
      "extendedDetails": {}
    },
    "01f37e42f050207b7659bf74e2484cf8bdae2d89": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-5390. Send one incremental block report per storage directory.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2832@1534891 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "22/10/13 6:28 PM",
      "commitName": "01f37e42f050207b7659bf74e2484cf8bdae2d89",
      "commitAuthor": "Arpit Agarwal",
      "commitDateOld": "21/10/13 7:22 PM",
      "commitNameOld": "0ebab3a88a5f172a1180f4e88a91cf6194b273ca",
      "commitAuthorOld": "Arpit Agarwal",
      "daysBetweenCommits": 0.96,
      "commitsBetweenForRepo": 6,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,14 +1,14 @@\n   void triggerDeletionReportForTests() {\n-    synchronized (pendingIncrementalBR) {\n+    synchronized (pendingIncrementalBRperStorage) {\n       lastDeletedReport \u003d 0;\n-      pendingIncrementalBR.notifyAll();\n+      pendingIncrementalBRperStorage.notifyAll();\n \n       while (lastDeletedReport \u003d\u003d 0) {\n         try {\n-          pendingIncrementalBR.wait(100);\n+          pendingIncrementalBRperStorage.wait(100);\n         } catch (InterruptedException e) {\n           return;\n         }\n       }\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void triggerDeletionReportForTests() {\n    synchronized (pendingIncrementalBRperStorage) {\n      lastDeletedReport \u003d 0;\n      pendingIncrementalBRperStorage.notifyAll();\n\n      while (lastDeletedReport \u003d\u003d 0) {\n        try {\n          pendingIncrementalBRperStorage.wait(100);\n        } catch (InterruptedException e) {\n          return;\n        }\n      }\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/BPServiceActor.java",
      "extendedDetails": {}
    },
    "6c0ccb5989c2053f5a1ebab0dd9fdb7b4019fda8": {
      "type": "Yexceptionschange",
      "commitMessage": "HDFS-2686. Remove DistributedUpgrade related code. Contributed by Suresh Srinivas\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1375800 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "21/08/12 2:18 PM",
      "commitName": "6c0ccb5989c2053f5a1ebab0dd9fdb7b4019fda8",
      "commitAuthor": "Suresh Srinivas",
      "commitDateOld": "12/07/12 12:01 PM",
      "commitNameOld": "4a5ba3b7bd2360fd9605863630b477d362874e1e",
      "commitAuthorOld": "Eli Collins",
      "daysBetweenCommits": 40.1,
      "commitsBetweenForRepo": 216,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,14 +1,14 @@\n-  void triggerDeletionReportForTests() throws IOException {\n+  void triggerDeletionReportForTests() {\n     synchronized (pendingIncrementalBR) {\n       lastDeletedReport \u003d 0;\n       pendingIncrementalBR.notifyAll();\n \n       while (lastDeletedReport \u003d\u003d 0) {\n         try {\n           pendingIncrementalBR.wait(100);\n         } catch (InterruptedException e) {\n           return;\n         }\n       }\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void triggerDeletionReportForTests() {\n    synchronized (pendingIncrementalBR) {\n      lastDeletedReport \u003d 0;\n      pendingIncrementalBR.notifyAll();\n\n      while (lastDeletedReport \u003d\u003d 0) {\n        try {\n          pendingIncrementalBR.wait(100);\n        } catch (InterruptedException e) {\n          return;\n        }\n      }\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/BPServiceActor.java",
      "extendedDetails": {
        "oldValue": "[IOException]",
        "newValue": "[]"
      }
    },
    "7527e943e6c8ea909f22d9d66246ac6c8bc2d6a0": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-2972. Small optimization building incremental block report. Contributed by Todd Lipcon.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1292497 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "22/02/12 12:37 PM",
      "commitName": "7527e943e6c8ea909f22d9d66246ac6c8bc2d6a0",
      "commitAuthor": "Todd Lipcon",
      "commitDateOld": "13/02/12 1:00 PM",
      "commitNameOld": "db187cf40ee307524c48cededd58710a4dfb4812",
      "commitAuthorOld": "",
      "daysBetweenCommits": 8.98,
      "commitsBetweenForRepo": 60,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,14 +1,14 @@\n   void triggerDeletionReportForTests() throws IOException {\n-    synchronized (receivedAndDeletedBlockList) {\n+    synchronized (pendingIncrementalBR) {\n       lastDeletedReport \u003d 0;\n-      receivedAndDeletedBlockList.notifyAll();\n+      pendingIncrementalBR.notifyAll();\n \n       while (lastDeletedReport \u003d\u003d 0) {\n         try {\n-          receivedAndDeletedBlockList.wait(100);\n+          pendingIncrementalBR.wait(100);\n         } catch (InterruptedException e) {\n           return;\n         }\n       }\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void triggerDeletionReportForTests() throws IOException {\n    synchronized (pendingIncrementalBR) {\n      lastDeletedReport \u003d 0;\n      pendingIncrementalBR.notifyAll();\n\n      while (lastDeletedReport \u003d\u003d 0) {\n        try {\n          pendingIncrementalBR.wait(100);\n        } catch (InterruptedException e) {\n          return;\n        }\n      }\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/BPServiceActor.java",
      "extendedDetails": {}
    },
    "31c91706f7d17da006ef2d6c541f8dd092fae077": {
      "type": "Yintroduced",
      "commitMessage": "HDFS-1972. Fencing mechanism for block invalidations and replications. Contributed by Todd Lipcon.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-1623@1221608 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "20/12/11 8:32 PM",
      "commitName": "31c91706f7d17da006ef2d6c541f8dd092fae077",
      "commitAuthor": "Todd Lipcon",
      "diff": "@@ -0,0 +1,14 @@\n+  void triggerDeletionReportForTests() throws IOException {\n+    synchronized (receivedAndDeletedBlockList) {\n+      lastDeletedReport \u003d 0;\n+      receivedAndDeletedBlockList.notifyAll();\n+\n+      while (lastDeletedReport \u003d\u003d 0) {\n+        try {\n+          receivedAndDeletedBlockList.wait(100);\n+        } catch (InterruptedException e) {\n+          return;\n+        }\n+      }\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  void triggerDeletionReportForTests() throws IOException {\n    synchronized (receivedAndDeletedBlockList) {\n      lastDeletedReport \u003d 0;\n      receivedAndDeletedBlockList.notifyAll();\n\n      while (lastDeletedReport \u003d\u003d 0) {\n        try {\n          receivedAndDeletedBlockList.wait(100);\n        } catch (InterruptedException e) {\n          return;\n        }\n      }\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/BPServiceActor.java"
    }
  }
}