{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "WebAppProxyServlet.java",
  "functionName": "handleRedirect",
  "functionId": "handleRedirect___id-String__req-HttpServletRequest__resp-HttpServletResponse",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-web-proxy/src/main/java/org/apache/hadoop/yarn/server/webproxy/WebAppProxyServlet.java",
  "functionStartLine": 631,
  "functionEndLine": 663,
  "numCommitsSeen": 31,
  "timeTaken": 1496,
  "changeHistory": [
    "736d33cddd88a0cec925a451940b2523999a9c51"
  ],
  "changeHistoryShort": {
    "736d33cddd88a0cec925a451940b2523999a9c51": "Yintroduced"
  },
  "changeHistoryDetails": {
    "736d33cddd88a0cec925a451940b2523999a9c51": {
      "type": "Yintroduced",
      "commitMessage": "YARN-4767. Network issues can cause persistent RM UI outage. (Daniel Templeton via kasha)\n",
      "commitDate": "03/10/16 2:35 PM",
      "commitName": "736d33cddd88a0cec925a451940b2523999a9c51",
      "commitAuthor": "Karthik Kambatla",
      "diff": "@@ -0,0 +1,33 @@\n+  private boolean handleRedirect(String id, HttpServletRequest req,\n+      HttpServletResponse resp) throws IOException {\n+    // If this isn\u0027t a redirect, we don\u0027t care.\n+    boolean badRedirect \u003d false;\n+\n+    // If this is a redirect, check if we\u0027re calling ourselves.\n+    try {\n+      badRedirect \u003d NetUtils.getLocalInetAddress(req.getRemoteHost()) !\u003d null;\n+    } catch (SocketException ex) {\n+      // This exception means we can\u0027t determine the calling host. Odds are\n+      // that means it\u0027s not us.  Let it go and hope it works out better next\n+      // time.\n+    }\n+\n+    // If the proxy tries to call itself, it gets into an endless\n+    // loop and consumes all available handler threads until the\n+    // application completes.  Redirect to the app page with a flag\n+    // that tells it to print an appropriate error message.\n+    if (badRedirect) {\n+      LOG.error(\"The AM\u0027s web app redirected the RM web proxy\u0027s request back \"\n+          + \"to the web proxy. The typical cause is that the AM is resolving \"\n+          + \"the RM\u0027s address as something other than what it expects. Check \"\n+          + \"your network configuration and the value of the \"\n+          + \"yarn.web-proxy.address property. Once the host resolution issue \"\n+          + \"has been resolved, you will likely need to delete the \"\n+          + \"misbehaving application, \" + id);\n+      String redirect \u003d StringHelper.pjoin(failurePageUrlBase, id);\n+      LOG.error(\"REDIRECT: sending redirect to \" + redirect);\n+      ProxyUtils.sendRedirect(req, resp, redirect);\n+    }\n+\n+    return badRedirect;\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private boolean handleRedirect(String id, HttpServletRequest req,\n      HttpServletResponse resp) throws IOException {\n    // If this isn\u0027t a redirect, we don\u0027t care.\n    boolean badRedirect \u003d false;\n\n    // If this is a redirect, check if we\u0027re calling ourselves.\n    try {\n      badRedirect \u003d NetUtils.getLocalInetAddress(req.getRemoteHost()) !\u003d null;\n    } catch (SocketException ex) {\n      // This exception means we can\u0027t determine the calling host. Odds are\n      // that means it\u0027s not us.  Let it go and hope it works out better next\n      // time.\n    }\n\n    // If the proxy tries to call itself, it gets into an endless\n    // loop and consumes all available handler threads until the\n    // application completes.  Redirect to the app page with a flag\n    // that tells it to print an appropriate error message.\n    if (badRedirect) {\n      LOG.error(\"The AM\u0027s web app redirected the RM web proxy\u0027s request back \"\n          + \"to the web proxy. The typical cause is that the AM is resolving \"\n          + \"the RM\u0027s address as something other than what it expects. Check \"\n          + \"your network configuration and the value of the \"\n          + \"yarn.web-proxy.address property. Once the host resolution issue \"\n          + \"has been resolved, you will likely need to delete the \"\n          + \"misbehaving application, \" + id);\n      String redirect \u003d StringHelper.pjoin(failurePageUrlBase, id);\n      LOG.error(\"REDIRECT: sending redirect to \" + redirect);\n      ProxyUtils.sendRedirect(req, resp, redirect);\n    }\n\n    return badRedirect;\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-web-proxy/src/main/java/org/apache/hadoop/yarn/server/webproxy/WebAppProxyServlet.java"
    }
  }
}