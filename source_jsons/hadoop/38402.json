{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "RMNodeLabelsManager.java",
  "functionName": "getModifiedNodeLabelsMappings",
  "functionId": "getModifiedNodeLabelsMappings___replaceLabelsToNode-Map__NodeId,Set__String____",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/nodelabels/RMNodeLabelsManager.java",
  "functionStartLine": 199,
  "functionEndLine": 223,
  "numCommitsSeen": 22,
  "timeTaken": 1263,
  "changeHistory": [
    "29a582ada0fe195989eca25e5a995895e178f4ea"
  ],
  "changeHistoryShort": {
    "29a582ada0fe195989eca25e5a995895e178f4ea": "Yintroduced"
  },
  "changeHistoryDetails": {
    "29a582ada0fe195989eca25e5a995895e178f4ea": {
      "type": "Yintroduced",
      "commitMessage": "YARN-4215. RMNodeLabels Manager Need to verify and replace node labels for the only modified Node Label Mappings in the request. (Naganarasimha G R via wangda)\n",
      "commitDate": "06/10/15 11:56 AM",
      "commitName": "29a582ada0fe195989eca25e5a995895e178f4ea",
      "commitAuthor": "Wangda Tan",
      "diff": "@@ -0,0 +1,25 @@\n+  private Map\u003cNodeId, Set\u003cString\u003e\u003e getModifiedNodeLabelsMappings(\n+      Map\u003cNodeId, Set\u003cString\u003e\u003e replaceLabelsToNode) {\n+    Map\u003cNodeId, Set\u003cString\u003e\u003e effectiveModifiedLabels \u003d new HashMap\u003c\u003e();\n+    for (Entry\u003cNodeId, Set\u003cString\u003e\u003e nodeLabelMappingEntry : replaceLabelsToNode\n+        .entrySet()) {\n+      NodeId nodeId \u003d nodeLabelMappingEntry.getKey();\n+      Set\u003cString\u003e modifiedNodeLabels \u003d nodeLabelMappingEntry.getValue();\n+      Set\u003cString\u003e labelsBeforeModification \u003d null;\n+      Host host \u003d nodeCollections.get(nodeId.getHost());\n+      if (host \u003d\u003d null) {\n+        effectiveModifiedLabels.put(nodeId, modifiedNodeLabels);\n+        continue;\n+      } else if (nodeId.getPort() \u003d\u003d WILDCARD_PORT) {\n+        labelsBeforeModification \u003d host.labels;\n+      } else if (host.nms.get(nodeId) !\u003d null) {\n+        labelsBeforeModification \u003d host.nms.get(nodeId).labels;\n+      }\n+      if (labelsBeforeModification \u003d\u003d null\n+          || labelsBeforeModification.size() !\u003d modifiedNodeLabels.size()\n+          || !labelsBeforeModification.containsAll(modifiedNodeLabels)) {\n+        effectiveModifiedLabels.put(nodeId, modifiedNodeLabels);\n+      }\n+    }\n+    return effectiveModifiedLabels;\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private Map\u003cNodeId, Set\u003cString\u003e\u003e getModifiedNodeLabelsMappings(\n      Map\u003cNodeId, Set\u003cString\u003e\u003e replaceLabelsToNode) {\n    Map\u003cNodeId, Set\u003cString\u003e\u003e effectiveModifiedLabels \u003d new HashMap\u003c\u003e();\n    for (Entry\u003cNodeId, Set\u003cString\u003e\u003e nodeLabelMappingEntry : replaceLabelsToNode\n        .entrySet()) {\n      NodeId nodeId \u003d nodeLabelMappingEntry.getKey();\n      Set\u003cString\u003e modifiedNodeLabels \u003d nodeLabelMappingEntry.getValue();\n      Set\u003cString\u003e labelsBeforeModification \u003d null;\n      Host host \u003d nodeCollections.get(nodeId.getHost());\n      if (host \u003d\u003d null) {\n        effectiveModifiedLabels.put(nodeId, modifiedNodeLabels);\n        continue;\n      } else if (nodeId.getPort() \u003d\u003d WILDCARD_PORT) {\n        labelsBeforeModification \u003d host.labels;\n      } else if (host.nms.get(nodeId) !\u003d null) {\n        labelsBeforeModification \u003d host.nms.get(nodeId).labels;\n      }\n      if (labelsBeforeModification \u003d\u003d null\n          || labelsBeforeModification.size() !\u003d modifiedNodeLabels.size()\n          || !labelsBeforeModification.containsAll(modifiedNodeLabels)) {\n        effectiveModifiedLabels.put(nodeId, modifiedNodeLabels);\n      }\n    }\n    return effectiveModifiedLabels;\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/nodelabels/RMNodeLabelsManager.java"
    }
  }
}