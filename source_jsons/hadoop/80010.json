{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "CachingGetSpaceUsed.java",
  "functionName": "run",
  "functionId": "run",
  "sourceFilePath": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/CachingGetSpaceUsed.java",
  "functionStartLine": 190,
  "functionEndLine": 216,
  "numCommitsSeen": 5,
  "timeTaken": 1687,
  "changeHistory": [
    "2b452b4e6063072b2bec491edd3f412eb7ac21f3",
    "008122b3c927767ac96dc876124bc591e10c9df4",
    "bf780406f2b30e627bdf36ac07973f6931f81106",
    "35f07705552ef5636f8b8d2599a6af5ec1426203"
  ],
  "changeHistoryShort": {
    "2b452b4e6063072b2bec491edd3f412eb7ac21f3": "Ybodychange",
    "008122b3c927767ac96dc876124bc591e10c9df4": "Ybodychange",
    "bf780406f2b30e627bdf36ac07973f6931f81106": "Ybodychange",
    "35f07705552ef5636f8b8d2599a6af5ec1426203": "Yintroduced"
  },
  "changeHistoryDetails": {
    "2b452b4e6063072b2bec491edd3f412eb7ac21f3": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-14986. ReplicaCachingGetSpaceUsed throws ConcurrentModificationException. Contributed by Aiphago.\n",
      "commitDate": "27/11/19 6:43 PM",
      "commitName": "2b452b4e6063072b2bec491edd3f412eb7ac21f3",
      "commitAuthor": "Yiqun Lin",
      "commitDateOld": "11/05/17 12:06 PM",
      "commitNameOld": "09f28da2d2aae1487bae85ff110794f8346f92a4",
      "commitAuthorOld": "Daniel Templeton",
      "daysBetweenCommits": 930.32,
      "commitsBetweenForRepo": 7336,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,24 +1,27 @@\n     public void run() {\n       while (spaceUsed.running()) {\n         try {\n           long refreshInterval \u003d spaceUsed.refreshInterval;\n \n           if (spaceUsed.jitter \u003e 0) {\n             long jitter \u003d spaceUsed.jitter;\n             // add/subtract the jitter.\n             refreshInterval +\u003d\n                 ThreadLocalRandom.current()\n                                  .nextLong(-jitter, jitter);\n           }\n           // Make sure that after the jitter we didn\u0027t end up at 0.\n           refreshInterval \u003d Math.max(refreshInterval, 1);\n-          Thread.sleep(refreshInterval);\n+          if (!runImmediately) {\n+            Thread.sleep(refreshInterval);\n+          }\n+          runImmediately \u003d false;\n           // update the used variable\n           spaceUsed.refresh();\n         } catch (InterruptedException e) {\n           LOG.warn(\"Thread Interrupted waiting to refresh disk information: \"\n               + e.getMessage());\n           Thread.currentThread().interrupt();\n         }\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void run() {\n      while (spaceUsed.running()) {\n        try {\n          long refreshInterval \u003d spaceUsed.refreshInterval;\n\n          if (spaceUsed.jitter \u003e 0) {\n            long jitter \u003d spaceUsed.jitter;\n            // add/subtract the jitter.\n            refreshInterval +\u003d\n                ThreadLocalRandom.current()\n                                 .nextLong(-jitter, jitter);\n          }\n          // Make sure that after the jitter we didn\u0027t end up at 0.\n          refreshInterval \u003d Math.max(refreshInterval, 1);\n          if (!runImmediately) {\n            Thread.sleep(refreshInterval);\n          }\n          runImmediately \u003d false;\n          // update the used variable\n          spaceUsed.refresh();\n        } catch (InterruptedException e) {\n          LOG.warn(\"Thread Interrupted waiting to refresh disk information: \"\n              + e.getMessage());\n          Thread.currentThread().interrupt();\n        }\n      }\n    }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/CachingGetSpaceUsed.java",
      "extendedDetails": {}
    },
    "008122b3c927767ac96dc876124bc591e10c9df4": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-13710. Supress CachingGetSpaceUsed from logging interrupted exception stacktrace. Contributed by Hanisha Koneru.\n",
      "commitDate": "13/10/16 11:37 AM",
      "commitName": "008122b3c927767ac96dc876124bc591e10c9df4",
      "commitAuthor": "Arpit Agarwal",
      "commitDateOld": "16/06/16 4:48 PM",
      "commitNameOld": "bf780406f2b30e627bdf36ac07973f6931f81106",
      "commitAuthorOld": "Colin Patrick Mccabe",
      "daysBetweenCommits": 118.78,
      "commitsBetweenForRepo": 912,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,23 +1,24 @@\n     public void run() {\n       while (spaceUsed.running()) {\n         try {\n           long refreshInterval \u003d spaceUsed.refreshInterval;\n \n           if (spaceUsed.jitter \u003e 0) {\n             long jitter \u003d spaceUsed.jitter;\n             // add/subtract the jitter.\n             refreshInterval +\u003d\n                 ThreadLocalRandom.current()\n                                  .nextLong(-jitter, jitter);\n           }\n           // Make sure that after the jitter we didn\u0027t end up at 0.\n           refreshInterval \u003d Math.max(refreshInterval, 1);\n           Thread.sleep(refreshInterval);\n           // update the used variable\n           spaceUsed.refresh();\n         } catch (InterruptedException e) {\n-          LOG.warn(\"Thread Interrupted waiting to refresh disk information\", e);\n+          LOG.warn(\"Thread Interrupted waiting to refresh disk information: \"\n+              + e.getMessage());\n           Thread.currentThread().interrupt();\n         }\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void run() {\n      while (spaceUsed.running()) {\n        try {\n          long refreshInterval \u003d spaceUsed.refreshInterval;\n\n          if (spaceUsed.jitter \u003e 0) {\n            long jitter \u003d spaceUsed.jitter;\n            // add/subtract the jitter.\n            refreshInterval +\u003d\n                ThreadLocalRandom.current()\n                                 .nextLong(-jitter, jitter);\n          }\n          // Make sure that after the jitter we didn\u0027t end up at 0.\n          refreshInterval \u003d Math.max(refreshInterval, 1);\n          Thread.sleep(refreshInterval);\n          // update the used variable\n          spaceUsed.refresh();\n        } catch (InterruptedException e) {\n          LOG.warn(\"Thread Interrupted waiting to refresh disk information: \"\n              + e.getMessage());\n          Thread.currentThread().interrupt();\n        }\n      }\n    }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/CachingGetSpaceUsed.java",
      "extendedDetails": {}
    },
    "bf780406f2b30e627bdf36ac07973f6931f81106": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-12975. Add jitter to CachingGetSpaceUsed\u0027s thread (Elliott Clark via Colin P. McCabe)\n",
      "commitDate": "16/06/16 4:48 PM",
      "commitName": "bf780406f2b30e627bdf36ac07973f6931f81106",
      "commitAuthor": "Colin Patrick Mccabe",
      "commitDateOld": "12/04/16 4:28 PM",
      "commitNameOld": "35f07705552ef5636f8b8d2599a6af5ec1426203",
      "commitAuthorOld": "Colin Patrick Mccabe",
      "daysBetweenCommits": 65.01,
      "commitsBetweenForRepo": 426,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,12 +1,23 @@\n     public void run() {\n       while (spaceUsed.running()) {\n         try {\n-          Thread.sleep(spaceUsed.getRefreshInterval());\n+          long refreshInterval \u003d spaceUsed.refreshInterval;\n+\n+          if (spaceUsed.jitter \u003e 0) {\n+            long jitter \u003d spaceUsed.jitter;\n+            // add/subtract the jitter.\n+            refreshInterval +\u003d\n+                ThreadLocalRandom.current()\n+                                 .nextLong(-jitter, jitter);\n+          }\n+          // Make sure that after the jitter we didn\u0027t end up at 0.\n+          refreshInterval \u003d Math.max(refreshInterval, 1);\n+          Thread.sleep(refreshInterval);\n           // update the used variable\n           spaceUsed.refresh();\n         } catch (InterruptedException e) {\n           LOG.warn(\"Thread Interrupted waiting to refresh disk information\", e);\n           Thread.currentThread().interrupt();\n         }\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void run() {\n      while (spaceUsed.running()) {\n        try {\n          long refreshInterval \u003d spaceUsed.refreshInterval;\n\n          if (spaceUsed.jitter \u003e 0) {\n            long jitter \u003d spaceUsed.jitter;\n            // add/subtract the jitter.\n            refreshInterval +\u003d\n                ThreadLocalRandom.current()\n                                 .nextLong(-jitter, jitter);\n          }\n          // Make sure that after the jitter we didn\u0027t end up at 0.\n          refreshInterval \u003d Math.max(refreshInterval, 1);\n          Thread.sleep(refreshInterval);\n          // update the used variable\n          spaceUsed.refresh();\n        } catch (InterruptedException e) {\n          LOG.warn(\"Thread Interrupted waiting to refresh disk information\", e);\n          Thread.currentThread().interrupt();\n        }\n      }\n    }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/CachingGetSpaceUsed.java",
      "extendedDetails": {}
    },
    "35f07705552ef5636f8b8d2599a6af5ec1426203": {
      "type": "Yintroduced",
      "commitMessage": "HADOOP-12973. Make DU pluggable. (Elliott Clark via cmccabe)\n",
      "commitDate": "12/04/16 4:28 PM",
      "commitName": "35f07705552ef5636f8b8d2599a6af5ec1426203",
      "commitAuthor": "Colin Patrick Mccabe",
      "diff": "@@ -0,0 +1,12 @@\n+    public void run() {\n+      while (spaceUsed.running()) {\n+        try {\n+          Thread.sleep(spaceUsed.getRefreshInterval());\n+          // update the used variable\n+          spaceUsed.refresh();\n+        } catch (InterruptedException e) {\n+          LOG.warn(\"Thread Interrupted waiting to refresh disk information\", e);\n+          Thread.currentThread().interrupt();\n+        }\n+      }\n+    }\n\\ No newline at end of file\n",
      "actualSource": "    public void run() {\n      while (spaceUsed.running()) {\n        try {\n          Thread.sleep(spaceUsed.getRefreshInterval());\n          // update the used variable\n          spaceUsed.refresh();\n        } catch (InterruptedException e) {\n          LOG.warn(\"Thread Interrupted waiting to refresh disk information\", e);\n          Thread.currentThread().interrupt();\n        }\n      }\n    }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/CachingGetSpaceUsed.java"
    }
  }
}