{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "IdentityTransformer.java",
  "functionName": "transformAclEntriesForGetRequest",
  "functionId": "transformAclEntriesForGetRequest___aclEntries-List__AclEntry__(modifiers-final)__localUser-String__localGroup-String",
  "sourceFilePath": "hadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/oauth2/IdentityTransformer.java",
  "functionStartLine": 245,
  "functionEndLine": 279,
  "numCommitsSeen": 5,
  "timeTaken": 1636,
  "changeHistory": [
    "43a91f820a5fce75ea69f78a62331bdc58e09a37"
  ],
  "changeHistoryShort": {
    "43a91f820a5fce75ea69f78a62331bdc58e09a37": "Yintroduced"
  },
  "changeHistoryDetails": {
    "43a91f820a5fce75ea69f78a62331bdc58e09a37": {
      "type": "Yintroduced",
      "commitMessage": "HADOOP-16315. ABFS: transform full UPN for named user in AclStatus\n\nContributed by Da Zhou\n\nChange-Id: Ibc78322415fcbeff89c06c8586c53f5695550290\n",
      "commitDate": "09/08/19 4:38 AM",
      "commitName": "43a91f820a5fce75ea69f78a62331bdc58e09a37",
      "commitAuthor": "Da Zhou",
      "diff": "@@ -0,0 +1,35 @@\n+  public void transformAclEntriesForGetRequest(final List\u003cAclEntry\u003e aclEntries, String localUser, String localGroup) {\n+    if (skipUserIdentityReplacement) {\n+      return;\n+    }\n+\n+    for (int i \u003d 0; i \u003c aclEntries.size(); i++) {\n+      AclEntry aclEntry \u003d aclEntries.get(i);\n+      String name \u003d aclEntry.getName();\n+      String transformedName \u003d name;\n+      if (name \u003d\u003d null || name.isEmpty() || aclEntry.getType().equals(AclEntryType.OTHER) || aclEntry.getType().equals(AclEntryType.MASK)) {\n+        continue;\n+      }\n+\n+      // when type of aclEntry is user or group\n+      if (aclEntry.getType().equals(AclEntryType.USER)) {\n+        transformedName \u003d transformIdentityForGetRequest(name, true, localUser);\n+      } else if (aclEntry.getType().equals(AclEntryType.GROUP)) {\n+        transformedName \u003d transformIdentityForGetRequest(name, false, localGroup);\n+      }\n+\n+      // Avoid unnecessary new AclEntry allocation\n+      if (transformedName.equals(name)) {\n+        continue;\n+      }\n+\n+      AclEntry.Builder aclEntryBuilder \u003d new AclEntry.Builder();\n+      aclEntryBuilder.setType(aclEntry.getType());\n+      aclEntryBuilder.setName(transformedName);\n+      aclEntryBuilder.setScope(aclEntry.getScope());\n+      aclEntryBuilder.setPermission(aclEntry.getPermission());\n+\n+      // Replace the original AclEntry\n+      aclEntries.set(i, aclEntryBuilder.build());\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  public void transformAclEntriesForGetRequest(final List\u003cAclEntry\u003e aclEntries, String localUser, String localGroup) {\n    if (skipUserIdentityReplacement) {\n      return;\n    }\n\n    for (int i \u003d 0; i \u003c aclEntries.size(); i++) {\n      AclEntry aclEntry \u003d aclEntries.get(i);\n      String name \u003d aclEntry.getName();\n      String transformedName \u003d name;\n      if (name \u003d\u003d null || name.isEmpty() || aclEntry.getType().equals(AclEntryType.OTHER) || aclEntry.getType().equals(AclEntryType.MASK)) {\n        continue;\n      }\n\n      // when type of aclEntry is user or group\n      if (aclEntry.getType().equals(AclEntryType.USER)) {\n        transformedName \u003d transformIdentityForGetRequest(name, true, localUser);\n      } else if (aclEntry.getType().equals(AclEntryType.GROUP)) {\n        transformedName \u003d transformIdentityForGetRequest(name, false, localGroup);\n      }\n\n      // Avoid unnecessary new AclEntry allocation\n      if (transformedName.equals(name)) {\n        continue;\n      }\n\n      AclEntry.Builder aclEntryBuilder \u003d new AclEntry.Builder();\n      aclEntryBuilder.setType(aclEntry.getType());\n      aclEntryBuilder.setName(transformedName);\n      aclEntryBuilder.setScope(aclEntry.getScope());\n      aclEntryBuilder.setPermission(aclEntry.getPermission());\n\n      // Replace the original AclEntry\n      aclEntries.set(i, aclEntryBuilder.build());\n    }\n  }",
      "path": "hadoop-tools/hadoop-azure/src/main/java/org/apache/hadoop/fs/azurebfs/oauth2/IdentityTransformer.java"
    }
  }
}