{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "TimelineReaderWebServices.java",
  "functionName": "checkAccess",
  "functionId": "checkAccess___readerManager-TimelineReaderManager__ugi-UserGroupInformation__entityUser-String",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-timelineservice/src/main/java/org/apache/hadoop/yarn/server/timelineservice/reader/TimelineReaderWebServices.java",
  "functionStartLine": 3637,
  "functionEndLine": 3649,
  "numCommitsSeen": 36,
  "timeTaken": 1651,
  "changeHistory": [
    "f4bda5e8e9fee6c5a0dda7c79ef14e73aec20e7e",
    "63e08ec071852640babea9e39780327a0907712a",
    "469b29c0817b7bf1902c9195c4f8d031a909e1c9"
  ],
  "changeHistoryShort": {
    "f4bda5e8e9fee6c5a0dda7c79ef14e73aec20e7e": "Ybodychange",
    "63e08ec071852640babea9e39780327a0907712a": "Ybodychange",
    "469b29c0817b7bf1902c9195c4f8d031a909e1c9": "Yintroduced"
  },
  "changeHistoryDetails": {
    "f4bda5e8e9fee6c5a0dda7c79ef14e73aec20e7e": {
      "type": "Ybodychange",
      "commitMessage": "YARN-8630. ATSv2 REST APIs should honor filter-entity-list-by-user in non-secure cluster when ACls are enabled. Contributed by Rohith Sharma K S.\n",
      "commitDate": "13/09/18 5:17 AM",
      "commitName": "f4bda5e8e9fee6c5a0dda7c79ef14e73aec20e7e",
      "commitAuthor": "Sunil G",
      "commitDateOld": "30/07/18 2:18 AM",
      "commitNameOld": "63e08ec071852640babea9e39780327a0907712a",
      "commitAuthorOld": "Sunil G",
      "daysBetweenCommits": 45.12,
      "commitsBetweenForRepo": 388,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,13 +1,13 @@\n   static boolean checkAccess(TimelineReaderManager readerManager,\n       UserGroupInformation ugi, String entityUser) {\n     if (isDisplayEntityPerUserFilterEnabled(readerManager.getConfig())) {\n-      if (ugi !\u003d null \u0026\u0026 !validateAuthUserWithEntityUser(readerManager, ugi,\n+      if (!validateAuthUserWithEntityUser(readerManager, ugi,\n           entityUser)) {\n-        String userName \u003d ugi.getShortUserName();\n+        String userName \u003d ugi \u003d\u003d null ? null : ugi.getShortUserName();\n         String msg \u003d \"User \" + userName\n             + \" is not allowed to read TimelineService V2 data.\";\n         throw new ForbiddenException(msg);\n       }\n     }\n     return true;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  static boolean checkAccess(TimelineReaderManager readerManager,\n      UserGroupInformation ugi, String entityUser) {\n    if (isDisplayEntityPerUserFilterEnabled(readerManager.getConfig())) {\n      if (!validateAuthUserWithEntityUser(readerManager, ugi,\n          entityUser)) {\n        String userName \u003d ugi \u003d\u003d null ? null : ugi.getShortUserName();\n        String msg \u003d \"User \" + userName\n            + \" is not allowed to read TimelineService V2 data.\";\n        throw new ForbiddenException(msg);\n      }\n    }\n    return true;\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-timelineservice/src/main/java/org/apache/hadoop/yarn/server/timelineservice/reader/TimelineReaderWebServices.java",
      "extendedDetails": {}
    },
    "63e08ec071852640babea9e39780327a0907712a": {
      "type": "Ybodychange",
      "commitMessage": "YARN-8591. [ATSv2] NPE while checking for entity acl in non-secure cluster. Contributed by Rohith Sharma K S.\n",
      "commitDate": "30/07/18 2:18 AM",
      "commitName": "63e08ec071852640babea9e39780327a0907712a",
      "commitAuthor": "Sunil G",
      "commitDateOld": "29/06/18 10:02 AM",
      "commitNameOld": "469b29c0817b7bf1902c9195c4f8d031a909e1c9",
      "commitAuthorOld": "Sunil G",
      "daysBetweenCommits": 30.68,
      "commitsBetweenForRepo": 186,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,12 +1,13 @@\n   static boolean checkAccess(TimelineReaderManager readerManager,\n       UserGroupInformation ugi, String entityUser) {\n     if (isDisplayEntityPerUserFilterEnabled(readerManager.getConfig())) {\n-      if (!validateAuthUserWithEntityUser(readerManager, ugi, entityUser)) {\n+      if (ugi !\u003d null \u0026\u0026 !validateAuthUserWithEntityUser(readerManager, ugi,\n+          entityUser)) {\n         String userName \u003d ugi.getShortUserName();\n         String msg \u003d \"User \" + userName\n             + \" is not allowed to read TimelineService V2 data.\";\n         throw new ForbiddenException(msg);\n       }\n     }\n     return true;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  static boolean checkAccess(TimelineReaderManager readerManager,\n      UserGroupInformation ugi, String entityUser) {\n    if (isDisplayEntityPerUserFilterEnabled(readerManager.getConfig())) {\n      if (ugi !\u003d null \u0026\u0026 !validateAuthUserWithEntityUser(readerManager, ugi,\n          entityUser)) {\n        String userName \u003d ugi.getShortUserName();\n        String msg \u003d \"User \" + userName\n            + \" is not allowed to read TimelineService V2 data.\";\n        throw new ForbiddenException(msg);\n      }\n    }\n    return true;\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-timelineservice/src/main/java/org/apache/hadoop/yarn/server/timelineservice/reader/TimelineReaderWebServices.java",
      "extendedDetails": {}
    },
    "469b29c0817b7bf1902c9195c4f8d031a909e1c9": {
      "type": "Yintroduced",
      "commitMessage": "YARN-8455. Add basic ACL check for all ATS v2 REST APIs. Contributed by Rohith Sharma K S.\n",
      "commitDate": "29/06/18 10:02 AM",
      "commitName": "469b29c0817b7bf1902c9195c4f8d031a909e1c9",
      "commitAuthor": "Sunil G",
      "diff": "@@ -0,0 +1,12 @@\n+  static boolean checkAccess(TimelineReaderManager readerManager,\n+      UserGroupInformation ugi, String entityUser) {\n+    if (isDisplayEntityPerUserFilterEnabled(readerManager.getConfig())) {\n+      if (!validateAuthUserWithEntityUser(readerManager, ugi, entityUser)) {\n+        String userName \u003d ugi.getShortUserName();\n+        String msg \u003d \"User \" + userName\n+            + \" is not allowed to read TimelineService V2 data.\";\n+        throw new ForbiddenException(msg);\n+      }\n+    }\n+    return true;\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  static boolean checkAccess(TimelineReaderManager readerManager,\n      UserGroupInformation ugi, String entityUser) {\n    if (isDisplayEntityPerUserFilterEnabled(readerManager.getConfig())) {\n      if (!validateAuthUserWithEntityUser(readerManager, ugi, entityUser)) {\n        String userName \u003d ugi.getShortUserName();\n        String msg \u003d \"User \" + userName\n            + \" is not allowed to read TimelineService V2 data.\";\n        throw new ForbiddenException(msg);\n      }\n    }\n    return true;\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-timelineservice/src/main/java/org/apache/hadoop/yarn/server/timelineservice/reader/TimelineReaderWebServices.java"
    }
  }
}