{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "ServiceClient.java",
  "functionName": "addFilesToCompression",
  "functionId": "addFilesToCompression___taos-TarArchiveOutputStream__file-File__dir-String__bundleRoot-String",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-services/hadoop-yarn-services-core/src/main/java/org/apache/hadoop/yarn/service/client/ServiceClient.java",
  "functionStartLine": 1086,
  "functionEndLine": 1119,
  "numCommitsSeen": 53,
  "timeTaken": 1055,
  "changeHistory": [
    "d07e873b7db6cb317eccb4768607c1afb505c99b"
  ],
  "changeHistoryShort": {
    "d07e873b7db6cb317eccb4768607c1afb505c99b": "Yintroduced"
  },
  "changeHistoryDetails": {
    "d07e873b7db6cb317eccb4768607c1afb505c99b": {
      "type": "Yintroduced",
      "commitMessage": "YARN-8569. Create an interface to provide cluster information to application. Contributed by Eric Yang\n",
      "commitDate": "26/10/18 5:57 PM",
      "commitName": "d07e873b7db6cb317eccb4768607c1afb505c99b",
      "commitAuthor": "Billie Rinaldi",
      "diff": "@@ -0,0 +1,34 @@\n+  private static void addFilesToCompression(TarArchiveOutputStream taos,\n+      File file, String dir, String bundleRoot) throws IOException {\n+    if (!file.isHidden()) {\n+      // Create an entry for the file\n+      if (!dir.equals(\".\")) {\n+        if (File.separator.equals(\"\\\\\")) {\n+          dir \u003d dir.replaceAll(\"\\\\\\\\\", \"/\");\n+        }\n+      }\n+      taos.putArchiveEntry(\n+          new TarArchiveEntry(file, dir + \"/\" + file.getName()));\n+      if (file.isFile()) {\n+        // Add the file to the archive\n+        try (FileInputStream input \u003d new FileInputStream(file)) {\n+          IOUtils.copy(input, taos);\n+          taos.closeArchiveEntry();\n+        }\n+      } else if (file.isDirectory()) {\n+        // close the archive entry\n+        if (!dir.equals(\".\")) {\n+          taos.closeArchiveEntry();\n+        }\n+        // go through all the files in the directory and using recursion, add\n+        // them to the archive\n+        File[] allFiles \u003d file.listFiles();\n+        if (allFiles !\u003d null) {\n+          for (File childFile : allFiles) {\n+            addFilesToCompression(taos, childFile,\n+                file.getPath().substring(bundleRoot.length()), bundleRoot);\n+          }\n+        }\n+      }\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private static void addFilesToCompression(TarArchiveOutputStream taos,\n      File file, String dir, String bundleRoot) throws IOException {\n    if (!file.isHidden()) {\n      // Create an entry for the file\n      if (!dir.equals(\".\")) {\n        if (File.separator.equals(\"\\\\\")) {\n          dir \u003d dir.replaceAll(\"\\\\\\\\\", \"/\");\n        }\n      }\n      taos.putArchiveEntry(\n          new TarArchiveEntry(file, dir + \"/\" + file.getName()));\n      if (file.isFile()) {\n        // Add the file to the archive\n        try (FileInputStream input \u003d new FileInputStream(file)) {\n          IOUtils.copy(input, taos);\n          taos.closeArchiveEntry();\n        }\n      } else if (file.isDirectory()) {\n        // close the archive entry\n        if (!dir.equals(\".\")) {\n          taos.closeArchiveEntry();\n        }\n        // go through all the files in the directory and using recursion, add\n        // them to the archive\n        File[] allFiles \u003d file.listFiles();\n        if (allFiles !\u003d null) {\n          for (File childFile : allFiles) {\n            addFilesToCompression(taos, childFile,\n                file.getPath().substring(bundleRoot.length()), bundleRoot);\n          }\n        }\n      }\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-services/hadoop-yarn-services-core/src/main/java/org/apache/hadoop/yarn/service/client/ServiceClient.java"
    }
  }
}