{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "DirectoryWithSnapshotFeature.java",
  "functionName": "destroyCreatedList",
  "functionId": "destroyCreatedList___reclaimContext-INode.ReclaimContext__currentINode-INodeDirectory(modifiers-final)",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
  "functionStartLine": 72,
  "functionEndLine": 80,
  "numCommitsSeen": 187,
  "timeTaken": 7474,
  "changeHistory": [
    "ba0da2785d251745969f88a50d33ce61876d91aa",
    "b2c85db86c9a62b0a03ee87547265077f664970a",
    "4536399d47f6c061e149e2504600804a0f1e093d",
    "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
    "5dae97a584d30cef3e34141edfaca49c4ec57913",
    "44a6560b5da3f79d2299579a36e7a2a60a91f823",
    "92e0416ced279a910616985bf11fa3f8b1b1de9b",
    "ca7c588185cbc982c7929e743535bf4fcab41beb",
    "9701555899315c94584b24d8717c1d7540a4a491",
    "3b3ea5c4220e674064c7603a449f63904c10bac1",
    "c7cf85ccb4ff2f58839e113f1baf903a468b606d",
    "f29fa9e820e25730d00a1a00c51c6f11028fb5a7"
  ],
  "changeHistoryShort": {
    "ba0da2785d251745969f88a50d33ce61876d91aa": "Ybodychange",
    "b2c85db86c9a62b0a03ee87547265077f664970a": "Ymultichange(Yreturntypechange,Ybodychange)",
    "4536399d47f6c061e149e2504600804a0f1e093d": "Ymultichange(Yparameterchange,Ybodychange)",
    "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63": "Ymultichange(Yparameterchange,Ybodychange)",
    "5dae97a584d30cef3e34141edfaca49c4ec57913": "Ymultichange(Yparameterchange,Yreturntypechange,Ybodychange)",
    "44a6560b5da3f79d2299579a36e7a2a60a91f823": "Ymultichange(Yfilerename,Yparameterchange)",
    "92e0416ced279a910616985bf11fa3f8b1b1de9b": "Ymultichange(Yparameterchange,Ybodychange)",
    "ca7c588185cbc982c7929e743535bf4fcab41beb": "Ymultichange(Yreturntypechange,Ybodychange)",
    "9701555899315c94584b24d8717c1d7540a4a491": "Ybodychange",
    "3b3ea5c4220e674064c7603a449f63904c10bac1": "Ymultichange(Yreturntypechange,Ybodychange)",
    "c7cf85ccb4ff2f58839e113f1baf903a468b606d": "Ybodychange",
    "f29fa9e820e25730d00a1a00c51c6f11028fb5a7": "Yintroduced"
  },
  "changeHistoryDetails": {
    "ba0da2785d251745969f88a50d33ce61876d91aa": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-13252. Code refactoring: Remove Diff.ListType.\n",
      "commitDate": "09/03/18 3:50 PM",
      "commitName": "ba0da2785d251745969f88a50d33ce61876d91aa",
      "commitAuthor": "Tsz-Wo Nicholas Sze",
      "commitDateOld": "06/03/18 1:35 PM",
      "commitNameOld": "346caa209571dedf1331b2658d5702b45dd40bfe",
      "commitAuthorOld": "Tsz-Wo Nicholas Sze",
      "daysBetweenCommits": 3.09,
      "commitsBetweenForRepo": 27,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,10 +1,9 @@\n     private void destroyCreatedList(INode.ReclaimContext reclaimContext,\n         final INodeDirectory currentINode) {\n-      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n-      for (INode c : createdList) {\n+      for (INode c : getCreatedUnmodifiable()) {\n         c.destroyAndCollectBlocks(reclaimContext);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n-      createdList.clear();\n+      clearCreated();\n     }\n\\ No newline at end of file\n",
      "actualSource": "    private void destroyCreatedList(INode.ReclaimContext reclaimContext,\n        final INodeDirectory currentINode) {\n      for (INode c : getCreatedUnmodifiable()) {\n        c.destroyAndCollectBlocks(reclaimContext);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      clearCreated();\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
      "extendedDetails": {}
    },
    "b2c85db86c9a62b0a03ee87547265077f664970a": {
      "type": "Ymultichange(Yreturntypechange,Ybodychange)",
      "commitMessage": "HDFS-7728. Avoid updating quota usage while loading edits. Contributed by Jing Zhao.\n",
      "commitDate": "13/05/15 9:50 PM",
      "commitName": "b2c85db86c9a62b0a03ee87547265077f664970a",
      "commitAuthor": "Haohui Mai",
      "subchanges": [
        {
          "type": "Yreturntypechange",
          "commitMessage": "HDFS-7728. Avoid updating quota usage while loading edits. Contributed by Jing Zhao.\n",
          "commitDate": "13/05/15 9:50 PM",
          "commitName": "b2c85db86c9a62b0a03ee87547265077f664970a",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "09/05/15 10:51 PM",
          "commitNameOld": "4536399d47f6c061e149e2504600804a0f1e093d",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 3.96,
          "commitsBetweenForRepo": 43,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,10 @@\n-    private QuotaCounts destroyCreatedList(\n-        INode.ReclaimContext reclaimContext, final INodeDirectory currentINode) {\n-      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n+    private void destroyCreatedList(INode.ReclaimContext reclaimContext,\n+        final INodeDirectory currentINode) {\n       final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n-        c.computeQuotaUsage(reclaimContext.storagePolicySuite(), counts, true);\n         c.destroyAndCollectBlocks(reclaimContext);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n-      return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private void destroyCreatedList(INode.ReclaimContext reclaimContext,\n        final INodeDirectory currentINode) {\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.destroyAndCollectBlocks(reclaimContext);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {
            "oldValue": "QuotaCounts",
            "newValue": "void"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-7728. Avoid updating quota usage while loading edits. Contributed by Jing Zhao.\n",
          "commitDate": "13/05/15 9:50 PM",
          "commitName": "b2c85db86c9a62b0a03ee87547265077f664970a",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "09/05/15 10:51 PM",
          "commitNameOld": "4536399d47f6c061e149e2504600804a0f1e093d",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 3.96,
          "commitsBetweenForRepo": 43,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,10 @@\n-    private QuotaCounts destroyCreatedList(\n-        INode.ReclaimContext reclaimContext, final INodeDirectory currentINode) {\n-      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n+    private void destroyCreatedList(INode.ReclaimContext reclaimContext,\n+        final INodeDirectory currentINode) {\n       final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n-        c.computeQuotaUsage(reclaimContext.storagePolicySuite(), counts, true);\n         c.destroyAndCollectBlocks(reclaimContext);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n-      return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private void destroyCreatedList(INode.ReclaimContext reclaimContext,\n        final INodeDirectory currentINode) {\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.destroyAndCollectBlocks(reclaimContext);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {}
        }
      ]
    },
    "4536399d47f6c061e149e2504600804a0f1e093d": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HDFS-8357. Consolidate parameters of INode.CleanSubtree() into a parameter objects. Contributed by Li Lu.\n",
      "commitDate": "09/05/15 10:51 PM",
      "commitName": "4536399d47f6c061e149e2504600804a0f1e093d",
      "commitAuthor": "Haohui Mai",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-8357. Consolidate parameters of INode.CleanSubtree() into a parameter objects. Contributed by Li Lu.\n",
          "commitDate": "09/05/15 10:51 PM",
          "commitName": "4536399d47f6c061e149e2504600804a0f1e093d",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "08/05/15 11:04 PM",
          "commitNameOld": "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 0.99,
          "commitsBetweenForRepo": 7,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,16 +1,13 @@\n     private QuotaCounts destroyCreatedList(\n-        final BlockStoragePolicySuite bsps, final INodeDirectory currentINode,\n-        final BlocksMapUpdateInfo collectedBlocks,\n-        final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n+        INode.ReclaimContext reclaimContext, final INodeDirectory currentINode) {\n       QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n       final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n-        c.computeQuotaUsage(bsps, counts, true);\n-        c.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes,\n-                                  removedUCFiles);\n+        c.computeQuotaUsage(reclaimContext.storagePolicySuite(), counts, true);\n+        c.destroyAndCollectBlocks(reclaimContext);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private QuotaCounts destroyCreatedList(\n        INode.ReclaimContext reclaimContext, final INodeDirectory currentINode) {\n      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.computeQuotaUsage(reclaimContext.storagePolicySuite(), counts, true);\n        c.destroyAndCollectBlocks(reclaimContext);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {
            "oldValue": "[bsps-BlockStoragePolicySuite(modifiers-final), currentINode-INodeDirectory(modifiers-final), collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final), removedUCFiles-List\u003cLong\u003e]",
            "newValue": "[reclaimContext-INode.ReclaimContext, currentINode-INodeDirectory(modifiers-final)]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-8357. Consolidate parameters of INode.CleanSubtree() into a parameter objects. Contributed by Li Lu.\n",
          "commitDate": "09/05/15 10:51 PM",
          "commitName": "4536399d47f6c061e149e2504600804a0f1e093d",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "08/05/15 11:04 PM",
          "commitNameOld": "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 0.99,
          "commitsBetweenForRepo": 7,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,16 +1,13 @@\n     private QuotaCounts destroyCreatedList(\n-        final BlockStoragePolicySuite bsps, final INodeDirectory currentINode,\n-        final BlocksMapUpdateInfo collectedBlocks,\n-        final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n+        INode.ReclaimContext reclaimContext, final INodeDirectory currentINode) {\n       QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n       final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n-        c.computeQuotaUsage(bsps, counts, true);\n-        c.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes,\n-                                  removedUCFiles);\n+        c.computeQuotaUsage(reclaimContext.storagePolicySuite(), counts, true);\n+        c.destroyAndCollectBlocks(reclaimContext);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private QuotaCounts destroyCreatedList(\n        INode.ReclaimContext reclaimContext, final INodeDirectory currentINode) {\n      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.computeQuotaUsage(reclaimContext.storagePolicySuite(), counts, true);\n        c.destroyAndCollectBlocks(reclaimContext);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {}
        }
      ]
    },
    "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HDFS-6757. Simplify lease manager with INodeID. Contributed by Haohui Mai.\n",
      "commitDate": "08/05/15 11:04 PM",
      "commitName": "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
      "commitAuthor": "Haohui Mai",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-6757. Simplify lease manager with INodeID. Contributed by Haohui Mai.\n",
          "commitDate": "08/05/15 11:04 PM",
          "commitName": "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "02/04/15 9:20 PM",
          "commitNameOld": "72f6bd4893dcf10d6dad24753f9be99505a87a1f",
          "commitAuthorOld": "Jing Zhao",
          "daysBetweenCommits": 36.07,
          "commitsBetweenForRepo": 375,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,16 +1,16 @@\n     private QuotaCounts destroyCreatedList(\n-        final BlockStoragePolicySuite bsps,\n-        final INodeDirectory currentINode,\n+        final BlockStoragePolicySuite bsps, final INodeDirectory currentINode,\n         final BlocksMapUpdateInfo collectedBlocks,\n-        final List\u003cINode\u003e removedINodes) {\n+        final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n       QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n       final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n         c.computeQuotaUsage(bsps, counts, true);\n-        c.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n+        c.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes,\n+                                  removedUCFiles);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private QuotaCounts destroyCreatedList(\n        final BlockStoragePolicySuite bsps, final INodeDirectory currentINode,\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.computeQuotaUsage(bsps, counts, true);\n        c.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes,\n                                  removedUCFiles);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {
            "oldValue": "[bsps-BlockStoragePolicySuite(modifiers-final), currentINode-INodeDirectory(modifiers-final), collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final)]",
            "newValue": "[bsps-BlockStoragePolicySuite(modifiers-final), currentINode-INodeDirectory(modifiers-final), collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final), removedUCFiles-List\u003cLong\u003e]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-6757. Simplify lease manager with INodeID. Contributed by Haohui Mai.\n",
          "commitDate": "08/05/15 11:04 PM",
          "commitName": "00fe1ed3a4b3ee35fe24be257ec36445d2f44d63",
          "commitAuthor": "Haohui Mai",
          "commitDateOld": "02/04/15 9:20 PM",
          "commitNameOld": "72f6bd4893dcf10d6dad24753f9be99505a87a1f",
          "commitAuthorOld": "Jing Zhao",
          "daysBetweenCommits": 36.07,
          "commitsBetweenForRepo": 375,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,16 +1,16 @@\n     private QuotaCounts destroyCreatedList(\n-        final BlockStoragePolicySuite bsps,\n-        final INodeDirectory currentINode,\n+        final BlockStoragePolicySuite bsps, final INodeDirectory currentINode,\n         final BlocksMapUpdateInfo collectedBlocks,\n-        final List\u003cINode\u003e removedINodes) {\n+        final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n       QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n       final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n         c.computeQuotaUsage(bsps, counts, true);\n-        c.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n+        c.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes,\n+                                  removedUCFiles);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private QuotaCounts destroyCreatedList(\n        final BlockStoragePolicySuite bsps, final INodeDirectory currentINode,\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes, List\u003cLong\u003e removedUCFiles) {\n      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.computeQuotaUsage(bsps, counts, true);\n        c.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes,\n                                  removedUCFiles);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {}
        }
      ]
    },
    "5dae97a584d30cef3e34141edfaca49c4ec57913": {
      "type": "Ymultichange(Yparameterchange,Yreturntypechange,Ybodychange)",
      "commitMessage": "HDFS-7723. Quota By Storage Type namenode implemenation. (Contributed by Xiaoyu Yao)\n",
      "commitDate": "11/02/15 10:41 AM",
      "commitName": "5dae97a584d30cef3e34141edfaca49c4ec57913",
      "commitAuthor": "Arpit Agarwal",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-7723. Quota By Storage Type namenode implemenation. (Contributed by Xiaoyu Yao)\n",
          "commitDate": "11/02/15 10:41 AM",
          "commitName": "5dae97a584d30cef3e34141edfaca49c4ec57913",
          "commitAuthor": "Arpit Agarwal",
          "commitDateOld": "02/02/15 4:32 PM",
          "commitNameOld": "8cb473124c1cf1c6f68ead7bde06558ebf7ce47e",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 8.76,
          "commitsBetweenForRepo": 109,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,14 +1,16 @@\n-    private Quota.Counts destroyCreatedList(final INodeDirectory currentINode,\n+    private QuotaCounts destroyCreatedList(\n+        final BlockStoragePolicySuite bsps,\n+        final INodeDirectory currentINode,\n         final BlocksMapUpdateInfo collectedBlocks,\n         final List\u003cINode\u003e removedINodes) {\n-      Quota.Counts counts \u003d Quota.Counts.newInstance();\n+      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n       final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n-        c.computeQuotaUsage(counts, true);\n-        c.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n+        c.computeQuotaUsage(bsps, counts, true);\n+        c.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private QuotaCounts destroyCreatedList(\n        final BlockStoragePolicySuite bsps,\n        final INodeDirectory currentINode,\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes) {\n      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.computeQuotaUsage(bsps, counts, true);\n        c.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {
            "oldValue": "[currentINode-INodeDirectory(modifiers-final), collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final)]",
            "newValue": "[bsps-BlockStoragePolicySuite(modifiers-final), currentINode-INodeDirectory(modifiers-final), collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final)]"
          }
        },
        {
          "type": "Yreturntypechange",
          "commitMessage": "HDFS-7723. Quota By Storage Type namenode implemenation. (Contributed by Xiaoyu Yao)\n",
          "commitDate": "11/02/15 10:41 AM",
          "commitName": "5dae97a584d30cef3e34141edfaca49c4ec57913",
          "commitAuthor": "Arpit Agarwal",
          "commitDateOld": "02/02/15 4:32 PM",
          "commitNameOld": "8cb473124c1cf1c6f68ead7bde06558ebf7ce47e",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 8.76,
          "commitsBetweenForRepo": 109,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,14 +1,16 @@\n-    private Quota.Counts destroyCreatedList(final INodeDirectory currentINode,\n+    private QuotaCounts destroyCreatedList(\n+        final BlockStoragePolicySuite bsps,\n+        final INodeDirectory currentINode,\n         final BlocksMapUpdateInfo collectedBlocks,\n         final List\u003cINode\u003e removedINodes) {\n-      Quota.Counts counts \u003d Quota.Counts.newInstance();\n+      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n       final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n-        c.computeQuotaUsage(counts, true);\n-        c.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n+        c.computeQuotaUsage(bsps, counts, true);\n+        c.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private QuotaCounts destroyCreatedList(\n        final BlockStoragePolicySuite bsps,\n        final INodeDirectory currentINode,\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes) {\n      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.computeQuotaUsage(bsps, counts, true);\n        c.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {
            "oldValue": "Quota.Counts",
            "newValue": "QuotaCounts"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-7723. Quota By Storage Type namenode implemenation. (Contributed by Xiaoyu Yao)\n",
          "commitDate": "11/02/15 10:41 AM",
          "commitName": "5dae97a584d30cef3e34141edfaca49c4ec57913",
          "commitAuthor": "Arpit Agarwal",
          "commitDateOld": "02/02/15 4:32 PM",
          "commitNameOld": "8cb473124c1cf1c6f68ead7bde06558ebf7ce47e",
          "commitAuthorOld": "Haohui Mai",
          "daysBetweenCommits": 8.76,
          "commitsBetweenForRepo": 109,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,14 +1,16 @@\n-    private Quota.Counts destroyCreatedList(final INodeDirectory currentINode,\n+    private QuotaCounts destroyCreatedList(\n+        final BlockStoragePolicySuite bsps,\n+        final INodeDirectory currentINode,\n         final BlocksMapUpdateInfo collectedBlocks,\n         final List\u003cINode\u003e removedINodes) {\n-      Quota.Counts counts \u003d Quota.Counts.newInstance();\n+      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n       final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n-        c.computeQuotaUsage(counts, true);\n-        c.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n+        c.computeQuotaUsage(bsps, counts, true);\n+        c.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private QuotaCounts destroyCreatedList(\n        final BlockStoragePolicySuite bsps,\n        final INodeDirectory currentINode,\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes) {\n      QuotaCounts counts \u003d new QuotaCounts.Builder().build();\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.computeQuotaUsage(bsps, counts, true);\n        c.destroyAndCollectBlocks(bsps, collectedBlocks, removedINodes);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {}
        }
      ]
    },
    "44a6560b5da3f79d2299579a36e7a2a60a91f823": {
      "type": "Ymultichange(Yfilerename,Yparameterchange)",
      "commitMessage": "HDFS-5632. Flatten INodeDirectory hierarchy: Replace INodeDirectoryWithSnapshot with DirectoryWithSnapshotFeature.  Contributed by jing9 \n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1550917 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "14/12/13 2:13 AM",
      "commitName": "44a6560b5da3f79d2299579a36e7a2a60a91f823",
      "commitAuthor": "Tsz-wo Sze",
      "subchanges": [
        {
          "type": "Yfilerename",
          "commitMessage": "HDFS-5632. Flatten INodeDirectory hierarchy: Replace INodeDirectoryWithSnapshot with DirectoryWithSnapshotFeature.  Contributed by jing9 \n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1550917 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "14/12/13 2:13 AM",
          "commitName": "44a6560b5da3f79d2299579a36e7a2a60a91f823",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "13/12/13 6:00 PM",
          "commitNameOld": "d63cfdbf1a5389acb27e8cd61f4c14d8eaedb26f",
          "commitAuthorOld": "Zhijie Shen",
          "daysBetweenCommits": 0.34,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,15 +1,14 @@\n-    private Quota.Counts destroyCreatedList(\n-        final INodeDirectoryWithSnapshot currentINode,\n+    private Quota.Counts destroyCreatedList(final INodeDirectory currentINode,\n         final BlocksMapUpdateInfo collectedBlocks,\n         final List\u003cINode\u003e removedINodes) {\n       Quota.Counts counts \u003d Quota.Counts.newInstance();\n       final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n         c.computeQuotaUsage(counts, true);\n         c.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private Quota.Counts destroyCreatedList(final INodeDirectory currentINode,\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.computeQuotaUsage(counts, true);\n        c.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {
            "oldPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
            "newPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java"
          }
        },
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-5632. Flatten INodeDirectory hierarchy: Replace INodeDirectoryWithSnapshot with DirectoryWithSnapshotFeature.  Contributed by jing9 \n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1550917 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "14/12/13 2:13 AM",
          "commitName": "44a6560b5da3f79d2299579a36e7a2a60a91f823",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "13/12/13 6:00 PM",
          "commitNameOld": "d63cfdbf1a5389acb27e8cd61f4c14d8eaedb26f",
          "commitAuthorOld": "Zhijie Shen",
          "daysBetweenCommits": 0.34,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,15 +1,14 @@\n-    private Quota.Counts destroyCreatedList(\n-        final INodeDirectoryWithSnapshot currentINode,\n+    private Quota.Counts destroyCreatedList(final INodeDirectory currentINode,\n         final BlocksMapUpdateInfo collectedBlocks,\n         final List\u003cINode\u003e removedINodes) {\n       Quota.Counts counts \u003d Quota.Counts.newInstance();\n       final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n         c.computeQuotaUsage(counts, true);\n         c.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private Quota.Counts destroyCreatedList(final INodeDirectory currentINode,\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.computeQuotaUsage(counts, true);\n        c.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/DirectoryWithSnapshotFeature.java",
          "extendedDetails": {
            "oldValue": "[currentINode-INodeDirectoryWithSnapshot(modifiers-final), collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final)]",
            "newValue": "[currentINode-INodeDirectory(modifiers-final), collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final)]"
          }
        }
      ]
    },
    "92e0416ced279a910616985bf11fa3f8b1b1de9b": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HDFS-4727. Update inodeMap after deleting files/directories/snapshots.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1470756 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "22/04/13 5:00 PM",
      "commitName": "92e0416ced279a910616985bf11fa3f8b1b1de9b",
      "commitAuthor": "Tsz-wo Sze",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-4727. Update inodeMap after deleting files/directories/snapshots.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1470756 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "22/04/13 5:00 PM",
          "commitName": "92e0416ced279a910616985bf11fa3f8b1b1de9b",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "22/04/13 3:13 PM",
          "commitNameOld": "43bdc22e9207a74678665de5f109dd7e56fe979a",
          "commitAuthorOld": "Tsz-wo Sze",
          "daysBetweenCommits": 0.07,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,14 +1,15 @@\n     private Quota.Counts destroyCreatedList(\n         final INodeDirectoryWithSnapshot currentINode,\n-        final BlocksMapUpdateInfo collectedBlocks) {\n+        final BlocksMapUpdateInfo collectedBlocks,\n+        final List\u003cINode\u003e removedINodes) {\n       Quota.Counts counts \u003d Quota.Counts.newInstance();\n       final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n         c.computeQuotaUsage(counts, true);\n-        c.destroyAndCollectBlocks(collectedBlocks);\n+        c.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private Quota.Counts destroyCreatedList(\n        final INodeDirectoryWithSnapshot currentINode,\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.computeQuotaUsage(counts, true);\n        c.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
          "extendedDetails": {
            "oldValue": "[currentINode-INodeDirectoryWithSnapshot(modifiers-final), collectedBlocks-BlocksMapUpdateInfo(modifiers-final)]",
            "newValue": "[currentINode-INodeDirectoryWithSnapshot(modifiers-final), collectedBlocks-BlocksMapUpdateInfo(modifiers-final), removedINodes-List\u003cINode\u003e(modifiers-final)]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-4727. Update inodeMap after deleting files/directories/snapshots.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1470756 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "22/04/13 5:00 PM",
          "commitName": "92e0416ced279a910616985bf11fa3f8b1b1de9b",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "22/04/13 3:13 PM",
          "commitNameOld": "43bdc22e9207a74678665de5f109dd7e56fe979a",
          "commitAuthorOld": "Tsz-wo Sze",
          "daysBetweenCommits": 0.07,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,14 +1,15 @@\n     private Quota.Counts destroyCreatedList(\n         final INodeDirectoryWithSnapshot currentINode,\n-        final BlocksMapUpdateInfo collectedBlocks) {\n+        final BlocksMapUpdateInfo collectedBlocks,\n+        final List\u003cINode\u003e removedINodes) {\n       Quota.Counts counts \u003d Quota.Counts.newInstance();\n       final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n         c.computeQuotaUsage(counts, true);\n-        c.destroyAndCollectBlocks(collectedBlocks);\n+        c.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n       return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private Quota.Counts destroyCreatedList(\n        final INodeDirectoryWithSnapshot currentINode,\n        final BlocksMapUpdateInfo collectedBlocks,\n        final List\u003cINode\u003e removedINodes) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.computeQuotaUsage(counts, true);\n        c.destroyAndCollectBlocks(collectedBlocks, removedINodes);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
          "extendedDetails": {}
        }
      ]
    },
    "ca7c588185cbc982c7929e743535bf4fcab41beb": {
      "type": "Ymultichange(Yreturntypechange,Ybodychange)",
      "commitMessage": "HDFS-4616. Update the FilesDeleted metric while deleting file/dir in the current tree.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1459485 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "21/03/13 12:30 PM",
      "commitName": "ca7c588185cbc982c7929e743535bf4fcab41beb",
      "commitAuthor": "Tsz-wo Sze",
      "subchanges": [
        {
          "type": "Yreturntypechange",
          "commitMessage": "HDFS-4616. Update the FilesDeleted metric while deleting file/dir in the current tree.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1459485 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "21/03/13 12:30 PM",
          "commitName": "ca7c588185cbc982c7929e743535bf4fcab41beb",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "18/03/13 11:27 PM",
          "commitNameOld": "9701555899315c94584b24d8717c1d7540a4a491",
          "commitAuthorOld": "Tsz-wo Sze",
          "daysBetweenCommits": 2.54,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,11 +1,14 @@\n-    private void destroyCreatedList(\n+    private Quota.Counts destroyCreatedList(\n         final INodeDirectoryWithSnapshot currentINode,\n         final BlocksMapUpdateInfo collectedBlocks) {\n+      Quota.Counts counts \u003d Quota.Counts.newInstance();\n       final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n+        c.computeQuotaUsage(counts, true);\n         c.destroyAndCollectBlocks(collectedBlocks);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n+      return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private Quota.Counts destroyCreatedList(\n        final INodeDirectoryWithSnapshot currentINode,\n        final BlocksMapUpdateInfo collectedBlocks) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.computeQuotaUsage(counts, true);\n        c.destroyAndCollectBlocks(collectedBlocks);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
          "extendedDetails": {
            "oldValue": "void",
            "newValue": "Quota.Counts"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-4616. Update the FilesDeleted metric while deleting file/dir in the current tree.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1459485 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "21/03/13 12:30 PM",
          "commitName": "ca7c588185cbc982c7929e743535bf4fcab41beb",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "18/03/13 11:27 PM",
          "commitNameOld": "9701555899315c94584b24d8717c1d7540a4a491",
          "commitAuthorOld": "Tsz-wo Sze",
          "daysBetweenCommits": 2.54,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,11 +1,14 @@\n-    private void destroyCreatedList(\n+    private Quota.Counts destroyCreatedList(\n         final INodeDirectoryWithSnapshot currentINode,\n         final BlocksMapUpdateInfo collectedBlocks) {\n+      Quota.Counts counts \u003d Quota.Counts.newInstance();\n       final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n+        c.computeQuotaUsage(counts, true);\n         c.destroyAndCollectBlocks(collectedBlocks);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n+      return counts;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private Quota.Counts destroyCreatedList(\n        final INodeDirectoryWithSnapshot currentINode,\n        final BlocksMapUpdateInfo collectedBlocks) {\n      Quota.Counts counts \u003d Quota.Counts.newInstance();\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.computeQuotaUsage(counts, true);\n        c.destroyAndCollectBlocks(collectedBlocks);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n      return counts;\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
          "extendedDetails": {}
        }
      ]
    },
    "9701555899315c94584b24d8717c1d7540a4a491": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-4534. Add INodeReference in order to support rename with snapshots.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1458164 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "18/03/13 11:27 PM",
      "commitName": "9701555899315c94584b24d8717c1d7540a4a491",
      "commitAuthor": "Tsz-wo Sze",
      "commitDateOld": "11/03/13 7:41 PM",
      "commitNameOld": "3b3ea5c4220e674064c7603a449f63904c10bac1",
      "commitAuthorOld": "Tsz-wo Sze",
      "daysBetweenCommits": 7.16,
      "commitsBetweenForRepo": 42,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,11 +1,11 @@\n     private void destroyCreatedList(\n         final INodeDirectoryWithSnapshot currentINode,\n         final BlocksMapUpdateInfo collectedBlocks) {\n-      List\u003cINode\u003e createdList \u003d getCreatedList();\n+      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n       for (INode c : createdList) {\n         c.destroyAndCollectBlocks(collectedBlocks);\n         // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n     }\n\\ No newline at end of file\n",
      "actualSource": "    private void destroyCreatedList(\n        final INodeDirectoryWithSnapshot currentINode,\n        final BlocksMapUpdateInfo collectedBlocks) {\n      final List\u003cINode\u003e createdList \u003d getList(ListType.CREATED);\n      for (INode c : createdList) {\n        c.destroyAndCollectBlocks(collectedBlocks);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
      "extendedDetails": {}
    },
    "3b3ea5c4220e674064c7603a449f63904c10bac1": {
      "type": "Ymultichange(Yreturntypechange,Ybodychange)",
      "commitMessage": "HDFS-4563. Update namespace/diskspace usage after deleting snapshots.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1455396 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "11/03/13 7:41 PM",
      "commitName": "3b3ea5c4220e674064c7603a449f63904c10bac1",
      "commitAuthor": "Tsz-wo Sze",
      "subchanges": [
        {
          "type": "Yreturntypechange",
          "commitMessage": "HDFS-4563. Update namespace/diskspace usage after deleting snapshots.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1455396 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "11/03/13 7:41 PM",
          "commitName": "3b3ea5c4220e674064c7603a449f63904c10bac1",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "10/03/13 8:45 PM",
          "commitNameOld": "43f8d0b9c9e209eb503451613c2f8d3fed07c203",
          "commitAuthorOld": "Tsz-wo Sze",
          "daysBetweenCommits": 0.96,
          "commitsBetweenForRepo": 4,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,11 @@\n-    private int destroyCreatedList(\n+    private void destroyCreatedList(\n         final INodeDirectoryWithSnapshot currentINode,\n         final BlocksMapUpdateInfo collectedBlocks) {\n-      int removedNum \u003d 0;\n       List\u003cINode\u003e createdList \u003d getCreatedList();\n       for (INode c : createdList) {\n-        removedNum +\u003d c.destroyAndCollectBlocks(collectedBlocks);\n-        // if c is also contained in the children list, remove it\n+        c.destroyAndCollectBlocks(collectedBlocks);\n+        // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n-      return removedNum;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private void destroyCreatedList(\n        final INodeDirectoryWithSnapshot currentINode,\n        final BlocksMapUpdateInfo collectedBlocks) {\n      List\u003cINode\u003e createdList \u003d getCreatedList();\n      for (INode c : createdList) {\n        c.destroyAndCollectBlocks(collectedBlocks);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
          "extendedDetails": {
            "oldValue": "int",
            "newValue": "void"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-4563. Update namespace/diskspace usage after deleting snapshots.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1455396 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "11/03/13 7:41 PM",
          "commitName": "3b3ea5c4220e674064c7603a449f63904c10bac1",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "10/03/13 8:45 PM",
          "commitNameOld": "43f8d0b9c9e209eb503451613c2f8d3fed07c203",
          "commitAuthorOld": "Tsz-wo Sze",
          "daysBetweenCommits": 0.96,
          "commitsBetweenForRepo": 4,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,11 @@\n-    private int destroyCreatedList(\n+    private void destroyCreatedList(\n         final INodeDirectoryWithSnapshot currentINode,\n         final BlocksMapUpdateInfo collectedBlocks) {\n-      int removedNum \u003d 0;\n       List\u003cINode\u003e createdList \u003d getCreatedList();\n       for (INode c : createdList) {\n-        removedNum +\u003d c.destroyAndCollectBlocks(collectedBlocks);\n-        // if c is also contained in the children list, remove it\n+        c.destroyAndCollectBlocks(collectedBlocks);\n+        // c should be contained in the children list, remove it\n         currentINode.removeChild(c);\n       }\n       createdList.clear();\n-      return removedNum;\n     }\n\\ No newline at end of file\n",
          "actualSource": "    private void destroyCreatedList(\n        final INodeDirectoryWithSnapshot currentINode,\n        final BlocksMapUpdateInfo collectedBlocks) {\n      List\u003cINode\u003e createdList \u003d getCreatedList();\n      for (INode c : createdList) {\n        c.destroyAndCollectBlocks(collectedBlocks);\n        // c should be contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n    }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
          "extendedDetails": {}
        }
      ]
    },
    "c7cf85ccb4ff2f58839e113f1baf903a468b606d": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-4507. Update quota verification for snapshots.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1451081 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "27/02/13 7:08 PM",
      "commitName": "c7cf85ccb4ff2f58839e113f1baf903a468b606d",
      "commitAuthor": "Tsz-wo Sze",
      "commitDateOld": "26/02/13 2:04 PM",
      "commitNameOld": "e2a618e1cc3fb99115547af6540932860dc6766e",
      "commitAuthorOld": "Tsz-wo Sze",
      "daysBetweenCommits": 1.21,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,13 +1,13 @@\n     private int destroyCreatedList(\n         final INodeDirectoryWithSnapshot currentINode,\n         final BlocksMapUpdateInfo collectedBlocks) {\n       int removedNum \u003d 0;\n       List\u003cINode\u003e createdList \u003d getCreatedList();\n       for (INode c : createdList) {\n         removedNum +\u003d c.destroyAndCollectBlocks(collectedBlocks);\n         // if c is also contained in the children list, remove it\n-        currentINode.removeChild(c, null);\n+        currentINode.removeChild(c);\n       }\n       createdList.clear();\n       return removedNum;\n     }\n\\ No newline at end of file\n",
      "actualSource": "    private int destroyCreatedList(\n        final INodeDirectoryWithSnapshot currentINode,\n        final BlocksMapUpdateInfo collectedBlocks) {\n      int removedNum \u003d 0;\n      List\u003cINode\u003e createdList \u003d getCreatedList();\n      for (INode c : createdList) {\n        removedNum +\u003d c.destroyAndCollectBlocks(collectedBlocks);\n        // if c is also contained in the children list, remove it\n        currentINode.removeChild(c);\n      }\n      createdList.clear();\n      return removedNum;\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java",
      "extendedDetails": {}
    },
    "f29fa9e820e25730d00a1a00c51c6f11028fb5a7": {
      "type": "Yintroduced",
      "commitMessage": "HDFS-4499. Fix file/directory/snapshot deletion for file diff.  Contributed by Jing Zhao\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/branches/HDFS-2802@1448504 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "20/02/13 7:27 PM",
      "commitName": "f29fa9e820e25730d00a1a00c51c6f11028fb5a7",
      "commitAuthor": "Tsz-wo Sze",
      "diff": "@@ -0,0 +1,13 @@\n+    private int destroyCreatedList(\n+        final INodeDirectoryWithSnapshot currentINode,\n+        final BlocksMapUpdateInfo collectedBlocks) {\n+      int removedNum \u003d 0;\n+      List\u003cINode\u003e createdList \u003d getCreatedList();\n+      for (INode c : createdList) {\n+        removedNum +\u003d c.destroyAndCollectBlocks(collectedBlocks);\n+        // if c is also contained in the children list, remove it\n+        currentINode.removeChild(c, null);\n+      }\n+      createdList.clear();\n+      return removedNum;\n+    }\n\\ No newline at end of file\n",
      "actualSource": "    private int destroyCreatedList(\n        final INodeDirectoryWithSnapshot currentINode,\n        final BlocksMapUpdateInfo collectedBlocks) {\n      int removedNum \u003d 0;\n      List\u003cINode\u003e createdList \u003d getCreatedList();\n      for (INode c : createdList) {\n        removedNum +\u003d c.destroyAndCollectBlocks(collectedBlocks);\n        // if c is also contained in the children list, remove it\n        currentINode.removeChild(c, null);\n      }\n      createdList.clear();\n      return removedNum;\n    }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/snapshot/INodeDirectoryWithSnapshot.java"
    }
  }
}