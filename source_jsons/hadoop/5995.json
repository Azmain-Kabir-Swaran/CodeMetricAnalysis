{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "NamenodeFsck.java",
  "functionName": "getBlockLocations",
  "functionId": "getBlockLocations___path-String__file-HdfsFileStatus",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/NamenodeFsck.java",
  "functionStartLine": 564,
  "functionEndLine": 583,
  "numCommitsSeen": 120,
  "timeTaken": 4189,
  "changeHistory": [
    "4b95c242eca540455a4d5d0899aaf73b6064b5ea",
    "ff0b99eafeda035ebe0dc82cfe689808047a8893",
    "015535dc0ad00c2ba357afb3d1e283e56ddda0d6",
    "6e3fcffe291faec40fa9214f4880a35a952836c4",
    "a38a37c63417a3b19dcdf98251af196c9d7b8c31",
    "3dd6395bb2448e5b178a51c864e3c9a3d12e8bc9",
    "ef4e9963b25d7d2e30f1071ddcaa9d92a7fe70f3"
  ],
  "changeHistoryShort": {
    "4b95c242eca540455a4d5d0899aaf73b6064b5ea": "Ybodychange",
    "ff0b99eafeda035ebe0dc82cfe689808047a8893": "Ybodychange",
    "015535dc0ad00c2ba357afb3d1e283e56ddda0d6": "Ybodychange",
    "6e3fcffe291faec40fa9214f4880a35a952836c4": "Ybodychange",
    "a38a37c63417a3b19dcdf98251af196c9d7b8c31": "Ybodychange",
    "3dd6395bb2448e5b178a51c864e3c9a3d12e8bc9": "Ybodychange",
    "ef4e9963b25d7d2e30f1071ddcaa9d92a7fe70f3": "Yintroduced"
  },
  "changeHistoryDetails": {
    "4b95c242eca540455a4d5d0899aaf73b6064b5ea": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-14743. Enhance INodeAttributeProvider/ AccessControlEnforcer Interface in HDFS to support Authorization of mkdir, rm, rmdir, copy, move etc... (#1829)\n\nReviewed-by: Xiaoyu Yao \u003cxyao@apache.org\u003e",
      "commitDate": "13/03/20 11:29 AM",
      "commitName": "4b95c242eca540455a4d5d0899aaf73b6064b5ea",
      "commitAuthor": "Wei-Chiu Chuang",
      "commitDateOld": "31/01/20 4:13 PM",
      "commitNameOld": "1e3a0b0d931676b191cb4813ed1a283ebb24d4eb",
      "commitAuthorOld": "Stephen O\u0027Donnell",
      "daysBetweenCommits": 41.76,
      "commitsBetweenForRepo": 132,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,18 +1,20 @@\n   private LocatedBlocks getBlockLocations(String path, HdfsFileStatus file)\n       throws IOException {\n     long fileLen \u003d file.getLen();\n     LocatedBlocks blocks \u003d null;\n     final FSNamesystem fsn \u003d namenode.getNamesystem();\n+    final String operationName \u003d \"fsckGetBlockLocations\";\n+    FSPermissionChecker.setOperationType(operationName);\n     fsn.readLock();\n     try {\n       blocks \u003d FSDirStatAndListingOp.getBlockLocations(\n           fsn.getFSDirectory(), fsn.getPermissionChecker(),\n           path, 0, fileLen, false)\n           .blocks;\n     } catch (FileNotFoundException fnfe) {\n       blocks \u003d null;\n     } finally {\n-      fsn.readUnlock(\"fsckGetBlockLocations\");\n+      fsn.readUnlock(operationName);\n     }\n     return blocks;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private LocatedBlocks getBlockLocations(String path, HdfsFileStatus file)\n      throws IOException {\n    long fileLen \u003d file.getLen();\n    LocatedBlocks blocks \u003d null;\n    final FSNamesystem fsn \u003d namenode.getNamesystem();\n    final String operationName \u003d \"fsckGetBlockLocations\";\n    FSPermissionChecker.setOperationType(operationName);\n    fsn.readLock();\n    try {\n      blocks \u003d FSDirStatAndListingOp.getBlockLocations(\n          fsn.getFSDirectory(), fsn.getPermissionChecker(),\n          path, 0, fileLen, false)\n          .blocks;\n    } catch (FileNotFoundException fnfe) {\n      blocks \u003d null;\n    } finally {\n      fsn.readUnlock(operationName);\n    }\n    return blocks;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/NamenodeFsck.java",
      "extendedDetails": {}
    },
    "ff0b99eafeda035ebe0dc82cfe689808047a8893": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-10872. Add MutableRate metrics for FSNamesystemLock operations. Contributed by Erik Krogen.\n",
      "commitDate": "14/11/16 11:05 AM",
      "commitName": "ff0b99eafeda035ebe0dc82cfe689808047a8893",
      "commitAuthor": "Zhe Zhang",
      "commitDateOld": "21/10/16 3:43 PM",
      "commitNameOld": "df857f0d10bda9fbb9c3f6ec77aba0cf46fe3631",
      "commitAuthorOld": "Wei-Chiu Chuang",
      "daysBetweenCommits": 23.85,
      "commitsBetweenForRepo": 237,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,18 +1,18 @@\n   private LocatedBlocks getBlockLocations(String path, HdfsFileStatus file)\n       throws IOException {\n     long fileLen \u003d file.getLen();\n     LocatedBlocks blocks \u003d null;\n     final FSNamesystem fsn \u003d namenode.getNamesystem();\n     fsn.readLock();\n     try {\n       blocks \u003d FSDirStatAndListingOp.getBlockLocations(\n           fsn.getFSDirectory(), fsn.getPermissionChecker(),\n           path, 0, fileLen, false)\n           .blocks;\n     } catch (FileNotFoundException fnfe) {\n       blocks \u003d null;\n     } finally {\n-      fsn.readUnlock();\n+      fsn.readUnlock(\"fsckGetBlockLocations\");\n     }\n     return blocks;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private LocatedBlocks getBlockLocations(String path, HdfsFileStatus file)\n      throws IOException {\n    long fileLen \u003d file.getLen();\n    LocatedBlocks blocks \u003d null;\n    final FSNamesystem fsn \u003d namenode.getNamesystem();\n    fsn.readLock();\n    try {\n      blocks \u003d FSDirStatAndListingOp.getBlockLocations(\n          fsn.getFSDirectory(), fsn.getPermissionChecker(),\n          path, 0, fileLen, false)\n          .blocks;\n    } catch (FileNotFoundException fnfe) {\n      blocks \u003d null;\n    } finally {\n      fsn.readUnlock(\"fsckGetBlockLocations\");\n    }\n    return blocks;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/NamenodeFsck.java",
      "extendedDetails": {}
    },
    "015535dc0ad00c2ba357afb3d1e283e56ddda0d6": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-8446. Separate safemode related operations in GetBlockLocations(). Contributed by Haohui Mai.\n",
      "commitDate": "17/06/15 4:38 PM",
      "commitName": "015535dc0ad00c2ba357afb3d1e283e56ddda0d6",
      "commitAuthor": "Haohui Mai",
      "commitDateOld": "17/06/15 8:05 AM",
      "commitNameOld": "6e3fcffe291faec40fa9214f4880a35a952836c4",
      "commitAuthorOld": "Andrew Wang",
      "daysBetweenCommits": 0.36,
      "commitsBetweenForRepo": 4,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,17 +1,18 @@\n   private LocatedBlocks getBlockLocations(String path, HdfsFileStatus file)\n       throws IOException {\n     long fileLen \u003d file.getLen();\n     LocatedBlocks blocks \u003d null;\n     final FSNamesystem fsn \u003d namenode.getNamesystem();\n     fsn.readLock();\n     try {\n-      blocks \u003d fsn.getBlockLocations(\n-          fsn.getPermissionChecker(), path, 0, fileLen, false, false)\n+      blocks \u003d FSDirStatAndListingOp.getBlockLocations(\n+          fsn.getFSDirectory(), fsn.getPermissionChecker(),\n+          path, 0, fileLen, false)\n           .blocks;\n     } catch (FileNotFoundException fnfe) {\n       blocks \u003d null;\n     } finally {\n       fsn.readUnlock();\n     }\n     return blocks;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private LocatedBlocks getBlockLocations(String path, HdfsFileStatus file)\n      throws IOException {\n    long fileLen \u003d file.getLen();\n    LocatedBlocks blocks \u003d null;\n    final FSNamesystem fsn \u003d namenode.getNamesystem();\n    fsn.readLock();\n    try {\n      blocks \u003d FSDirStatAndListingOp.getBlockLocations(\n          fsn.getFSDirectory(), fsn.getPermissionChecker(),\n          path, 0, fileLen, false)\n          .blocks;\n    } catch (FileNotFoundException fnfe) {\n      blocks \u003d null;\n    } finally {\n      fsn.readUnlock();\n    }\n    return blocks;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/NamenodeFsck.java",
      "extendedDetails": {}
    },
    "6e3fcffe291faec40fa9214f4880a35a952836c4": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-8608. Merge HDFS-7912 to trunk and branch-2 (track BlockInfo instead of Block in UnderReplicatedBlocks and PendingReplicationBlocks). Contributed by Zhe Zhang.\n",
      "commitDate": "17/06/15 8:05 AM",
      "commitName": "6e3fcffe291faec40fa9214f4880a35a952836c4",
      "commitAuthor": "Andrew Wang",
      "commitDateOld": "27/05/15 3:42 PM",
      "commitNameOld": "4928f5473394981829e5ffd4b16ea0801baf5c45",
      "commitAuthorOld": "Andrew Wang",
      "daysBetweenCommits": 20.68,
      "commitsBetweenForRepo": 151,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,17 +1,17 @@\n   private LocatedBlocks getBlockLocations(String path, HdfsFileStatus file)\n       throws IOException {\n     long fileLen \u003d file.getLen();\n     LocatedBlocks blocks \u003d null;\n-    FSNamesystem fsn \u003d namenode.getNamesystem();\n+    final FSNamesystem fsn \u003d namenode.getNamesystem();\n     fsn.readLock();\n     try {\n       blocks \u003d fsn.getBlockLocations(\n           fsn.getPermissionChecker(), path, 0, fileLen, false, false)\n           .blocks;\n     } catch (FileNotFoundException fnfe) {\n       blocks \u003d null;\n     } finally {\n       fsn.readUnlock();\n     }\n     return blocks;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private LocatedBlocks getBlockLocations(String path, HdfsFileStatus file)\n      throws IOException {\n    long fileLen \u003d file.getLen();\n    LocatedBlocks blocks \u003d null;\n    final FSNamesystem fsn \u003d namenode.getNamesystem();\n    fsn.readLock();\n    try {\n      blocks \u003d fsn.getBlockLocations(\n          fsn.getPermissionChecker(), path, 0, fileLen, false, false)\n          .blocks;\n    } catch (FileNotFoundException fnfe) {\n      blocks \u003d null;\n    } finally {\n      fsn.readUnlock();\n    }\n    return blocks;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/NamenodeFsck.java",
      "extendedDetails": {}
    },
    "a38a37c63417a3b19dcdf98251af196c9d7b8c31": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-7912. Erasure Coding: track BlockInfo instead of Block in UnderReplicatedBlocks and PendingReplicationBlocks. Contributed by Jing Zhao.\n",
      "commitDate": "26/05/15 11:41 AM",
      "commitName": "a38a37c63417a3b19dcdf98251af196c9d7b8c31",
      "commitAuthor": "Jing Zhao",
      "commitDateOld": "26/05/15 11:07 AM",
      "commitNameOld": "9af1f4779b646fb2f09b5e36447c8b8abe920a7c",
      "commitAuthorOld": "Zhe Zhang",
      "daysBetweenCommits": 0.02,
      "commitsBetweenForRepo": 10,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,17 +1,17 @@\n   private LocatedBlocks getBlockLocations(String path, HdfsFileStatus file)\n       throws IOException {\n     long fileLen \u003d file.getLen();\n     LocatedBlocks blocks \u003d null;\n-    FSNamesystem fsn \u003d namenode.getNamesystem();\n+    final FSNamesystem fsn \u003d namenode.getNamesystem();\n     fsn.readLock();\n     try {\n       blocks \u003d fsn.getBlockLocations(\n           fsn.getPermissionChecker(), path, 0, fileLen, false, false)\n           .blocks;\n     } catch (FileNotFoundException fnfe) {\n       blocks \u003d null;\n     } finally {\n       fsn.readUnlock();\n     }\n     return blocks;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private LocatedBlocks getBlockLocations(String path, HdfsFileStatus file)\n      throws IOException {\n    long fileLen \u003d file.getLen();\n    LocatedBlocks blocks \u003d null;\n    final FSNamesystem fsn \u003d namenode.getNamesystem();\n    fsn.readLock();\n    try {\n      blocks \u003d fsn.getBlockLocations(\n          fsn.getPermissionChecker(), path, 0, fileLen, false, false)\n          .blocks;\n    } catch (FileNotFoundException fnfe) {\n      blocks \u003d null;\n    } finally {\n      fsn.readUnlock();\n    }\n    return blocks;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/NamenodeFsck.java",
      "extendedDetails": {}
    },
    "3dd6395bb2448e5b178a51c864e3c9a3d12e8bc9": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-8269. getBlockLocations() does not resolve the .reserved path and generates incorrect edit logs when updating the atime. Contributed by Haohui Mai.\n",
      "commitDate": "29/04/15 11:12 AM",
      "commitName": "3dd6395bb2448e5b178a51c864e3c9a3d12e8bc9",
      "commitAuthor": "Haohui Mai",
      "commitDateOld": "23/04/15 2:19 PM",
      "commitNameOld": "ef4e9963b25d7d2e30f1071ddcaa9d92a7fe70f3",
      "commitAuthorOld": "Tsz-Wo Nicholas Sze",
      "daysBetweenCommits": 5.87,
      "commitsBetweenForRepo": 51,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,15 +1,17 @@\n   private LocatedBlocks getBlockLocations(String path, HdfsFileStatus file)\n       throws IOException {\n     long fileLen \u003d file.getLen();\n     LocatedBlocks blocks \u003d null;\n     FSNamesystem fsn \u003d namenode.getNamesystem();\n     fsn.readLock();\n     try {\n-      blocks \u003d fsn.getBlockLocations(path, 0, fileLen, false, false).blocks;\n+      blocks \u003d fsn.getBlockLocations(\n+          fsn.getPermissionChecker(), path, 0, fileLen, false, false)\n+          .blocks;\n     } catch (FileNotFoundException fnfe) {\n       blocks \u003d null;\n     } finally {\n       fsn.readUnlock();\n     }\n     return blocks;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private LocatedBlocks getBlockLocations(String path, HdfsFileStatus file)\n      throws IOException {\n    long fileLen \u003d file.getLen();\n    LocatedBlocks blocks \u003d null;\n    FSNamesystem fsn \u003d namenode.getNamesystem();\n    fsn.readLock();\n    try {\n      blocks \u003d fsn.getBlockLocations(\n          fsn.getPermissionChecker(), path, 0, fileLen, false, false)\n          .blocks;\n    } catch (FileNotFoundException fnfe) {\n      blocks \u003d null;\n    } finally {\n      fsn.readUnlock();\n    }\n    return blocks;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/NamenodeFsck.java",
      "extendedDetails": {}
    },
    "ef4e9963b25d7d2e30f1071ddcaa9d92a7fe70f3": {
      "type": "Yintroduced",
      "commitMessage": "HDFS-8215. Refactor NamenodeFsck#check method.  Contributed by Takanobu Asanuma\n",
      "commitDate": "23/04/15 2:19 PM",
      "commitName": "ef4e9963b25d7d2e30f1071ddcaa9d92a7fe70f3",
      "commitAuthor": "Tsz-Wo Nicholas Sze",
      "diff": "@@ -0,0 +1,15 @@\n+  private LocatedBlocks getBlockLocations(String path, HdfsFileStatus file)\n+      throws IOException {\n+    long fileLen \u003d file.getLen();\n+    LocatedBlocks blocks \u003d null;\n+    FSNamesystem fsn \u003d namenode.getNamesystem();\n+    fsn.readLock();\n+    try {\n+      blocks \u003d fsn.getBlockLocations(path, 0, fileLen, false, false).blocks;\n+    } catch (FileNotFoundException fnfe) {\n+      blocks \u003d null;\n+    } finally {\n+      fsn.readUnlock();\n+    }\n+    return blocks;\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private LocatedBlocks getBlockLocations(String path, HdfsFileStatus file)\n      throws IOException {\n    long fileLen \u003d file.getLen();\n    LocatedBlocks blocks \u003d null;\n    FSNamesystem fsn \u003d namenode.getNamesystem();\n    fsn.readLock();\n    try {\n      blocks \u003d fsn.getBlockLocations(path, 0, fileLen, false, false).blocks;\n    } catch (FileNotFoundException fnfe) {\n      blocks \u003d null;\n    } finally {\n      fsn.readUnlock();\n    }\n    return blocks;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/NamenodeFsck.java"
    }
  }
}