{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "BPOfferService.java",
  "functionName": "setNamespaceInfo",
  "functionId": "setNamespaceInfo___nsInfo-NamespaceInfo",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/BPOfferService.java",
  "functionStartLine": 243,
  "functionEndLine": 262,
  "numCommitsSeen": 87,
  "timeTaken": 971,
  "changeHistory": [
    "e7d187a1b6a826edd5bd0f708184d48f3674d489"
  ],
  "changeHistoryShort": {
    "e7d187a1b6a826edd5bd0f708184d48f3674d489": "Yintroduced"
  },
  "changeHistoryDetails": {
    "e7d187a1b6a826edd5bd0f708184d48f3674d489": {
      "type": "Yintroduced",
      "commitMessage": "HDFS-12140. Remove BPOfferService lock contention to get block pool id. Contributed by Daryn Sharp.\n",
      "commitDate": "14/07/17 2:07 PM",
      "commitName": "e7d187a1b6a826edd5bd0f708184d48f3674d489",
      "commitAuthor": "Kihwal Lee",
      "diff": "@@ -0,0 +1,20 @@\n+  NamespaceInfo setNamespaceInfo(NamespaceInfo nsInfo) throws IOException {\n+    writeLock();\n+    try {\n+      NamespaceInfo old \u003d bpNSInfo;\n+      if (bpNSInfo !\u003d null \u0026\u0026 nsInfo !\u003d null) {\n+        checkNSEquality(bpNSInfo.getBlockPoolID(), nsInfo.getBlockPoolID(),\n+            \"Blockpool ID\");\n+        checkNSEquality(bpNSInfo.getNamespaceID(), nsInfo.getNamespaceID(),\n+            \"Namespace ID\");\n+        checkNSEquality(bpNSInfo.getClusterID(), nsInfo.getClusterID(),\n+            \"Cluster ID\");\n+      }\n+      bpNSInfo \u003d nsInfo;\n+      // cache the block pool id for lock-free access.\n+      bpId \u003d (nsInfo !\u003d null) ? nsInfo.getBlockPoolID() : null;\n+      return old;\n+    } finally {\n+      writeUnlock();\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  NamespaceInfo setNamespaceInfo(NamespaceInfo nsInfo) throws IOException {\n    writeLock();\n    try {\n      NamespaceInfo old \u003d bpNSInfo;\n      if (bpNSInfo !\u003d null \u0026\u0026 nsInfo !\u003d null) {\n        checkNSEquality(bpNSInfo.getBlockPoolID(), nsInfo.getBlockPoolID(),\n            \"Blockpool ID\");\n        checkNSEquality(bpNSInfo.getNamespaceID(), nsInfo.getNamespaceID(),\n            \"Namespace ID\");\n        checkNSEquality(bpNSInfo.getClusterID(), nsInfo.getClusterID(),\n            \"Cluster ID\");\n      }\n      bpNSInfo \u003d nsInfo;\n      // cache the block pool id for lock-free access.\n      bpId \u003d (nsInfo !\u003d null) ? nsInfo.getBlockPoolID() : null;\n      return old;\n    } finally {\n      writeUnlock();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/BPOfferService.java"
    }
  }
}