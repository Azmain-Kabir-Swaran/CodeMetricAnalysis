{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "S3Guard.java",
  "functionName": "addAncestors",
  "functionId": "addAncestors___metadataStore-MetadataStore(modifiers-final)__qualifiedPath-Path(modifiers-final)__timeProvider-ITtlTimeProvider(modifiers-final)__operationState-BulkOperationState(annotations-@Nullable__modifiers-final)",
  "sourceFilePath": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/S3Guard.java",
  "functionStartLine": 710,
  "functionEndLine": 716,
  "numCommitsSeen": 46,
  "timeTaken": 4967,
  "changeHistory": [
    "c58e11bf521d746842ce16724211a2a0339d7b61",
    "e02eb24e0a9139418120027b694492e0738df20a",
    "f9cc9e162175444efe9d5b07ecb9a795f750ca3c",
    "a36274d69947648dbe82721220cc5240ec5d396d",
    "621b43e254afaff708cd6fc4698b29628f6abc33"
  ],
  "changeHistoryShort": {
    "c58e11bf521d746842ce16724211a2a0339d7b61": "Ybodychange",
    "e02eb24e0a9139418120027b694492e0738df20a": "Ymultichange(Yparameterchange,Ybodychange,Yparametermetachange)",
    "f9cc9e162175444efe9d5b07ecb9a795f750ca3c": "Ymultichange(Yparameterchange,Ybodychange)",
    "a36274d69947648dbe82721220cc5240ec5d396d": "Ybodychange",
    "621b43e254afaff708cd6fc4698b29628f6abc33": "Yintroduced"
  },
  "changeHistoryDetails": {
    "c58e11bf521d746842ce16724211a2a0339d7b61": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-16383. Pass ITtlTimeProvider instance in initialize method in MetadataStore interface.  Contributed by Gabor Bota. (#1009) \n\n\r\n",
      "commitDate": "17/07/19 7:24 AM",
      "commitName": "c58e11bf521d746842ce16724211a2a0339d7b61",
      "commitAuthor": "Gabor Bota",
      "commitDateOld": "08/07/19 10:27 AM",
      "commitNameOld": "de6b7bc67ace7744adb0320ee7de79cf28259d2d",
      "commitAuthorOld": "Sean Mackrory",
      "daysBetweenCommits": 8.87,
      "commitsBetweenForRepo": 79,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,7 +1,7 @@\n   public static void addAncestors(\n       final MetadataStore metadataStore,\n       final Path qualifiedPath,\n       final ITtlTimeProvider timeProvider,\n       @Nullable final BulkOperationState operationState) throws IOException {\n-    metadataStore.addAncestors(qualifiedPath, timeProvider, operationState);\n+    metadataStore.addAncestors(qualifiedPath, operationState);\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public static void addAncestors(\n      final MetadataStore metadataStore,\n      final Path qualifiedPath,\n      final ITtlTimeProvider timeProvider,\n      @Nullable final BulkOperationState operationState) throws IOException {\n    metadataStore.addAncestors(qualifiedPath, operationState);\n  }",
      "path": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/S3Guard.java",
      "extendedDetails": {}
    },
    "e02eb24e0a9139418120027b694492e0738df20a": {
      "type": "Ymultichange(Yparameterchange,Ybodychange,Yparametermetachange)",
      "commitMessage": "HADOOP-15183. S3Guard store becomes inconsistent after partial failure of rename.\n\nContributed by Steve Loughran.\n\nChange-Id: I825b0bc36be960475d2d259b1cdab45ae1bb78eb\n",
      "commitDate": "20/06/19 1:56 AM",
      "commitName": "e02eb24e0a9139418120027b694492e0738df20a",
      "commitAuthor": "Steve Loughran",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HADOOP-15183. S3Guard store becomes inconsistent after partial failure of rename.\n\nContributed by Steve Loughran.\n\nChange-Id: I825b0bc36be960475d2d259b1cdab45ae1bb78eb\n",
          "commitDate": "20/06/19 1:56 AM",
          "commitName": "e02eb24e0a9139418120027b694492e0738df20a",
          "commitAuthor": "Steve Loughran",
          "commitDateOld": "16/06/19 9:05 AM",
          "commitNameOld": "f9cc9e162175444efe9d5b07ecb9a795f750ca3c",
          "commitAuthorOld": "Gabor Bota",
          "daysBetweenCommits": 3.7,
          "commitsBetweenForRepo": 44,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,18 +1,7 @@\n-  public static void addAncestors(MetadataStore metadataStore,\n-      Path qualifiedPath, String username, ITtlTimeProvider timeProvider)\n-      throws IOException {\n-    Collection\u003cPathMetadata\u003e newDirs \u003d new ArrayList\u003c\u003e();\n-    Path parent \u003d qualifiedPath.getParent();\n-    while (!parent.isRoot()) {\n-      PathMetadata directory \u003d metadataStore.get(parent);\n-      if (directory \u003d\u003d null || directory.isDeleted()) {\n-        S3AFileStatus s3aStatus \u003d new S3AFileStatus(Tristate.FALSE, parent, username);\n-        PathMetadata meta \u003d new PathMetadata(s3aStatus, Tristate.FALSE, false);\n-        newDirs.add(meta);\n-      } else {\n-        break;\n-      }\n-      parent \u003d parent.getParent();\n-    }\n-    S3Guard.putWithTtl(metadataStore, newDirs, timeProvider);\n+  public static void addAncestors(\n+      final MetadataStore metadataStore,\n+      final Path qualifiedPath,\n+      final ITtlTimeProvider timeProvider,\n+      @Nullable final BulkOperationState operationState) throws IOException {\n+    metadataStore.addAncestors(qualifiedPath, timeProvider, operationState);\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public static void addAncestors(\n      final MetadataStore metadataStore,\n      final Path qualifiedPath,\n      final ITtlTimeProvider timeProvider,\n      @Nullable final BulkOperationState operationState) throws IOException {\n    metadataStore.addAncestors(qualifiedPath, timeProvider, operationState);\n  }",
          "path": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/S3Guard.java",
          "extendedDetails": {
            "oldValue": "[metadataStore-MetadataStore, qualifiedPath-Path, username-String, timeProvider-ITtlTimeProvider]",
            "newValue": "[metadataStore-MetadataStore(modifiers-final), qualifiedPath-Path(modifiers-final), timeProvider-ITtlTimeProvider(modifiers-final), operationState-BulkOperationState(annotations-@Nullable__modifiers-final)]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HADOOP-15183. S3Guard store becomes inconsistent after partial failure of rename.\n\nContributed by Steve Loughran.\n\nChange-Id: I825b0bc36be960475d2d259b1cdab45ae1bb78eb\n",
          "commitDate": "20/06/19 1:56 AM",
          "commitName": "e02eb24e0a9139418120027b694492e0738df20a",
          "commitAuthor": "Steve Loughran",
          "commitDateOld": "16/06/19 9:05 AM",
          "commitNameOld": "f9cc9e162175444efe9d5b07ecb9a795f750ca3c",
          "commitAuthorOld": "Gabor Bota",
          "daysBetweenCommits": 3.7,
          "commitsBetweenForRepo": 44,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,18 +1,7 @@\n-  public static void addAncestors(MetadataStore metadataStore,\n-      Path qualifiedPath, String username, ITtlTimeProvider timeProvider)\n-      throws IOException {\n-    Collection\u003cPathMetadata\u003e newDirs \u003d new ArrayList\u003c\u003e();\n-    Path parent \u003d qualifiedPath.getParent();\n-    while (!parent.isRoot()) {\n-      PathMetadata directory \u003d metadataStore.get(parent);\n-      if (directory \u003d\u003d null || directory.isDeleted()) {\n-        S3AFileStatus s3aStatus \u003d new S3AFileStatus(Tristate.FALSE, parent, username);\n-        PathMetadata meta \u003d new PathMetadata(s3aStatus, Tristate.FALSE, false);\n-        newDirs.add(meta);\n-      } else {\n-        break;\n-      }\n-      parent \u003d parent.getParent();\n-    }\n-    S3Guard.putWithTtl(metadataStore, newDirs, timeProvider);\n+  public static void addAncestors(\n+      final MetadataStore metadataStore,\n+      final Path qualifiedPath,\n+      final ITtlTimeProvider timeProvider,\n+      @Nullable final BulkOperationState operationState) throws IOException {\n+    metadataStore.addAncestors(qualifiedPath, timeProvider, operationState);\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public static void addAncestors(\n      final MetadataStore metadataStore,\n      final Path qualifiedPath,\n      final ITtlTimeProvider timeProvider,\n      @Nullable final BulkOperationState operationState) throws IOException {\n    metadataStore.addAncestors(qualifiedPath, timeProvider, operationState);\n  }",
          "path": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/S3Guard.java",
          "extendedDetails": {}
        },
        {
          "type": "Yparametermetachange",
          "commitMessage": "HADOOP-15183. S3Guard store becomes inconsistent after partial failure of rename.\n\nContributed by Steve Loughran.\n\nChange-Id: I825b0bc36be960475d2d259b1cdab45ae1bb78eb\n",
          "commitDate": "20/06/19 1:56 AM",
          "commitName": "e02eb24e0a9139418120027b694492e0738df20a",
          "commitAuthor": "Steve Loughran",
          "commitDateOld": "16/06/19 9:05 AM",
          "commitNameOld": "f9cc9e162175444efe9d5b07ecb9a795f750ca3c",
          "commitAuthorOld": "Gabor Bota",
          "daysBetweenCommits": 3.7,
          "commitsBetweenForRepo": 44,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,18 +1,7 @@\n-  public static void addAncestors(MetadataStore metadataStore,\n-      Path qualifiedPath, String username, ITtlTimeProvider timeProvider)\n-      throws IOException {\n-    Collection\u003cPathMetadata\u003e newDirs \u003d new ArrayList\u003c\u003e();\n-    Path parent \u003d qualifiedPath.getParent();\n-    while (!parent.isRoot()) {\n-      PathMetadata directory \u003d metadataStore.get(parent);\n-      if (directory \u003d\u003d null || directory.isDeleted()) {\n-        S3AFileStatus s3aStatus \u003d new S3AFileStatus(Tristate.FALSE, parent, username);\n-        PathMetadata meta \u003d new PathMetadata(s3aStatus, Tristate.FALSE, false);\n-        newDirs.add(meta);\n-      } else {\n-        break;\n-      }\n-      parent \u003d parent.getParent();\n-    }\n-    S3Guard.putWithTtl(metadataStore, newDirs, timeProvider);\n+  public static void addAncestors(\n+      final MetadataStore metadataStore,\n+      final Path qualifiedPath,\n+      final ITtlTimeProvider timeProvider,\n+      @Nullable final BulkOperationState operationState) throws IOException {\n+    metadataStore.addAncestors(qualifiedPath, timeProvider, operationState);\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public static void addAncestors(\n      final MetadataStore metadataStore,\n      final Path qualifiedPath,\n      final ITtlTimeProvider timeProvider,\n      @Nullable final BulkOperationState operationState) throws IOException {\n    metadataStore.addAncestors(qualifiedPath, timeProvider, operationState);\n  }",
          "path": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/S3Guard.java",
          "extendedDetails": {
            "oldValue": "[metadataStore-MetadataStore, qualifiedPath-Path, username-String, timeProvider-ITtlTimeProvider]",
            "newValue": "[metadataStore-MetadataStore(modifiers-final), qualifiedPath-Path(modifiers-final), timeProvider-ITtlTimeProvider(modifiers-final), operationState-BulkOperationState(annotations-@Nullable__modifiers-final)]"
          }
        }
      ]
    },
    "f9cc9e162175444efe9d5b07ecb9a795f750ca3c": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HADOOP-16279. S3Guard: Implement time-based (TTL) expiry for entries (and tombstones).\n\nContributed by Gabor Bota.\n\nChange-Id: I73a2d2861901dedfe7a0e783b310fbb95e7c1af9\n",
      "commitDate": "16/06/19 9:05 AM",
      "commitName": "f9cc9e162175444efe9d5b07ecb9a795f750ca3c",
      "commitAuthor": "Gabor Bota",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HADOOP-16279. S3Guard: Implement time-based (TTL) expiry for entries (and tombstones).\n\nContributed by Gabor Bota.\n\nChange-Id: I73a2d2861901dedfe7a0e783b310fbb95e7c1af9\n",
          "commitDate": "16/06/19 9:05 AM",
          "commitName": "f9cc9e162175444efe9d5b07ecb9a795f750ca3c",
          "commitAuthor": "Gabor Bota",
          "commitDateOld": "19/05/19 2:29 PM",
          "commitNameOld": "a36274d69947648dbe82721220cc5240ec5d396d",
          "commitAuthorOld": "Ben Roling",
          "daysBetweenCommits": 27.77,
          "commitsBetweenForRepo": 198,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,17 +1,18 @@\n   public static void addAncestors(MetadataStore metadataStore,\n-      Path qualifiedPath, String username) throws IOException {\n+      Path qualifiedPath, String username, ITtlTimeProvider timeProvider)\n+      throws IOException {\n     Collection\u003cPathMetadata\u003e newDirs \u003d new ArrayList\u003c\u003e();\n     Path parent \u003d qualifiedPath.getParent();\n     while (!parent.isRoot()) {\n       PathMetadata directory \u003d metadataStore.get(parent);\n       if (directory \u003d\u003d null || directory.isDeleted()) {\n         S3AFileStatus s3aStatus \u003d new S3AFileStatus(Tristate.FALSE, parent, username);\n         PathMetadata meta \u003d new PathMetadata(s3aStatus, Tristate.FALSE, false);\n         newDirs.add(meta);\n       } else {\n         break;\n       }\n       parent \u003d parent.getParent();\n     }\n-    metadataStore.put(newDirs);\n+    S3Guard.putWithTtl(metadataStore, newDirs, timeProvider);\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public static void addAncestors(MetadataStore metadataStore,\n      Path qualifiedPath, String username, ITtlTimeProvider timeProvider)\n      throws IOException {\n    Collection\u003cPathMetadata\u003e newDirs \u003d new ArrayList\u003c\u003e();\n    Path parent \u003d qualifiedPath.getParent();\n    while (!parent.isRoot()) {\n      PathMetadata directory \u003d metadataStore.get(parent);\n      if (directory \u003d\u003d null || directory.isDeleted()) {\n        S3AFileStatus s3aStatus \u003d new S3AFileStatus(Tristate.FALSE, parent, username);\n        PathMetadata meta \u003d new PathMetadata(s3aStatus, Tristate.FALSE, false);\n        newDirs.add(meta);\n      } else {\n        break;\n      }\n      parent \u003d parent.getParent();\n    }\n    S3Guard.putWithTtl(metadataStore, newDirs, timeProvider);\n  }",
          "path": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/S3Guard.java",
          "extendedDetails": {
            "oldValue": "[metadataStore-MetadataStore, qualifiedPath-Path, username-String]",
            "newValue": "[metadataStore-MetadataStore, qualifiedPath-Path, username-String, timeProvider-ITtlTimeProvider]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HADOOP-16279. S3Guard: Implement time-based (TTL) expiry for entries (and tombstones).\n\nContributed by Gabor Bota.\n\nChange-Id: I73a2d2861901dedfe7a0e783b310fbb95e7c1af9\n",
          "commitDate": "16/06/19 9:05 AM",
          "commitName": "f9cc9e162175444efe9d5b07ecb9a795f750ca3c",
          "commitAuthor": "Gabor Bota",
          "commitDateOld": "19/05/19 2:29 PM",
          "commitNameOld": "a36274d69947648dbe82721220cc5240ec5d396d",
          "commitAuthorOld": "Ben Roling",
          "daysBetweenCommits": 27.77,
          "commitsBetweenForRepo": 198,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,17 +1,18 @@\n   public static void addAncestors(MetadataStore metadataStore,\n-      Path qualifiedPath, String username) throws IOException {\n+      Path qualifiedPath, String username, ITtlTimeProvider timeProvider)\n+      throws IOException {\n     Collection\u003cPathMetadata\u003e newDirs \u003d new ArrayList\u003c\u003e();\n     Path parent \u003d qualifiedPath.getParent();\n     while (!parent.isRoot()) {\n       PathMetadata directory \u003d metadataStore.get(parent);\n       if (directory \u003d\u003d null || directory.isDeleted()) {\n         S3AFileStatus s3aStatus \u003d new S3AFileStatus(Tristate.FALSE, parent, username);\n         PathMetadata meta \u003d new PathMetadata(s3aStatus, Tristate.FALSE, false);\n         newDirs.add(meta);\n       } else {\n         break;\n       }\n       parent \u003d parent.getParent();\n     }\n-    metadataStore.put(newDirs);\n+    S3Guard.putWithTtl(metadataStore, newDirs, timeProvider);\n   }\n\\ No newline at end of file\n",
          "actualSource": "  public static void addAncestors(MetadataStore metadataStore,\n      Path qualifiedPath, String username, ITtlTimeProvider timeProvider)\n      throws IOException {\n    Collection\u003cPathMetadata\u003e newDirs \u003d new ArrayList\u003c\u003e();\n    Path parent \u003d qualifiedPath.getParent();\n    while (!parent.isRoot()) {\n      PathMetadata directory \u003d metadataStore.get(parent);\n      if (directory \u003d\u003d null || directory.isDeleted()) {\n        S3AFileStatus s3aStatus \u003d new S3AFileStatus(Tristate.FALSE, parent, username);\n        PathMetadata meta \u003d new PathMetadata(s3aStatus, Tristate.FALSE, false);\n        newDirs.add(meta);\n      } else {\n        break;\n      }\n      parent \u003d parent.getParent();\n    }\n    S3Guard.putWithTtl(metadataStore, newDirs, timeProvider);\n  }",
          "path": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/S3Guard.java",
          "extendedDetails": {}
        }
      ]
    },
    "a36274d69947648dbe82721220cc5240ec5d396d": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-16085. S3Guard: use object version or etags to protect against inconsistent read after replace/overwrite.\n\nContributed by Ben Roling.\n\nS3Guard will now track the etag of uploaded files and, if an S3\nbucket is versioned, the object version.\n\nYou can then control how to react to a mismatch between the data\nin the DynamoDB table and that in the store: warn, fail, or, when\nusing versions, return the original value.\n\nThis adds two new columns to the table: etag and version.\nThis is transparent to older S3A clients -but when such clients\nadd/update data to the S3Guard table, they will not add these values.\nAs a result, the etag/version checks will not work with files uploaded by older clients.\n\nFor a consistent experience, upgrade all clients to use the latest hadoop version.\n",
      "commitDate": "19/05/19 2:29 PM",
      "commitName": "a36274d69947648dbe82721220cc5240ec5d396d",
      "commitAuthor": "Ben Roling",
      "commitDateOld": "30/04/19 3:53 AM",
      "commitNameOld": "0af4011580878566213016af0c32633eabd15100",
      "commitAuthorOld": "Ben Roling",
      "daysBetweenCommits": 19.44,
      "commitsBetweenForRepo": 90,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,18 +1,17 @@\n   public static void addAncestors(MetadataStore metadataStore,\n       Path qualifiedPath, String username) throws IOException {\n     Collection\u003cPathMetadata\u003e newDirs \u003d new ArrayList\u003c\u003e();\n     Path parent \u003d qualifiedPath.getParent();\n     while (!parent.isRoot()) {\n       PathMetadata directory \u003d metadataStore.get(parent);\n       if (directory \u003d\u003d null || directory.isDeleted()) {\n-        FileStatus status \u003d new FileStatus(0, true, 1, 0, 0, 0, null, username,\n-            null, parent);\n-        PathMetadata meta \u003d new PathMetadata(status, Tristate.FALSE, false);\n+        S3AFileStatus s3aStatus \u003d new S3AFileStatus(Tristate.FALSE, parent, username);\n+        PathMetadata meta \u003d new PathMetadata(s3aStatus, Tristate.FALSE, false);\n         newDirs.add(meta);\n       } else {\n         break;\n       }\n       parent \u003d parent.getParent();\n     }\n     metadataStore.put(newDirs);\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public static void addAncestors(MetadataStore metadataStore,\n      Path qualifiedPath, String username) throws IOException {\n    Collection\u003cPathMetadata\u003e newDirs \u003d new ArrayList\u003c\u003e();\n    Path parent \u003d qualifiedPath.getParent();\n    while (!parent.isRoot()) {\n      PathMetadata directory \u003d metadataStore.get(parent);\n      if (directory \u003d\u003d null || directory.isDeleted()) {\n        S3AFileStatus s3aStatus \u003d new S3AFileStatus(Tristate.FALSE, parent, username);\n        PathMetadata meta \u003d new PathMetadata(s3aStatus, Tristate.FALSE, false);\n        newDirs.add(meta);\n      } else {\n        break;\n      }\n      parent \u003d parent.getParent();\n    }\n    metadataStore.put(newDirs);\n  }",
      "path": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/S3Guard.java",
      "extendedDetails": {}
    },
    "621b43e254afaff708cd6fc4698b29628f6abc33": {
      "type": "Yintroduced",
      "commitMessage": "HADOOP-13345 HS3Guard: Improved Consistency for S3A.\nContributed by: Chris Nauroth, Aaron Fabbri, Mingliang Liu, Lei (Eddy) Xu,\nSean Mackrory, Steve Loughran and others.\n",
      "commitDate": "01/09/17 6:13 AM",
      "commitName": "621b43e254afaff708cd6fc4698b29628f6abc33",
      "commitAuthor": "Steve Loughran",
      "diff": "@@ -0,0 +1,18 @@\n+  public static void addAncestors(MetadataStore metadataStore,\n+      Path qualifiedPath, String username) throws IOException {\n+    Collection\u003cPathMetadata\u003e newDirs \u003d new ArrayList\u003c\u003e();\n+    Path parent \u003d qualifiedPath.getParent();\n+    while (!parent.isRoot()) {\n+      PathMetadata directory \u003d metadataStore.get(parent);\n+      if (directory \u003d\u003d null || directory.isDeleted()) {\n+        FileStatus status \u003d new FileStatus(0, true, 1, 0, 0, 0, null, username,\n+            null, parent);\n+        PathMetadata meta \u003d new PathMetadata(status, Tristate.FALSE, false);\n+        newDirs.add(meta);\n+      } else {\n+        break;\n+      }\n+      parent \u003d parent.getParent();\n+    }\n+    metadataStore.put(newDirs);\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  public static void addAncestors(MetadataStore metadataStore,\n      Path qualifiedPath, String username) throws IOException {\n    Collection\u003cPathMetadata\u003e newDirs \u003d new ArrayList\u003c\u003e();\n    Path parent \u003d qualifiedPath.getParent();\n    while (!parent.isRoot()) {\n      PathMetadata directory \u003d metadataStore.get(parent);\n      if (directory \u003d\u003d null || directory.isDeleted()) {\n        FileStatus status \u003d new FileStatus(0, true, 1, 0, 0, 0, null, username,\n            null, parent);\n        PathMetadata meta \u003d new PathMetadata(status, Tristate.FALSE, false);\n        newDirs.add(meta);\n      } else {\n        break;\n      }\n      parent \u003d parent.getParent();\n    }\n    metadataStore.put(newDirs);\n  }",
      "path": "hadoop-tools/hadoop-aws/src/main/java/org/apache/hadoop/fs/s3a/s3guard/S3Guard.java"
    }
  }
}