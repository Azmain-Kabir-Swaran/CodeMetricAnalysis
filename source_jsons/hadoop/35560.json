{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "WindowsSecureContainerExecutor.java",
  "functionName": "createOutputStreamWithMode",
  "functionId": "createOutputStreamWithMode___f-Path__append-boolean__permission-FsPermission",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/WindowsSecureContainerExecutor.java",
  "functionStartLine": 363,
  "functionEndLine": 380,
  "numCommitsSeen": 23,
  "timeTaken": 2330,
  "changeHistory": [
    "e996a1bfd4f3ada6cbd9633fe68fda1e0c910bdf",
    "3b12fd6cfbf4cc91ef8e8616c7aafa9de006cde5"
  ],
  "changeHistoryShort": {
    "e996a1bfd4f3ada6cbd9633fe68fda1e0c910bdf": "Ymultichange(Yrename,Yparameterchange,Ybodychange)",
    "3b12fd6cfbf4cc91ef8e8616c7aafa9de006cde5": "Yintroduced"
  },
  "changeHistoryDetails": {
    "e996a1bfd4f3ada6cbd9633fe68fda1e0c910bdf": {
      "type": "Ymultichange(Yrename,Yparameterchange,Ybodychange)",
      "commitMessage": "HADOOP-11321. copyToLocal cannot save a file to an SMB share unless the user has Full Control permissions. Contributed by Chris Nauroth.\n",
      "commitDate": "16/12/14 3:29 PM",
      "commitName": "e996a1bfd4f3ada6cbd9633fe68fda1e0c910bdf",
      "commitAuthor": "cnauroth",
      "subchanges": [
        {
          "type": "Yrename",
          "commitMessage": "HADOOP-11321. copyToLocal cannot save a file to an SMB share unless the user has Full Control permissions. Contributed by Chris Nauroth.\n",
          "commitDate": "16/12/14 3:29 PM",
          "commitName": "e996a1bfd4f3ada6cbd9633fe68fda1e0c910bdf",
          "commitAuthor": "cnauroth",
          "commitDateOld": "22/10/14 3:57 PM",
          "commitNameOld": "3b12fd6cfbf4cc91ef8e8616c7aafa9de006cde5",
          "commitAuthorOld": "Jian He",
          "daysBetweenCommits": 55.02,
          "commitsBetweenForRepo": 458,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,7 +1,18 @@\n-      protected OutputStream createOutputStream(Path f, boolean append) \n-          throws IOException {\n+      protected OutputStream createOutputStreamWithMode(Path f, boolean append,\n+          FsPermission permission) throws IOException {\n         if (LOG.isDebugEnabled()) {\n-          LOG.debug(String.format(\"EFS:create: %s %b\", f, append));\n+          LOG.debug(String.format(\"EFS:createOutputStreamWithMode: %s %b %s\", f,\n+              append, permission));\n         }\n-        return Native.Elevated.create(f, append); \n+        boolean success \u003d false;\n+        OutputStream os \u003d Native.Elevated.create(f, append);\n+        try {\n+          setPermission(f, permission);\n+          success \u003d true;\n+          return os;\n+        } finally {\n+          if (!success) {\n+            IOUtils.cleanup(LOG, os);\n+          }\n+        }\n       }\n\\ No newline at end of file\n",
          "actualSource": "      protected OutputStream createOutputStreamWithMode(Path f, boolean append,\n          FsPermission permission) throws IOException {\n        if (LOG.isDebugEnabled()) {\n          LOG.debug(String.format(\"EFS:createOutputStreamWithMode: %s %b %s\", f,\n              append, permission));\n        }\n        boolean success \u003d false;\n        OutputStream os \u003d Native.Elevated.create(f, append);\n        try {\n          setPermission(f, permission);\n          success \u003d true;\n          return os;\n        } finally {\n          if (!success) {\n            IOUtils.cleanup(LOG, os);\n          }\n        }\n      }",
          "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/WindowsSecureContainerExecutor.java",
          "extendedDetails": {
            "oldValue": "createOutputStream",
            "newValue": "createOutputStreamWithMode"
          }
        },
        {
          "type": "Yparameterchange",
          "commitMessage": "HADOOP-11321. copyToLocal cannot save a file to an SMB share unless the user has Full Control permissions. Contributed by Chris Nauroth.\n",
          "commitDate": "16/12/14 3:29 PM",
          "commitName": "e996a1bfd4f3ada6cbd9633fe68fda1e0c910bdf",
          "commitAuthor": "cnauroth",
          "commitDateOld": "22/10/14 3:57 PM",
          "commitNameOld": "3b12fd6cfbf4cc91ef8e8616c7aafa9de006cde5",
          "commitAuthorOld": "Jian He",
          "daysBetweenCommits": 55.02,
          "commitsBetweenForRepo": 458,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,7 +1,18 @@\n-      protected OutputStream createOutputStream(Path f, boolean append) \n-          throws IOException {\n+      protected OutputStream createOutputStreamWithMode(Path f, boolean append,\n+          FsPermission permission) throws IOException {\n         if (LOG.isDebugEnabled()) {\n-          LOG.debug(String.format(\"EFS:create: %s %b\", f, append));\n+          LOG.debug(String.format(\"EFS:createOutputStreamWithMode: %s %b %s\", f,\n+              append, permission));\n         }\n-        return Native.Elevated.create(f, append); \n+        boolean success \u003d false;\n+        OutputStream os \u003d Native.Elevated.create(f, append);\n+        try {\n+          setPermission(f, permission);\n+          success \u003d true;\n+          return os;\n+        } finally {\n+          if (!success) {\n+            IOUtils.cleanup(LOG, os);\n+          }\n+        }\n       }\n\\ No newline at end of file\n",
          "actualSource": "      protected OutputStream createOutputStreamWithMode(Path f, boolean append,\n          FsPermission permission) throws IOException {\n        if (LOG.isDebugEnabled()) {\n          LOG.debug(String.format(\"EFS:createOutputStreamWithMode: %s %b %s\", f,\n              append, permission));\n        }\n        boolean success \u003d false;\n        OutputStream os \u003d Native.Elevated.create(f, append);\n        try {\n          setPermission(f, permission);\n          success \u003d true;\n          return os;\n        } finally {\n          if (!success) {\n            IOUtils.cleanup(LOG, os);\n          }\n        }\n      }",
          "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/WindowsSecureContainerExecutor.java",
          "extendedDetails": {
            "oldValue": "[f-Path, append-boolean]",
            "newValue": "[f-Path, append-boolean, permission-FsPermission]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HADOOP-11321. copyToLocal cannot save a file to an SMB share unless the user has Full Control permissions. Contributed by Chris Nauroth.\n",
          "commitDate": "16/12/14 3:29 PM",
          "commitName": "e996a1bfd4f3ada6cbd9633fe68fda1e0c910bdf",
          "commitAuthor": "cnauroth",
          "commitDateOld": "22/10/14 3:57 PM",
          "commitNameOld": "3b12fd6cfbf4cc91ef8e8616c7aafa9de006cde5",
          "commitAuthorOld": "Jian He",
          "daysBetweenCommits": 55.02,
          "commitsBetweenForRepo": 458,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,7 +1,18 @@\n-      protected OutputStream createOutputStream(Path f, boolean append) \n-          throws IOException {\n+      protected OutputStream createOutputStreamWithMode(Path f, boolean append,\n+          FsPermission permission) throws IOException {\n         if (LOG.isDebugEnabled()) {\n-          LOG.debug(String.format(\"EFS:create: %s %b\", f, append));\n+          LOG.debug(String.format(\"EFS:createOutputStreamWithMode: %s %b %s\", f,\n+              append, permission));\n         }\n-        return Native.Elevated.create(f, append); \n+        boolean success \u003d false;\n+        OutputStream os \u003d Native.Elevated.create(f, append);\n+        try {\n+          setPermission(f, permission);\n+          success \u003d true;\n+          return os;\n+        } finally {\n+          if (!success) {\n+            IOUtils.cleanup(LOG, os);\n+          }\n+        }\n       }\n\\ No newline at end of file\n",
          "actualSource": "      protected OutputStream createOutputStreamWithMode(Path f, boolean append,\n          FsPermission permission) throws IOException {\n        if (LOG.isDebugEnabled()) {\n          LOG.debug(String.format(\"EFS:createOutputStreamWithMode: %s %b %s\", f,\n              append, permission));\n        }\n        boolean success \u003d false;\n        OutputStream os \u003d Native.Elevated.create(f, append);\n        try {\n          setPermission(f, permission);\n          success \u003d true;\n          return os;\n        } finally {\n          if (!success) {\n            IOUtils.cleanup(LOG, os);\n          }\n        }\n      }",
          "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/WindowsSecureContainerExecutor.java",
          "extendedDetails": {}
        }
      ]
    },
    "3b12fd6cfbf4cc91ef8e8616c7aafa9de006cde5": {
      "type": "Yintroduced",
      "commitMessage": "YARN-2198. Remove the need to run NodeManager as privileged account for Windows Secure Container Executor. Contributed by Remus Rusanu\n",
      "commitDate": "22/10/14 3:57 PM",
      "commitName": "3b12fd6cfbf4cc91ef8e8616c7aafa9de006cde5",
      "commitAuthor": "Jian He",
      "diff": "@@ -0,0 +1,7 @@\n+      protected OutputStream createOutputStream(Path f, boolean append) \n+          throws IOException {\n+        if (LOG.isDebugEnabled()) {\n+          LOG.debug(String.format(\"EFS:create: %s %b\", f, append));\n+        }\n+        return Native.Elevated.create(f, append); \n+      }\n\\ No newline at end of file\n",
      "actualSource": "      protected OutputStream createOutputStream(Path f, boolean append) \n          throws IOException {\n        if (LOG.isDebugEnabled()) {\n          LOG.debug(String.format(\"EFS:create: %s %b\", f, append));\n        }\n        return Native.Elevated.create(f, append); \n      }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/WindowsSecureContainerExecutor.java"
    }
  }
}