{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "BlockUnderConstructionFeature.java",
  "functionName": "updateStorageScheduledSize",
  "functionId": "updateStorageScheduledSize___storedBlock-BlockInfoStriped",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/BlockUnderConstructionFeature.java",
  "functionStartLine": 159,
  "functionEndLine": 177,
  "numCommitsSeen": 12,
  "timeTaken": 1542,
  "changeHistory": [
    "5644137adad30c84e40d2c4719627b3aabc73628",
    "19adb2bc641999b83e25ff0e107ba8c6edbad399"
  ],
  "changeHistoryShort": {
    "5644137adad30c84e40d2c4719627b3aabc73628": "Ybodychange",
    "19adb2bc641999b83e25ff0e107ba8c6edbad399": "Yintroduced"
  },
  "changeHistoryDetails": {
    "5644137adad30c84e40d2c4719627b3aabc73628": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-9941. Do not log StandbyException on NN, other minor logging fixes. Contributed by Arpit Agarwal.\n",
      "commitDate": "14/03/16 9:54 AM",
      "commitName": "5644137adad30c84e40d2c4719627b3aabc73628",
      "commitAuthor": "Chris Nauroth",
      "commitDateOld": "10/02/16 9:24 PM",
      "commitNameOld": "19adb2bc641999b83e25ff0e107ba8c6edbad399",
      "commitAuthorOld": "Jing Zhao",
      "daysBetweenCommits": 32.48,
      "commitsBetweenForRepo": 203,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,19 +1,19 @@\n   void updateStorageScheduledSize(BlockInfoStriped storedBlock) {\n     assert storedBlock.getUnderConstructionFeature() \u003d\u003d this;\n-    if (replicas \u003d\u003d null) {\n+    if (replicas.length \u003d\u003d 0) {\n       return;\n     }\n     final int dataBlockNum \u003d storedBlock.getDataBlockNum();\n     final int realDataBlockNum \u003d storedBlock.getRealDataBlockNum();\n     if (realDataBlockNum \u003c dataBlockNum) {\n       for (ReplicaUnderConstruction replica : replicas) {\n         int index \u003d BlockIdManager.getBlockIndex(replica);\n         if (index \u003e\u003d realDataBlockNum \u0026\u0026 index \u003c dataBlockNum) {\n           final DatanodeStorageInfo storage \u003d\n               replica.getExpectedStorageLocation();\n           storage.getDatanodeDescriptor()\n               .decrementBlocksScheduled(storage.getStorageType());\n         }\n       }\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void updateStorageScheduledSize(BlockInfoStriped storedBlock) {\n    assert storedBlock.getUnderConstructionFeature() \u003d\u003d this;\n    if (replicas.length \u003d\u003d 0) {\n      return;\n    }\n    final int dataBlockNum \u003d storedBlock.getDataBlockNum();\n    final int realDataBlockNum \u003d storedBlock.getRealDataBlockNum();\n    if (realDataBlockNum \u003c dataBlockNum) {\n      for (ReplicaUnderConstruction replica : replicas) {\n        int index \u003d BlockIdManager.getBlockIndex(replica);\n        if (index \u003e\u003d realDataBlockNum \u0026\u0026 index \u003c dataBlockNum) {\n          final DatanodeStorageInfo storage \u003d\n              replica.getExpectedStorageLocation();\n          storage.getDatanodeDescriptor()\n              .decrementBlocksScheduled(storage.getStorageType());\n        }\n      }\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/BlockUnderConstructionFeature.java",
      "extendedDetails": {}
    },
    "19adb2bc641999b83e25ff0e107ba8c6edbad399": {
      "type": "Yintroduced",
      "commitMessage": "HDFS-9789. Correctly update DataNode\u0027s scheduled block size when writing small EC file. Contributed by Jing Zhao.\n",
      "commitDate": "10/02/16 9:24 PM",
      "commitName": "19adb2bc641999b83e25ff0e107ba8c6edbad399",
      "commitAuthor": "Jing Zhao",
      "diff": "@@ -0,0 +1,19 @@\n+  void updateStorageScheduledSize(BlockInfoStriped storedBlock) {\n+    assert storedBlock.getUnderConstructionFeature() \u003d\u003d this;\n+    if (replicas \u003d\u003d null) {\n+      return;\n+    }\n+    final int dataBlockNum \u003d storedBlock.getDataBlockNum();\n+    final int realDataBlockNum \u003d storedBlock.getRealDataBlockNum();\n+    if (realDataBlockNum \u003c dataBlockNum) {\n+      for (ReplicaUnderConstruction replica : replicas) {\n+        int index \u003d BlockIdManager.getBlockIndex(replica);\n+        if (index \u003e\u003d realDataBlockNum \u0026\u0026 index \u003c dataBlockNum) {\n+          final DatanodeStorageInfo storage \u003d\n+              replica.getExpectedStorageLocation();\n+          storage.getDatanodeDescriptor()\n+              .decrementBlocksScheduled(storage.getStorageType());\n+        }\n+      }\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  void updateStorageScheduledSize(BlockInfoStriped storedBlock) {\n    assert storedBlock.getUnderConstructionFeature() \u003d\u003d this;\n    if (replicas \u003d\u003d null) {\n      return;\n    }\n    final int dataBlockNum \u003d storedBlock.getDataBlockNum();\n    final int realDataBlockNum \u003d storedBlock.getRealDataBlockNum();\n    if (realDataBlockNum \u003c dataBlockNum) {\n      for (ReplicaUnderConstruction replica : replicas) {\n        int index \u003d BlockIdManager.getBlockIndex(replica);\n        if (index \u003e\u003d realDataBlockNum \u0026\u0026 index \u003c dataBlockNum) {\n          final DatanodeStorageInfo storage \u003d\n              replica.getExpectedStorageLocation();\n          storage.getDatanodeDescriptor()\n              .decrementBlocksScheduled(storage.getStorageType());\n        }\n      }\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/blockmanagement/BlockUnderConstructionFeature.java"
    }
  }
}