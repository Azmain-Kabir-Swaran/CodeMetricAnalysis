{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "ClientAMService.java",
  "functionName": "upgrade",
  "functionId": "upgrade___request-UpgradeServiceRequestProto",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-services/hadoop-yarn-services-core/src/main/java/org/apache/hadoop/yarn/service/ClientAMService.java",
  "functionStartLine": 168,
  "functionEndLine": 180,
  "numCommitsSeen": 12,
  "timeTaken": 1745,
  "changeHistory": [
    "e557c6bd8de2811a561210f672f47b4d07a9d5c6",
    "7f083ed8699a720d3fb82e4ec310356902a6ac30",
    "4a7369b09547a78f532af66c763c6994a38b5d68",
    "27d60a16342fd39973d43b61008f54a8815a6237"
  ],
  "changeHistoryShort": {
    "e557c6bd8de2811a561210f672f47b4d07a9d5c6": "Ybodychange",
    "7f083ed8699a720d3fb82e4ec310356902a6ac30": "Ybodychange",
    "4a7369b09547a78f532af66c763c6994a38b5d68": "Ybodychange",
    "27d60a16342fd39973d43b61008f54a8815a6237": "Yintroduced"
  },
  "changeHistoryDetails": {
    "e557c6bd8de2811a561210f672f47b4d07a9d5c6": {
      "type": "Ybodychange",
      "commitMessage": "YARN-8298.  Added express upgrade for YARN service.\n            Contributed by Chandni Singh\n",
      "commitDate": "21/08/18 4:49 PM",
      "commitName": "e557c6bd8de2811a561210f672f47b4d07a9d5c6",
      "commitAuthor": "Eric Yang",
      "commitDateOld": "16/07/18 2:41 PM",
      "commitNameOld": "121865c3f96166e2190ed54b433ebcf8d053b91c",
      "commitAuthorOld": "Eric Yang",
      "daysBetweenCommits": 36.09,
      "commitsBetweenForRepo": 296,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,13 +1,13 @@\n   public UpgradeServiceResponseProto upgrade(\n       UpgradeServiceRequestProto request) throws IOException {\n     try {\n       LOG.info(\"Upgrading service to version {} by {}\", request.getVersion(),\n           UserGroupInformation.getCurrentUser());\n       context.getServiceManager().processUpgradeRequest(request.getVersion(),\n-          request.getAutoFinalize());\n+          request.getAutoFinalize(), request.getExpressUpgrade());\n       return UpgradeServiceResponseProto.newBuilder().build();\n     } catch (Exception ex) {\n       return UpgradeServiceResponseProto.newBuilder().setError(ex.getMessage())\n           .build();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public UpgradeServiceResponseProto upgrade(\n      UpgradeServiceRequestProto request) throws IOException {\n    try {\n      LOG.info(\"Upgrading service to version {} by {}\", request.getVersion(),\n          UserGroupInformation.getCurrentUser());\n      context.getServiceManager().processUpgradeRequest(request.getVersion(),\n          request.getAutoFinalize(), request.getExpressUpgrade());\n      return UpgradeServiceResponseProto.newBuilder().build();\n    } catch (Exception ex) {\n      return UpgradeServiceResponseProto.newBuilder().setError(ex.getMessage())\n          .build();\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-services/hadoop-yarn-services-core/src/main/java/org/apache/hadoop/yarn/service/ClientAMService.java",
      "extendedDetails": {}
    },
    "7f083ed8699a720d3fb82e4ec310356902a6ac30": {
      "type": "Ybodychange",
      "commitMessage": "YARN-8080.  Add restart policy for YARN services.\n            Contributed by Suma Shivaprasad\n",
      "commitDate": "17/05/18 2:16 PM",
      "commitName": "7f083ed8699a720d3fb82e4ec310356902a6ac30",
      "commitAuthor": "Eric Yang",
      "commitDateOld": "26/04/18 1:54 PM",
      "commitNameOld": "4a7369b09547a78f532af66c763c6994a38b5d68",
      "commitAuthorOld": "Eric Yang",
      "daysBetweenCommits": 21.02,
      "commitsBetweenForRepo": 165,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,13 +1,13 @@\n   public UpgradeServiceResponseProto upgrade(\n       UpgradeServiceRequestProto request) throws IOException {\n     try {\n-      context.getServiceManager().processUpgradeRequest(request.getVersion(),\n-          request.getAutoFinalize());\n       LOG.info(\"Upgrading service to version {} by {}\", request.getVersion(),\n           UserGroupInformation.getCurrentUser());\n+      context.getServiceManager().processUpgradeRequest(request.getVersion(),\n+          request.getAutoFinalize());\n       return UpgradeServiceResponseProto.newBuilder().build();\n     } catch (Exception ex) {\n       return UpgradeServiceResponseProto.newBuilder().setError(ex.getMessage())\n           .build();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public UpgradeServiceResponseProto upgrade(\n      UpgradeServiceRequestProto request) throws IOException {\n    try {\n      LOG.info(\"Upgrading service to version {} by {}\", request.getVersion(),\n          UserGroupInformation.getCurrentUser());\n      context.getServiceManager().processUpgradeRequest(request.getVersion(),\n          request.getAutoFinalize());\n      return UpgradeServiceResponseProto.newBuilder().build();\n    } catch (Exception ex) {\n      return UpgradeServiceResponseProto.newBuilder().setError(ex.getMessage())\n          .build();\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-services/hadoop-yarn-services-core/src/main/java/org/apache/hadoop/yarn/service/ClientAMService.java",
      "extendedDetails": {}
    },
    "4a7369b09547a78f532af66c763c6994a38b5d68": {
      "type": "Ybodychange",
      "commitMessage": "YARN-7939.  Added support to upgrade a component instance.\n            Contributed by Chandni Singh\n",
      "commitDate": "26/04/18 1:54 PM",
      "commitName": "4a7369b09547a78f532af66c763c6994a38b5d68",
      "commitAuthor": "Eric Yang",
      "commitDateOld": "13/04/18 12:34 PM",
      "commitNameOld": "9031a76d447f0c5eaa392144fd17c5b9812e1b20",
      "commitAuthorOld": "Eric Yang",
      "daysBetweenCommits": 13.06,
      "commitsBetweenForRepo": 584,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,9 +1,13 @@\n   public UpgradeServiceResponseProto upgrade(\n       UpgradeServiceRequestProto request) throws IOException {\n-    ServiceEvent event \u003d new ServiceEvent(ServiceEventType.UPGRADE);\n-    event.setVersion(request.getVersion());\n-    context.scheduler.getDispatcher().getEventHandler().handle(event);\n-    LOG.info(\"Upgrading service to version {} by {}\", request.getVersion(),\n-        UserGroupInformation.getCurrentUser());\n-    return UpgradeServiceResponseProto.newBuilder().build();\n+    try {\n+      context.getServiceManager().processUpgradeRequest(request.getVersion(),\n+          request.getAutoFinalize());\n+      LOG.info(\"Upgrading service to version {} by {}\", request.getVersion(),\n+          UserGroupInformation.getCurrentUser());\n+      return UpgradeServiceResponseProto.newBuilder().build();\n+    } catch (Exception ex) {\n+      return UpgradeServiceResponseProto.newBuilder().setError(ex.getMessage())\n+          .build();\n+    }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public UpgradeServiceResponseProto upgrade(\n      UpgradeServiceRequestProto request) throws IOException {\n    try {\n      context.getServiceManager().processUpgradeRequest(request.getVersion(),\n          request.getAutoFinalize());\n      LOG.info(\"Upgrading service to version {} by {}\", request.getVersion(),\n          UserGroupInformation.getCurrentUser());\n      return UpgradeServiceResponseProto.newBuilder().build();\n    } catch (Exception ex) {\n      return UpgradeServiceResponseProto.newBuilder().setError(ex.getMessage())\n          .build();\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-services/hadoop-yarn-services-core/src/main/java/org/apache/hadoop/yarn/service/ClientAMService.java",
      "extendedDetails": {}
    },
    "27d60a16342fd39973d43b61008f54a8815a6237": {
      "type": "Yintroduced",
      "commitMessage": "YARN-8018.  Added support for initiating yarn service upgrade.\n            Contributed by Chandni Singh\n",
      "commitDate": "26/03/18 3:46 PM",
      "commitName": "27d60a16342fd39973d43b61008f54a8815a6237",
      "commitAuthor": "Eric Yang",
      "diff": "@@ -0,0 +1,9 @@\n+  public UpgradeServiceResponseProto upgrade(\n+      UpgradeServiceRequestProto request) throws IOException {\n+    ServiceEvent event \u003d new ServiceEvent(ServiceEventType.UPGRADE);\n+    event.setVersion(request.getVersion());\n+    context.scheduler.getDispatcher().getEventHandler().handle(event);\n+    LOG.info(\"Upgrading service to version {} by {}\", request.getVersion(),\n+        UserGroupInformation.getCurrentUser());\n+    return UpgradeServiceResponseProto.newBuilder().build();\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  public UpgradeServiceResponseProto upgrade(\n      UpgradeServiceRequestProto request) throws IOException {\n    ServiceEvent event \u003d new ServiceEvent(ServiceEventType.UPGRADE);\n    event.setVersion(request.getVersion());\n    context.scheduler.getDispatcher().getEventHandler().handle(event);\n    LOG.info(\"Upgrading service to version {} by {}\", request.getVersion(),\n        UserGroupInformation.getCurrentUser());\n    return UpgradeServiceResponseProto.newBuilder().build();\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-services/hadoop-yarn-services-core/src/main/java/org/apache/hadoop/yarn/service/ClientAMService.java"
    }
  }
}