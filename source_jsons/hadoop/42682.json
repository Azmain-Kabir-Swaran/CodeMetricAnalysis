{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "RMAppAttemptImpl.java",
  "functionName": "transferStateFromAttempt",
  "functionId": "transferStateFromAttempt___attempt-RMAppAttempt",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/rmapp/attempt/RMAppAttemptImpl.java",
  "functionStartLine": 997,
  "functionEndLine": 1016,
  "numCommitsSeen": 252,
  "timeTaken": 5433,
  "changeHistory": [
    "30fc5801966feb7f9bdd7d79db75acc595102913",
    "e0b570dffb47ede298e0378a63350b699128d96e",
    "9cb0c963d21bcbefc56716d332a3bbdf090417c0",
    "d03dcb9635dbd79a45d229d1cab5fd28e5e49f49",
    "0a641496c706fc175e7bf66d69ebf71c7d078e84",
    "95897ca14b7abd7fe047fdcf150473a8a2cbb024",
    "1393581bceda234c88cafec00dbfc0ef2a402e83"
  ],
  "changeHistoryShort": {
    "30fc5801966feb7f9bdd7d79db75acc595102913": "Ybodychange",
    "e0b570dffb47ede298e0378a63350b699128d96e": "Ybodychange",
    "9cb0c963d21bcbefc56716d332a3bbdf090417c0": "Ybodychange",
    "d03dcb9635dbd79a45d229d1cab5fd28e5e49f49": "Yrename",
    "0a641496c706fc175e7bf66d69ebf71c7d078e84": "Ybodychange",
    "95897ca14b7abd7fe047fdcf150473a8a2cbb024": "Ybodychange",
    "1393581bceda234c88cafec00dbfc0ef2a402e83": "Yintroduced"
  },
  "changeHistoryDetails": {
    "30fc5801966feb7f9bdd7d79db75acc595102913": {
      "type": "Ybodychange",
      "commitMessage": "YARN-6519. Fix warnings from Spotbugs in hadoop-yarn-server-resourcemanager. Contributed by Weiwei Yang.\n",
      "commitDate": "01/05/17 7:45 AM",
      "commitName": "30fc5801966feb7f9bdd7d79db75acc595102913",
      "commitAuthor": "Naganarasimha",
      "commitDateOld": "27/03/17 5:23 PM",
      "commitNameOld": "9bae6720cb8432efd78c909dc624c00e367cedf5",
      "commitAuthorOld": "Robert Kanter",
      "daysBetweenCommits": 34.6,
      "commitsBetweenForRepo": 194,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,18 +1,20 @@\n   public void transferStateFromAttempt(RMAppAttempt attempt) {\n     this.justFinishedContainers \u003d attempt.getJustFinishedContainersReference();\n     this.finishedContainersSentToAM \u003d\n         attempt.getFinishedContainersSentToAMReference();\n     // container complete msg was moved from justFinishedContainers to\n     // finishedContainersSentToAM in ApplicationMasterService#allocate,\n     // if am crashed and not received this response, we should resend\n     // this msg again after am restart\n     if (!this.finishedContainersSentToAM.isEmpty()) {\n-      for (NodeId nodeId : this.finishedContainersSentToAM.keySet()) {\n+      for (Map.Entry\u003cNodeId, List\u003cContainerStatus\u003e\u003e finishedContainer\n+          : this.finishedContainersSentToAM.entrySet()) {\n         List\u003cContainerStatus\u003e containerStatuses \u003d\n-            this.finishedContainersSentToAM.get(nodeId);\n+            finishedContainer.getValue();\n+        NodeId nodeId \u003d finishedContainer.getKey();\n         this.justFinishedContainers.putIfAbsent(nodeId, new ArrayList\u003c\u003e());\n         this.justFinishedContainers.get(nodeId).addAll(containerStatuses);\n       }\n       this.finishedContainersSentToAM.clear();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void transferStateFromAttempt(RMAppAttempt attempt) {\n    this.justFinishedContainers \u003d attempt.getJustFinishedContainersReference();\n    this.finishedContainersSentToAM \u003d\n        attempt.getFinishedContainersSentToAMReference();\n    // container complete msg was moved from justFinishedContainers to\n    // finishedContainersSentToAM in ApplicationMasterService#allocate,\n    // if am crashed and not received this response, we should resend\n    // this msg again after am restart\n    if (!this.finishedContainersSentToAM.isEmpty()) {\n      for (Map.Entry\u003cNodeId, List\u003cContainerStatus\u003e\u003e finishedContainer\n          : this.finishedContainersSentToAM.entrySet()) {\n        List\u003cContainerStatus\u003e containerStatuses \u003d\n            finishedContainer.getValue();\n        NodeId nodeId \u003d finishedContainer.getKey();\n        this.justFinishedContainers.putIfAbsent(nodeId, new ArrayList\u003c\u003e());\n        this.justFinishedContainers.get(nodeId).addAll(containerStatuses);\n      }\n      this.finishedContainersSentToAM.clear();\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/rmapp/attempt/RMAppAttemptImpl.java",
      "extendedDetails": {}
    },
    "e0b570dffb47ede298e0378a63350b699128d96e": {
      "type": "Ybodychange",
      "commitMessage": "YARN-5483. Optimize RMAppAttempt#pullJustFinishedContainers. Contributed by sandflee\n",
      "commitDate": "10/08/16 11:04 AM",
      "commitName": "e0b570dffb47ede298e0378a63350b699128d96e",
      "commitAuthor": "Jason Lowe",
      "commitDateOld": "28/06/16 9:38 PM",
      "commitNameOld": "26b5e6116f392b6be91dca57968259f87554ce33",
      "commitAuthorOld": "Rohith Sharma K S",
      "daysBetweenCommits": 42.56,
      "commitsBetweenForRepo": 385,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,19 +1,18 @@\n   public void transferStateFromAttempt(RMAppAttempt attempt) {\n     this.justFinishedContainers \u003d attempt.getJustFinishedContainersReference();\n     this.finishedContainersSentToAM \u003d\n         attempt.getFinishedContainersSentToAMReference();\n     // container complete msg was moved from justFinishedContainers to\n     // finishedContainersSentToAM in ApplicationMasterService#allocate,\n     // if am crashed and not received this response, we should resend\n     // this msg again after am restart\n     if (!this.finishedContainersSentToAM.isEmpty()) {\n       for (NodeId nodeId : this.finishedContainersSentToAM.keySet()) {\n         List\u003cContainerStatus\u003e containerStatuses \u003d\n             this.finishedContainersSentToAM.get(nodeId);\n-        this.justFinishedContainers.putIfAbsent(nodeId,\n-            new ArrayList\u003cContainerStatus\u003e());\n+        this.justFinishedContainers.putIfAbsent(nodeId, new ArrayList\u003c\u003e());\n         this.justFinishedContainers.get(nodeId).addAll(containerStatuses);\n       }\n       this.finishedContainersSentToAM.clear();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void transferStateFromAttempt(RMAppAttempt attempt) {\n    this.justFinishedContainers \u003d attempt.getJustFinishedContainersReference();\n    this.finishedContainersSentToAM \u003d\n        attempt.getFinishedContainersSentToAMReference();\n    // container complete msg was moved from justFinishedContainers to\n    // finishedContainersSentToAM in ApplicationMasterService#allocate,\n    // if am crashed and not received this response, we should resend\n    // this msg again after am restart\n    if (!this.finishedContainersSentToAM.isEmpty()) {\n      for (NodeId nodeId : this.finishedContainersSentToAM.keySet()) {\n        List\u003cContainerStatus\u003e containerStatuses \u003d\n            this.finishedContainersSentToAM.get(nodeId);\n        this.justFinishedContainers.putIfAbsent(nodeId, new ArrayList\u003c\u003e());\n        this.justFinishedContainers.get(nodeId).addAll(containerStatuses);\n      }\n      this.finishedContainersSentToAM.clear();\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/rmapp/attempt/RMAppAttemptImpl.java",
      "extendedDetails": {}
    },
    "9cb0c963d21bcbefc56716d332a3bbdf090417c0": {
      "type": "Ybodychange",
      "commitMessage": "YARN-4740. AM may not receive the container complete msg when it restarts. Contributed by Jun Gong\n",
      "commitDate": "08/04/16 11:20 AM",
      "commitName": "9cb0c963d21bcbefc56716d332a3bbdf090417c0",
      "commitAuthor": "Jian He",
      "commitDateOld": "04/02/16 12:02 AM",
      "commitNameOld": "308d63f382e1992ea2b8ccf3130edaaa751c644d",
      "commitAuthorOld": "Varun Vasudev",
      "daysBetweenCommits": 64.43,
      "commitsBetweenForRepo": 402,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,5 +1,19 @@\n   public void transferStateFromAttempt(RMAppAttempt attempt) {\n     this.justFinishedContainers \u003d attempt.getJustFinishedContainersReference();\n     this.finishedContainersSentToAM \u003d\n         attempt.getFinishedContainersSentToAMReference();\n+    // container complete msg was moved from justFinishedContainers to\n+    // finishedContainersSentToAM in ApplicationMasterService#allocate,\n+    // if am crashed and not received this response, we should resend\n+    // this msg again after am restart\n+    if (!this.finishedContainersSentToAM.isEmpty()) {\n+      for (NodeId nodeId : this.finishedContainersSentToAM.keySet()) {\n+        List\u003cContainerStatus\u003e containerStatuses \u003d\n+            this.finishedContainersSentToAM.get(nodeId);\n+        this.justFinishedContainers.putIfAbsent(nodeId,\n+            new ArrayList\u003cContainerStatus\u003e());\n+        this.justFinishedContainers.get(nodeId).addAll(containerStatuses);\n+      }\n+      this.finishedContainersSentToAM.clear();\n+    }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void transferStateFromAttempt(RMAppAttempt attempt) {\n    this.justFinishedContainers \u003d attempt.getJustFinishedContainersReference();\n    this.finishedContainersSentToAM \u003d\n        attempt.getFinishedContainersSentToAMReference();\n    // container complete msg was moved from justFinishedContainers to\n    // finishedContainersSentToAM in ApplicationMasterService#allocate,\n    // if am crashed and not received this response, we should resend\n    // this msg again after am restart\n    if (!this.finishedContainersSentToAM.isEmpty()) {\n      for (NodeId nodeId : this.finishedContainersSentToAM.keySet()) {\n        List\u003cContainerStatus\u003e containerStatuses \u003d\n            this.finishedContainersSentToAM.get(nodeId);\n        this.justFinishedContainers.putIfAbsent(nodeId,\n            new ArrayList\u003cContainerStatus\u003e());\n        this.justFinishedContainers.get(nodeId).addAll(containerStatuses);\n      }\n      this.finishedContainersSentToAM.clear();\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/rmapp/attempt/RMAppAttemptImpl.java",
      "extendedDetails": {}
    },
    "d03dcb9635dbd79a45d229d1cab5fd28e5e49f49": {
      "type": "Yrename",
      "commitMessage": "YARN-3387. Previous AM\u0027s container completed status couldn\u0027t pass to current AM if AM and RM restarted during the same time. Contributed by Sandflee\n",
      "commitDate": "24/04/15 12:13 PM",
      "commitName": "d03dcb9635dbd79a45d229d1cab5fd28e5e49f49",
      "commitAuthor": "Jian He",
      "commitDateOld": "17/04/15 5:11 PM",
      "commitNameOld": "f65eeb412d140a3808bcf99344a9f3a965918f70",
      "commitAuthorOld": "Wangda Tan",
      "daysBetweenCommits": 6.79,
      "commitsBetweenForRepo": 63,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,5 +1,5 @@\n-  public void transferStateFromPreviousAttempt(RMAppAttempt attempt) {\n+  public void transferStateFromAttempt(RMAppAttempt attempt) {\n     this.justFinishedContainers \u003d attempt.getJustFinishedContainersReference();\n     this.finishedContainersSentToAM \u003d\n         attempt.getFinishedContainersSentToAMReference();\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void transferStateFromAttempt(RMAppAttempt attempt) {\n    this.justFinishedContainers \u003d attempt.getJustFinishedContainersReference();\n    this.finishedContainersSentToAM \u003d\n        attempt.getFinishedContainersSentToAMReference();\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/rmapp/attempt/RMAppAttemptImpl.java",
      "extendedDetails": {
        "oldValue": "transferStateFromPreviousAttempt",
        "newValue": "transferStateFromAttempt"
      }
    },
    "0a641496c706fc175e7bf66d69ebf71c7d078e84": {
      "type": "Ybodychange",
      "commitMessage": "YARN-1372. Ensure all completed containers are reported to the AMs across RM restart. Contributed by Anubhav Dhoot\n",
      "commitDate": "22/09/14 10:30 AM",
      "commitName": "0a641496c706fc175e7bf66d69ebf71c7d078e84",
      "commitAuthor": "Jian He",
      "commitDateOld": "17/09/14 9:44 PM",
      "commitNameOld": "ee21b13cbd4654d7181306404174329f12193613",
      "commitAuthorOld": "Jian He",
      "daysBetweenCommits": 4.53,
      "commitsBetweenForRepo": 48,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,3 +1,5 @@\n   public void transferStateFromPreviousAttempt(RMAppAttempt attempt) {\n-    this.justFinishedContainers \u003d attempt.getJustFinishedContainers();\n+    this.justFinishedContainers \u003d attempt.getJustFinishedContainersReference();\n+    this.finishedContainersSentToAM \u003d\n+        attempt.getFinishedContainersSentToAMReference();\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void transferStateFromPreviousAttempt(RMAppAttempt attempt) {\n    this.justFinishedContainers \u003d attempt.getJustFinishedContainersReference();\n    this.finishedContainersSentToAM \u003d\n        attempt.getFinishedContainersSentToAMReference();\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/rmapp/attempt/RMAppAttemptImpl.java",
      "extendedDetails": {}
    },
    "95897ca14b7abd7fe047fdcf150473a8a2cbb024": {
      "type": "Ybodychange",
      "commitMessage": "YARN-1885. Fixed a bug that RM may not send application-clean-up signal to NMs where the completed applications previously ran in case of RM restart. Contributed by Wangda Tan\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1603028 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "16/06/14 4:56 PM",
      "commitName": "95897ca14b7abd7fe047fdcf150473a8a2cbb024",
      "commitAuthor": "Jian He",
      "commitDateOld": "10/06/14 12:03 PM",
      "commitNameOld": "5de6f72054d4911fcaf12132dccb05662f36a82d",
      "commitAuthorOld": "Karthik Kambatla",
      "daysBetweenCommits": 6.2,
      "commitsBetweenForRepo": 46,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,4 +1,3 @@\n   public void transferStateFromPreviousAttempt(RMAppAttempt attempt) {\n     this.justFinishedContainers \u003d attempt.getJustFinishedContainers();\n-    this.ranNodes \u003d attempt.getRanNodes();\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public void transferStateFromPreviousAttempt(RMAppAttempt attempt) {\n    this.justFinishedContainers \u003d attempt.getJustFinishedContainers();\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/rmapp/attempt/RMAppAttemptImpl.java",
      "extendedDetails": {}
    },
    "1393581bceda234c88cafec00dbfc0ef2a402e83": {
      "type": "Yintroduced",
      "commitMessage": "YARN-1490. Introduced the ability to make ResourceManager optionally not kill all containers when an ApplicationMaster exits. Contributed by Jian He.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1557143 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "10/01/14 7:04 AM",
      "commitName": "1393581bceda234c88cafec00dbfc0ef2a402e83",
      "commitAuthor": "Vinod Kumar Vavilapalli",
      "diff": "@@ -0,0 +1,4 @@\n+  public void transferStateFromPreviousAttempt(RMAppAttempt attempt) {\n+    this.justFinishedContainers \u003d attempt.getJustFinishedContainers();\n+    this.ranNodes \u003d attempt.getRanNodes();\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  public void transferStateFromPreviousAttempt(RMAppAttempt attempt) {\n    this.justFinishedContainers \u003d attempt.getJustFinishedContainers();\n    this.ranNodes \u003d attempt.getRanNodes();\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/rmapp/attempt/RMAppAttemptImpl.java"
    }
  }
}