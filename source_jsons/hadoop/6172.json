{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "FSImageFormat.java",
  "functionName": "renameReservedPathsOnUpgrade",
  "functionId": "renameReservedPathsOnUpgrade___path-String__layoutVersion-int(modifiers-final)",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSImageFormat.java",
  "functionStartLine": 1099,
  "functionEndLine": 1134,
  "numCommitsSeen": 127,
  "timeTaken": 2193,
  "changeHistory": [
    "25051c3bd08efc12333a6acb51782cc7800403a4"
  ],
  "changeHistoryShort": {
    "25051c3bd08efc12333a6acb51782cc7800403a4": "Yexceptionschange"
  },
  "changeHistoryDetails": {
    "25051c3bd08efc12333a6acb51782cc7800403a4": {
      "type": "Yexceptionschange",
      "commitMessage": "HDFS-9569. Log the name of the fsimage being loaded for better supportability. (Yongjun Zhang)\n",
      "commitDate": "12/01/16 9:22 AM",
      "commitName": "25051c3bd08efc12333a6acb51782cc7800403a4",
      "commitAuthor": "Yongjun Zhang",
      "commitDateOld": "27/08/15 1:02 AM",
      "commitNameOld": "164cbe643988f878f0f4100a4de51783e5b6738e",
      "commitAuthorOld": "Walter Su",
      "daysBetweenCommits": 138.39,
      "commitsBetweenForRepo": 944,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,36 +1,36 @@\n   static String renameReservedPathsOnUpgrade(String path,\n-      final int layoutVersion) {\n+      final int layoutVersion) throws IllegalReservedPathException {\n     final String oldPath \u003d path;\n     // If any known LVs aren\u0027t supported, we\u0027re doing an upgrade\n     if (!NameNodeLayoutVersion.supports(Feature.ADD_INODE_ID, layoutVersion)) {\n       String[] components \u003d INode.getPathNames(path);\n       // Only need to worry about the root directory\n       if (components.length \u003e 1) {\n         components[1] \u003d DFSUtil.bytes2String(\n             renameReservedRootComponentOnUpgrade(\n                 DFSUtil.string2Bytes(components[1]),\n                 layoutVersion));\n         path \u003d DFSUtil.strings2PathString(components);\n       }\n     }\n     if (!NameNodeLayoutVersion.supports(Feature.SNAPSHOT, layoutVersion)) {\n       String[] components \u003d INode.getPathNames(path);\n       // Special case the root path\n       if (components.length \u003d\u003d 0) {\n         return path;\n       }\n       for (int i\u003d0; i\u003ccomponents.length; i++) {\n         components[i] \u003d DFSUtil.bytes2String(\n             renameReservedComponentOnUpgrade(\n                 DFSUtil.string2Bytes(components[i]),\n                 layoutVersion));\n       }\n       path \u003d DFSUtil.strings2PathString(components);\n     }\n \n     if (!path.equals(oldPath)) {\n       LOG.info(\"Upgrade process renamed reserved path \" + oldPath + \" to \"\n           + path);\n     }\n     return path;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  static String renameReservedPathsOnUpgrade(String path,\n      final int layoutVersion) throws IllegalReservedPathException {\n    final String oldPath \u003d path;\n    // If any known LVs aren\u0027t supported, we\u0027re doing an upgrade\n    if (!NameNodeLayoutVersion.supports(Feature.ADD_INODE_ID, layoutVersion)) {\n      String[] components \u003d INode.getPathNames(path);\n      // Only need to worry about the root directory\n      if (components.length \u003e 1) {\n        components[1] \u003d DFSUtil.bytes2String(\n            renameReservedRootComponentOnUpgrade(\n                DFSUtil.string2Bytes(components[1]),\n                layoutVersion));\n        path \u003d DFSUtil.strings2PathString(components);\n      }\n    }\n    if (!NameNodeLayoutVersion.supports(Feature.SNAPSHOT, layoutVersion)) {\n      String[] components \u003d INode.getPathNames(path);\n      // Special case the root path\n      if (components.length \u003d\u003d 0) {\n        return path;\n      }\n      for (int i\u003d0; i\u003ccomponents.length; i++) {\n        components[i] \u003d DFSUtil.bytes2String(\n            renameReservedComponentOnUpgrade(\n                DFSUtil.string2Bytes(components[i]),\n                layoutVersion));\n      }\n      path \u003d DFSUtil.strings2PathString(components);\n    }\n\n    if (!path.equals(oldPath)) {\n      LOG.info(\"Upgrade process renamed reserved path \" + oldPath + \" to \"\n          + path);\n    }\n    return path;\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSImageFormat.java",
      "extendedDetails": {
        "oldValue": "[]",
        "newValue": "[IllegalReservedPathException]"
      }
    }
  }
}