{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "ContainerManagementProtocolProxy.java",
  "functionName": "addProxyToCache",
  "functionId": "addProxyToCache___containerManagerBindAddr-String__proxy-ContainerManagementProtocolProxyData",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client/src/main/java/org/apache/hadoop/yarn/client/api/impl/ContainerManagementProtocolProxy.java",
  "functionStartLine": 145,
  "functionEndLine": 171,
  "numCommitsSeen": 10,
  "timeTaken": 1288,
  "changeHistory": [
    "2064ca015d1584263aac0cc20c60b925a3aff612",
    "f44cf99599119b5e989be724eeab447b2dc4fe53"
  ],
  "changeHistoryShort": {
    "2064ca015d1584263aac0cc20c60b925a3aff612": "Ybodychange",
    "f44cf99599119b5e989be724eeab447b2dc4fe53": "Yintroduced"
  },
  "changeHistoryDetails": {
    "2064ca015d1584263aac0cc20c60b925a3aff612": {
      "type": "Ybodychange",
      "commitMessage": "YARN-9349.  Changed logging to use slf4j api.\n            Contributed by Prabhu Joseph\n",
      "commitDate": "15/03/19 4:20 PM",
      "commitName": "2064ca015d1584263aac0cc20c60b925a3aff612",
      "commitAuthor": "Eric Yang",
      "commitDateOld": "31/10/17 1:09 AM",
      "commitNameOld": "c02d2ba50db8a355ea03081c3984b2ea0c375a3f",
      "commitAuthorOld": "Akira Ajisaka",
      "daysBetweenCommits": 500.63,
      "commitsBetweenForRepo": 4349,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,29 +1,27 @@\n   private void addProxyToCache(String containerManagerBindAddr,\n       ContainerManagementProtocolProxyData proxy) {\n     while (cmProxy.size() \u003e\u003d maxConnectedNMs) {\n-      if (LOG.isDebugEnabled()) {\n-        LOG.debug(\"Cleaning up the proxy cache, size\u003d\" + cmProxy.size()\n-            + \" max\u003d\" + maxConnectedNMs);\n-      }\n+      LOG.debug(\"Cleaning up the proxy cache, size\u003d{} max\u003d{}\", cmProxy.size(),\n+          maxConnectedNMs);\n       boolean removedProxy \u003d false;\n       for (ContainerManagementProtocolProxyData otherProxy : cmProxy.values()) {\n         removedProxy \u003d removeProxy(otherProxy);\n         if (removedProxy) {\n           break;\n         }\n       }\n       if (!removedProxy) {\n         // all of the proxies are currently in use and already scheduled\n         // for removal, so we need to wait until at least one of them closes\n         try {\n           this.wait();\n         } catch (InterruptedException e) {\n           e.printStackTrace();\n         }\n       }\n     }\n \n     if (maxConnectedNMs \u003e 0) {\n       cmProxy.put(containerManagerBindAddr, proxy);\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private void addProxyToCache(String containerManagerBindAddr,\n      ContainerManagementProtocolProxyData proxy) {\n    while (cmProxy.size() \u003e\u003d maxConnectedNMs) {\n      LOG.debug(\"Cleaning up the proxy cache, size\u003d{} max\u003d{}\", cmProxy.size(),\n          maxConnectedNMs);\n      boolean removedProxy \u003d false;\n      for (ContainerManagementProtocolProxyData otherProxy : cmProxy.values()) {\n        removedProxy \u003d removeProxy(otherProxy);\n        if (removedProxy) {\n          break;\n        }\n      }\n      if (!removedProxy) {\n        // all of the proxies are currently in use and already scheduled\n        // for removal, so we need to wait until at least one of them closes\n        try {\n          this.wait();\n        } catch (InterruptedException e) {\n          e.printStackTrace();\n        }\n      }\n    }\n\n    if (maxConnectedNMs \u003e 0) {\n      cmProxy.put(containerManagerBindAddr, proxy);\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client/src/main/java/org/apache/hadoop/yarn/client/api/impl/ContainerManagementProtocolProxy.java",
      "extendedDetails": {}
    },
    "f44cf99599119b5e989be724eeab447b2dc4fe53": {
      "type": "Yintroduced",
      "commitMessage": "YARN-2314. Disable ContainerManagementProtocolProxy cache by default to prevent creating thousands of threads in a large cluster. Contributed by Jason Lowe\n",
      "commitDate": "24/10/14 11:05 PM",
      "commitName": "f44cf99599119b5e989be724eeab447b2dc4fe53",
      "commitAuthor": "Jian He",
      "diff": "@@ -0,0 +1,29 @@\n+  private void addProxyToCache(String containerManagerBindAddr,\n+      ContainerManagementProtocolProxyData proxy) {\n+    while (cmProxy.size() \u003e\u003d maxConnectedNMs) {\n+      if (LOG.isDebugEnabled()) {\n+        LOG.debug(\"Cleaning up the proxy cache, size\u003d\" + cmProxy.size()\n+            + \" max\u003d\" + maxConnectedNMs);\n+      }\n+      boolean removedProxy \u003d false;\n+      for (ContainerManagementProtocolProxyData otherProxy : cmProxy.values()) {\n+        removedProxy \u003d removeProxy(otherProxy);\n+        if (removedProxy) {\n+          break;\n+        }\n+      }\n+      if (!removedProxy) {\n+        // all of the proxies are currently in use and already scheduled\n+        // for removal, so we need to wait until at least one of them closes\n+        try {\n+          this.wait();\n+        } catch (InterruptedException e) {\n+          e.printStackTrace();\n+        }\n+      }\n+    }\n+\n+    if (maxConnectedNMs \u003e 0) {\n+      cmProxy.put(containerManagerBindAddr, proxy);\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private void addProxyToCache(String containerManagerBindAddr,\n      ContainerManagementProtocolProxyData proxy) {\n    while (cmProxy.size() \u003e\u003d maxConnectedNMs) {\n      if (LOG.isDebugEnabled()) {\n        LOG.debug(\"Cleaning up the proxy cache, size\u003d\" + cmProxy.size()\n            + \" max\u003d\" + maxConnectedNMs);\n      }\n      boolean removedProxy \u003d false;\n      for (ContainerManagementProtocolProxyData otherProxy : cmProxy.values()) {\n        removedProxy \u003d removeProxy(otherProxy);\n        if (removedProxy) {\n          break;\n        }\n      }\n      if (!removedProxy) {\n        // all of the proxies are currently in use and already scheduled\n        // for removal, so we need to wait until at least one of them closes\n        try {\n          this.wait();\n        } catch (InterruptedException e) {\n          e.printStackTrace();\n        }\n      }\n    }\n\n    if (maxConnectedNMs \u003e 0) {\n      cmProxy.put(containerManagerBindAddr, proxy);\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client/src/main/java/org/apache/hadoop/yarn/client/api/impl/ContainerManagementProtocolProxy.java"
    }
  }
}