{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "FsVolumeList.java",
  "functionName": "getNextTransientVolume",
  "functionId": "getNextTransientVolume___blockSize-long",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsVolumeList.java",
  "functionStartLine": 127,
  "functionEndLine": 137,
  "numCommitsSeen": 42,
  "timeTaken": 2426,
  "changeHistory": [
    "a3954ccab148bddc290cb96528e63ff19799bcc9",
    "b7f4a3156c0f5c600816c469637237ba6c9b330c",
    "3b173d95171d01ab55042b1162569d1cf14a8d43"
  ],
  "changeHistoryShort": {
    "a3954ccab148bddc290cb96528e63ff19799bcc9": "Ybodychange",
    "b7f4a3156c0f5c600816c469637237ba6c9b330c": "Ymultichange(Yreturntypechange,Ybodychange)",
    "3b173d95171d01ab55042b1162569d1cf14a8d43": "Ymultichange(Ymodifierchange,Ybodychange)"
  },
  "changeHistoryDetails": {
    "a3954ccab148bddc290cb96528e63ff19799bcc9": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-9807. Add an optional StorageID to writes. Contributed by Ewan Higgs\n",
      "commitDate": "05/05/17 12:01 PM",
      "commitName": "a3954ccab148bddc290cb96528e63ff19799bcc9",
      "commitAuthor": "Chris Douglas",
      "commitDateOld": "10/03/17 2:37 PM",
      "commitNameOld": "6d356b6b4d8ccb32397cacfb5d0357b21f6035fc",
      "commitAuthorOld": "Lei Xu",
      "daysBetweenCommits": 55.85,
      "commitsBetweenForRepo": 315,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,11 +1,11 @@\n   FsVolumeReference getNextTransientVolume(long blockSize) throws IOException {\n     // Get a snapshot of currently available volumes.\n     final List\u003cFsVolumeImpl\u003e curVolumes \u003d getVolumes();\n     final List\u003cFsVolumeImpl\u003e list \u003d new ArrayList\u003c\u003e(curVolumes.size());\n     for(FsVolumeImpl v : curVolumes) {\n       if (v.isTransientStorage()) {\n         list.add(v);\n       }\n     }\n-    return chooseVolume(list, blockSize);\n+    return chooseVolume(list, blockSize, null);\n   }\n\\ No newline at end of file\n",
      "actualSource": "  FsVolumeReference getNextTransientVolume(long blockSize) throws IOException {\n    // Get a snapshot of currently available volumes.\n    final List\u003cFsVolumeImpl\u003e curVolumes \u003d getVolumes();\n    final List\u003cFsVolumeImpl\u003e list \u003d new ArrayList\u003c\u003e(curVolumes.size());\n    for(FsVolumeImpl v : curVolumes) {\n      if (v.isTransientStorage()) {\n        list.add(v);\n      }\n    }\n    return chooseVolume(list, blockSize, null);\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsVolumeList.java",
      "extendedDetails": {}
    },
    "b7f4a3156c0f5c600816c469637237ba6c9b330c": {
      "type": "Ymultichange(Yreturntypechange,Ybodychange)",
      "commitMessage": "HDFS-7496. Fix FsVolume removal race conditions on the DataNode by reference-counting the volume instances (lei via cmccabe)\n",
      "commitDate": "20/01/15 7:05 PM",
      "commitName": "b7f4a3156c0f5c600816c469637237ba6c9b330c",
      "commitAuthor": "Colin Patrick Mccabe",
      "subchanges": [
        {
          "type": "Yreturntypechange",
          "commitMessage": "HDFS-7496. Fix FsVolume removal race conditions on the DataNode by reference-counting the volume instances (lei via cmccabe)\n",
          "commitDate": "20/01/15 7:05 PM",
          "commitName": "b7f4a3156c0f5c600816c469637237ba6c9b330c",
          "commitAuthor": "Colin Patrick Mccabe",
          "commitDateOld": "19/12/14 11:13 AM",
          "commitNameOld": "a4876c130f1627e59ef055e586640d1933fc49af",
          "commitAuthorOld": "Colin Patrick Mccabe",
          "daysBetweenCommits": 32.33,
          "commitsBetweenForRepo": 151,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,11 +1,11 @@\n-  FsVolumeImpl getNextTransientVolume(long blockSize) throws IOException {\n+  FsVolumeReference getNextTransientVolume(long blockSize) throws IOException {\n     // Get a snapshot of currently available volumes.\n     final List\u003cFsVolumeImpl\u003e curVolumes \u003d getVolumes();\n     final List\u003cFsVolumeImpl\u003e list \u003d new ArrayList\u003c\u003e(curVolumes.size());\n     for(FsVolumeImpl v : curVolumes) {\n       if (v.isTransientStorage()) {\n         list.add(v);\n       }\n     }\n-    return blockChooser.chooseVolume(list, blockSize);\n+    return chooseVolume(list, blockSize);\n   }\n\\ No newline at end of file\n",
          "actualSource": "  FsVolumeReference getNextTransientVolume(long blockSize) throws IOException {\n    // Get a snapshot of currently available volumes.\n    final List\u003cFsVolumeImpl\u003e curVolumes \u003d getVolumes();\n    final List\u003cFsVolumeImpl\u003e list \u003d new ArrayList\u003c\u003e(curVolumes.size());\n    for(FsVolumeImpl v : curVolumes) {\n      if (v.isTransientStorage()) {\n        list.add(v);\n      }\n    }\n    return chooseVolume(list, blockSize);\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsVolumeList.java",
          "extendedDetails": {
            "oldValue": "FsVolumeImpl",
            "newValue": "FsVolumeReference"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-7496. Fix FsVolume removal race conditions on the DataNode by reference-counting the volume instances (lei via cmccabe)\n",
          "commitDate": "20/01/15 7:05 PM",
          "commitName": "b7f4a3156c0f5c600816c469637237ba6c9b330c",
          "commitAuthor": "Colin Patrick Mccabe",
          "commitDateOld": "19/12/14 11:13 AM",
          "commitNameOld": "a4876c130f1627e59ef055e586640d1933fc49af",
          "commitAuthorOld": "Colin Patrick Mccabe",
          "daysBetweenCommits": 32.33,
          "commitsBetweenForRepo": 151,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,11 +1,11 @@\n-  FsVolumeImpl getNextTransientVolume(long blockSize) throws IOException {\n+  FsVolumeReference getNextTransientVolume(long blockSize) throws IOException {\n     // Get a snapshot of currently available volumes.\n     final List\u003cFsVolumeImpl\u003e curVolumes \u003d getVolumes();\n     final List\u003cFsVolumeImpl\u003e list \u003d new ArrayList\u003c\u003e(curVolumes.size());\n     for(FsVolumeImpl v : curVolumes) {\n       if (v.isTransientStorage()) {\n         list.add(v);\n       }\n     }\n-    return blockChooser.chooseVolume(list, blockSize);\n+    return chooseVolume(list, blockSize);\n   }\n\\ No newline at end of file\n",
          "actualSource": "  FsVolumeReference getNextTransientVolume(long blockSize) throws IOException {\n    // Get a snapshot of currently available volumes.\n    final List\u003cFsVolumeImpl\u003e curVolumes \u003d getVolumes();\n    final List\u003cFsVolumeImpl\u003e list \u003d new ArrayList\u003c\u003e(curVolumes.size());\n    for(FsVolumeImpl v : curVolumes) {\n      if (v.isTransientStorage()) {\n        list.add(v);\n      }\n    }\n    return chooseVolume(list, blockSize);\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsVolumeList.java",
          "extendedDetails": {}
        }
      ]
    },
    "3b173d95171d01ab55042b1162569d1cf14a8d43": {
      "type": "Ymultichange(Ymodifierchange,Ybodychange)",
      "commitMessage": "HDFS-7531. Improve the concurrent access on FsVolumeList (Lei Xu via Colin P. McCabe)\n",
      "commitDate": "17/12/14 4:41 PM",
      "commitName": "3b173d95171d01ab55042b1162569d1cf14a8d43",
      "commitAuthor": "Colin Patrick Mccabe",
      "subchanges": [
        {
          "type": "Ymodifierchange",
          "commitMessage": "HDFS-7531. Improve the concurrent access on FsVolumeList (Lei Xu via Colin P. McCabe)\n",
          "commitDate": "17/12/14 4:41 PM",
          "commitName": "3b173d95171d01ab55042b1162569d1cf14a8d43",
          "commitAuthor": "Colin Patrick Mccabe",
          "commitDateOld": "09/12/14 10:56 AM",
          "commitNameOld": "d8352b9b2b99aa46679c5880a724ba3f0ceb41ff",
          "commitAuthorOld": "Colin Patrick Mccabe",
          "daysBetweenCommits": 8.24,
          "commitsBetweenForRepo": 70,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,10 +1,11 @@\n-  synchronized FsVolumeImpl getNextTransientVolume(\n-      long blockSize) throws IOException {\n-    final List\u003cFsVolumeImpl\u003e list \u003d new ArrayList\u003cFsVolumeImpl\u003e(volumes.size());\n-    for(FsVolumeImpl v : volumes) {\n+  FsVolumeImpl getNextTransientVolume(long blockSize) throws IOException {\n+    // Get a snapshot of currently available volumes.\n+    final List\u003cFsVolumeImpl\u003e curVolumes \u003d getVolumes();\n+    final List\u003cFsVolumeImpl\u003e list \u003d new ArrayList\u003c\u003e(curVolumes.size());\n+    for(FsVolumeImpl v : curVolumes) {\n       if (v.isTransientStorage()) {\n         list.add(v);\n       }\n     }\n     return blockChooser.chooseVolume(list, blockSize);\n   }\n\\ No newline at end of file\n",
          "actualSource": "  FsVolumeImpl getNextTransientVolume(long blockSize) throws IOException {\n    // Get a snapshot of currently available volumes.\n    final List\u003cFsVolumeImpl\u003e curVolumes \u003d getVolumes();\n    final List\u003cFsVolumeImpl\u003e list \u003d new ArrayList\u003c\u003e(curVolumes.size());\n    for(FsVolumeImpl v : curVolumes) {\n      if (v.isTransientStorage()) {\n        list.add(v);\n      }\n    }\n    return blockChooser.chooseVolume(list, blockSize);\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsVolumeList.java",
          "extendedDetails": {
            "oldValue": "[synchronized]",
            "newValue": "[]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-7531. Improve the concurrent access on FsVolumeList (Lei Xu via Colin P. McCabe)\n",
          "commitDate": "17/12/14 4:41 PM",
          "commitName": "3b173d95171d01ab55042b1162569d1cf14a8d43",
          "commitAuthor": "Colin Patrick Mccabe",
          "commitDateOld": "09/12/14 10:56 AM",
          "commitNameOld": "d8352b9b2b99aa46679c5880a724ba3f0ceb41ff",
          "commitAuthorOld": "Colin Patrick Mccabe",
          "daysBetweenCommits": 8.24,
          "commitsBetweenForRepo": 70,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,10 +1,11 @@\n-  synchronized FsVolumeImpl getNextTransientVolume(\n-      long blockSize) throws IOException {\n-    final List\u003cFsVolumeImpl\u003e list \u003d new ArrayList\u003cFsVolumeImpl\u003e(volumes.size());\n-    for(FsVolumeImpl v : volumes) {\n+  FsVolumeImpl getNextTransientVolume(long blockSize) throws IOException {\n+    // Get a snapshot of currently available volumes.\n+    final List\u003cFsVolumeImpl\u003e curVolumes \u003d getVolumes();\n+    final List\u003cFsVolumeImpl\u003e list \u003d new ArrayList\u003c\u003e(curVolumes.size());\n+    for(FsVolumeImpl v : curVolumes) {\n       if (v.isTransientStorage()) {\n         list.add(v);\n       }\n     }\n     return blockChooser.chooseVolume(list, blockSize);\n   }\n\\ No newline at end of file\n",
          "actualSource": "  FsVolumeImpl getNextTransientVolume(long blockSize) throws IOException {\n    // Get a snapshot of currently available volumes.\n    final List\u003cFsVolumeImpl\u003e curVolumes \u003d getVolumes();\n    final List\u003cFsVolumeImpl\u003e list \u003d new ArrayList\u003c\u003e(curVolumes.size());\n    for(FsVolumeImpl v : curVolumes) {\n      if (v.isTransientStorage()) {\n        list.add(v);\n      }\n    }\n    return blockChooser.chooseVolume(list, blockSize);\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsVolumeList.java",
          "extendedDetails": {}
        }
      ]
    }
  }
}