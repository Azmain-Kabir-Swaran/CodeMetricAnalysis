{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "ApplicationMaster.java",
  "functionName": "cleanup",
  "functionId": "cleanup",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell/src/main/java/org/apache/hadoop/yarn/applications/distributedshell/ApplicationMaster.java",
  "functionStartLine": 784,
  "functionEndLine": 799,
  "numCommitsSeen": 113,
  "timeTaken": 1893,
  "changeHistory": [
    "30c6dd92e1d4075d143adc891dc8ec536dddc0d9",
    "6a0e7dd454d587266a6020f83c6d07efb946d6ce",
    "b0d24ef39cbee53ae092f3aafeeebd22cd81bcac"
  ],
  "changeHistoryShort": {
    "30c6dd92e1d4075d143adc891dc8ec536dddc0d9": "Ybodychange",
    "6a0e7dd454d587266a6020f83c6d07efb946d6ce": "Ybodychange",
    "b0d24ef39cbee53ae092f3aafeeebd22cd81bcac": "Yintroduced"
  },
  "changeHistoryDetails": {
    "30c6dd92e1d4075d143adc891dc8ec536dddc0d9": {
      "type": "Ybodychange",
      "commitMessage": "YARN-9452. Fix TestDistributedShell and TestTimelineAuthFilterForV2 failures. Contributed by Prabhu Joseph.\n",
      "commitDate": "30/05/19 10:02 AM",
      "commitName": "30c6dd92e1d4075d143adc891dc8ec536dddc0d9",
      "commitAuthor": "Sunil G",
      "commitDateOld": "23/05/19 1:27 PM",
      "commitNameOld": "6a0e7dd454d587266a6020f83c6d07efb946d6ce",
      "commitAuthorOld": "Giovanni Matteo Fumarola",
      "daysBetweenCommits": 6.86,
      "commitsBetweenForRepo": 46,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,16 +1,16 @@\n   private void cleanup() {\n     try {\n       appSubmitterUgi.doAs(new PrivilegedExceptionAction\u003cVoid\u003e() {\n         @Override\n         public Void run() throws IOException {\n           FileSystem fs \u003d FileSystem.get(conf);\n-          Path dst \u003d new Path(getAppSubmitterHomeDir(),\n+          Path dst \u003d new Path(homeDirectory,\n               getRelativePath(appName, appId.toString(), \"\"));\n           fs.delete(dst, true);\n           return null;\n         }\n       });\n     } catch(Exception e) {\n       LOG.warn(\"Failed to remove application staging directory\", e);\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private void cleanup() {\n    try {\n      appSubmitterUgi.doAs(new PrivilegedExceptionAction\u003cVoid\u003e() {\n        @Override\n        public Void run() throws IOException {\n          FileSystem fs \u003d FileSystem.get(conf);\n          Path dst \u003d new Path(homeDirectory,\n              getRelativePath(appName, appId.toString(), \"\"));\n          fs.delete(dst, true);\n          return null;\n        }\n      });\n    } catch(Exception e) {\n      LOG.warn(\"Failed to remove application staging directory\", e);\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell/src/main/java/org/apache/hadoop/yarn/applications/distributedshell/ApplicationMaster.java",
      "extendedDetails": {}
    },
    "6a0e7dd454d587266a6020f83c6d07efb946d6ce": {
      "type": "Ybodychange",
      "commitMessage": "YARN-9482. DistributedShell job with localization fails in unsecure cluster. Contributed by Prabhu Joseph.\n",
      "commitDate": "23/05/19 1:27 PM",
      "commitName": "6a0e7dd454d587266a6020f83c6d07efb946d6ce",
      "commitAuthor": "Giovanni Matteo Fumarola",
      "commitDateOld": "09/05/19 10:59 AM",
      "commitNameOld": "ec361263464a903348bb80f23801094b4e0570d1",
      "commitAuthorOld": "Giovanni Matteo Fumarola",
      "daysBetweenCommits": 14.1,
      "commitsBetweenForRepo": 71,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,11 +1,16 @@\n   private void cleanup() {\n-    Path dst \u003d null;\n     try {\n-      FileSystem fs \u003d FileSystem.get(conf);\n-      dst \u003d new Path(fs.getHomeDirectory(), getRelativePath(appName,\n-          appId.toString(), \"\"));\n-      fs.delete(dst, true);\n-    } catch(IOException e) {\n-      LOG.warn(\"Failed to remove application staging directory {}\", dst);\n+      appSubmitterUgi.doAs(new PrivilegedExceptionAction\u003cVoid\u003e() {\n+        @Override\n+        public Void run() throws IOException {\n+          FileSystem fs \u003d FileSystem.get(conf);\n+          Path dst \u003d new Path(getAppSubmitterHomeDir(),\n+              getRelativePath(appName, appId.toString(), \"\"));\n+          fs.delete(dst, true);\n+          return null;\n+        }\n+      });\n+    } catch(Exception e) {\n+      LOG.warn(\"Failed to remove application staging directory\", e);\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private void cleanup() {\n    try {\n      appSubmitterUgi.doAs(new PrivilegedExceptionAction\u003cVoid\u003e() {\n        @Override\n        public Void run() throws IOException {\n          FileSystem fs \u003d FileSystem.get(conf);\n          Path dst \u003d new Path(getAppSubmitterHomeDir(),\n              getRelativePath(appName, appId.toString(), \"\"));\n          fs.delete(dst, true);\n          return null;\n        }\n      });\n    } catch(Exception e) {\n      LOG.warn(\"Failed to remove application staging directory\", e);\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell/src/main/java/org/apache/hadoop/yarn/applications/distributedshell/ApplicationMaster.java",
      "extendedDetails": {}
    },
    "b0d24ef39cbee53ae092f3aafeeebd22cd81bcac": {
      "type": "Yintroduced",
      "commitMessage": "YARN-9227. DistributedShell RelativePath is not removed at end. Contributed by Prabhu Joseph.\n",
      "commitDate": "01/04/19 10:59 AM",
      "commitName": "b0d24ef39cbee53ae092f3aafeeebd22cd81bcac",
      "commitAuthor": "Giovanni Matteo Fumarola",
      "diff": "@@ -0,0 +1,11 @@\n+  private void cleanup() {\n+    Path dst \u003d null;\n+    try {\n+      FileSystem fs \u003d FileSystem.get(conf);\n+      dst \u003d new Path(fs.getHomeDirectory(), getRelativePath(appName,\n+          appId.toString(), \"\"));\n+      fs.delete(dst, true);\n+    } catch(IOException e) {\n+      LOG.warn(\"Failed to remove application staging directory {}\", dst);\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private void cleanup() {\n    Path dst \u003d null;\n    try {\n      FileSystem fs \u003d FileSystem.get(conf);\n      dst \u003d new Path(fs.getHomeDirectory(), getRelativePath(appName,\n          appId.toString(), \"\"));\n      fs.delete(dst, true);\n    } catch(IOException e) {\n      LOG.warn(\"Failed to remove application staging directory {}\", dst);\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-applications/hadoop-yarn-applications-distributedshell/src/main/java/org/apache/hadoop/yarn/applications/distributedshell/ApplicationMaster.java"
    }
  }
}