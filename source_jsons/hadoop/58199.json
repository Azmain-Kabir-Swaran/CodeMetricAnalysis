{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "RMDelegationTokenIdentifier.java",
  "functionName": "cancel",
  "functionId": "cancel___token-Token__?____conf-Configuration",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/security/client/RMDelegationTokenIdentifier.java",
  "functionStartLine": 117,
  "functionEndLine": 135,
  "numCommitsSeen": 11,
  "timeTaken": 1912,
  "changeHistory": [
    "77e134d13fb87cd098f2e9c23212affe0a7be1be",
    "a83fb61ac07c0468cbc7a38526e92683883dd932",
    "92b7165a71656468f17ce8b760ce11e648932f0e",
    "ab16a375720f1b5fa8400498d6a727007275e1d8",
    "dd8fc7e499200476f44a3d1d38127f5c47c9eefb"
  ],
  "changeHistoryShort": {
    "77e134d13fb87cd098f2e9c23212affe0a7be1be": "Ybodychange",
    "a83fb61ac07c0468cbc7a38526e92683883dd932": "Ybodychange",
    "92b7165a71656468f17ce8b760ce11e648932f0e": "Ybodychange",
    "ab16a375720f1b5fa8400498d6a727007275e1d8": "Ymultichange(Ymovefromfile,Ybodychange)",
    "dd8fc7e499200476f44a3d1d38127f5c47c9eefb": "Yintroduced"
  },
  "changeHistoryDetails": {
    "77e134d13fb87cd098f2e9c23212affe0a7be1be": {
      "type": "Ybodychange",
      "commitMessage": "YARN-387. Renamed YARN protocols for consistency. Contributed by Vinod K V.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1493623 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "16/06/13 7:27 PM",
      "commitName": "77e134d13fb87cd098f2e9c23212affe0a7be1be",
      "commitAuthor": "Arun Murthy",
      "commitDateOld": "03/06/13 9:05 PM",
      "commitNameOld": "a83fb61ac07c0468cbc7a38526e92683883dd932",
      "commitAuthorOld": "Vinod Kumar Vavilapalli",
      "daysBetweenCommits": 12.93,
      "commitsBetweenForRepo": 96,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,19 +1,19 @@\n     public void cancel(Token\u003c?\u003e token, Configuration conf) throws IOException,\n         InterruptedException {\n-      final ClientRMProtocol rmClient \u003d getRmClient(token, conf);\n+      final ApplicationClientProtocol rmClient \u003d getRmClient(token, conf);\n       if (rmClient !\u003d null) {\n         try {\n           CancelDelegationTokenRequest request \u003d\n               Records.newRecord(CancelDelegationTokenRequest.class);\n           request.setDelegationToken(convertToProtoToken(token));\n           rmClient.cancelDelegationToken(request);\n         } catch (YarnException e) {\n           throw new IOException(e);\n         } finally {\n           RPC.stopProxy(rmClient);\n         }\n       } else {\n         localSecretManager.cancelToken(\n             (Token\u003cRMDelegationTokenIdentifier\u003e)token, getRenewer(token));\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void cancel(Token\u003c?\u003e token, Configuration conf) throws IOException,\n        InterruptedException {\n      final ApplicationClientProtocol rmClient \u003d getRmClient(token, conf);\n      if (rmClient !\u003d null) {\n        try {\n          CancelDelegationTokenRequest request \u003d\n              Records.newRecord(CancelDelegationTokenRequest.class);\n          request.setDelegationToken(convertToProtoToken(token));\n          rmClient.cancelDelegationToken(request);\n        } catch (YarnException e) {\n          throw new IOException(e);\n        } finally {\n          RPC.stopProxy(rmClient);\n        }\n      } else {\n        localSecretManager.cancelToken(\n            (Token\u003cRMDelegationTokenIdentifier\u003e)token, getRenewer(token));\n      }\n    }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/security/client/RMDelegationTokenIdentifier.java",
      "extendedDetails": {}
    },
    "a83fb61ac07c0468cbc7a38526e92683883dd932": {
      "type": "Ybodychange",
      "commitMessage": "YARN-635. Renamed YarnRemoteException to YarnException. Contributed by Siddharth Seth.\nMAPREDUCE-5301. Updated MR code to work with YARN-635 changes of renaming YarnRemoteException to YarnException. Contributed by Siddharth Seth\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1489283 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "03/06/13 9:05 PM",
      "commitName": "a83fb61ac07c0468cbc7a38526e92683883dd932",
      "commitAuthor": "Vinod Kumar Vavilapalli",
      "commitDateOld": "03/06/13 5:34 PM",
      "commitNameOld": "d33534c4fb35cb82ff8d56abeeb63a949e72a031",
      "commitAuthorOld": "Vinod Kumar Vavilapalli",
      "daysBetweenCommits": 0.15,
      "commitsBetweenForRepo": 5,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,19 +1,19 @@\n     public void cancel(Token\u003c?\u003e token, Configuration conf) throws IOException,\n         InterruptedException {\n       final ClientRMProtocol rmClient \u003d getRmClient(token, conf);\n       if (rmClient !\u003d null) {\n         try {\n           CancelDelegationTokenRequest request \u003d\n               Records.newRecord(CancelDelegationTokenRequest.class);\n           request.setDelegationToken(convertToProtoToken(token));\n           rmClient.cancelDelegationToken(request);\n-        } catch (YarnRemoteException e) {\n+        } catch (YarnException e) {\n           throw new IOException(e);\n         } finally {\n           RPC.stopProxy(rmClient);\n         }\n       } else {\n         localSecretManager.cancelToken(\n             (Token\u003cRMDelegationTokenIdentifier\u003e)token, getRenewer(token));\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void cancel(Token\u003c?\u003e token, Configuration conf) throws IOException,\n        InterruptedException {\n      final ClientRMProtocol rmClient \u003d getRmClient(token, conf);\n      if (rmClient !\u003d null) {\n        try {\n          CancelDelegationTokenRequest request \u003d\n              Records.newRecord(CancelDelegationTokenRequest.class);\n          request.setDelegationToken(convertToProtoToken(token));\n          rmClient.cancelDelegationToken(request);\n        } catch (YarnException e) {\n          throw new IOException(e);\n        } finally {\n          RPC.stopProxy(rmClient);\n        }\n      } else {\n        localSecretManager.cancelToken(\n            (Token\u003cRMDelegationTokenIdentifier\u003e)token, getRenewer(token));\n      }\n    }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/security/client/RMDelegationTokenIdentifier.java",
      "extendedDetails": {}
    },
    "92b7165a71656468f17ce8b760ce11e648932f0e": {
      "type": "Ybodychange",
      "commitMessage": "YARN-629. Make YarnRemoteException not be rooted at IOException. Contributed by Xuan Gong.\nMAPREDUCE-5204. Handling YarnRemoteException separately from IOException in MR app after YARN-629. Contributed by Xuan Gong.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1479680 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "06/05/13 12:04 PM",
      "commitName": "92b7165a71656468f17ce8b760ce11e648932f0e",
      "commitAuthor": "Vinod Kumar Vavilapalli",
      "commitDateOld": "06/02/13 11:03 AM",
      "commitNameOld": "ab16a375720f1b5fa8400498d6a727007275e1d8",
      "commitAuthorOld": "Siddharth Seth",
      "daysBetweenCommits": 89.0,
      "commitsBetweenForRepo": 443,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,17 +1,19 @@\n     public void cancel(Token\u003c?\u003e token, Configuration conf) throws IOException,\n         InterruptedException {\n       final ClientRMProtocol rmClient \u003d getRmClient(token, conf);\n       if (rmClient !\u003d null) {\n         try {\n           CancelDelegationTokenRequest request \u003d\n               Records.newRecord(CancelDelegationTokenRequest.class);\n           request.setDelegationToken(convertToProtoToken(token));\n           rmClient.cancelDelegationToken(request);\n+        } catch (YarnRemoteException e) {\n+          throw new IOException(e);\n         } finally {\n           RPC.stopProxy(rmClient);\n         }\n       } else {\n         localSecretManager.cancelToken(\n             (Token\u003cRMDelegationTokenIdentifier\u003e)token, getRenewer(token));\n       }\n     }\n\\ No newline at end of file\n",
      "actualSource": "    public void cancel(Token\u003c?\u003e token, Configuration conf) throws IOException,\n        InterruptedException {\n      final ClientRMProtocol rmClient \u003d getRmClient(token, conf);\n      if (rmClient !\u003d null) {\n        try {\n          CancelDelegationTokenRequest request \u003d\n              Records.newRecord(CancelDelegationTokenRequest.class);\n          request.setDelegationToken(convertToProtoToken(token));\n          rmClient.cancelDelegationToken(request);\n        } catch (YarnRemoteException e) {\n          throw new IOException(e);\n        } finally {\n          RPC.stopProxy(rmClient);\n        }\n      } else {\n        localSecretManager.cancelToken(\n            (Token\u003cRMDelegationTokenIdentifier\u003e)token, getRenewer(token));\n      }\n    }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/security/client/RMDelegationTokenIdentifier.java",
      "extendedDetails": {}
    },
    "ab16a375720f1b5fa8400498d6a727007275e1d8": {
      "type": "Ymultichange(Ymovefromfile,Ybodychange)",
      "commitMessage": "YARN-355. Fixes a bug where RM app submission could jam under load. Contributed by Daryn Sharp.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1443131 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "06/02/13 11:03 AM",
      "commitName": "ab16a375720f1b5fa8400498d6a727007275e1d8",
      "commitAuthor": "Siddharth Seth",
      "subchanges": [
        {
          "type": "Ymovefromfile",
          "commitMessage": "YARN-355. Fixes a bug where RM app submission could jam under load. Contributed by Daryn Sharp.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1443131 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "06/02/13 11:03 AM",
          "commitName": "ab16a375720f1b5fa8400498d6a727007275e1d8",
          "commitAuthor": "Siddharth Seth",
          "commitDateOld": "06/02/13 10:20 AM",
          "commitNameOld": "8159dad8566641053045e8099939d858fa30f757",
          "commitAuthorOld": "Suresh Srinivas",
          "daysBetweenCommits": 0.03,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,14 +1,17 @@\n-  public void cancel(Token\u003c?\u003e token, Configuration conf) throws IOException,\n-      InterruptedException {\n-    YarnClientImpl yarnClient \u003d getYarnClient(conf,\n-        SecurityUtil.getTokenServiceAddr(token));\n-    try {\n-      DelegationToken dToken \u003d BuilderUtils.newDelegationToken(\n-          token.getIdentifier(), token.getKind().toString(),\n-          token.getPassword(), token.getService().toString());\n-      yarnClient.cancelRMDelegationToken(dToken);\n-      return;\n-    } finally {\n-      yarnClient.stop();\n-    }\n-  }\n\\ No newline at end of file\n+    public void cancel(Token\u003c?\u003e token, Configuration conf) throws IOException,\n+        InterruptedException {\n+      final ClientRMProtocol rmClient \u003d getRmClient(token, conf);\n+      if (rmClient !\u003d null) {\n+        try {\n+          CancelDelegationTokenRequest request \u003d\n+              Records.newRecord(CancelDelegationTokenRequest.class);\n+          request.setDelegationToken(convertToProtoToken(token));\n+          rmClient.cancelDelegationToken(request);\n+        } finally {\n+          RPC.stopProxy(rmClient);\n+        }\n+      } else {\n+        localSecretManager.cancelToken(\n+            (Token\u003cRMDelegationTokenIdentifier\u003e)token, getRenewer(token));\n+      }\n+    }\n\\ No newline at end of file\n",
          "actualSource": "    public void cancel(Token\u003c?\u003e token, Configuration conf) throws IOException,\n        InterruptedException {\n      final ClientRMProtocol rmClient \u003d getRmClient(token, conf);\n      if (rmClient !\u003d null) {\n        try {\n          CancelDelegationTokenRequest request \u003d\n              Records.newRecord(CancelDelegationTokenRequest.class);\n          request.setDelegationToken(convertToProtoToken(token));\n          rmClient.cancelDelegationToken(request);\n        } finally {\n          RPC.stopProxy(rmClient);\n        }\n      } else {\n        localSecretManager.cancelToken(\n            (Token\u003cRMDelegationTokenIdentifier\u003e)token, getRenewer(token));\n      }\n    }",
          "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/security/client/RMDelegationTokenIdentifier.java",
          "extendedDetails": {
            "oldPath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client/src/main/java/org/apache/hadoop/yarn/security/RMDelegationTokenRenewer.java",
            "newPath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/security/client/RMDelegationTokenIdentifier.java",
            "oldMethodName": "cancel",
            "newMethodName": "cancel"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "YARN-355. Fixes a bug where RM app submission could jam under load. Contributed by Daryn Sharp.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1443131 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "06/02/13 11:03 AM",
          "commitName": "ab16a375720f1b5fa8400498d6a727007275e1d8",
          "commitAuthor": "Siddharth Seth",
          "commitDateOld": "06/02/13 10:20 AM",
          "commitNameOld": "8159dad8566641053045e8099939d858fa30f757",
          "commitAuthorOld": "Suresh Srinivas",
          "daysBetweenCommits": 0.03,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,14 +1,17 @@\n-  public void cancel(Token\u003c?\u003e token, Configuration conf) throws IOException,\n-      InterruptedException {\n-    YarnClientImpl yarnClient \u003d getYarnClient(conf,\n-        SecurityUtil.getTokenServiceAddr(token));\n-    try {\n-      DelegationToken dToken \u003d BuilderUtils.newDelegationToken(\n-          token.getIdentifier(), token.getKind().toString(),\n-          token.getPassword(), token.getService().toString());\n-      yarnClient.cancelRMDelegationToken(dToken);\n-      return;\n-    } finally {\n-      yarnClient.stop();\n-    }\n-  }\n\\ No newline at end of file\n+    public void cancel(Token\u003c?\u003e token, Configuration conf) throws IOException,\n+        InterruptedException {\n+      final ClientRMProtocol rmClient \u003d getRmClient(token, conf);\n+      if (rmClient !\u003d null) {\n+        try {\n+          CancelDelegationTokenRequest request \u003d\n+              Records.newRecord(CancelDelegationTokenRequest.class);\n+          request.setDelegationToken(convertToProtoToken(token));\n+          rmClient.cancelDelegationToken(request);\n+        } finally {\n+          RPC.stopProxy(rmClient);\n+        }\n+      } else {\n+        localSecretManager.cancelToken(\n+            (Token\u003cRMDelegationTokenIdentifier\u003e)token, getRenewer(token));\n+      }\n+    }\n\\ No newline at end of file\n",
          "actualSource": "    public void cancel(Token\u003c?\u003e token, Configuration conf) throws IOException,\n        InterruptedException {\n      final ClientRMProtocol rmClient \u003d getRmClient(token, conf);\n      if (rmClient !\u003d null) {\n        try {\n          CancelDelegationTokenRequest request \u003d\n              Records.newRecord(CancelDelegationTokenRequest.class);\n          request.setDelegationToken(convertToProtoToken(token));\n          rmClient.cancelDelegationToken(request);\n        } finally {\n          RPC.stopProxy(rmClient);\n        }\n      } else {\n        localSecretManager.cancelToken(\n            (Token\u003cRMDelegationTokenIdentifier\u003e)token, getRenewer(token));\n      }\n    }",
          "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-common/src/main/java/org/apache/hadoop/yarn/security/client/RMDelegationTokenIdentifier.java",
          "extendedDetails": {}
        }
      ]
    },
    "dd8fc7e499200476f44a3d1d38127f5c47c9eefb": {
      "type": "Yintroduced",
      "commitMessage": "YARN-50. Implement renewal / cancellation of Delegation Tokens(Siddharth Seth via tgraves)\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1429085 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "04/01/13 12:15 PM",
      "commitName": "dd8fc7e499200476f44a3d1d38127f5c47c9eefb",
      "commitAuthor": "Thomas Graves",
      "diff": "@@ -0,0 +1,14 @@\n+  public void cancel(Token\u003c?\u003e token, Configuration conf) throws IOException,\n+      InterruptedException {\n+    YarnClientImpl yarnClient \u003d getYarnClient(conf,\n+        SecurityUtil.getTokenServiceAddr(token));\n+    try {\n+      DelegationToken dToken \u003d BuilderUtils.newDelegationToken(\n+          token.getIdentifier(), token.getKind().toString(),\n+          token.getPassword(), token.getService().toString());\n+      yarnClient.cancelRMDelegationToken(dToken);\n+      return;\n+    } finally {\n+      yarnClient.stop();\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  public void cancel(Token\u003c?\u003e token, Configuration conf) throws IOException,\n      InterruptedException {\n    YarnClientImpl yarnClient \u003d getYarnClient(conf,\n        SecurityUtil.getTokenServiceAddr(token));\n    try {\n      DelegationToken dToken \u003d BuilderUtils.newDelegationToken(\n          token.getIdentifier(), token.getKind().toString(),\n          token.getPassword(), token.getService().toString());\n      yarnClient.cancelRMDelegationToken(dToken);\n      return;\n    } finally {\n      yarnClient.stop();\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-client/src/main/java/org/apache/hadoop/yarn/security/RMDelegationTokenRenewer.java"
    }
  }
}