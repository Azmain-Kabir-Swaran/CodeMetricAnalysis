{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "FSNamesystem.java",
  "functionName": "startStandbyServices",
  "functionId": "startStandbyServices___conf-Configuration(modifiers-final)__isObserver-boolean",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
  "functionStartLine": 1483,
  "functionEndLine": 1501,
  "numCommitsSeen": 1776,
  "timeTaken": 48993,
  "changeHistory": [
    "3a78e5ffd83dd96ef9bca72745f27efdda0c9e24",
    "9ca79e8d327e95845ef9794396afd43a52bc3d40",
    "fe328621d4a84ae99efcb6394a910009b4e1761f",
    "23b6ed973e1ff5ace1e3a97cded008908e8daa55",
    "675a7e4acba1417a80e1403b468c32efe597ba90",
    "8c0366bf103ca638b5ef9e962671f7728db4fd10"
  ],
  "changeHistoryShort": {
    "3a78e5ffd83dd96ef9bca72745f27efdda0c9e24": "Ymultichange(Yparameterchange,Ybodychange)",
    "9ca79e8d327e95845ef9794396afd43a52bc3d40": "Ybodychange",
    "fe328621d4a84ae99efcb6394a910009b4e1761f": "Ybodychange",
    "23b6ed973e1ff5ace1e3a97cded008908e8daa55": "Ybodychange",
    "675a7e4acba1417a80e1403b468c32efe597ba90": "Yexceptionschange",
    "8c0366bf103ca638b5ef9e962671f7728db4fd10": "Ymultichange(Yparameterchange,Ybodychange)"
  },
  "changeHistoryDetails": {
    "3a78e5ffd83dd96ef9bca72745f27efdda0c9e24": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HDFS-12975. [SBN read] Changes to the NameNode to support reads from standby. Contributed by Chao Sun.",
      "commitDate": "24/12/18 9:33 AM",
      "commitName": "3a78e5ffd83dd96ef9bca72745f27efdda0c9e24",
      "commitAuthor": "Chao Sun",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-12975. [SBN read] Changes to the NameNode to support reads from standby. Contributed by Chao Sun.",
          "commitDate": "24/12/18 9:33 AM",
          "commitName": "3a78e5ffd83dd96ef9bca72745f27efdda0c9e24",
          "commitAuthor": "Chao Sun",
          "commitDateOld": "03/12/18 10:01 AM",
          "commitNameOld": "dd5e7c6b7239a93f2391beaa11181e442a387db4",
          "commitAuthorOld": "Kitti Nanasi",
          "daysBetweenCommits": 20.98,
          "commitsBetweenForRepo": 116,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,18 +1,19 @@\n-  void startStandbyServices(final Configuration conf) throws IOException {\n-    LOG.info(\"Starting services required for standby state\");\n+  void startStandbyServices(final Configuration conf, boolean isObserver)\n+      throws IOException {\n+    LOG.info(\"Starting services required for \" +\n+        (isObserver ? \"observer\" : \"standby\") + \" state\");\n     if (!getFSImage().editLog.isOpenForRead()) {\n       // During startup, we\u0027re already open for read.\n       getFSImage().editLog.initSharedJournalsForRead();\n     }\n-    \n     blockManager.setPostponeBlocksFromFuture(true);\n \n     // Disable quota checks while in standby.\n     dir.disableQuotaChecks();\n     editLogTailer \u003d new EditLogTailer(this, conf);\n     editLogTailer.start();\n-    if (standbyShouldCheckpoint) {\n+    if (!isObserver \u0026\u0026 standbyShouldCheckpoint) {\n       standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n       standbyCheckpointer.start();\n     }\n   }\n\\ No newline at end of file\n",
          "actualSource": "  void startStandbyServices(final Configuration conf, boolean isObserver)\n      throws IOException {\n    LOG.info(\"Starting services required for \" +\n        (isObserver ? \"observer\" : \"standby\") + \" state\");\n    if (!getFSImage().editLog.isOpenForRead()) {\n      // During startup, we\u0027re already open for read.\n      getFSImage().editLog.initSharedJournalsForRead();\n    }\n    blockManager.setPostponeBlocksFromFuture(true);\n\n    // Disable quota checks while in standby.\n    dir.disableQuotaChecks();\n    editLogTailer \u003d new EditLogTailer(this, conf);\n    editLogTailer.start();\n    if (!isObserver \u0026\u0026 standbyShouldCheckpoint) {\n      standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n      standbyCheckpointer.start();\n    }\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
          "extendedDetails": {
            "oldValue": "[conf-Configuration(modifiers-final)]",
            "newValue": "[conf-Configuration(modifiers-final), isObserver-boolean]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-12975. [SBN read] Changes to the NameNode to support reads from standby. Contributed by Chao Sun.",
          "commitDate": "24/12/18 9:33 AM",
          "commitName": "3a78e5ffd83dd96ef9bca72745f27efdda0c9e24",
          "commitAuthor": "Chao Sun",
          "commitDateOld": "03/12/18 10:01 AM",
          "commitNameOld": "dd5e7c6b7239a93f2391beaa11181e442a387db4",
          "commitAuthorOld": "Kitti Nanasi",
          "daysBetweenCommits": 20.98,
          "commitsBetweenForRepo": 116,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,18 +1,19 @@\n-  void startStandbyServices(final Configuration conf) throws IOException {\n-    LOG.info(\"Starting services required for standby state\");\n+  void startStandbyServices(final Configuration conf, boolean isObserver)\n+      throws IOException {\n+    LOG.info(\"Starting services required for \" +\n+        (isObserver ? \"observer\" : \"standby\") + \" state\");\n     if (!getFSImage().editLog.isOpenForRead()) {\n       // During startup, we\u0027re already open for read.\n       getFSImage().editLog.initSharedJournalsForRead();\n     }\n-    \n     blockManager.setPostponeBlocksFromFuture(true);\n \n     // Disable quota checks while in standby.\n     dir.disableQuotaChecks();\n     editLogTailer \u003d new EditLogTailer(this, conf);\n     editLogTailer.start();\n-    if (standbyShouldCheckpoint) {\n+    if (!isObserver \u0026\u0026 standbyShouldCheckpoint) {\n       standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n       standbyCheckpointer.start();\n     }\n   }\n\\ No newline at end of file\n",
          "actualSource": "  void startStandbyServices(final Configuration conf, boolean isObserver)\n      throws IOException {\n    LOG.info(\"Starting services required for \" +\n        (isObserver ? \"observer\" : \"standby\") + \" state\");\n    if (!getFSImage().editLog.isOpenForRead()) {\n      // During startup, we\u0027re already open for read.\n      getFSImage().editLog.initSharedJournalsForRead();\n    }\n    blockManager.setPostponeBlocksFromFuture(true);\n\n    // Disable quota checks while in standby.\n    dir.disableQuotaChecks();\n    editLogTailer \u003d new EditLogTailer(this, conf);\n    editLogTailer.start();\n    if (!isObserver \u0026\u0026 standbyShouldCheckpoint) {\n      standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n      standbyCheckpointer.start();\n    }\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
          "extendedDetails": {}
        }
      ]
    },
    "9ca79e8d327e95845ef9794396afd43a52bc3d40": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-6557. Move the reference of fsimage to FSNamesystem. Contributed by Haohui Mai.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1604242 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "20/06/14 11:54 AM",
      "commitName": "9ca79e8d327e95845ef9794396afd43a52bc3d40",
      "commitAuthor": "Haohui Mai",
      "commitDateOld": "20/06/14 11:25 AM",
      "commitNameOld": "d9eb18bb2e6c25ecc3acaaa2f7e53aff1d795edd",
      "commitAuthorOld": "Jing Zhao",
      "daysBetweenCommits": 0.02,
      "commitsBetweenForRepo": 4,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,18 +1,18 @@\n   void startStandbyServices(final Configuration conf) throws IOException {\n     LOG.info(\"Starting services required for standby state\");\n-    if (!dir.fsImage.editLog.isOpenForRead()) {\n+    if (!getFSImage().editLog.isOpenForRead()) {\n       // During startup, we\u0027re already open for read.\n-      dir.fsImage.editLog.initSharedJournalsForRead();\n+      getFSImage().editLog.initSharedJournalsForRead();\n     }\n     \n     blockManager.setPostponeBlocksFromFuture(true);\n \n     // Disable quota checks while in standby.\n     dir.disableQuotaChecks();\n     editLogTailer \u003d new EditLogTailer(this, conf);\n     editLogTailer.start();\n     if (standbyShouldCheckpoint) {\n       standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n       standbyCheckpointer.start();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void startStandbyServices(final Configuration conf) throws IOException {\n    LOG.info(\"Starting services required for standby state\");\n    if (!getFSImage().editLog.isOpenForRead()) {\n      // During startup, we\u0027re already open for read.\n      getFSImage().editLog.initSharedJournalsForRead();\n    }\n    \n    blockManager.setPostponeBlocksFromFuture(true);\n\n    // Disable quota checks while in standby.\n    dir.disableQuotaChecks();\n    editLogTailer \u003d new EditLogTailer(this, conf);\n    editLogTailer.start();\n    if (standbyShouldCheckpoint) {\n      standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n      standbyCheckpointer.start();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
      "extendedDetails": {}
    },
    "fe328621d4a84ae99efcb6394a910009b4e1761f": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-6191. Disable quota checks when replaying edit log.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1585544 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "07/04/14 11:25 AM",
      "commitName": "fe328621d4a84ae99efcb6394a910009b4e1761f",
      "commitAuthor": "Kihwal Lee",
      "commitDateOld": "26/03/14 9:25 PM",
      "commitNameOld": "21d225af4dd0189509fa98c3499319672096a1b6",
      "commitAuthorOld": "Suresh Srinivas",
      "daysBetweenCommits": 11.58,
      "commitsBetweenForRepo": 49,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,16 +1,18 @@\n   void startStandbyServices(final Configuration conf) throws IOException {\n     LOG.info(\"Starting services required for standby state\");\n     if (!dir.fsImage.editLog.isOpenForRead()) {\n       // During startup, we\u0027re already open for read.\n       dir.fsImage.editLog.initSharedJournalsForRead();\n     }\n     \n     blockManager.setPostponeBlocksFromFuture(true);\n \n+    // Disable quota checks while in standby.\n+    dir.disableQuotaChecks();\n     editLogTailer \u003d new EditLogTailer(this, conf);\n     editLogTailer.start();\n     if (standbyShouldCheckpoint) {\n       standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n       standbyCheckpointer.start();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void startStandbyServices(final Configuration conf) throws IOException {\n    LOG.info(\"Starting services required for standby state\");\n    if (!dir.fsImage.editLog.isOpenForRead()) {\n      // During startup, we\u0027re already open for read.\n      dir.fsImage.editLog.initSharedJournalsForRead();\n    }\n    \n    blockManager.setPostponeBlocksFromFuture(true);\n\n    // Disable quota checks while in standby.\n    dir.disableQuotaChecks();\n    editLogTailer \u003d new EditLogTailer(this, conf);\n    editLogTailer.start();\n    if (standbyShouldCheckpoint) {\n      standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n      standbyCheckpointer.start();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
      "extendedDetails": {}
    },
    "23b6ed973e1ff5ace1e3a97cded008908e8daa55": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-3605. Block mistakenly marked corrupt during edit log catchup phase of failover. Contributed by Todd Lipcon and Brahma Reddy Battula.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1363175 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "18/07/12 4:42 PM",
      "commitName": "23b6ed973e1ff5ace1e3a97cded008908e8daa55",
      "commitAuthor": "Todd Lipcon",
      "commitDateOld": "17/07/12 10:05 PM",
      "commitNameOld": "6981b14003d3ff99fd719515ac08d748fc5f44bd",
      "commitAuthorOld": "Eli Collins",
      "daysBetweenCommits": 0.78,
      "commitsBetweenForRepo": 6,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,13 +1,16 @@\n   void startStandbyServices(final Configuration conf) throws IOException {\n     LOG.info(\"Starting services required for standby state\");\n     if (!dir.fsImage.editLog.isOpenForRead()) {\n       // During startup, we\u0027re already open for read.\n       dir.fsImage.editLog.initSharedJournalsForRead();\n     }\n+    \n+    blockManager.setPostponeBlocksFromFuture(true);\n+\n     editLogTailer \u003d new EditLogTailer(this, conf);\n     editLogTailer.start();\n     if (standbyShouldCheckpoint) {\n       standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n       standbyCheckpointer.start();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void startStandbyServices(final Configuration conf) throws IOException {\n    LOG.info(\"Starting services required for standby state\");\n    if (!dir.fsImage.editLog.isOpenForRead()) {\n      // During startup, we\u0027re already open for read.\n      dir.fsImage.editLog.initSharedJournalsForRead();\n    }\n    \n    blockManager.setPostponeBlocksFromFuture(true);\n\n    editLogTailer \u003d new EditLogTailer(this, conf);\n    editLogTailer.start();\n    if (standbyShouldCheckpoint) {\n      standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n      standbyCheckpointer.start();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
      "extendedDetails": {}
    },
    "675a7e4acba1417a80e1403b468c32efe597ba90": {
      "type": "Yexceptionschange",
      "commitMessage": "HDFS-3484. hdfs fsck doesn\u0027t work if NN HTTP address is set to 0.0.0.0 even if NN RPC address is configured. Contributed by Aaron T. Myers\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1344908 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "31/05/12 2:02 PM",
      "commitName": "675a7e4acba1417a80e1403b468c32efe597ba90",
      "commitAuthor": "Eli Collins",
      "commitDateOld": "21/05/12 11:51 AM",
      "commitNameOld": "d69510a7f8b3a86cbf0175a6ff2e28ac82707924",
      "commitAuthorOld": "Tsz-wo Sze",
      "daysBetweenCommits": 10.09,
      "commitsBetweenForRepo": 44,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,13 +1,13 @@\n-  void startStandbyServices(final Configuration conf) {\n+  void startStandbyServices(final Configuration conf) throws IOException {\n     LOG.info(\"Starting services required for standby state\");\n     if (!dir.fsImage.editLog.isOpenForRead()) {\n       // During startup, we\u0027re already open for read.\n       dir.fsImage.editLog.initSharedJournalsForRead();\n     }\n     editLogTailer \u003d new EditLogTailer(this, conf);\n     editLogTailer.start();\n     if (standbyShouldCheckpoint) {\n       standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n       standbyCheckpointer.start();\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  void startStandbyServices(final Configuration conf) throws IOException {\n    LOG.info(\"Starting services required for standby state\");\n    if (!dir.fsImage.editLog.isOpenForRead()) {\n      // During startup, we\u0027re already open for read.\n      dir.fsImage.editLog.initSharedJournalsForRead();\n    }\n    editLogTailer \u003d new EditLogTailer(this, conf);\n    editLogTailer.start();\n    if (standbyShouldCheckpoint) {\n      standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n      standbyCheckpointer.start();\n    }\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
      "extendedDetails": {
        "oldValue": "[]",
        "newValue": "[IOException]"
      }
    },
    "8c0366bf103ca638b5ef9e962671f7728db4fd10": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HDFS-3168. Remove unnecessary \"throw IOException\" and change fields to final in FSNamesystem and BlockManager. \n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1309218 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "03/04/12 7:51 PM",
      "commitName": "8c0366bf103ca638b5ef9e962671f7728db4fd10",
      "commitAuthor": "Tsz-wo Sze",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-3168. Remove unnecessary \"throw IOException\" and change fields to final in FSNamesystem and BlockManager. \n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1309218 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "03/04/12 7:51 PM",
          "commitName": "8c0366bf103ca638b5ef9e962671f7728db4fd10",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "02/04/12 4:13 PM",
          "commitNameOld": "72b3f302dc3590b7f731cad26558cd592c35dc5a",
          "commitAuthorOld": "Eli Collins",
          "daysBetweenCommits": 1.15,
          "commitsBetweenForRepo": 17,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,13 @@\n-  void startStandbyServices() {\n+  void startStandbyServices(final Configuration conf) {\n     LOG.info(\"Starting services required for standby state\");\n     if (!dir.fsImage.editLog.isOpenForRead()) {\n       // During startup, we\u0027re already open for read.\n       dir.fsImage.editLog.initSharedJournalsForRead();\n     }\n-    editLogTailer \u003d new EditLogTailer(this);\n+    editLogTailer \u003d new EditLogTailer(this, conf);\n     editLogTailer.start();\n     if (standbyShouldCheckpoint) {\n       standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n       standbyCheckpointer.start();\n     }\n   }\n\\ No newline at end of file\n",
          "actualSource": "  void startStandbyServices(final Configuration conf) {\n    LOG.info(\"Starting services required for standby state\");\n    if (!dir.fsImage.editLog.isOpenForRead()) {\n      // During startup, we\u0027re already open for read.\n      dir.fsImage.editLog.initSharedJournalsForRead();\n    }\n    editLogTailer \u003d new EditLogTailer(this, conf);\n    editLogTailer.start();\n    if (standbyShouldCheckpoint) {\n      standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n      standbyCheckpointer.start();\n    }\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
          "extendedDetails": {
            "oldValue": "[]",
            "newValue": "[conf-Configuration(modifiers-final)]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-3168. Remove unnecessary \"throw IOException\" and change fields to final in FSNamesystem and BlockManager. \n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1309218 13f79535-47bb-0310-9956-ffa450edef68\n",
          "commitDate": "03/04/12 7:51 PM",
          "commitName": "8c0366bf103ca638b5ef9e962671f7728db4fd10",
          "commitAuthor": "Tsz-wo Sze",
          "commitDateOld": "02/04/12 4:13 PM",
          "commitNameOld": "72b3f302dc3590b7f731cad26558cd592c35dc5a",
          "commitAuthorOld": "Eli Collins",
          "daysBetweenCommits": 1.15,
          "commitsBetweenForRepo": 17,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,13 @@\n-  void startStandbyServices() {\n+  void startStandbyServices(final Configuration conf) {\n     LOG.info(\"Starting services required for standby state\");\n     if (!dir.fsImage.editLog.isOpenForRead()) {\n       // During startup, we\u0027re already open for read.\n       dir.fsImage.editLog.initSharedJournalsForRead();\n     }\n-    editLogTailer \u003d new EditLogTailer(this);\n+    editLogTailer \u003d new EditLogTailer(this, conf);\n     editLogTailer.start();\n     if (standbyShouldCheckpoint) {\n       standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n       standbyCheckpointer.start();\n     }\n   }\n\\ No newline at end of file\n",
          "actualSource": "  void startStandbyServices(final Configuration conf) {\n    LOG.info(\"Starting services required for standby state\");\n    if (!dir.fsImage.editLog.isOpenForRead()) {\n      // During startup, we\u0027re already open for read.\n      dir.fsImage.editLog.initSharedJournalsForRead();\n    }\n    editLogTailer \u003d new EditLogTailer(this, conf);\n    editLogTailer.start();\n    if (standbyShouldCheckpoint) {\n      standbyCheckpointer \u003d new StandbyCheckpointer(conf, this);\n      standbyCheckpointer.start();\n    }\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/FSNamesystem.java",
          "extendedDetails": {}
        }
      ]
    }
  }
}