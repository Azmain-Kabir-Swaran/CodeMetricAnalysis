{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "MRAMSimulator.java",
  "functionName": "restart",
  "functionId": "restart",
  "sourceFilePath": "hadoop-tools/hadoop-sls/src/main/java/org/apache/hadoop/yarn/sls/appmaster/MRAMSimulator.java",
  "functionStartLine": 250,
  "functionEndLine": 277,
  "numCommitsSeen": 12,
  "timeTaken": 832,
  "changeHistory": [
    "b32ffa2753e83615b980721b6067fcc35ce54372",
    "58b08e11b9f04c9190ab4a07473f0ee04e01ec6b"
  ],
  "changeHistoryShort": {
    "b32ffa2753e83615b980721b6067fcc35ce54372": "Ybodychange",
    "58b08e11b9f04c9190ab4a07473f0ee04e01ec6b": "Yintroduced"
  },
  "changeHistoryDetails": {
    "b32ffa2753e83615b980721b6067fcc35ce54372": {
      "type": "Ybodychange",
      "commitMessage": "YARN-4779. Fix AM container allocation logic in SLS. Contributed by Wangda Tan.\n",
      "commitDate": "24/02/17 8:09 AM",
      "commitName": "b32ffa2753e83615b980721b6067fcc35ce54372",
      "commitAuthor": "Sunil G",
      "commitDateOld": "09/09/14 3:13 PM",
      "commitNameOld": "28d99db99236ff2a6e4a605802820e2b512225f9",
      "commitAuthorOld": "Karthik Kambatla",
      "daysBetweenCommits": 898.75,
      "commitsBetweenForRepo": 6750,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,18 +1,28 @@\n   private void restart()\n           throws YarnException, IOException, InterruptedException {\n-    // clear \n-    finishedContainers \u003d 0;\n+    // clear\n     isFinished \u003d false;\n-    mapFinished \u003d 0;\n-    reduceFinished \u003d 0;\n     pendingFailedMaps.clear();\n     pendingMaps.clear();\n     pendingReduces.clear();\n     pendingFailedReduces.clear();\n-    pendingMaps.addAll(allMaps);\n-    pendingReduces.addAll(pendingReduces);\n-    isAMContainerRunning \u003d false;\n+\n+    // Only add totalMaps - finishedMaps\n+    int added \u003d 0;\n+    for (ContainerSimulator cs : allMaps) {\n+      if (added \u003e\u003d mapTotal - mapFinished) {\n+        break;\n+      }\n+      pendingMaps.add(cs);\n+    }\n+\n+    // And same, only add totalReduces - finishedReduces\n+    added \u003d 0;\n+    for (ContainerSimulator cs : allReduces) {\n+      if (added \u003e\u003d reduceTotal - reduceFinished) {\n+        break;\n+      }\n+      pendingReduces.add(cs);\n+    }\n     amContainer \u003d null;\n-    // resent am container request\n-    requestAMContainer();\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private void restart()\n          throws YarnException, IOException, InterruptedException {\n    // clear\n    isFinished \u003d false;\n    pendingFailedMaps.clear();\n    pendingMaps.clear();\n    pendingReduces.clear();\n    pendingFailedReduces.clear();\n\n    // Only add totalMaps - finishedMaps\n    int added \u003d 0;\n    for (ContainerSimulator cs : allMaps) {\n      if (added \u003e\u003d mapTotal - mapFinished) {\n        break;\n      }\n      pendingMaps.add(cs);\n    }\n\n    // And same, only add totalReduces - finishedReduces\n    added \u003d 0;\n    for (ContainerSimulator cs : allReduces) {\n      if (added \u003e\u003d reduceTotal - reduceFinished) {\n        break;\n      }\n      pendingReduces.add(cs);\n    }\n    amContainer \u003d null;\n  }",
      "path": "hadoop-tools/hadoop-sls/src/main/java/org/apache/hadoop/yarn/sls/appmaster/MRAMSimulator.java",
      "extendedDetails": {}
    },
    "58b08e11b9f04c9190ab4a07473f0ee04e01ec6b": {
      "type": "Yintroduced",
      "commitMessage": "YARN-1021. Yarn Scheduler Load Simulator. (ywskycn via tucu)\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1527059 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "27/09/13 1:23 PM",
      "commitName": "58b08e11b9f04c9190ab4a07473f0ee04e01ec6b",
      "commitAuthor": "Alejandro Abdelnur",
      "diff": "@@ -0,0 +1,18 @@\n+  private void restart()\n+          throws YarnException, IOException, InterruptedException {\n+    // clear \n+    finishedContainers \u003d 0;\n+    isFinished \u003d false;\n+    mapFinished \u003d 0;\n+    reduceFinished \u003d 0;\n+    pendingFailedMaps.clear();\n+    pendingMaps.clear();\n+    pendingReduces.clear();\n+    pendingFailedReduces.clear();\n+    pendingMaps.addAll(allMaps);\n+    pendingReduces.addAll(pendingReduces);\n+    isAMContainerRunning \u003d false;\n+    amContainer \u003d null;\n+    // resent am container request\n+    requestAMContainer();\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private void restart()\n          throws YarnException, IOException, InterruptedException {\n    // clear \n    finishedContainers \u003d 0;\n    isFinished \u003d false;\n    mapFinished \u003d 0;\n    reduceFinished \u003d 0;\n    pendingFailedMaps.clear();\n    pendingMaps.clear();\n    pendingReduces.clear();\n    pendingFailedReduces.clear();\n    pendingMaps.addAll(allMaps);\n    pendingReduces.addAll(pendingReduces);\n    isAMContainerRunning \u003d false;\n    amContainer \u003d null;\n    // resent am container request\n    requestAMContainer();\n  }",
      "path": "hadoop-tools/hadoop-sls/src/main/java/org/apache/hadoop/yarn/sls/appmaster/MRAMSimulator.java"
    }
  }
}