{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "HdfsManifestToResourcesPlugin.java",
  "functionName": "getResource",
  "functionId": "getResource___blob-ImageManifest.Blob__dir-String__expectedMediaType-String__expectedHashAlgorithm-String__resourceSuffix-String",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/linux/runtime/runc/HdfsManifestToResourcesPlugin.java",
  "functionStartLine": 137,
  "functionEndLine": 174,
  "numCommitsSeen": 1,
  "timeTaken": 1429,
  "changeHistory": [
    "0e22e9ab83438af37d821cb2f96e31f9a19ace2c"
  ],
  "changeHistoryShort": {
    "0e22e9ab83438af37d821cb2f96e31f9a19ace2c": "Yintroduced"
  },
  "changeHistoryDetails": {
    "0e22e9ab83438af37d821cb2f96e31f9a19ace2c": {
      "type": "Yintroduced",
      "commitMessage": "YARN-9562. Add Java changes for the new RuncContainerRuntime. Contributed by Eric Badger\n",
      "commitDate": "18/11/19 1:56 PM",
      "commitName": "0e22e9ab83438af37d821cb2f96e31f9a19ace2c",
      "commitAuthor": "Eric Badger",
      "diff": "@@ -0,0 +1,38 @@\n+  public LocalResource getResource(ImageManifest.Blob blob,\n+      String dir, String expectedMediaType,\n+      String expectedHashAlgorithm, String resourceSuffix) throws IOException {\n+    String mediaType \u003d blob.getMediaType();\n+    if (!mediaType.equals(expectedMediaType)) {\n+      throw new IOException(\"Invalid blob mediaType: \" + mediaType);\n+    }\n+\n+    String[] blobDigest \u003d blob.getDigest().split(\":\", 2);\n+\n+    String algorithm \u003d blobDigest[0];\n+    if (!algorithm.equals(expectedHashAlgorithm)) {\n+      throw new IOException(\"Invalid blob digest algorithm: \" + algorithm);\n+    }\n+\n+    String hash \u003d blobDigest[1];\n+    if (!hash.matches(ALPHA_NUMERIC) || hash.length() !\u003d SHA256_HASH_LENGTH) {\n+      throw new IOException(\"Malformed blob digest: \" + hash);\n+    }\n+\n+    long size \u003d blob.getSize();\n+    Path path \u003d new Path(dir, hash + resourceSuffix);\n+    LocalResource rsrc;\n+\n+    try {\n+      FileStatus stat \u003d statCache.get(path);\n+      long timestamp \u003d stat.getModificationTime();\n+      URL url \u003d URL.fromPath(path);\n+\n+      rsrc \u003d LocalResource.newInstance(url,\n+        LocalResourceType.FILE, LocalResourceVisibility.PUBLIC,\n+        size, timestamp);\n+    } catch (ExecutionException e) {\n+      throw new IOException(e);\n+    }\n+\n+    return rsrc;\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  public LocalResource getResource(ImageManifest.Blob blob,\n      String dir, String expectedMediaType,\n      String expectedHashAlgorithm, String resourceSuffix) throws IOException {\n    String mediaType \u003d blob.getMediaType();\n    if (!mediaType.equals(expectedMediaType)) {\n      throw new IOException(\"Invalid blob mediaType: \" + mediaType);\n    }\n\n    String[] blobDigest \u003d blob.getDigest().split(\":\", 2);\n\n    String algorithm \u003d blobDigest[0];\n    if (!algorithm.equals(expectedHashAlgorithm)) {\n      throw new IOException(\"Invalid blob digest algorithm: \" + algorithm);\n    }\n\n    String hash \u003d blobDigest[1];\n    if (!hash.matches(ALPHA_NUMERIC) || hash.length() !\u003d SHA256_HASH_LENGTH) {\n      throw new IOException(\"Malformed blob digest: \" + hash);\n    }\n\n    long size \u003d blob.getSize();\n    Path path \u003d new Path(dir, hash + resourceSuffix);\n    LocalResource rsrc;\n\n    try {\n      FileStatus stat \u003d statCache.get(path);\n      long timestamp \u003d stat.getModificationTime();\n      URL url \u003d URL.fromPath(path);\n\n      rsrc \u003d LocalResource.newInstance(url,\n        LocalResourceType.FILE, LocalResourceVisibility.PUBLIC,\n        size, timestamp);\n    } catch (ExecutionException e) {\n      throw new IOException(e);\n    }\n\n    return rsrc;\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/containermanager/linux/runtime/runc/HdfsManifestToResourcesPlugin.java"
    }
  }
}