{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "RMWebServices.java",
  "functionName": "createKerberosUserGroupInformation",
  "functionId": "createKerberosUserGroupInformation___hsr-HttpServletRequest__callerUGI-UserGroupInformation",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/webapp/RMWebServices.java",
  "functionStartLine": 1812,
  "functionEndLine": 1829,
  "numCommitsSeen": 185,
  "timeTaken": 5235,
  "changeHistory": [
    "d76fbbc9b82e720d7d5188f9ae2f56a8d78f3a98",
    "1220bb72d452521c6f09cebe1dd77341054ee9dd",
    "030580387a4d8d97560a93da2fd7494b4366e3b6"
  ],
  "changeHistoryShort": {
    "d76fbbc9b82e720d7d5188f9ae2f56a8d78f3a98": "Ymultichange(Yparameterchange,Yreturntypechange,Ybodychange)",
    "1220bb72d452521c6f09cebe1dd77341054ee9dd": "Ybodychange",
    "030580387a4d8d97560a93da2fd7494b4366e3b6": "Yintroduced"
  },
  "changeHistoryDetails": {
    "d76fbbc9b82e720d7d5188f9ae2f56a8d78f3a98": {
      "type": "Ymultichange(Yparameterchange,Yreturntypechange,Ybodychange)",
      "commitMessage": "YARN-8249. Fixed few REST APIs in RMWebServices to have static-user check. Contributed by Sunil Govindan.\n",
      "commitDate": "10/05/18 7:05 PM",
      "commitName": "d76fbbc9b82e720d7d5188f9ae2f56a8d78f3a98",
      "commitAuthor": "Vinod Kumar Vavilapalli (I am also known as @tshooter.)",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "YARN-8249. Fixed few REST APIs in RMWebServices to have static-user check. Contributed by Sunil Govindan.\n",
          "commitDate": "10/05/18 7:05 PM",
          "commitName": "d76fbbc9b82e720d7d5188f9ae2f56a8d78f3a98",
          "commitAuthor": "Vinod Kumar Vavilapalli (I am also known as @tshooter.)",
          "commitDateOld": "27/04/18 10:28 AM",
          "commitNameOld": "ef3ecc308dbea41c6a88bd4d16739c7bbc10cdda",
          "commitAuthorOld": "Rohith Sharma K S",
          "daysBetweenCommits": 13.36,
          "commitsBetweenForRepo": 87,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,27 +1,18 @@\n-  private UserGroupInformation createKerberosUserGroupInformation(\n-      HttpServletRequest hsr) throws AuthorizationException, YarnException {\n-\n-    UserGroupInformation callerUGI \u003d getCallerUserGroupInformation(hsr, true);\n-    if (callerUGI \u003d\u003d null) {\n-      String msg \u003d \"Unable to obtain user name, user not authenticated\";\n-      throw new AuthorizationException(msg);\n-    }\n+  private void createKerberosUserGroupInformation(HttpServletRequest hsr,\n+      UserGroupInformation callerUGI)\n+      throws AuthorizationException, YarnException {\n \n     String authType \u003d hsr.getAuthType();\n     if (!KerberosAuthenticationHandler.TYPE.equalsIgnoreCase(authType)) {\n       String msg \u003d \"Delegation token operations can only be carried out on a \"\n           + \"Kerberos authenticated channel. Expected auth type is \"\n           + KerberosAuthenticationHandler.TYPE + \", got type \" + authType;\n       throw new YarnException(msg);\n     }\n     if (hsr.getAttribute(\n         DelegationTokenAuthenticationHandler.DELEGATION_TOKEN_UGI_ATTRIBUTE) !\u003d null) {\n-      String msg \u003d\n-          \"Delegation token operations cannot be carried out using delegation\"\n-              + \" token authentication.\";\n+      String msg \u003d \"Delegation token operations cannot be carried out using \"\n+          + \"delegation token authentication.\";\n       throw new YarnException(msg);\n     }\n-\n-    callerUGI.setAuthenticationMethod(AuthenticationMethod.KERBEROS);\n-    return callerUGI;\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private void createKerberosUserGroupInformation(HttpServletRequest hsr,\n      UserGroupInformation callerUGI)\n      throws AuthorizationException, YarnException {\n\n    String authType \u003d hsr.getAuthType();\n    if (!KerberosAuthenticationHandler.TYPE.equalsIgnoreCase(authType)) {\n      String msg \u003d \"Delegation token operations can only be carried out on a \"\n          + \"Kerberos authenticated channel. Expected auth type is \"\n          + KerberosAuthenticationHandler.TYPE + \", got type \" + authType;\n      throw new YarnException(msg);\n    }\n    if (hsr.getAttribute(\n        DelegationTokenAuthenticationHandler.DELEGATION_TOKEN_UGI_ATTRIBUTE) !\u003d null) {\n      String msg \u003d \"Delegation token operations cannot be carried out using \"\n          + \"delegation token authentication.\";\n      throw new YarnException(msg);\n    }\n  }",
          "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/webapp/RMWebServices.java",
          "extendedDetails": {
            "oldValue": "[hsr-HttpServletRequest]",
            "newValue": "[hsr-HttpServletRequest, callerUGI-UserGroupInformation]"
          }
        },
        {
          "type": "Yreturntypechange",
          "commitMessage": "YARN-8249. Fixed few REST APIs in RMWebServices to have static-user check. Contributed by Sunil Govindan.\n",
          "commitDate": "10/05/18 7:05 PM",
          "commitName": "d76fbbc9b82e720d7d5188f9ae2f56a8d78f3a98",
          "commitAuthor": "Vinod Kumar Vavilapalli (I am also known as @tshooter.)",
          "commitDateOld": "27/04/18 10:28 AM",
          "commitNameOld": "ef3ecc308dbea41c6a88bd4d16739c7bbc10cdda",
          "commitAuthorOld": "Rohith Sharma K S",
          "daysBetweenCommits": 13.36,
          "commitsBetweenForRepo": 87,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,27 +1,18 @@\n-  private UserGroupInformation createKerberosUserGroupInformation(\n-      HttpServletRequest hsr) throws AuthorizationException, YarnException {\n-\n-    UserGroupInformation callerUGI \u003d getCallerUserGroupInformation(hsr, true);\n-    if (callerUGI \u003d\u003d null) {\n-      String msg \u003d \"Unable to obtain user name, user not authenticated\";\n-      throw new AuthorizationException(msg);\n-    }\n+  private void createKerberosUserGroupInformation(HttpServletRequest hsr,\n+      UserGroupInformation callerUGI)\n+      throws AuthorizationException, YarnException {\n \n     String authType \u003d hsr.getAuthType();\n     if (!KerberosAuthenticationHandler.TYPE.equalsIgnoreCase(authType)) {\n       String msg \u003d \"Delegation token operations can only be carried out on a \"\n           + \"Kerberos authenticated channel. Expected auth type is \"\n           + KerberosAuthenticationHandler.TYPE + \", got type \" + authType;\n       throw new YarnException(msg);\n     }\n     if (hsr.getAttribute(\n         DelegationTokenAuthenticationHandler.DELEGATION_TOKEN_UGI_ATTRIBUTE) !\u003d null) {\n-      String msg \u003d\n-          \"Delegation token operations cannot be carried out using delegation\"\n-              + \" token authentication.\";\n+      String msg \u003d \"Delegation token operations cannot be carried out using \"\n+          + \"delegation token authentication.\";\n       throw new YarnException(msg);\n     }\n-\n-    callerUGI.setAuthenticationMethod(AuthenticationMethod.KERBEROS);\n-    return callerUGI;\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private void createKerberosUserGroupInformation(HttpServletRequest hsr,\n      UserGroupInformation callerUGI)\n      throws AuthorizationException, YarnException {\n\n    String authType \u003d hsr.getAuthType();\n    if (!KerberosAuthenticationHandler.TYPE.equalsIgnoreCase(authType)) {\n      String msg \u003d \"Delegation token operations can only be carried out on a \"\n          + \"Kerberos authenticated channel. Expected auth type is \"\n          + KerberosAuthenticationHandler.TYPE + \", got type \" + authType;\n      throw new YarnException(msg);\n    }\n    if (hsr.getAttribute(\n        DelegationTokenAuthenticationHandler.DELEGATION_TOKEN_UGI_ATTRIBUTE) !\u003d null) {\n      String msg \u003d \"Delegation token operations cannot be carried out using \"\n          + \"delegation token authentication.\";\n      throw new YarnException(msg);\n    }\n  }",
          "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/webapp/RMWebServices.java",
          "extendedDetails": {
            "oldValue": "UserGroupInformation",
            "newValue": "void"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "YARN-8249. Fixed few REST APIs in RMWebServices to have static-user check. Contributed by Sunil Govindan.\n",
          "commitDate": "10/05/18 7:05 PM",
          "commitName": "d76fbbc9b82e720d7d5188f9ae2f56a8d78f3a98",
          "commitAuthor": "Vinod Kumar Vavilapalli (I am also known as @tshooter.)",
          "commitDateOld": "27/04/18 10:28 AM",
          "commitNameOld": "ef3ecc308dbea41c6a88bd4d16739c7bbc10cdda",
          "commitAuthorOld": "Rohith Sharma K S",
          "daysBetweenCommits": 13.36,
          "commitsBetweenForRepo": 87,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,27 +1,18 @@\n-  private UserGroupInformation createKerberosUserGroupInformation(\n-      HttpServletRequest hsr) throws AuthorizationException, YarnException {\n-\n-    UserGroupInformation callerUGI \u003d getCallerUserGroupInformation(hsr, true);\n-    if (callerUGI \u003d\u003d null) {\n-      String msg \u003d \"Unable to obtain user name, user not authenticated\";\n-      throw new AuthorizationException(msg);\n-    }\n+  private void createKerberosUserGroupInformation(HttpServletRequest hsr,\n+      UserGroupInformation callerUGI)\n+      throws AuthorizationException, YarnException {\n \n     String authType \u003d hsr.getAuthType();\n     if (!KerberosAuthenticationHandler.TYPE.equalsIgnoreCase(authType)) {\n       String msg \u003d \"Delegation token operations can only be carried out on a \"\n           + \"Kerberos authenticated channel. Expected auth type is \"\n           + KerberosAuthenticationHandler.TYPE + \", got type \" + authType;\n       throw new YarnException(msg);\n     }\n     if (hsr.getAttribute(\n         DelegationTokenAuthenticationHandler.DELEGATION_TOKEN_UGI_ATTRIBUTE) !\u003d null) {\n-      String msg \u003d\n-          \"Delegation token operations cannot be carried out using delegation\"\n-              + \" token authentication.\";\n+      String msg \u003d \"Delegation token operations cannot be carried out using \"\n+          + \"delegation token authentication.\";\n       throw new YarnException(msg);\n     }\n-\n-    callerUGI.setAuthenticationMethod(AuthenticationMethod.KERBEROS);\n-    return callerUGI;\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private void createKerberosUserGroupInformation(HttpServletRequest hsr,\n      UserGroupInformation callerUGI)\n      throws AuthorizationException, YarnException {\n\n    String authType \u003d hsr.getAuthType();\n    if (!KerberosAuthenticationHandler.TYPE.equalsIgnoreCase(authType)) {\n      String msg \u003d \"Delegation token operations can only be carried out on a \"\n          + \"Kerberos authenticated channel. Expected auth type is \"\n          + KerberosAuthenticationHandler.TYPE + \", got type \" + authType;\n      throw new YarnException(msg);\n    }\n    if (hsr.getAttribute(\n        DelegationTokenAuthenticationHandler.DELEGATION_TOKEN_UGI_ATTRIBUTE) !\u003d null) {\n      String msg \u003d \"Delegation token operations cannot be carried out using \"\n          + \"delegation token authentication.\";\n      throw new YarnException(msg);\n    }\n  }",
          "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/webapp/RMWebServices.java",
          "extendedDetails": {}
        }
      ]
    },
    "1220bb72d452521c6f09cebe1dd77341054ee9dd": {
      "type": "Ybodychange",
      "commitMessage": "YARN-2656. Made RM web services authentication filter support proxy user. Contributed by Varun Vasudev and Zhijie Shen.\n",
      "commitDate": "14/10/14 9:50 PM",
      "commitName": "1220bb72d452521c6f09cebe1dd77341054ee9dd",
      "commitAuthor": "Zhijie Shen",
      "commitDateOld": "29/08/14 11:40 AM",
      "commitNameOld": "c686aa3533b42e1baf62a78bc1bfb0ac05be53bb",
      "commitAuthorOld": "Jian He",
      "daysBetweenCommits": 46.42,
      "commitsBetweenForRepo": 483,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,20 +1,28 @@\n   private UserGroupInformation createKerberosUserGroupInformation(\n       HttpServletRequest hsr) throws AuthorizationException, YarnException {\n \n     UserGroupInformation callerUGI \u003d getCallerUserGroupInformation(hsr, true);\n     if (callerUGI \u003d\u003d null) {\n       String msg \u003d \"Unable to obtain user name, user not authenticated\";\n       throw new AuthorizationException(msg);\n     }\n \n     String authType \u003d hsr.getAuthType();\n-    if (!KerberosAuthenticationHandler.TYPE.equals(authType)) {\n+    if (!KerberosAuthenticationHandler.TYPE.equalsIgnoreCase(authType)) {\n       String msg \u003d\n           \"Delegation token operations can only be carried out on a \"\n-              + \"Kerberos authenticated channel\";\n+              + \"Kerberos authenticated channel. Expected auth type is \"\n+              + KerberosAuthenticationHandler.TYPE + \", got type \" + authType;\n+      throw new YarnException(msg);\n+    }\n+    if (hsr\n+      .getAttribute(DelegationTokenAuthenticationHandler.DELEGATION_TOKEN_UGI_ATTRIBUTE) !\u003d null) {\n+      String msg \u003d\n+          \"Delegation token operations cannot be carried out using delegation\"\n+              + \" token authentication.\";\n       throw new YarnException(msg);\n     }\n \n     callerUGI.setAuthenticationMethod(AuthenticationMethod.KERBEROS);\n     return callerUGI;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private UserGroupInformation createKerberosUserGroupInformation(\n      HttpServletRequest hsr) throws AuthorizationException, YarnException {\n\n    UserGroupInformation callerUGI \u003d getCallerUserGroupInformation(hsr, true);\n    if (callerUGI \u003d\u003d null) {\n      String msg \u003d \"Unable to obtain user name, user not authenticated\";\n      throw new AuthorizationException(msg);\n    }\n\n    String authType \u003d hsr.getAuthType();\n    if (!KerberosAuthenticationHandler.TYPE.equalsIgnoreCase(authType)) {\n      String msg \u003d\n          \"Delegation token operations can only be carried out on a \"\n              + \"Kerberos authenticated channel. Expected auth type is \"\n              + KerberosAuthenticationHandler.TYPE + \", got type \" + authType;\n      throw new YarnException(msg);\n    }\n    if (hsr\n      .getAttribute(DelegationTokenAuthenticationHandler.DELEGATION_TOKEN_UGI_ATTRIBUTE) !\u003d null) {\n      String msg \u003d\n          \"Delegation token operations cannot be carried out using delegation\"\n              + \" token authentication.\";\n      throw new YarnException(msg);\n    }\n\n    callerUGI.setAuthenticationMethod(AuthenticationMethod.KERBEROS);\n    return callerUGI;\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/webapp/RMWebServices.java",
      "extendedDetails": {}
    },
    "030580387a4d8d97560a93da2fd7494b4366e3b6": {
      "type": "Yintroduced",
      "commitMessage": "YARN-2233. Implemented ResourceManager web-services to create, renew and cancel delegation tokens. Contributed by Varun Vasudev.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1610876 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "15/07/14 4:00 PM",
      "commitName": "030580387a4d8d97560a93da2fd7494b4366e3b6",
      "commitAuthor": "Vinod Kumar Vavilapalli",
      "diff": "@@ -0,0 +1,20 @@\n+  private UserGroupInformation createKerberosUserGroupInformation(\n+      HttpServletRequest hsr) throws AuthorizationException, YarnException {\n+\n+    UserGroupInformation callerUGI \u003d getCallerUserGroupInformation(hsr, true);\n+    if (callerUGI \u003d\u003d null) {\n+      String msg \u003d \"Unable to obtain user name, user not authenticated\";\n+      throw new AuthorizationException(msg);\n+    }\n+\n+    String authType \u003d hsr.getAuthType();\n+    if (!KerberosAuthenticationHandler.TYPE.equals(authType)) {\n+      String msg \u003d\n+          \"Delegation token operations can only be carried out on a \"\n+              + \"Kerberos authenticated channel\";\n+      throw new YarnException(msg);\n+    }\n+\n+    callerUGI.setAuthenticationMethod(AuthenticationMethod.KERBEROS);\n+    return callerUGI;\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private UserGroupInformation createKerberosUserGroupInformation(\n      HttpServletRequest hsr) throws AuthorizationException, YarnException {\n\n    UserGroupInformation callerUGI \u003d getCallerUserGroupInformation(hsr, true);\n    if (callerUGI \u003d\u003d null) {\n      String msg \u003d \"Unable to obtain user name, user not authenticated\";\n      throw new AuthorizationException(msg);\n    }\n\n    String authType \u003d hsr.getAuthType();\n    if (!KerberosAuthenticationHandler.TYPE.equals(authType)) {\n      String msg \u003d\n          \"Delegation token operations can only be carried out on a \"\n              + \"Kerberos authenticated channel\";\n      throw new YarnException(msg);\n    }\n\n    callerUGI.setAuthenticationMethod(AuthenticationMethod.KERBEROS);\n    return callerUGI;\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-resourcemanager/src/main/java/org/apache/hadoop/yarn/server/resourcemanager/webapp/RMWebServices.java"
    }
  }
}