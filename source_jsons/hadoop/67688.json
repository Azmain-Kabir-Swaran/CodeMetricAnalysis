{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "CopyMapper.java",
  "functionName": "canSkip",
  "functionId": "canSkip___sourceFS-FileSystem__source-CopyListingFileStatus__target-FileStatus",
  "sourceFilePath": "hadoop-tools/hadoop-distcp/src/main/java/org/apache/hadoop/tools/mapred/CopyMapper.java",
  "functionStartLine": 349,
  "functionEndLine": 364,
  "numCommitsSeen": 39,
  "timeTaken": 3020,
  "changeHistory": [
    "51c64b357d4bd1a0038e61df3d4b8ea0a3ad7449",
    "a1a0281e12ea96476e75b076f76d5b5eb5254eea",
    "3671a5e16fbddbe5a0516289ce98e1305e02291c"
  ],
  "changeHistoryShort": {
    "51c64b357d4bd1a0038e61df3d4b8ea0a3ad7449": "Ybodychange",
    "a1a0281e12ea96476e75b076f76d5b5eb5254eea": "Yparameterchange",
    "3671a5e16fbddbe5a0516289ce98e1305e02291c": "Yintroduced"
  },
  "changeHistoryDetails": {
    "51c64b357d4bd1a0038e61df3d4b8ea0a3ad7449": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-13660. DistCp job fails when new data is appended in the file while the DistCp copy job is running\n\nThis uses the length of the file known at the start of the copy to determine the amount of data to copy.\n\n* If a file is appended to during the copy, the original bytes are copied.\n* If a file is truncated during a copy, or the attempt to read the data fails with a truncated stream,\n  distcp will now fail. Until now these failures were not detected.\n\nContributed by Mukund Thakur.\n\nChange-Id: I576a49d951fa48d37a45a7e4c82c47488aa8e884\n",
      "commitDate": "24/09/19 3:23 AM",
      "commitName": "51c64b357d4bd1a0038e61df3d4b8ea0a3ad7449",
      "commitAuthor": "Mukund Thakur",
      "commitDateOld": "07/02/19 2:07 AM",
      "commitNameOld": "de804e53b9d20a2df75a4c7252bf83ed52011488",
      "commitAuthorOld": "Andrew Olson",
      "daysBetweenCommits": 229.01,
      "commitsBetweenForRepo": 1796,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,16 +1,16 @@\n   private boolean canSkip(FileSystem sourceFS, CopyListingFileStatus source,\n       FileStatus target) throws IOException {\n     if (!syncFolders) {\n       return true;\n     }\n     boolean sameLength \u003d target.getLen() \u003d\u003d source.getLen();\n     boolean sameBlockSize \u003d source.getBlockSize() \u003d\u003d target.getBlockSize()\n         || !preserve.contains(FileAttribute.BLOCKSIZE);\n     if (sameLength \u0026\u0026 sameBlockSize) {\n       return skipCrc ||\n           DistCpUtils.checksumsAreEqual(sourceFS, source.getPath(), null,\n-              targetFS, target.getPath());\n+              targetFS, target.getPath(), source.getLen());\n     } else {\n       return false;\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private boolean canSkip(FileSystem sourceFS, CopyListingFileStatus source,\n      FileStatus target) throws IOException {\n    if (!syncFolders) {\n      return true;\n    }\n    boolean sameLength \u003d target.getLen() \u003d\u003d source.getLen();\n    boolean sameBlockSize \u003d source.getBlockSize() \u003d\u003d target.getBlockSize()\n        || !preserve.contains(FileAttribute.BLOCKSIZE);\n    if (sameLength \u0026\u0026 sameBlockSize) {\n      return skipCrc ||\n          DistCpUtils.checksumsAreEqual(sourceFS, source.getPath(), null,\n              targetFS, target.getPath(), source.getLen());\n    } else {\n      return false;\n    }\n  }",
      "path": "hadoop-tools/hadoop-distcp/src/main/java/org/apache/hadoop/tools/mapred/CopyMapper.java",
      "extendedDetails": {}
    },
    "a1a0281e12ea96476e75b076f76d5b5eb5254eea": {
      "type": "Yparameterchange",
      "commitMessage": "HADOOP-13626. Remove distcp dependency on FileStatus serialization\n",
      "commitDate": "24/10/16 12:46 PM",
      "commitName": "a1a0281e12ea96476e75b076f76d5b5eb5254eea",
      "commitAuthor": "Chris Douglas",
      "commitDateOld": "17/05/16 5:00 AM",
      "commitNameOld": "c69a649257a331da55c1a1bf61c819e289015a6b",
      "commitAuthorOld": "Steve Loughran",
      "daysBetweenCommits": 160.32,
      "commitsBetweenForRepo": 1196,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,16 +1,16 @@\n-  private boolean canSkip(FileSystem sourceFS, FileStatus source, \n+  private boolean canSkip(FileSystem sourceFS, CopyListingFileStatus source,\n       FileStatus target) throws IOException {\n     if (!syncFolders) {\n       return true;\n     }\n     boolean sameLength \u003d target.getLen() \u003d\u003d source.getLen();\n     boolean sameBlockSize \u003d source.getBlockSize() \u003d\u003d target.getBlockSize()\n         || !preserve.contains(FileAttribute.BLOCKSIZE);\n     if (sameLength \u0026\u0026 sameBlockSize) {\n       return skipCrc ||\n           DistCpUtils.checksumsAreEqual(sourceFS, source.getPath(), null,\n               targetFS, target.getPath());\n     } else {\n       return false;\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private boolean canSkip(FileSystem sourceFS, CopyListingFileStatus source,\n      FileStatus target) throws IOException {\n    if (!syncFolders) {\n      return true;\n    }\n    boolean sameLength \u003d target.getLen() \u003d\u003d source.getLen();\n    boolean sameBlockSize \u003d source.getBlockSize() \u003d\u003d target.getBlockSize()\n        || !preserve.contains(FileAttribute.BLOCKSIZE);\n    if (sameLength \u0026\u0026 sameBlockSize) {\n      return skipCrc ||\n          DistCpUtils.checksumsAreEqual(sourceFS, source.getPath(), null,\n              targetFS, target.getPath());\n    } else {\n      return false;\n    }\n  }",
      "path": "hadoop-tools/hadoop-distcp/src/main/java/org/apache/hadoop/tools/mapred/CopyMapper.java",
      "extendedDetails": {
        "oldValue": "[sourceFS-FileSystem, source-FileStatus, target-FileStatus]",
        "newValue": "[sourceFS-FileSystem, source-CopyListingFileStatus, target-FileStatus]"
      }
    },
    "3671a5e16fbddbe5a0516289ce98e1305e02291c": {
      "type": "Yintroduced",
      "commitMessage": "MAPREDUCE-5899. Support incremental data copy in DistCp. Contributed by Jing Zhao.\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1596931 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "22/05/14 11:17 AM",
      "commitName": "3671a5e16fbddbe5a0516289ce98e1305e02291c",
      "commitAuthor": "Jing Zhao",
      "diff": "@@ -0,0 +1,16 @@\n+  private boolean canSkip(FileSystem sourceFS, FileStatus source, \n+      FileStatus target) throws IOException {\n+    if (!syncFolders) {\n+      return true;\n+    }\n+    boolean sameLength \u003d target.getLen() \u003d\u003d source.getLen();\n+    boolean sameBlockSize \u003d source.getBlockSize() \u003d\u003d target.getBlockSize()\n+        || !preserve.contains(FileAttribute.BLOCKSIZE);\n+    if (sameLength \u0026\u0026 sameBlockSize) {\n+      return skipCrc ||\n+          DistCpUtils.checksumsAreEqual(sourceFS, source.getPath(), null,\n+              targetFS, target.getPath());\n+    } else {\n+      return false;\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private boolean canSkip(FileSystem sourceFS, FileStatus source, \n      FileStatus target) throws IOException {\n    if (!syncFolders) {\n      return true;\n    }\n    boolean sameLength \u003d target.getLen() \u003d\u003d source.getLen();\n    boolean sameBlockSize \u003d source.getBlockSize() \u003d\u003d target.getBlockSize()\n        || !preserve.contains(FileAttribute.BLOCKSIZE);\n    if (sameLength \u0026\u0026 sameBlockSize) {\n      return skipCrc ||\n          DistCpUtils.checksumsAreEqual(sourceFS, source.getPath(), null,\n              targetFS, target.getPath());\n    } else {\n      return false;\n    }\n  }",
      "path": "hadoop-tools/hadoop-distcp/src/main/java/org/apache/hadoop/tools/mapred/CopyMapper.java"
    }
  }
}