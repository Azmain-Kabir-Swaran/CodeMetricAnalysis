{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "KMSClientProvider.java",
  "functionName": "containsKmsDt",
  "functionId": "containsKmsDt___ugi-UserGroupInformation",
  "sourceFilePath": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/crypto/key/kms/KMSClientProvider.java",
  "functionStartLine": 1151,
  "functionEndLine": 1161,
  "numCommitsSeen": 119,
  "timeTaken": 5098,
  "changeHistory": [
    "51427cbdfb39cb6f5774b7b70009d7ee4388edfc",
    "a3a1552c33d5650fbd0a702369fccd21b8c9d3e2",
    "583fa6ed48ad3df40bcaa9c591d5ccd07ce3ea81",
    "59d78a5088700350a5122c3a3ba5e76cd26d6a80",
    "a46933e8ce4c1715c11e3e3283bf0e8c2b53b837",
    "8ebf2e95d2053cb94c6ff87ca018811fe8276f2b"
  ],
  "changeHistoryShort": {
    "51427cbdfb39cb6f5774b7b70009d7ee4388edfc": "Ybodychange",
    "a3a1552c33d5650fbd0a702369fccd21b8c9d3e2": "Ymultichange(Yexceptionschange,Ybodychange)",
    "583fa6ed48ad3df40bcaa9c591d5ccd07ce3ea81": "Ymultichange(Yexceptionschange,Ybodychange)",
    "59d78a5088700350a5122c3a3ba5e76cd26d6a80": "Ybodychange",
    "a46933e8ce4c1715c11e3e3283bf0e8c2b53b837": "Ymultichange(Yrename,Yparameterchange,Ybodychange)",
    "8ebf2e95d2053cb94c6ff87ca018811fe8276f2b": "Yintroduced"
  },
  "changeHistoryDetails": {
    "51427cbdfb39cb6f5774b7b70009d7ee4388edfc": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-15997. KMS client uses wrong UGI after HADOOP-14445. Contributed by Wei-Chiu Chuang.\n",
      "commitDate": "04/01/19 8:19 AM",
      "commitName": "51427cbdfb39cb6f5774b7b70009d7ee4388edfc",
      "commitAuthor": "Sunil G",
      "commitDateOld": "12/10/18 9:35 AM",
      "commitNameOld": "5ec86b445cc492f52c33639efb6a09a0d2f27475",
      "commitAuthorOld": "Xiao Chen",
      "daysBetweenCommits": 83.99,
      "commitsBetweenForRepo": 601,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,13 +1,11 @@\n   private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n     // Add existing credentials from the UGI, since provider is cached.\n     Credentials creds \u003d ugi.getCredentials();\n     if (!creds.getAllTokens().isEmpty()) {\n-      LOG.debug(\"Searching for token that matches service: {}\", dtService);\n-      org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n-          dToken \u003d creds.getToken(dtService);\n-      if (dToken !\u003d null) {\n-        return true;\n-      }\n+      LOG.debug(\"Searching for KMS delegation token in user {}\u0027s credentials\",\n+          ugi);\n+      return clientTokenProvider.selectDelegationToken(creds) !\u003d null;\n     }\n+\n     return false;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n    // Add existing credentials from the UGI, since provider is cached.\n    Credentials creds \u003d ugi.getCredentials();\n    if (!creds.getAllTokens().isEmpty()) {\n      LOG.debug(\"Searching for KMS delegation token in user {}\u0027s credentials\",\n          ugi);\n      return clientTokenProvider.selectDelegationToken(creds) !\u003d null;\n    }\n\n    return false;\n  }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/crypto/key/kms/KMSClientProvider.java",
      "extendedDetails": {}
    },
    "a3a1552c33d5650fbd0a702369fccd21b8c9d3e2": {
      "type": "Ymultichange(Yexceptionschange,Ybodychange)",
      "commitMessage": "Revert \"HADOOP-14445. Delegation tokens are not shared between KMS instances. Contributed by Xiao Chen and Rushabh S Shah.\"\n\nThis reverts commit 583fa6ed48ad3df40bcaa9c591d5ccd07ce3ea81.\n\n Conflicts:\n\thadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/crypto/key/kms/KMSTokenRenewer.java\n\thadoop-common-project/hadoop-kms/src/test/java/org/apache/hadoop/crypto/key/kms/server/TestKMS.java\n",
      "commitDate": "07/05/18 1:32 PM",
      "commitName": "a3a1552c33d5650fbd0a702369fccd21b8c9d3e2",
      "commitAuthor": "Xiao Chen",
      "subchanges": [
        {
          "type": "Yexceptionschange",
          "commitMessage": "Revert \"HADOOP-14445. Delegation tokens are not shared between KMS instances. Contributed by Xiao Chen and Rushabh S Shah.\"\n\nThis reverts commit 583fa6ed48ad3df40bcaa9c591d5ccd07ce3ea81.\n\n Conflicts:\n\thadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/crypto/key/kms/KMSTokenRenewer.java\n\thadoop-common-project/hadoop-kms/src/test/java/org/apache/hadoop/crypto/key/kms/server/TestKMS.java\n",
          "commitDate": "07/05/18 1:32 PM",
          "commitName": "a3a1552c33d5650fbd0a702369fccd21b8c9d3e2",
          "commitAuthor": "Xiao Chen",
          "commitDateOld": "04/05/18 1:36 PM",
          "commitNameOld": "4cdbdce752e192b45c2b9756c2d4bd24ceffdabd",
          "commitAuthorOld": "Rushabh Shah",
          "daysBetweenCommits": 3.0,
          "commitsBetweenForRepo": 7,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,10 +1,13 @@\n-  private boolean containsKmsDt(UserGroupInformation ugi) {\n-    final Credentials creds \u003d ugi.getCredentials();\n+  private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n+    // Add existing credentials from the UGI, since provider is cached.\n+    Credentials creds \u003d ugi.getCredentials();\n     if (!creds.getAllTokens().isEmpty()) {\n-      final Token dToken \u003d selectKMSDelegationToken(creds);\n+      LOG.debug(\"Searching for token that matches service: {}\", dtService);\n+      org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n+          dToken \u003d creds.getToken(dtService);\n       if (dToken !\u003d null) {\n         return true;\n       }\n     }\n     return false;\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n    // Add existing credentials from the UGI, since provider is cached.\n    Credentials creds \u003d ugi.getCredentials();\n    if (!creds.getAllTokens().isEmpty()) {\n      LOG.debug(\"Searching for token that matches service: {}\", dtService);\n      org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n          dToken \u003d creds.getToken(dtService);\n      if (dToken !\u003d null) {\n        return true;\n      }\n    }\n    return false;\n  }",
          "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/crypto/key/kms/KMSClientProvider.java",
          "extendedDetails": {
            "oldValue": "[]",
            "newValue": "[IOException]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "Revert \"HADOOP-14445. Delegation tokens are not shared between KMS instances. Contributed by Xiao Chen and Rushabh S Shah.\"\n\nThis reverts commit 583fa6ed48ad3df40bcaa9c591d5ccd07ce3ea81.\n\n Conflicts:\n\thadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/crypto/key/kms/KMSTokenRenewer.java\n\thadoop-common-project/hadoop-kms/src/test/java/org/apache/hadoop/crypto/key/kms/server/TestKMS.java\n",
          "commitDate": "07/05/18 1:32 PM",
          "commitName": "a3a1552c33d5650fbd0a702369fccd21b8c9d3e2",
          "commitAuthor": "Xiao Chen",
          "commitDateOld": "04/05/18 1:36 PM",
          "commitNameOld": "4cdbdce752e192b45c2b9756c2d4bd24ceffdabd",
          "commitAuthorOld": "Rushabh Shah",
          "daysBetweenCommits": 3.0,
          "commitsBetweenForRepo": 7,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,10 +1,13 @@\n-  private boolean containsKmsDt(UserGroupInformation ugi) {\n-    final Credentials creds \u003d ugi.getCredentials();\n+  private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n+    // Add existing credentials from the UGI, since provider is cached.\n+    Credentials creds \u003d ugi.getCredentials();\n     if (!creds.getAllTokens().isEmpty()) {\n-      final Token dToken \u003d selectKMSDelegationToken(creds);\n+      LOG.debug(\"Searching for token that matches service: {}\", dtService);\n+      org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n+          dToken \u003d creds.getToken(dtService);\n       if (dToken !\u003d null) {\n         return true;\n       }\n     }\n     return false;\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n    // Add existing credentials from the UGI, since provider is cached.\n    Credentials creds \u003d ugi.getCredentials();\n    if (!creds.getAllTokens().isEmpty()) {\n      LOG.debug(\"Searching for token that matches service: {}\", dtService);\n      org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n          dToken \u003d creds.getToken(dtService);\n      if (dToken !\u003d null) {\n        return true;\n      }\n    }\n    return false;\n  }",
          "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/crypto/key/kms/KMSClientProvider.java",
          "extendedDetails": {}
        }
      ]
    },
    "583fa6ed48ad3df40bcaa9c591d5ccd07ce3ea81": {
      "type": "Ymultichange(Yexceptionschange,Ybodychange)",
      "commitMessage": "HADOOP-14445. Delegation tokens are not shared between KMS instances. Contributed by Xiao Chen and Rushabh S Shah.\n",
      "commitDate": "10/04/18 3:38 PM",
      "commitName": "583fa6ed48ad3df40bcaa9c591d5ccd07ce3ea81",
      "commitAuthor": "Xiao Chen",
      "subchanges": [
        {
          "type": "Yexceptionschange",
          "commitMessage": "HADOOP-14445. Delegation tokens are not shared between KMS instances. Contributed by Xiao Chen and Rushabh S Shah.\n",
          "commitDate": "10/04/18 3:38 PM",
          "commitName": "583fa6ed48ad3df40bcaa9c591d5ccd07ce3ea81",
          "commitAuthor": "Xiao Chen",
          "commitDateOld": "03/11/17 4:10 PM",
          "commitNameOld": "59d78a5088700350a5122c3a3ba5e76cd26d6a80",
          "commitAuthorOld": "Xiaoyu Yao",
          "daysBetweenCommits": 157.98,
          "commitsBetweenForRepo": 1162,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,10 @@\n-  private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n-    // Add existing credentials from the UGI, since provider is cached.\n-    Credentials creds \u003d ugi.getCredentials();\n+  private boolean containsKmsDt(UserGroupInformation ugi) {\n+    final Credentials creds \u003d ugi.getCredentials();\n     if (!creds.getAllTokens().isEmpty()) {\n-      LOG.debug(\"Searching for token that matches service: {}\", dtService);\n-      org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n-          dToken \u003d creds.getToken(dtService);\n+      final Token dToken \u003d selectKMSDelegationToken(creds);\n       if (dToken !\u003d null) {\n         return true;\n       }\n     }\n     return false;\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private boolean containsKmsDt(UserGroupInformation ugi) {\n    final Credentials creds \u003d ugi.getCredentials();\n    if (!creds.getAllTokens().isEmpty()) {\n      final Token dToken \u003d selectKMSDelegationToken(creds);\n      if (dToken !\u003d null) {\n        return true;\n      }\n    }\n    return false;\n  }",
          "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/crypto/key/kms/KMSClientProvider.java",
          "extendedDetails": {
            "oldValue": "[IOException]",
            "newValue": "[]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HADOOP-14445. Delegation tokens are not shared between KMS instances. Contributed by Xiao Chen and Rushabh S Shah.\n",
          "commitDate": "10/04/18 3:38 PM",
          "commitName": "583fa6ed48ad3df40bcaa9c591d5ccd07ce3ea81",
          "commitAuthor": "Xiao Chen",
          "commitDateOld": "03/11/17 4:10 PM",
          "commitNameOld": "59d78a5088700350a5122c3a3ba5e76cd26d6a80",
          "commitAuthorOld": "Xiaoyu Yao",
          "daysBetweenCommits": 157.98,
          "commitsBetweenForRepo": 1162,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,10 @@\n-  private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n-    // Add existing credentials from the UGI, since provider is cached.\n-    Credentials creds \u003d ugi.getCredentials();\n+  private boolean containsKmsDt(UserGroupInformation ugi) {\n+    final Credentials creds \u003d ugi.getCredentials();\n     if (!creds.getAllTokens().isEmpty()) {\n-      LOG.debug(\"Searching for token that matches service: {}\", dtService);\n-      org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n-          dToken \u003d creds.getToken(dtService);\n+      final Token dToken \u003d selectKMSDelegationToken(creds);\n       if (dToken !\u003d null) {\n         return true;\n       }\n     }\n     return false;\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private boolean containsKmsDt(UserGroupInformation ugi) {\n    final Credentials creds \u003d ugi.getCredentials();\n    if (!creds.getAllTokens().isEmpty()) {\n      final Token dToken \u003d selectKMSDelegationToken(creds);\n      if (dToken !\u003d null) {\n        return true;\n      }\n    }\n    return false;\n  }",
          "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/crypto/key/kms/KMSClientProvider.java",
          "extendedDetails": {}
        }
      ]
    },
    "59d78a5088700350a5122c3a3ba5e76cd26d6a80": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-14987. Improve KMSClientProvider log around delegation token checking. Contributed by Xiaoyu Yao and Xiao Chen.\n",
      "commitDate": "03/11/17 4:10 PM",
      "commitName": "59d78a5088700350a5122c3a3ba5e76cd26d6a80",
      "commitAuthor": "Xiaoyu Yao",
      "commitDateOld": "19/10/17 6:02 AM",
      "commitNameOld": "97c70c7ac6881f87eee1575bcbdd28b31ecac231",
      "commitAuthorOld": "Wei-Chiu Chuang",
      "daysBetweenCommits": 15.42,
      "commitsBetweenForRepo": 110,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,12 +1,13 @@\n   private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n     // Add existing credentials from the UGI, since provider is cached.\n     Credentials creds \u003d ugi.getCredentials();\n     if (!creds.getAllTokens().isEmpty()) {\n+      LOG.debug(\"Searching for token that matches service: {}\", dtService);\n       org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n-          dToken \u003d creds.getToken(getDelegationTokenService());\n+          dToken \u003d creds.getToken(dtService);\n       if (dToken !\u003d null) {\n         return true;\n       }\n     }\n     return false;\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n    // Add existing credentials from the UGI, since provider is cached.\n    Credentials creds \u003d ugi.getCredentials();\n    if (!creds.getAllTokens().isEmpty()) {\n      LOG.debug(\"Searching for token that matches service: {}\", dtService);\n      org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n          dToken \u003d creds.getToken(dtService);\n      if (dToken !\u003d null) {\n        return true;\n      }\n    }\n    return false;\n  }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/crypto/key/kms/KMSClientProvider.java",
      "extendedDetails": {}
    },
    "a46933e8ce4c1715c11e3e3283bf0e8c2b53b837": {
      "type": "Ymultichange(Yrename,Yparameterchange,Ybodychange)",
      "commitMessage": "HADOOP-13988. KMSClientProvider does not work with WebHDFS and Apache Knox w/ProxyUser. Contributed by Greg Senia and Xiaoyu Yao.\n",
      "commitDate": "25/01/17 1:33 PM",
      "commitName": "a46933e8ce4c1715c11e3e3283bf0e8c2b53b837",
      "commitAuthor": "Xiaoyu Yao",
      "subchanges": [
        {
          "type": "Yrename",
          "commitMessage": "HADOOP-13988. KMSClientProvider does not work with WebHDFS and Apache Knox w/ProxyUser. Contributed by Greg Senia and Xiaoyu Yao.\n",
          "commitDate": "25/01/17 1:33 PM",
          "commitName": "a46933e8ce4c1715c11e3e3283bf0e8c2b53b837",
          "commitAuthor": "Xiaoyu Yao",
          "commitDateOld": "06/12/16 12:04 PM",
          "commitNameOld": "79d90b810c14d5e3abab75235f587663834ce36c",
          "commitAuthorOld": "Xiao Chen",
          "daysBetweenCommits": 50.06,
          "commitsBetweenForRepo": 246,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,12 @@\n-  private boolean currentUgiContainsKmsDt() throws IOException {\n-    // Add existing credentials from current UGI, since provider is cached.\n-    Credentials creds \u003d UserGroupInformation.getCurrentUser().\n-        getCredentials();\n+  private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n+    // Add existing credentials from the UGI, since provider is cached.\n+    Credentials creds \u003d ugi.getCredentials();\n     if (!creds.getAllTokens().isEmpty()) {\n       org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n           dToken \u003d creds.getToken(getDelegationTokenService());\n       if (dToken !\u003d null) {\n         return true;\n       }\n     }\n     return false;\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n    // Add existing credentials from the UGI, since provider is cached.\n    Credentials creds \u003d ugi.getCredentials();\n    if (!creds.getAllTokens().isEmpty()) {\n      org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n          dToken \u003d creds.getToken(getDelegationTokenService());\n      if (dToken !\u003d null) {\n        return true;\n      }\n    }\n    return false;\n  }",
          "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/crypto/key/kms/KMSClientProvider.java",
          "extendedDetails": {
            "oldValue": "currentUgiContainsKmsDt",
            "newValue": "containsKmsDt"
          }
        },
        {
          "type": "Yparameterchange",
          "commitMessage": "HADOOP-13988. KMSClientProvider does not work with WebHDFS and Apache Knox w/ProxyUser. Contributed by Greg Senia and Xiaoyu Yao.\n",
          "commitDate": "25/01/17 1:33 PM",
          "commitName": "a46933e8ce4c1715c11e3e3283bf0e8c2b53b837",
          "commitAuthor": "Xiaoyu Yao",
          "commitDateOld": "06/12/16 12:04 PM",
          "commitNameOld": "79d90b810c14d5e3abab75235f587663834ce36c",
          "commitAuthorOld": "Xiao Chen",
          "daysBetweenCommits": 50.06,
          "commitsBetweenForRepo": 246,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,12 @@\n-  private boolean currentUgiContainsKmsDt() throws IOException {\n-    // Add existing credentials from current UGI, since provider is cached.\n-    Credentials creds \u003d UserGroupInformation.getCurrentUser().\n-        getCredentials();\n+  private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n+    // Add existing credentials from the UGI, since provider is cached.\n+    Credentials creds \u003d ugi.getCredentials();\n     if (!creds.getAllTokens().isEmpty()) {\n       org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n           dToken \u003d creds.getToken(getDelegationTokenService());\n       if (dToken !\u003d null) {\n         return true;\n       }\n     }\n     return false;\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n    // Add existing credentials from the UGI, since provider is cached.\n    Credentials creds \u003d ugi.getCredentials();\n    if (!creds.getAllTokens().isEmpty()) {\n      org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n          dToken \u003d creds.getToken(getDelegationTokenService());\n      if (dToken !\u003d null) {\n        return true;\n      }\n    }\n    return false;\n  }",
          "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/crypto/key/kms/KMSClientProvider.java",
          "extendedDetails": {
            "oldValue": "[]",
            "newValue": "[ugi-UserGroupInformation]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HADOOP-13988. KMSClientProvider does not work with WebHDFS and Apache Knox w/ProxyUser. Contributed by Greg Senia and Xiaoyu Yao.\n",
          "commitDate": "25/01/17 1:33 PM",
          "commitName": "a46933e8ce4c1715c11e3e3283bf0e8c2b53b837",
          "commitAuthor": "Xiaoyu Yao",
          "commitDateOld": "06/12/16 12:04 PM",
          "commitNameOld": "79d90b810c14d5e3abab75235f587663834ce36c",
          "commitAuthorOld": "Xiao Chen",
          "daysBetweenCommits": 50.06,
          "commitsBetweenForRepo": 246,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,12 @@\n-  private boolean currentUgiContainsKmsDt() throws IOException {\n-    // Add existing credentials from current UGI, since provider is cached.\n-    Credentials creds \u003d UserGroupInformation.getCurrentUser().\n-        getCredentials();\n+  private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n+    // Add existing credentials from the UGI, since provider is cached.\n+    Credentials creds \u003d ugi.getCredentials();\n     if (!creds.getAllTokens().isEmpty()) {\n       org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n           dToken \u003d creds.getToken(getDelegationTokenService());\n       if (dToken !\u003d null) {\n         return true;\n       }\n     }\n     return false;\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private boolean containsKmsDt(UserGroupInformation ugi) throws IOException {\n    // Add existing credentials from the UGI, since provider is cached.\n    Credentials creds \u003d ugi.getCredentials();\n    if (!creds.getAllTokens().isEmpty()) {\n      org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n          dToken \u003d creds.getToken(getDelegationTokenService());\n      if (dToken !\u003d null) {\n        return true;\n      }\n    }\n    return false;\n  }",
          "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/crypto/key/kms/KMSClientProvider.java",
          "extendedDetails": {}
        }
      ]
    },
    "8ebf2e95d2053cb94c6ff87ca018811fe8276f2b": {
      "type": "Yintroduced",
      "commitMessage": "HADOOP-13381. KMS clients should use KMS Delegation Tokens from current UGI. Contributed by Xiao Chen.\n",
      "commitDate": "28/07/16 6:24 PM",
      "commitName": "8ebf2e95d2053cb94c6ff87ca018811fe8276f2b",
      "commitAuthor": "Xiao Chen",
      "diff": "@@ -0,0 +1,13 @@\n+  private boolean currentUgiContainsKmsDt() throws IOException {\n+    // Add existing credentials from current UGI, since provider is cached.\n+    Credentials creds \u003d UserGroupInformation.getCurrentUser().\n+        getCredentials();\n+    if (!creds.getAllTokens().isEmpty()) {\n+      org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n+          dToken \u003d creds.getToken(getDelegationTokenService());\n+      if (dToken !\u003d null) {\n+        return true;\n+      }\n+    }\n+    return false;\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private boolean currentUgiContainsKmsDt() throws IOException {\n    // Add existing credentials from current UGI, since provider is cached.\n    Credentials creds \u003d UserGroupInformation.getCurrentUser().\n        getCredentials();\n    if (!creds.getAllTokens().isEmpty()) {\n      org.apache.hadoop.security.token.Token\u003c? extends TokenIdentifier\u003e\n          dToken \u003d creds.getToken(getDelegationTokenService());\n      if (dToken !\u003d null) {\n        return true;\n      }\n    }\n    return false;\n  }",
      "path": "hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/crypto/key/kms/KMSClientProvider.java"
    }
  }
}