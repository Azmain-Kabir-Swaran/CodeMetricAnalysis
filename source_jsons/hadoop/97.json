{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "Nfs3Utils.java",
  "functionName": "getNfs3FileAttrFromFileStatus",
  "functionId": "getNfs3FileAttrFromFileStatus___fs-HdfsFileStatus__iug-IdMappingServiceProvider",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs-nfs/src/main/java/org/apache/hadoop/hdfs/nfs/nfs3/Nfs3Utils.java",
  "functionStartLine": 70,
  "functionEndLine": 89,
  "numCommitsSeen": 24,
  "timeTaken": 2556,
  "changeHistory": [
    "645a8f2a4d09acb5a21820f52ee78784d9e4cc8a",
    "2cc868dede3187ef3e122e878b8ee0882c82dc81",
    "72a556d3b0def0ab4e4509528cc513f6df06b084",
    "ede10b8a1f9a4d099c16469f827345cb359cef3d",
    "37f587563a943a827fbff865f5302bac6d202415"
  ],
  "changeHistoryShort": {
    "645a8f2a4d09acb5a21820f52ee78784d9e4cc8a": "Ybodychange",
    "2cc868dede3187ef3e122e878b8ee0882c82dc81": "Ybodychange",
    "72a556d3b0def0ab4e4509528cc513f6df06b084": "Yparameterchange",
    "ede10b8a1f9a4d099c16469f827345cb359cef3d": "Ybodychange",
    "37f587563a943a827fbff865f5302bac6d202415": "Yintroduced"
  },
  "changeHistoryDetails": {
    "645a8f2a4d09acb5a21820f52ee78784d9e4cc8a": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-14726. Mark FileStatus::isDir as final\n",
      "commitDate": "14/08/17 9:57 PM",
      "commitName": "645a8f2a4d09acb5a21820f52ee78784d9e4cc8a",
      "commitAuthor": "Chris Douglas",
      "commitDateOld": "11/12/14 3:40 PM",
      "commitNameOld": "f6f2a3f1c73266bfedd802eacde60d8b19b81015",
      "commitAuthorOld": "Brandon Li",
      "daysBetweenCommits": 977.22,
      "commitsBetweenForRepo": 6878,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,18 +1,20 @@\n   public static Nfs3FileAttributes getNfs3FileAttrFromFileStatus(\n       HdfsFileStatus fs, IdMappingServiceProvider iug) {\n     /**\n      * Some 32bit Linux client has problem with 64bit fileId: it seems the 32bit\n      * client takes only the lower 32bit of the fileId and treats it as signed\n      * int. When the 32th bit is 1, the client considers it invalid.\n      */\n-    NfsFileType fileType \u003d fs.isDir() ? NfsFileType.NFSDIR : NfsFileType.NFSREG;\n+    NfsFileType fileType \u003d fs.isDirectory()\n+        ? NfsFileType.NFSDIR\n+        : NfsFileType.NFSREG;\n     fileType \u003d fs.isSymlink() ? NfsFileType.NFSLNK : fileType;\n     int nlink \u003d (fileType \u003d\u003d NfsFileType.NFSDIR) ? fs.getChildrenNum() + 2 : 1;\n     long size \u003d (fileType \u003d\u003d NfsFileType.NFSDIR) ? getDirSize(fs\n         .getChildrenNum()) : fs.getLen();\n     return new Nfs3FileAttributes(fileType, nlink,\n         fs.getPermission().toShort(), iug.getUidAllowingUnknown(fs.getOwner()),\n         iug.getGidAllowingUnknown(fs.getGroup()), size, 0 /* fsid */,\n         fs.getFileId(), fs.getModificationTime(), fs.getAccessTime(),\n         new Nfs3FileAttributes.Specdata3());\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public static Nfs3FileAttributes getNfs3FileAttrFromFileStatus(\n      HdfsFileStatus fs, IdMappingServiceProvider iug) {\n    /**\n     * Some 32bit Linux client has problem with 64bit fileId: it seems the 32bit\n     * client takes only the lower 32bit of the fileId and treats it as signed\n     * int. When the 32th bit is 1, the client considers it invalid.\n     */\n    NfsFileType fileType \u003d fs.isDirectory()\n        ? NfsFileType.NFSDIR\n        : NfsFileType.NFSREG;\n    fileType \u003d fs.isSymlink() ? NfsFileType.NFSLNK : fileType;\n    int nlink \u003d (fileType \u003d\u003d NfsFileType.NFSDIR) ? fs.getChildrenNum() + 2 : 1;\n    long size \u003d (fileType \u003d\u003d NfsFileType.NFSDIR) ? getDirSize(fs\n        .getChildrenNum()) : fs.getLen();\n    return new Nfs3FileAttributes(fileType, nlink,\n        fs.getPermission().toShort(), iug.getUidAllowingUnknown(fs.getOwner()),\n        iug.getGidAllowingUnknown(fs.getGroup()), size, 0 /* fsid */,\n        fs.getFileId(), fs.getModificationTime(), fs.getAccessTime(),\n        new Nfs3FileAttributes.Specdata3());\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs-nfs/src/main/java/org/apache/hadoop/hdfs/nfs/nfs3/Nfs3Utils.java",
      "extendedDetails": {}
    },
    "2cc868dede3187ef3e122e878b8ee0882c82dc81": {
      "type": "Ybodychange",
      "commitMessage": "HADOOP-11296. Nfs3FileAttributes should not change the values of rdev, nlink and size in the constructor. Contributed by Brandon Li.\n",
      "commitDate": "10/11/14 3:42 PM",
      "commitName": "2cc868dede3187ef3e122e878b8ee0882c82dc81",
      "commitAuthor": "Haohui Mai",
      "commitDateOld": "29/10/14 11:05 AM",
      "commitNameOld": "72a556d3b0def0ab4e4509528cc513f6df06b084",
      "commitAuthorOld": "Brandon Li",
      "daysBetweenCommits": 12.23,
      "commitsBetweenForRepo": 135,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,15 +1,18 @@\n   public static Nfs3FileAttributes getNfs3FileAttrFromFileStatus(\n       HdfsFileStatus fs, IdMappingServiceProvider iug) {\n     /**\n      * Some 32bit Linux client has problem with 64bit fileId: it seems the 32bit\n      * client takes only the lower 32bit of the fileId and treats it as signed\n      * int. When the 32th bit is 1, the client considers it invalid.\n      */\n     NfsFileType fileType \u003d fs.isDir() ? NfsFileType.NFSDIR : NfsFileType.NFSREG;\n     fileType \u003d fs.isSymlink() ? NfsFileType.NFSLNK : fileType;\n-    \n-    return new Nfs3FileAttributes(fileType, fs.getChildrenNum(), fs\n-        .getPermission().toShort(), iug.getUidAllowingUnknown(fs.getOwner()),\n-        iug.getGidAllowingUnknown(fs.getGroup()), fs.getLen(), 0 /* fsid */,\n-        fs.getFileId(), fs.getModificationTime(), fs.getAccessTime());\n+    int nlink \u003d (fileType \u003d\u003d NfsFileType.NFSDIR) ? fs.getChildrenNum() + 2 : 1;\n+    long size \u003d (fileType \u003d\u003d NfsFileType.NFSDIR) ? getDirSize(fs\n+        .getChildrenNum()) : fs.getLen();\n+    return new Nfs3FileAttributes(fileType, nlink,\n+        fs.getPermission().toShort(), iug.getUidAllowingUnknown(fs.getOwner()),\n+        iug.getGidAllowingUnknown(fs.getGroup()), size, 0 /* fsid */,\n+        fs.getFileId(), fs.getModificationTime(), fs.getAccessTime(),\n+        new Nfs3FileAttributes.Specdata3());\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public static Nfs3FileAttributes getNfs3FileAttrFromFileStatus(\n      HdfsFileStatus fs, IdMappingServiceProvider iug) {\n    /**\n     * Some 32bit Linux client has problem with 64bit fileId: it seems the 32bit\n     * client takes only the lower 32bit of the fileId and treats it as signed\n     * int. When the 32th bit is 1, the client considers it invalid.\n     */\n    NfsFileType fileType \u003d fs.isDir() ? NfsFileType.NFSDIR : NfsFileType.NFSREG;\n    fileType \u003d fs.isSymlink() ? NfsFileType.NFSLNK : fileType;\n    int nlink \u003d (fileType \u003d\u003d NfsFileType.NFSDIR) ? fs.getChildrenNum() + 2 : 1;\n    long size \u003d (fileType \u003d\u003d NfsFileType.NFSDIR) ? getDirSize(fs\n        .getChildrenNum()) : fs.getLen();\n    return new Nfs3FileAttributes(fileType, nlink,\n        fs.getPermission().toShort(), iug.getUidAllowingUnknown(fs.getOwner()),\n        iug.getGidAllowingUnknown(fs.getGroup()), size, 0 /* fsid */,\n        fs.getFileId(), fs.getModificationTime(), fs.getAccessTime(),\n        new Nfs3FileAttributes.Specdata3());\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs-nfs/src/main/java/org/apache/hadoop/hdfs/nfs/nfs3/Nfs3Utils.java",
      "extendedDetails": {}
    },
    "72a556d3b0def0ab4e4509528cc513f6df06b084": {
      "type": "Yparameterchange",
      "commitMessage": "HADOOP-11195. Move Id-Name mapping in NFS to the hadoop-common area for better maintenance. Contributed by Yongjun Zhang\n",
      "commitDate": "29/10/14 11:05 AM",
      "commitName": "72a556d3b0def0ab4e4509528cc513f6df06b084",
      "commitAuthor": "Brandon Li",
      "commitDateOld": "16/07/14 11:52 AM",
      "commitNameOld": "e896de98f2dba9fbd58024b8da35c8b72a404724",
      "commitAuthorOld": "Brandon Li",
      "daysBetweenCommits": 104.97,
      "commitsBetweenForRepo": 1030,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,15 +1,15 @@\n   public static Nfs3FileAttributes getNfs3FileAttrFromFileStatus(\n-      HdfsFileStatus fs, IdUserGroup iug) {\n+      HdfsFileStatus fs, IdMappingServiceProvider iug) {\n     /**\n      * Some 32bit Linux client has problem with 64bit fileId: it seems the 32bit\n      * client takes only the lower 32bit of the fileId and treats it as signed\n      * int. When the 32th bit is 1, the client considers it invalid.\n      */\n     NfsFileType fileType \u003d fs.isDir() ? NfsFileType.NFSDIR : NfsFileType.NFSREG;\n     fileType \u003d fs.isSymlink() ? NfsFileType.NFSLNK : fileType;\n     \n     return new Nfs3FileAttributes(fileType, fs.getChildrenNum(), fs\n         .getPermission().toShort(), iug.getUidAllowingUnknown(fs.getOwner()),\n         iug.getGidAllowingUnknown(fs.getGroup()), fs.getLen(), 0 /* fsid */,\n         fs.getFileId(), fs.getModificationTime(), fs.getAccessTime());\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public static Nfs3FileAttributes getNfs3FileAttrFromFileStatus(\n      HdfsFileStatus fs, IdMappingServiceProvider iug) {\n    /**\n     * Some 32bit Linux client has problem with 64bit fileId: it seems the 32bit\n     * client takes only the lower 32bit of the fileId and treats it as signed\n     * int. When the 32th bit is 1, the client considers it invalid.\n     */\n    NfsFileType fileType \u003d fs.isDir() ? NfsFileType.NFSDIR : NfsFileType.NFSREG;\n    fileType \u003d fs.isSymlink() ? NfsFileType.NFSLNK : fileType;\n    \n    return new Nfs3FileAttributes(fileType, fs.getChildrenNum(), fs\n        .getPermission().toShort(), iug.getUidAllowingUnknown(fs.getOwner()),\n        iug.getGidAllowingUnknown(fs.getGroup()), fs.getLen(), 0 /* fsid */,\n        fs.getFileId(), fs.getModificationTime(), fs.getAccessTime());\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs-nfs/src/main/java/org/apache/hadoop/hdfs/nfs/nfs3/Nfs3Utils.java",
      "extendedDetails": {
        "oldValue": "[fs-HdfsFileStatus, iug-IdUserGroup]",
        "newValue": "[fs-HdfsFileStatus, iug-IdMappingServiceProvider]"
      }
    },
    "ede10b8a1f9a4d099c16469f827345cb359cef3d": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-5067 Support symlink operations in NFS gateway. Contributed by Brandon Li\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1522774 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "12/09/13 9:21 PM",
      "commitName": "ede10b8a1f9a4d099c16469f827345cb359cef3d",
      "commitAuthor": "Brandon Li",
      "commitDateOld": "23/08/13 2:14 PM",
      "commitNameOld": "15632cd76f12c2f7df50d0df4865fbe3d8261597",
      "commitAuthorOld": "Brandon Li",
      "daysBetweenCommits": 20.3,
      "commitsBetweenForRepo": 93,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,12 +1,15 @@\n   public static Nfs3FileAttributes getNfs3FileAttrFromFileStatus(\n       HdfsFileStatus fs, IdUserGroup iug) {\n     /**\n      * Some 32bit Linux client has problem with 64bit fileId: it seems the 32bit\n      * client takes only the lower 32bit of the fileId and treats it as signed\n      * int. When the 32th bit is 1, the client considers it invalid.\n      */\n-    return new Nfs3FileAttributes(fs.isDir(), fs.getChildrenNum(), fs\n+    NfsFileType fileType \u003d fs.isDir() ? NfsFileType.NFSDIR : NfsFileType.NFSREG;\n+    fileType \u003d fs.isSymlink() ? NfsFileType.NFSLNK : fileType;\n+    \n+    return new Nfs3FileAttributes(fileType, fs.getChildrenNum(), fs\n         .getPermission().toShort(), iug.getUidAllowingUnknown(fs.getOwner()),\n         iug.getGidAllowingUnknown(fs.getGroup()), fs.getLen(), 0 /* fsid */,\n         fs.getFileId(), fs.getModificationTime(), fs.getAccessTime());\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public static Nfs3FileAttributes getNfs3FileAttrFromFileStatus(\n      HdfsFileStatus fs, IdUserGroup iug) {\n    /**\n     * Some 32bit Linux client has problem with 64bit fileId: it seems the 32bit\n     * client takes only the lower 32bit of the fileId and treats it as signed\n     * int. When the 32th bit is 1, the client considers it invalid.\n     */\n    NfsFileType fileType \u003d fs.isDir() ? NfsFileType.NFSDIR : NfsFileType.NFSREG;\n    fileType \u003d fs.isSymlink() ? NfsFileType.NFSLNK : fileType;\n    \n    return new Nfs3FileAttributes(fileType, fs.getChildrenNum(), fs\n        .getPermission().toShort(), iug.getUidAllowingUnknown(fs.getOwner()),\n        iug.getGidAllowingUnknown(fs.getGroup()), fs.getLen(), 0 /* fsid */,\n        fs.getFileId(), fs.getModificationTime(), fs.getAccessTime());\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs-nfs/src/main/java/org/apache/hadoop/hdfs/nfs/nfs3/Nfs3Utils.java",
      "extendedDetails": {}
    },
    "37f587563a943a827fbff865f5302bac6d202415": {
      "type": "Yintroduced",
      "commitMessage": "HDFS-4762 Provide HDFS based NFSv3 and Mountd implementation. Contributed by Brandon Li\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1499029 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "02/07/13 10:31 AM",
      "commitName": "37f587563a943a827fbff865f5302bac6d202415",
      "commitAuthor": "Brandon Li",
      "diff": "@@ -0,0 +1,12 @@\n+  public static Nfs3FileAttributes getNfs3FileAttrFromFileStatus(\n+      HdfsFileStatus fs, IdUserGroup iug) {\n+    /**\n+     * Some 32bit Linux client has problem with 64bit fileId: it seems the 32bit\n+     * client takes only the lower 32bit of the fileId and treats it as signed\n+     * int. When the 32th bit is 1, the client considers it invalid.\n+     */\n+    return new Nfs3FileAttributes(fs.isDir(), fs.getChildrenNum(), fs\n+        .getPermission().toShort(), iug.getUidAllowingUnknown(fs.getOwner()),\n+        iug.getGidAllowingUnknown(fs.getGroup()), fs.getLen(), 0 /* fsid */,\n+        fs.getFileId(), fs.getModificationTime(), fs.getAccessTime());\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  public static Nfs3FileAttributes getNfs3FileAttrFromFileStatus(\n      HdfsFileStatus fs, IdUserGroup iug) {\n    /**\n     * Some 32bit Linux client has problem with 64bit fileId: it seems the 32bit\n     * client takes only the lower 32bit of the fileId and treats it as signed\n     * int. When the 32th bit is 1, the client considers it invalid.\n     */\n    return new Nfs3FileAttributes(fs.isDir(), fs.getChildrenNum(), fs\n        .getPermission().toShort(), iug.getUidAllowingUnknown(fs.getOwner()),\n        iug.getGidAllowingUnknown(fs.getGroup()), fs.getLen(), 0 /* fsid */,\n        fs.getFileId(), fs.getModificationTime(), fs.getAccessTime());\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs-nfs/src/main/java/org/apache/hadoop/hdfs/nfs/nfs3/Nfs3Utils.java"
    }
  }
}