{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "StoragePolicySatisfier.java",
  "functionName": "buildContinuousBlockMovingInfos",
  "functionId": "buildContinuousBlockMovingInfos___blockInfo-LocatedBlock__sourceNode-DatanodeInfo__sourceStorageType-StorageType__targetNode-DatanodeInfo__targetStorageType-StorageType__blkMovingInfos-List__BlockMovingInfo__",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/sps/StoragePolicySatisfier.java",
  "functionStartLine": 695,
  "functionEndLine": 703,
  "numCommitsSeen": 83,
  "timeTaken": 6628,
  "changeHistory": [
    "05d4daf6ba3e5bd40f46e8003ee12fc7c613453d",
    "78420719eb1f138c6f10558befb7bc8ebcc28a54",
    "00eceed233d6e80d5c7137bf5b5286746ec4d5fb",
    "81ed364b632189c6eebd6426b6abc52c790570ea",
    "b7bed9f00a25bcad6f9c3543f5a1fb0a1f23b0e9"
  ],
  "changeHistoryShort": {
    "05d4daf6ba3e5bd40f46e8003ee12fc7c613453d": "Ymultichange(Yparameterchange,Ybodychange)",
    "78420719eb1f138c6f10558befb7bc8ebcc28a54": "Yfilerename",
    "00eceed233d6e80d5c7137bf5b5286746ec4d5fb": "Ymultichange(Yparameterchange,Ybodychange)",
    "81ed364b632189c6eebd6426b6abc52c790570ea": "Yrename",
    "b7bed9f00a25bcad6f9c3543f5a1fb0a1f23b0e9": "Yintroduced"
  },
  "changeHistoryDetails": {
    "05d4daf6ba3e5bd40f46e8003ee12fc7c613453d": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HDFS-12982 : [SPS]: Reduce the locking and cleanup the Namesystem access. Contributed by Rakesh R.\n",
      "commitDate": "12/08/18 3:06 AM",
      "commitName": "05d4daf6ba3e5bd40f46e8003ee12fc7c613453d",
      "commitAuthor": "Surendra Singh Lilhore",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-12982 : [SPS]: Reduce the locking and cleanup the Namesystem access. Contributed by Rakesh R.\n",
          "commitDate": "12/08/18 3:06 AM",
          "commitName": "05d4daf6ba3e5bd40f46e8003ee12fc7c613453d",
          "commitAuthor": "Surendra Singh Lilhore",
          "commitDateOld": "12/08/18 3:06 AM",
          "commitNameOld": "78420719eb1f138c6f10558befb7bc8ebcc28a54",
          "commitAuthorOld": "Uma Maheswara Rao G",
          "daysBetweenCommits": 0.0,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,10 +1,9 @@\n-  private void buildContinuousBlockMovingInfos(BlockInfo blockInfo,\n+  private void buildContinuousBlockMovingInfos(LocatedBlock blockInfo,\n       DatanodeInfo sourceNode, StorageType sourceStorageType,\n       DatanodeInfo targetNode, StorageType targetStorageType,\n       List\u003cBlockMovingInfo\u003e blkMovingInfos) {\n-    Block blk \u003d new Block(blockInfo.getBlockId(), blockInfo.getNumBytes(),\n-        blockInfo.getGenerationStamp());\n+    Block blk \u003d ExtendedBlock.getLocalBlock(blockInfo.getBlock());\n     BlockMovingInfo blkMovingInfo \u003d new BlockMovingInfo(blk, sourceNode,\n         targetNode, sourceStorageType, targetStorageType);\n     blkMovingInfos.add(blkMovingInfo);\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private void buildContinuousBlockMovingInfos(LocatedBlock blockInfo,\n      DatanodeInfo sourceNode, StorageType sourceStorageType,\n      DatanodeInfo targetNode, StorageType targetStorageType,\n      List\u003cBlockMovingInfo\u003e blkMovingInfos) {\n    Block blk \u003d ExtendedBlock.getLocalBlock(blockInfo.getBlock());\n    BlockMovingInfo blkMovingInfo \u003d new BlockMovingInfo(blk, sourceNode,\n        targetNode, sourceStorageType, targetStorageType);\n    blkMovingInfos.add(blkMovingInfo);\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/sps/StoragePolicySatisfier.java",
          "extendedDetails": {
            "oldValue": "[blockInfo-BlockInfo, sourceNode-DatanodeInfo, sourceStorageType-StorageType, targetNode-DatanodeInfo, targetStorageType-StorageType, blkMovingInfos-List\u003cBlockMovingInfo\u003e]",
            "newValue": "[blockInfo-LocatedBlock, sourceNode-DatanodeInfo, sourceStorageType-StorageType, targetNode-DatanodeInfo, targetStorageType-StorageType, blkMovingInfos-List\u003cBlockMovingInfo\u003e]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-12982 : [SPS]: Reduce the locking and cleanup the Namesystem access. Contributed by Rakesh R.\n",
          "commitDate": "12/08/18 3:06 AM",
          "commitName": "05d4daf6ba3e5bd40f46e8003ee12fc7c613453d",
          "commitAuthor": "Surendra Singh Lilhore",
          "commitDateOld": "12/08/18 3:06 AM",
          "commitNameOld": "78420719eb1f138c6f10558befb7bc8ebcc28a54",
          "commitAuthorOld": "Uma Maheswara Rao G",
          "daysBetweenCommits": 0.0,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,10 +1,9 @@\n-  private void buildContinuousBlockMovingInfos(BlockInfo blockInfo,\n+  private void buildContinuousBlockMovingInfos(LocatedBlock blockInfo,\n       DatanodeInfo sourceNode, StorageType sourceStorageType,\n       DatanodeInfo targetNode, StorageType targetStorageType,\n       List\u003cBlockMovingInfo\u003e blkMovingInfos) {\n-    Block blk \u003d new Block(blockInfo.getBlockId(), blockInfo.getNumBytes(),\n-        blockInfo.getGenerationStamp());\n+    Block blk \u003d ExtendedBlock.getLocalBlock(blockInfo.getBlock());\n     BlockMovingInfo blkMovingInfo \u003d new BlockMovingInfo(blk, sourceNode,\n         targetNode, sourceStorageType, targetStorageType);\n     blkMovingInfos.add(blkMovingInfo);\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private void buildContinuousBlockMovingInfos(LocatedBlock blockInfo,\n      DatanodeInfo sourceNode, StorageType sourceStorageType,\n      DatanodeInfo targetNode, StorageType targetStorageType,\n      List\u003cBlockMovingInfo\u003e blkMovingInfos) {\n    Block blk \u003d ExtendedBlock.getLocalBlock(blockInfo.getBlock());\n    BlockMovingInfo blkMovingInfo \u003d new BlockMovingInfo(blk, sourceNode,\n        targetNode, sourceStorageType, targetStorageType);\n    blkMovingInfos.add(blkMovingInfo);\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/sps/StoragePolicySatisfier.java",
          "extendedDetails": {}
        }
      ]
    },
    "78420719eb1f138c6f10558befb7bc8ebcc28a54": {
      "type": "Yfilerename",
      "commitMessage": "HDFS-12955: [SPS]: Move SPS classes to a separate package. Contributed by Rakesh R.\n",
      "commitDate": "12/08/18 3:06 AM",
      "commitName": "78420719eb1f138c6f10558befb7bc8ebcc28a54",
      "commitAuthor": "Uma Maheswara Rao G",
      "commitDateOld": "12/08/18 3:06 AM",
      "commitNameOld": "c561cb316e365ef674784cd6cf0b12c0fbc271a3",
      "commitAuthorOld": "Surendra Singh Lilhore",
      "daysBetweenCommits": 0.0,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "",
      "actualSource": "  private void buildContinuousBlockMovingInfos(BlockInfo blockInfo,\n      DatanodeInfo sourceNode, StorageType sourceStorageType,\n      DatanodeInfo targetNode, StorageType targetStorageType,\n      List\u003cBlockMovingInfo\u003e blkMovingInfos) {\n    Block blk \u003d new Block(blockInfo.getBlockId(), blockInfo.getNumBytes(),\n        blockInfo.getGenerationStamp());\n    BlockMovingInfo blkMovingInfo \u003d new BlockMovingInfo(blk, sourceNode,\n        targetNode, sourceStorageType, targetStorageType);\n    blkMovingInfos.add(blkMovingInfo);\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/sps/StoragePolicySatisfier.java",
      "extendedDetails": {
        "oldPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/StoragePolicySatisfier.java",
        "newPath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/sps/StoragePolicySatisfier.java"
      }
    },
    "00eceed233d6e80d5c7137bf5b5286746ec4d5fb": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "HDFS-12570: [SPS]: Refactor Co-ordinator datanode logic to track the block storage movements. Contributed by Rakesh R.\n",
      "commitDate": "12/08/18 3:06 AM",
      "commitName": "00eceed233d6e80d5c7137bf5b5286746ec4d5fb",
      "commitAuthor": "Uma Maheswara Rao G",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "HDFS-12570: [SPS]: Refactor Co-ordinator datanode logic to track the block storage movements. Contributed by Rakesh R.\n",
          "commitDate": "12/08/18 3:06 AM",
          "commitName": "00eceed233d6e80d5c7137bf5b5286746ec4d5fb",
          "commitAuthor": "Uma Maheswara Rao G",
          "commitDateOld": "12/08/18 3:06 AM",
          "commitNameOld": "bfd3f8bd8a9ae2186ec3e4addc71f912ec7b8923",
          "commitAuthorOld": "Uma Maheswara Rao G",
          "daysBetweenCommits": 0.0,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,10 @@\n   private void buildContinuousBlockMovingInfos(BlockInfo blockInfo,\n-      List\u003cDatanodeInfo\u003e sourceNodes, List\u003cStorageType\u003e sourceStorageTypes,\n-      List\u003cDatanodeInfo\u003e targetNodes, List\u003cStorageType\u003e targetStorageTypes,\n+      DatanodeInfo sourceNode, StorageType sourceStorageType,\n+      DatanodeInfo targetNode, StorageType targetStorageType,\n       List\u003cBlockMovingInfo\u003e blkMovingInfos) {\n     Block blk \u003d new Block(blockInfo.getBlockId(), blockInfo.getNumBytes(),\n         blockInfo.getGenerationStamp());\n-    BlockMovingInfo blkMovingInfo \u003d new BlockMovingInfo(blk,\n-        sourceNodes.toArray(new DatanodeInfo[sourceNodes.size()]),\n-        targetNodes.toArray(new DatanodeInfo[targetNodes.size()]),\n-        sourceStorageTypes.toArray(new StorageType[sourceStorageTypes.size()]),\n-        targetStorageTypes.toArray(new StorageType[targetStorageTypes.size()]));\n+    BlockMovingInfo blkMovingInfo \u003d new BlockMovingInfo(blk, sourceNode,\n+        targetNode, sourceStorageType, targetStorageType);\n     blkMovingInfos.add(blkMovingInfo);\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private void buildContinuousBlockMovingInfos(BlockInfo blockInfo,\n      DatanodeInfo sourceNode, StorageType sourceStorageType,\n      DatanodeInfo targetNode, StorageType targetStorageType,\n      List\u003cBlockMovingInfo\u003e blkMovingInfos) {\n    Block blk \u003d new Block(blockInfo.getBlockId(), blockInfo.getNumBytes(),\n        blockInfo.getGenerationStamp());\n    BlockMovingInfo blkMovingInfo \u003d new BlockMovingInfo(blk, sourceNode,\n        targetNode, sourceStorageType, targetStorageType);\n    blkMovingInfos.add(blkMovingInfo);\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/StoragePolicySatisfier.java",
          "extendedDetails": {
            "oldValue": "[blockInfo-BlockInfo, sourceNodes-List\u003cDatanodeInfo\u003e, sourceStorageTypes-List\u003cStorageType\u003e, targetNodes-List\u003cDatanodeInfo\u003e, targetStorageTypes-List\u003cStorageType\u003e, blkMovingInfos-List\u003cBlockMovingInfo\u003e]",
            "newValue": "[blockInfo-BlockInfo, sourceNode-DatanodeInfo, sourceStorageType-StorageType, targetNode-DatanodeInfo, targetStorageType-StorageType, blkMovingInfos-List\u003cBlockMovingInfo\u003e]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "HDFS-12570: [SPS]: Refactor Co-ordinator datanode logic to track the block storage movements. Contributed by Rakesh R.\n",
          "commitDate": "12/08/18 3:06 AM",
          "commitName": "00eceed233d6e80d5c7137bf5b5286746ec4d5fb",
          "commitAuthor": "Uma Maheswara Rao G",
          "commitDateOld": "12/08/18 3:06 AM",
          "commitNameOld": "bfd3f8bd8a9ae2186ec3e4addc71f912ec7b8923",
          "commitAuthorOld": "Uma Maheswara Rao G",
          "daysBetweenCommits": 0.0,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "diff": "@@ -1,13 +1,10 @@\n   private void buildContinuousBlockMovingInfos(BlockInfo blockInfo,\n-      List\u003cDatanodeInfo\u003e sourceNodes, List\u003cStorageType\u003e sourceStorageTypes,\n-      List\u003cDatanodeInfo\u003e targetNodes, List\u003cStorageType\u003e targetStorageTypes,\n+      DatanodeInfo sourceNode, StorageType sourceStorageType,\n+      DatanodeInfo targetNode, StorageType targetStorageType,\n       List\u003cBlockMovingInfo\u003e blkMovingInfos) {\n     Block blk \u003d new Block(blockInfo.getBlockId(), blockInfo.getNumBytes(),\n         blockInfo.getGenerationStamp());\n-    BlockMovingInfo blkMovingInfo \u003d new BlockMovingInfo(blk,\n-        sourceNodes.toArray(new DatanodeInfo[sourceNodes.size()]),\n-        targetNodes.toArray(new DatanodeInfo[targetNodes.size()]),\n-        sourceStorageTypes.toArray(new StorageType[sourceStorageTypes.size()]),\n-        targetStorageTypes.toArray(new StorageType[targetStorageTypes.size()]));\n+    BlockMovingInfo blkMovingInfo \u003d new BlockMovingInfo(blk, sourceNode,\n+        targetNode, sourceStorageType, targetStorageType);\n     blkMovingInfos.add(blkMovingInfo);\n   }\n\\ No newline at end of file\n",
          "actualSource": "  private void buildContinuousBlockMovingInfos(BlockInfo blockInfo,\n      DatanodeInfo sourceNode, StorageType sourceStorageType,\n      DatanodeInfo targetNode, StorageType targetStorageType,\n      List\u003cBlockMovingInfo\u003e blkMovingInfos) {\n    Block blk \u003d new Block(blockInfo.getBlockId(), blockInfo.getNumBytes(),\n        blockInfo.getGenerationStamp());\n    BlockMovingInfo blkMovingInfo \u003d new BlockMovingInfo(blk, sourceNode,\n        targetNode, sourceStorageType, targetStorageType);\n    blkMovingInfos.add(blkMovingInfo);\n  }",
          "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/StoragePolicySatisfier.java",
          "extendedDetails": {}
        }
      ]
    },
    "81ed364b632189c6eebd6426b6abc52c790570ea": {
      "type": "Yrename",
      "commitMessage": "HDFS-11193 : [SPS]: Erasure coded files should be considered for satisfying storage policy. Contributed by Rakesh R\n",
      "commitDate": "12/08/18 3:05 AM",
      "commitName": "81ed364b632189c6eebd6426b6abc52c790570ea",
      "commitAuthor": "Uma Maheswara Rao G",
      "commitDateOld": "12/08/18 3:05 AM",
      "commitNameOld": "b7bed9f00a25bcad6f9c3543f5a1fb0a1f23b0e9",
      "commitAuthorOld": "Uma Maheswara Rao G",
      "daysBetweenCommits": 0.0,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,13 +1,13 @@\n-  private void buildBlockMovingInfos(BlockInfo blockInfo,\n+  private void buildContinuousBlockMovingInfos(BlockInfo blockInfo,\n       List\u003cDatanodeInfo\u003e sourceNodes, List\u003cStorageType\u003e sourceStorageTypes,\n       List\u003cDatanodeInfo\u003e targetNodes, List\u003cStorageType\u003e targetStorageTypes,\n       List\u003cBlockMovingInfo\u003e blkMovingInfos) {\n     Block blk \u003d new Block(blockInfo.getBlockId(), blockInfo.getNumBytes(),\n         blockInfo.getGenerationStamp());\n     BlockMovingInfo blkMovingInfo \u003d new BlockMovingInfo(blk,\n         sourceNodes.toArray(new DatanodeInfo[sourceNodes.size()]),\n         targetNodes.toArray(new DatanodeInfo[targetNodes.size()]),\n         sourceStorageTypes.toArray(new StorageType[sourceStorageTypes.size()]),\n         targetStorageTypes.toArray(new StorageType[targetStorageTypes.size()]));\n     blkMovingInfos.add(blkMovingInfo);\n   }\n\\ No newline at end of file\n",
      "actualSource": "  private void buildContinuousBlockMovingInfos(BlockInfo blockInfo,\n      List\u003cDatanodeInfo\u003e sourceNodes, List\u003cStorageType\u003e sourceStorageTypes,\n      List\u003cDatanodeInfo\u003e targetNodes, List\u003cStorageType\u003e targetStorageTypes,\n      List\u003cBlockMovingInfo\u003e blkMovingInfos) {\n    Block blk \u003d new Block(blockInfo.getBlockId(), blockInfo.getNumBytes(),\n        blockInfo.getGenerationStamp());\n    BlockMovingInfo blkMovingInfo \u003d new BlockMovingInfo(blk,\n        sourceNodes.toArray(new DatanodeInfo[sourceNodes.size()]),\n        targetNodes.toArray(new DatanodeInfo[targetNodes.size()]),\n        sourceStorageTypes.toArray(new StorageType[sourceStorageTypes.size()]),\n        targetStorageTypes.toArray(new StorageType[targetStorageTypes.size()]));\n    blkMovingInfos.add(blkMovingInfo);\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/StoragePolicySatisfier.java",
      "extendedDetails": {
        "oldValue": "buildBlockMovingInfos",
        "newValue": "buildContinuousBlockMovingInfos"
      }
    },
    "b7bed9f00a25bcad6f9c3543f5a1fb0a1f23b0e9": {
      "type": "Yintroduced",
      "commitMessage": "HDFS-11248: [SPS]: Handle partial block location movements. Contributed by Rakesh R\n",
      "commitDate": "12/08/18 3:05 AM",
      "commitName": "b7bed9f00a25bcad6f9c3543f5a1fb0a1f23b0e9",
      "commitAuthor": "Uma Maheswara Rao G",
      "diff": "@@ -0,0 +1,13 @@\n+  private void buildBlockMovingInfos(BlockInfo blockInfo,\n+      List\u003cDatanodeInfo\u003e sourceNodes, List\u003cStorageType\u003e sourceStorageTypes,\n+      List\u003cDatanodeInfo\u003e targetNodes, List\u003cStorageType\u003e targetStorageTypes,\n+      List\u003cBlockMovingInfo\u003e blkMovingInfos) {\n+    Block blk \u003d new Block(blockInfo.getBlockId(), blockInfo.getNumBytes(),\n+        blockInfo.getGenerationStamp());\n+    BlockMovingInfo blkMovingInfo \u003d new BlockMovingInfo(blk,\n+        sourceNodes.toArray(new DatanodeInfo[sourceNodes.size()]),\n+        targetNodes.toArray(new DatanodeInfo[targetNodes.size()]),\n+        sourceStorageTypes.toArray(new StorageType[sourceStorageTypes.size()]),\n+        targetStorageTypes.toArray(new StorageType[targetStorageTypes.size()]));\n+    blkMovingInfos.add(blkMovingInfo);\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  private void buildBlockMovingInfos(BlockInfo blockInfo,\n      List\u003cDatanodeInfo\u003e sourceNodes, List\u003cStorageType\u003e sourceStorageTypes,\n      List\u003cDatanodeInfo\u003e targetNodes, List\u003cStorageType\u003e targetStorageTypes,\n      List\u003cBlockMovingInfo\u003e blkMovingInfos) {\n    Block blk \u003d new Block(blockInfo.getBlockId(), blockInfo.getNumBytes(),\n        blockInfo.getGenerationStamp());\n    BlockMovingInfo blkMovingInfo \u003d new BlockMovingInfo(blk,\n        sourceNodes.toArray(new DatanodeInfo[sourceNodes.size()]),\n        targetNodes.toArray(new DatanodeInfo[targetNodes.size()]),\n        sourceStorageTypes.toArray(new StorageType[sourceStorageTypes.size()]),\n        targetStorageTypes.toArray(new StorageType[targetStorageTypes.size()]));\n    blkMovingInfos.add(blkMovingInfo);\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/namenode/StoragePolicySatisfier.java"
    }
  }
}