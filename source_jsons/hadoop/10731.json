{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "ShortCircuitRegistry.java",
  "functionName": "removeShm",
  "functionId": "removeShm___shm-ShortCircuitShm",
  "sourceFilePath": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/ShortCircuitRegistry.java",
  "functionStartLine": 116,
  "functionEndLine": 133,
  "numCommitsSeen": 18,
  "timeTaken": 1205,
  "changeHistory": [
    "d95c13774e1bd5b3cc61bf4da8bae4a93ed0040c",
    "6465b0b55f263c06f4d37800db951adba314a9fd"
  ],
  "changeHistoryShort": {
    "d95c13774e1bd5b3cc61bf4da8bae4a93ed0040c": "Ybodychange",
    "6465b0b55f263c06f4d37800db951adba314a9fd": "Yintroduced"
  },
  "changeHistoryDetails": {
    "d95c13774e1bd5b3cc61bf4da8bae4a93ed0040c": {
      "type": "Ybodychange",
      "commitMessage": "HDFS-12963. Error log level in ShortCircuitRegistry#removeShm. Contributed by hu xiaodong.\n",
      "commitDate": "23/01/18 6:43 PM",
      "commitName": "d95c13774e1bd5b3cc61bf4da8bae4a93ed0040c",
      "commitAuthor": "Yiqun Lin",
      "commitDateOld": "23/09/17 12:16 PM",
      "commitNameOld": "40ef9fa171f8aa5209c80acae351bd90afe364ab",
      "commitAuthorOld": "Anu Engineer",
      "daysBetweenCommits": 122.31,
      "commitsBetweenForRepo": 817,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,18 +1,18 @@\n   public synchronized void removeShm(ShortCircuitShm shm) {\n     if (LOG.isTraceEnabled()) {\n-      LOG.debug(\"removing shm \" + shm);\n+      LOG.trace(\"removing shm \" + shm);\n     }\n     // Stop tracking the shmId.\n     RegisteredShm removedShm \u003d segments.remove(shm.getShmId());\n     Preconditions.checkState(removedShm \u003d\u003d shm,\n         \"failed to remove \" + shm.getShmId());\n     // Stop tracking the slots.\n     for (Iterator\u003cSlot\u003e iter \u003d shm.slotIterator(); iter.hasNext(); ) {\n       Slot slot \u003d iter.next();\n       boolean removed \u003d slots.remove(slot.getBlockId(), slot);\n       Preconditions.checkState(removed);\n       slot.makeInvalid();\n     }\n     // De-allocate the memory map and close the shared file. \n     shm.free();\n   }\n\\ No newline at end of file\n",
      "actualSource": "  public synchronized void removeShm(ShortCircuitShm shm) {\n    if (LOG.isTraceEnabled()) {\n      LOG.trace(\"removing shm \" + shm);\n    }\n    // Stop tracking the shmId.\n    RegisteredShm removedShm \u003d segments.remove(shm.getShmId());\n    Preconditions.checkState(removedShm \u003d\u003d shm,\n        \"failed to remove \" + shm.getShmId());\n    // Stop tracking the slots.\n    for (Iterator\u003cSlot\u003e iter \u003d shm.slotIterator(); iter.hasNext(); ) {\n      Slot slot \u003d iter.next();\n      boolean removed \u003d slots.remove(slot.getBlockId(), slot);\n      Preconditions.checkState(removed);\n      slot.makeInvalid();\n    }\n    // De-allocate the memory map and close the shared file. \n    shm.free();\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/ShortCircuitRegistry.java",
      "extendedDetails": {}
    },
    "6465b0b55f263c06f4d37800db951adba314a9fd": {
      "type": "Yintroduced",
      "commitMessage": "add missing file for HDFS-5950\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1573434 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "02/03/14 8:01 PM",
      "commitName": "6465b0b55f263c06f4d37800db951adba314a9fd",
      "commitAuthor": "Colin McCabe",
      "diff": "@@ -0,0 +1,18 @@\n+  public synchronized void removeShm(ShortCircuitShm shm) {\n+    if (LOG.isTraceEnabled()) {\n+      LOG.debug(\"removing shm \" + shm);\n+    }\n+    // Stop tracking the shmId.\n+    RegisteredShm removedShm \u003d segments.remove(shm.getShmId());\n+    Preconditions.checkState(removedShm \u003d\u003d shm,\n+        \"failed to remove \" + shm.getShmId());\n+    // Stop tracking the slots.\n+    for (Iterator\u003cSlot\u003e iter \u003d shm.slotIterator(); iter.hasNext(); ) {\n+      Slot slot \u003d iter.next();\n+      boolean removed \u003d slots.remove(slot.getBlockId(), slot);\n+      Preconditions.checkState(removed);\n+      slot.makeInvalid();\n+    }\n+    // De-allocate the memory map and close the shared file. \n+    shm.free();\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  public synchronized void removeShm(ShortCircuitShm shm) {\n    if (LOG.isTraceEnabled()) {\n      LOG.debug(\"removing shm \" + shm);\n    }\n    // Stop tracking the shmId.\n    RegisteredShm removedShm \u003d segments.remove(shm.getShmId());\n    Preconditions.checkState(removedShm \u003d\u003d shm,\n        \"failed to remove \" + shm.getShmId());\n    // Stop tracking the slots.\n    for (Iterator\u003cSlot\u003e iter \u003d shm.slotIterator(); iter.hasNext(); ) {\n      Slot slot \u003d iter.next();\n      boolean removed \u003d slots.remove(slot.getBlockId(), slot);\n      Preconditions.checkState(removed);\n      slot.makeInvalid();\n    }\n    // De-allocate the memory map and close the shared file. \n    shm.free();\n  }",
      "path": "hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/server/datanode/ShortCircuitRegistry.java"
    }
  }
}