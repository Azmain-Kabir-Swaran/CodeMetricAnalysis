{
  "origin": "codeshovel",
  "repositoryName": "hadoop",
  "repositoryPath": "/home/shaiful/research/codeshovel/codeshovel-projects/hadoop/.git",
  "startCommitName": "HEAD",
  "sourceFileName": "NodeStatusUpdaterImpl.java",
  "functionName": "rebootNodeStatusUpdaterAndRegisterWithRM",
  "functionId": "rebootNodeStatusUpdaterAndRegisterWithRM",
  "sourceFilePath": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/NodeStatusUpdaterImpl.java",
  "functionStartLine": 322,
  "functionEndLine": 344,
  "numCommitsSeen": 153,
  "timeTaken": 3874,
  "changeHistory": [
    "39c1ea1ed454b6c61f0985fc951f20913ed964fb",
    "e82f961a3925aadf9e53a009820a48ba9e4f78b6",
    "92b7e0d41302b6b110927f99de5c2b4a4a93c5fd",
    "1c4047b0e46e95a92509de2e59a93433f5968538",
    "a8c330fd338f755acc619aff88e55739d6ee0528",
    "2e3b56f6e907f15f7c6caaad37d37b9e0ee89963"
  ],
  "changeHistoryShort": {
    "39c1ea1ed454b6c61f0985fc951f20913ed964fb": "Ybodychange",
    "e82f961a3925aadf9e53a009820a48ba9e4f78b6": "Ybodychange",
    "92b7e0d41302b6b110927f99de5c2b4a4a93c5fd": "Ybodychange",
    "1c4047b0e46e95a92509de2e59a93433f5968538": "Yrename",
    "a8c330fd338f755acc619aff88e55739d6ee0528": "Ybodychange",
    "2e3b56f6e907f15f7c6caaad37d37b9e0ee89963": "Yintroduced"
  },
  "changeHistoryDetails": {
    "39c1ea1ed454b6c61f0985fc951f20913ed964fb": {
      "type": "Ybodychange",
      "commitMessage": "YARN-8729. Node status updater thread could be lost after it is restarted. Contributed by Tao Yang.\n",
      "commitDate": "13/09/18 7:21 AM",
      "commitName": "39c1ea1ed454b6c61f0985fc951f20913ed964fb",
      "commitAuthor": "Weiwei Yang",
      "commitDateOld": "12/09/18 3:31 AM",
      "commitNameOld": "3b3b6efe2103244febfe6b4f61989e92bd7bb08a",
      "commitAuthorOld": "Naganarasimha",
      "daysBetweenCommits": 1.16,
      "commitsBetweenForRepo": 34,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,23 +1,23 @@\n   protected void rebootNodeStatusUpdaterAndRegisterWithRM() {\n     // Interrupt the updater.\n     synchronized(shutdownMonitor) {\n       if(this.isStopped) {\n         LOG.info(\"Currently being shutdown. Aborting reboot\");\n         return;\n       }\n       this.isStopped \u003d true;\n       sendOutofBandHeartBeat();\n       try {\n         statusUpdater.join();\n         registerWithRM();\n         statusUpdater \u003d new Thread(statusUpdaterRunnable, \"Node Status Updater\");\n-        statusUpdater.start();\n         this.isStopped \u003d false;\n+        statusUpdater.start();\n         LOG.info(\"NodeStatusUpdater thread is reRegistered and restarted\");\n       } catch (Exception e) {\n         String errorMessage \u003d \"Unexpected error rebooting NodeStatusUpdater\";\n         LOG.error(errorMessage, e);\n         throw new YarnRuntimeException(e);\n       }\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  protected void rebootNodeStatusUpdaterAndRegisterWithRM() {\n    // Interrupt the updater.\n    synchronized(shutdownMonitor) {\n      if(this.isStopped) {\n        LOG.info(\"Currently being shutdown. Aborting reboot\");\n        return;\n      }\n      this.isStopped \u003d true;\n      sendOutofBandHeartBeat();\n      try {\n        statusUpdater.join();\n        registerWithRM();\n        statusUpdater \u003d new Thread(statusUpdaterRunnable, \"Node Status Updater\");\n        this.isStopped \u003d false;\n        statusUpdater.start();\n        LOG.info(\"NodeStatusUpdater thread is reRegistered and restarted\");\n      } catch (Exception e) {\n        String errorMessage \u003d \"Unexpected error rebooting NodeStatusUpdater\";\n        LOG.error(errorMessage, e);\n        throw new YarnRuntimeException(e);\n      }\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/NodeStatusUpdaterImpl.java",
      "extendedDetails": {}
    },
    "e82f961a3925aadf9e53a009820a48ba9e4f78b6": {
      "type": "Ybodychange",
      "commitMessage": "YARN-4756. Unnecessary wait in Node Status Updater during reboot. (Eric Badger via kasha)\n",
      "commitDate": "07/04/16 5:05 PM",
      "commitName": "e82f961a3925aadf9e53a009820a48ba9e4f78b6",
      "commitAuthor": "Karthik Kambatla",
      "commitDateOld": "18/03/16 9:12 AM",
      "commitNameOld": "92b7e0d41302b6b110927f99de5c2b4a4a93c5fd",
      "commitAuthorOld": "Eric Payne",
      "daysBetweenCommits": 20.33,
      "commitsBetweenForRepo": 119,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,22 +1,23 @@\n   protected void rebootNodeStatusUpdaterAndRegisterWithRM() {\n     // Interrupt the updater.\n     synchronized(shutdownMonitor) {\n       if(this.isStopped) {\n         LOG.info(\"Currently being shutdown. Aborting reboot\");\n         return;\n       }\n       this.isStopped \u003d true;\n+      sendOutofBandHeartBeat();\n       try {\n         statusUpdater.join();\n         registerWithRM();\n         statusUpdater \u003d new Thread(statusUpdaterRunnable, \"Node Status Updater\");\n         statusUpdater.start();\n         this.isStopped \u003d false;\n         LOG.info(\"NodeStatusUpdater thread is reRegistered and restarted\");\n       } catch (Exception e) {\n         String errorMessage \u003d \"Unexpected error rebooting NodeStatusUpdater\";\n         LOG.error(errorMessage, e);\n         throw new YarnRuntimeException(e);\n       }\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  protected void rebootNodeStatusUpdaterAndRegisterWithRM() {\n    // Interrupt the updater.\n    synchronized(shutdownMonitor) {\n      if(this.isStopped) {\n        LOG.info(\"Currently being shutdown. Aborting reboot\");\n        return;\n      }\n      this.isStopped \u003d true;\n      sendOutofBandHeartBeat();\n      try {\n        statusUpdater.join();\n        registerWithRM();\n        statusUpdater \u003d new Thread(statusUpdaterRunnable, \"Node Status Updater\");\n        statusUpdater.start();\n        this.isStopped \u003d false;\n        LOG.info(\"NodeStatusUpdater thread is reRegistered and restarted\");\n      } catch (Exception e) {\n        String errorMessage \u003d \"Unexpected error rebooting NodeStatusUpdater\";\n        LOG.error(errorMessage, e);\n        throw new YarnRuntimeException(e);\n      }\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/NodeStatusUpdaterImpl.java",
      "extendedDetails": {}
    },
    "92b7e0d41302b6b110927f99de5c2b4a4a93c5fd": {
      "type": "Ybodychange",
      "commitMessage": "YARN-4686. MiniYARNCluster.start() returns before cluster is completely started. Contributed by Eric Badger.\n",
      "commitDate": "18/03/16 9:12 AM",
      "commitName": "92b7e0d41302b6b110927f99de5c2b4a4a93c5fd",
      "commitAuthor": "Eric Payne",
      "commitDateOld": "16/12/15 1:18 PM",
      "commitNameOld": "79c41b1d83e981ae74cb8b58ffcf7907b7612ad4",
      "commitAuthorOld": "Wangda Tan",
      "daysBetweenCommits": 92.79,
      "commitsBetweenForRepo": 591,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,17 +1,22 @@\n   protected void rebootNodeStatusUpdaterAndRegisterWithRM() {\n     // Interrupt the updater.\n-    this.isStopped \u003d true;\n-\n-    try {\n-      statusUpdater.join();\n-      registerWithRM();\n-      statusUpdater \u003d new Thread(statusUpdaterRunnable, \"Node Status Updater\");\n-      this.isStopped \u003d false;\n-      statusUpdater.start();\n-      LOG.info(\"NodeStatusUpdater thread is reRegistered and restarted\");\n-    } catch (Exception e) {\n-      String errorMessage \u003d \"Unexpected error rebooting NodeStatusUpdater\";\n-      LOG.error(errorMessage, e);\n-      throw new YarnRuntimeException(e);\n+    synchronized(shutdownMonitor) {\n+      if(this.isStopped) {\n+        LOG.info(\"Currently being shutdown. Aborting reboot\");\n+        return;\n+      }\n+      this.isStopped \u003d true;\n+      try {\n+        statusUpdater.join();\n+        registerWithRM();\n+        statusUpdater \u003d new Thread(statusUpdaterRunnable, \"Node Status Updater\");\n+        statusUpdater.start();\n+        this.isStopped \u003d false;\n+        LOG.info(\"NodeStatusUpdater thread is reRegistered and restarted\");\n+      } catch (Exception e) {\n+        String errorMessage \u003d \"Unexpected error rebooting NodeStatusUpdater\";\n+        LOG.error(errorMessage, e);\n+        throw new YarnRuntimeException(e);\n+      }\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  protected void rebootNodeStatusUpdaterAndRegisterWithRM() {\n    // Interrupt the updater.\n    synchronized(shutdownMonitor) {\n      if(this.isStopped) {\n        LOG.info(\"Currently being shutdown. Aborting reboot\");\n        return;\n      }\n      this.isStopped \u003d true;\n      try {\n        statusUpdater.join();\n        registerWithRM();\n        statusUpdater \u003d new Thread(statusUpdaterRunnable, \"Node Status Updater\");\n        statusUpdater.start();\n        this.isStopped \u003d false;\n        LOG.info(\"NodeStatusUpdater thread is reRegistered and restarted\");\n      } catch (Exception e) {\n        String errorMessage \u003d \"Unexpected error rebooting NodeStatusUpdater\";\n        LOG.error(errorMessage, e);\n        throw new YarnRuntimeException(e);\n      }\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/NodeStatusUpdaterImpl.java",
      "extendedDetails": {}
    },
    "1c4047b0e46e95a92509de2e59a93433f5968538": {
      "type": "Yrename",
      "commitMessage": "YARN-1783. Fixed a bug in NodeManager\u0027s status-updater that was losing completed container statuses when NodeManager is forced to resync by the ResourceManager. Contributed by Jian He.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1575437 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "07/03/14 2:36 PM",
      "commitName": "1c4047b0e46e95a92509de2e59a93433f5968538",
      "commitAuthor": "Vinod Kumar Vavilapalli",
      "commitDateOld": "18/11/13 9:17 PM",
      "commitNameOld": "cfa783141fa69c2cf154d1d9e5393353d14ce5e1",
      "commitAuthorOld": "Vinod Kumar Vavilapalli",
      "daysBetweenCommits": 108.72,
      "commitsBetweenForRepo": 763,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,17 +1,17 @@\n-  protected void rebootNodeStatusUpdater() {\n+  protected void rebootNodeStatusUpdaterAndRegisterWithRM() {\n     // Interrupt the updater.\n     this.isStopped \u003d true;\n \n     try {\n       statusUpdater.join();\n       registerWithRM();\n       statusUpdater \u003d new Thread(statusUpdaterRunnable, \"Node Status Updater\");\n       this.isStopped \u003d false;\n       statusUpdater.start();\n       LOG.info(\"NodeStatusUpdater thread is reRegistered and restarted\");\n     } catch (Exception e) {\n       String errorMessage \u003d \"Unexpected error rebooting NodeStatusUpdater\";\n       LOG.error(errorMessage, e);\n       throw new YarnRuntimeException(e);\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  protected void rebootNodeStatusUpdaterAndRegisterWithRM() {\n    // Interrupt the updater.\n    this.isStopped \u003d true;\n\n    try {\n      statusUpdater.join();\n      registerWithRM();\n      statusUpdater \u003d new Thread(statusUpdaterRunnable, \"Node Status Updater\");\n      this.isStopped \u003d false;\n      statusUpdater.start();\n      LOG.info(\"NodeStatusUpdater thread is reRegistered and restarted\");\n    } catch (Exception e) {\n      String errorMessage \u003d \"Unexpected error rebooting NodeStatusUpdater\";\n      LOG.error(errorMessage, e);\n      throw new YarnRuntimeException(e);\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/NodeStatusUpdaterImpl.java",
      "extendedDetails": {
        "oldValue": "rebootNodeStatusUpdater",
        "newValue": "rebootNodeStatusUpdaterAndRegisterWithRM"
      }
    },
    "a8c330fd338f755acc619aff88e55739d6ee0528": {
      "type": "Ybodychange",
      "commitMessage": "YARN-760. NodeManager throws AvroRuntimeException on failed start. Contributed by Niranjan Singh\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1490704 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "07/06/13 9:20 AM",
      "commitName": "a8c330fd338f755acc619aff88e55739d6ee0528",
      "commitAuthor": "Jason Darrell Lowe",
      "commitDateOld": "03/06/13 9:05 PM",
      "commitNameOld": "a83fb61ac07c0468cbc7a38526e92683883dd932",
      "commitAuthorOld": "Vinod Kumar Vavilapalli",
      "daysBetweenCommits": 3.51,
      "commitsBetweenForRepo": 26,
      "commitsBetweenForFile": 1,
      "diff": "@@ -1,15 +1,17 @@\n   protected void rebootNodeStatusUpdater() {\n     // Interrupt the updater.\n     this.isStopped \u003d true;\n \n     try {\n       statusUpdater.join();\n       registerWithRM();\n       statusUpdater \u003d new Thread(statusUpdaterRunnable, \"Node Status Updater\");\n       this.isStopped \u003d false;\n       statusUpdater.start();\n       LOG.info(\"NodeStatusUpdater thread is reRegistered and restarted\");\n     } catch (Exception e) {\n-      throw new AvroRuntimeException(e);\n+      String errorMessage \u003d \"Unexpected error rebooting NodeStatusUpdater\";\n+      LOG.error(errorMessage, e);\n+      throw new YarnRuntimeException(e);\n     }\n   }\n\\ No newline at end of file\n",
      "actualSource": "  protected void rebootNodeStatusUpdater() {\n    // Interrupt the updater.\n    this.isStopped \u003d true;\n\n    try {\n      statusUpdater.join();\n      registerWithRM();\n      statusUpdater \u003d new Thread(statusUpdaterRunnable, \"Node Status Updater\");\n      this.isStopped \u003d false;\n      statusUpdater.start();\n      LOG.info(\"NodeStatusUpdater thread is reRegistered and restarted\");\n    } catch (Exception e) {\n      String errorMessage \u003d \"Unexpected error rebooting NodeStatusUpdater\";\n      LOG.error(errorMessage, e);\n      throw new YarnRuntimeException(e);\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/NodeStatusUpdaterImpl.java",
      "extendedDetails": {}
    },
    "2e3b56f6e907f15f7c6caaad37d37b9e0ee89963": {
      "type": "Yintroduced",
      "commitMessage": "YARN-495. Changed NM reboot behaviour to be a simple resync - kill all containers  and re-register with RM. Contributed by Jian He.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/common/trunk@1466752 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "10/04/13 7:00 PM",
      "commitName": "2e3b56f6e907f15f7c6caaad37d37b9e0ee89963",
      "commitAuthor": "Vinod Kumar Vavilapalli",
      "diff": "@@ -0,0 +1,15 @@\n+  protected void rebootNodeStatusUpdater() {\n+    // Interrupt the updater.\n+    this.isStopped \u003d true;\n+\n+    try {\n+      statusUpdater.join();\n+      registerWithRM();\n+      statusUpdater \u003d new Thread(statusUpdaterRunnable, \"Node Status Updater\");\n+      this.isStopped \u003d false;\n+      statusUpdater.start();\n+      LOG.info(\"NodeStatusUpdater thread is reRegistered and restarted\");\n+    } catch (Exception e) {\n+      throw new AvroRuntimeException(e);\n+    }\n+  }\n\\ No newline at end of file\n",
      "actualSource": "  protected void rebootNodeStatusUpdater() {\n    // Interrupt the updater.\n    this.isStopped \u003d true;\n\n    try {\n      statusUpdater.join();\n      registerWithRM();\n      statusUpdater \u003d new Thread(statusUpdaterRunnable, \"Node Status Updater\");\n      this.isStopped \u003d false;\n      statusUpdater.start();\n      LOG.info(\"NodeStatusUpdater thread is reRegistered and restarted\");\n    } catch (Exception e) {\n      throw new AvroRuntimeException(e);\n    }\n  }",
      "path": "hadoop-yarn-project/hadoop-yarn/hadoop-yarn-server/hadoop-yarn-server-nodemanager/src/main/java/org/apache/hadoop/yarn/server/nodemanager/NodeStatusUpdaterImpl.java"
    }
  }
}